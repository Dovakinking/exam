

МОСКОВСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ 
им. М.В. ЛОМОНОСОВА Экономический факультет 

Филипп Картаев 
ВВЕДЕНИЕ В ЭКОНОМЕТРИКУ 
Учебник 
Москва 2019 
УДК 330.43 ББК 65в6 К27 
Картаев Филипп 
К27 Введение в эконометрику: учебник. – М.: Экономический факультет МГУ имени М.В. Ломоносова, 2019. – 472 с. 
ISBN 978-5-906932-22-8 
Книга представляет собой вводный учебник по эконометрике, включающий и обсуждение теории, и разбор большого числа практических примеров. Освоив её, вы сможете понимать современные статьи, использующие эмпирические методы, а также осуществить собственное эконометрическое исследование. 
ISBN 978-5-906932-22-8 © Экономический факультет                                                                                 МГУ имени М.В. Ломоносова, 2019 
ОГЛАВЛЕНИЕ 
Предисловие . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 
Предисловие для преподавателей ........................................ 9 
Глава 1 . Что такое эконометрика и зачем она нужна ........................ 11 
1.1. Чем занимаются эконометристы ........................................11 
1.2. Корреляция и причинно-следственная связь: некоторые подводные камни............................................15 
1.3. Типы данных, используемых в эконометрике .............................21 Задания для самостоятельного решения .....................................23 
Глава 2 . Парная регрессия ............................................. 25 
2.1. Предварительные замечания............................................25 
2.2. Метод наименьших квадратов...........................................27 
2.3. Классическая линейная модель парной регрессии .........................36 
2.4. Свойства МНК-оценок ................................................41 
2.5. Тестирование гипотез и построение доверительных интервалов .............46 2.6. Прогнозирование .....................................................58 2.7. Заключение...........................................................61 Задания для самостоятельного решения .....................................62 
Глава 3 . Множественная регрессия: основы ............................... 65 
3.1. Почему не стоит ограничиваться парной регрессией . . . . . . . . . . . . . . . . . . . . . . .65 
3.2. Классическая линейная модель множественной регрессии .................67 
3.3. Векторно-матричная форма записи и некоторые доказательства ............69 
3.4. Степень соответствия модели данным....................................77 
3.5. Тестирование гипотез и построение доверительных интервалов .............80 
3.6. Тест на линейное ограничение общего вида...............................88 3.7. Обобщающий пример..................................................88 Задания для самостоятельного решения .....................................23 Приложение 3А . Таблицы распределения Стьюдента и Фишера ................100 
Глава 4 . Множественная регрессия: мультиколлинеарность, фиктивные переменные, нелинейные модели...................... 106 
4.1. Мультиколлинеарность ...............................................106 4.2. Фиктивные переменные...............................................110 
4.3. Нелинейные модели ..................................................116 4.4. Обобщающий пример.................................................127 
4.5. Рекомендации по оформлению результатов эконометрических расчетов............................................134 
Задания для самостоятельного решения ....................................135 


Глава 5 . Гетероскедастичность, обобщенная линейная модель . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .143 
5.1. Гетероскедастичность: определение и последствия .......................143 
5.2. Состоятельные в условиях гетероскедастичности стандартные ошибки..................................................145 
5.3. Взвешенный метод наименьших квадратов ..............................149 
5.4. Выявление гетероскедастичности ......................................154 
5.5. Обобщенная линейная модель и обобщенный МНК . . . . . . . . . . . . . . . . . . . . . .159 Задания для самостоятельного решения ....................................166 
Глава 6 . Модель со стохастическими регрессорами и асимптотический подход в эконометрике ....................... 171 
6.1. Некоторые важные результаты математической статистики................172 
6.2. Линейная регрессионная модель со стохастическими регрессорами ......................................176 
6.3. Состоятельность МНК-оценок.........................................184 
6.4. Асимптотическая нормальность МНК-оценок ...........................188 
6.5. Тестирование гипотез и построение доверительных интервалов ............192 Задания для самостоятельного решения ....................................198 Приложение 6А . Состоятельная в условиях гетероскедастичности 
стандартная ошибка оценки коэффициента: доказательство состоятельности........................ 202 Приложение 6Б . Дельта-метод........................................ 205 Приложение 6В . Таблицы стандартного нормального распределения и распределения Хи-квадрат ............. 209 
Глава 7 . Проблемы спецификации уравнения регрессии ................... 210 
7.1. Эндогенность из-за пропуска существенной переменной..................211 
7.2. Эндогенность из-за выбора неверной функциональной формы связи .......217 
7.3. Эндогенность из-за двусторонней причинно-следственной связи ..........218 
7.4. Эндогенность из-за ошибок измерения .................................222 
7.5. Другие (помимо эндогенности) потенциальные угрозы обоснованности выводов эконометрического исследования.........223 
7.6. Чек-лист эконометриста ..............................................235 Задания для самостоятельного решения ....................................236 
Глава 8 . Инструментальные переменные................................. 241 
8.1. Двухшаговый МНК: парная регрессия ..................................241 
8.2. Двухшаговый МНК: множественная регрессия...........................247 
8.3. Векторно-матричная форма записи.....................................250 
8.4. Тесты для моделей, оцененных двухшаговым МНК.......................251 
8.5. Где взять подходящие инструменты?....................................256 Задания для самостоятельного решения ....................................269 
Глава 9 . Панельные данные ........................................... 262 
9.1. Модель с фиксированными эффектами .................................278 
9.2. Модель с фиктивными переменными ...................................280 
9.3. Внутригрупповое преобразование ......................................286 
9.4. Модель в первых разностях ............................................291 
9.5. Модель со случайными эффектами .....................................293 
9.6. Доступный ОМНК для оценивания модели со случайными эффектами .....295 9.7. Спецификационные тесты.............................................298 Задания для самостоятельного решения ....................................301 
Глава 10 . Модели бинарного выбора .................................... 308 
10.1. Линейная модель вероятности ........................................308 
10.2. Логит-модель: введение ..............................................310 
10.3. Логит-модель: оценивание и тестирование гипотез ......................314 10.4. Пробит-модель......................................................319 Задания для самостоятельного решения ....................................321 
Глава 11 . Оценка эффекта воздействия ................................. 325 
11.1. Оценка эффекта воздействия в идеальном эксперименте .................326 11.2. Оценка эффекта воздействия методом разности разностей ...............333 11.3. Локальный средний эффект воздействия (LATE)........................340 11.4. Разрывный регрессионный дизайн ....................................346 Задания для самостоятельного решения ....................................354 
Заключение: что дальше? ............................................. 360 
Решения к заданиям.................................................. 362 
К главе 1................................................................362 К главе 2................................................................363 К главе 3................................................................375 К главе 4................................................................389 К главе 5................................................................401 К главе 6................................................................416 К главе 7................................................................425 К главе 8................................................................432 К главе 9................................................................443 К главе 10...............................................................453 К главе 11...............................................................458 


ПРЕДИСЛОВИЕ 
В этой книге я постарался собрать все необходимое для первого знакомства с эконометрикой. 
Во-первых, тут есть основы эконометрической теории. Чтобы с ними разобраться, вам потребуется знание математического анализа, линейной алгебры, теории вероятностей и математической статистики. Впрочем, все самые утомительные доказательства вынесены в отдельные параграфы или приложения. Поэтому если ваша цель состоит в знакомстве с ключевыми идеями, а в технические детали вы погружаться не хотите, то их можно будет пропустить. В этом случае требования к базовой математической подготовке будут гораздо более мягкими. 
Во-вторых, в учебнике содержится детальное обсуждение применения эконометрики на практике. При рассказе о разных методах я стараюсь пояснить, для чего каждый из них может быть полезен в ваших собственных изысканиях. Во второй части книги есть много отсылок к хорошим (широко цитируемым) исследованиям, использующим эмпирические методы. Эти примеры помогают понять, как эконометрика работает в реальной жизни, и позволяют начать применять ее сразу после знакомства с данной книгой. 
В-третьих, в конце каждой главы предложены задания для самостоятельной работы, а в заключительной части учебника приведены решения каждого из них. Я рекомендую переходить к ключам только после того, как вы попробуете решить задачи самостоятельно. 
Некоторые из этих примеров тоже опираются на реальные прикладные исследования и требуют использования специальных эконометрических пакетов. Решение таких заданий может быть не только полезным для полноценного освоения эконометрики, но и очень интересным. Массивы данных для заданий доступны по адресу: https://clck.ru/FJCBU. Кроме того, по этой ссылке будет публиковаться список всех неточностей и опечаток, обнаруженных в данном издании учебника. 
Хотелось бы выразить признательность моим коллегам, чьи ценные соображения и поддержка сделали возможным появление этой работы: Дарье Елицур, Ольге Клачковой, Евгению Лукашу, Ольге Сучковой, Янине Рощиной, Екатерине Ураковой и многим другим, а также Елизавете Майоровой, взявшей на себя труд неоднократно вычитать черновик книги. 
Также выражаю свою благодарность всем тем замечательным студентам экономического факультета МГУ, которым мне довелось читать вводный курс эконометрики: ваша внимательность помогла устранить многие неточности в этом учебнике. Общение с вами служит для автора постоянным источником мотивации и новых идей. 
Все ошибки в итоговой версии работы полностью остаются на совести автора. Буду признателен, если, обнаружив их, вы сообщите мне по электронной почте kartaev@gmail.com. 

ПРЕДИСЛОВИЕ ДЛЯ ПРЕПОДАВАТЕЛЕЙ 
Представленный учебник содержит все темы, необходимые в рамках современного базового курса эконометрики пространственных и панельных данных. В зависимости от начального уровня подготовки студентов и количества часов он может быть полностью изложен в рамках одного семестра или стать основой для годичного курса (во втором случае целесообразно дополнить его введением в методы анализа временных рядов). 
Не вполне традиционной для вводных курсов является, пожалуй, гл. 11, которая посвящена оценке эффектов воздействия. Однако мне представляется важным познакомить студентов с этой идеологией, так как она стала основой многих современных прикладных работ, посвященных выявлению причинно-следственных связей и оценке последствий политики. 
Любой автор вводного учебника по эконометрике вынужден принять несколько важных решений по поводу подхода к изложению материала: 
•	 
начать с модели детерминированных регрессоров или стохастических; 

•	 
обсудить подробно свойства оценок для конечных выборок или сразу делать акцент на асимптотических свойствах; 

•	 
начать со случая гомоскедастичности случайных ошибок или со случая гетероскедастичности. 


Большинство вводных учебников [см., напр., Магнус, Катышев, Пересецкий, 2007; Dougherty, 2011; Носко, 2011] делают выбор в пользу первого варианта в каждом из трех перечисленных пунктов, т.е. начинают с классической линейной модели. Некоторые более поздние работы в каждом из указанных пунктов, напротив, выбирают второй вариант [см., Сток, Ватсон, 2015]. Преимущество последнего заключается в возможности сразу приблизиться к методологии большинства современных прикладных исследований (например, практически все статьи в хороших журналах при работе с пространственными или панельными выборками по умолчанию предполагают, что в данных присутствует гетероскедастичность). Недостаток этого варианта состоит в том, что он более сложен для студентов, если они впервые в жизни знакомятся с эконометрикой, и если вы хотите излагать материал достаточно строго. 
В этом учебнике используется компромиссный путь. Первые главы опираются на предпосылки классической линейной модели с детерминированными регрессорами. Однако довольно быстро мы отказываемся от наименее правдоподобных ее предположений (таких как нормальность случайных ошибок, постоянство их дисперсии или неслучайность регрессоров), переходя к более реалистичным моделям. Как показывает мой опыт преподавания вводного курса эконометрики, такая логика, с одной стороны, помогает комфортно освоить ключевые идеи эконометрики студентам с разным уровнем начальной подготовки, а с другой − дает возможность показать, как теория связана с практическими приложениями. 

ГЛАВА 1 
ЧТО ТАКОЕ ЭКОНОМЕТРИКА И ЗАЧЕМ ОНА НУЖНА 
В первом параграфе главы вы можете найти описание того, что такое эконометрика и какие задачи она позволяет решать. Второй параграф призван показать некоторые типичные трудности, с которыми сталкиваются эконометристы, чтобы продемонстрировать, что в этой науке все не так уж и просто, и мотивировать вас приложить усилия для изучения продвинутых методов. Наконец, в третьем параграфе речь идет о том, без чего прикладная эконометрика невозможна, — о данных. 
1 .1 . Чем занимаются эконометристы 
В литературе можно встретить много определений эконометрической науки. Например, такое. 
Эконометрика — это наука, изучающая количественные и качественные экономические взаимосвязи с помощью математических и статистических методов и моделей. 
Однако лучше всего для понимания того, что представляет собой эконометрика, выяснить, какие задачи можно решать с ее помощью: 
1) проводить описательный (дескриптивный) анализ; 
2) выявлять причинно-следственные связи между переменными; 
3) заниматься прогнозированием. Поясним суть каждого из этих пунктов и приведем примеры. 
Описательный (дескриптивный) анализ 
В этом случае речь идет о количественных оценках зависимостей между переменными без выявления направления причинно-следственных связей. 
Об этом вы уже много знаете из курса математической статистики. Например, скорее всего вы умеете вычислять коэффициент корреляции, сравнивать средние значения в выборках и тестировать гипотезы о соотношении средних друг с другом. В рамках данного учебника мы обсудим и более продвинутые техники. 
Рассмотрим такой пример. Некоторым исследователям интересно, есть ли корреляция между здоровым образом жизни (скажем, количеством времени, которое индивид в течение месяца посвящает тренировкам) и заработной платой. 
Более тонкий вопрос: сохранится ли эта корреляция, если учесть влияние прочих важных факторов, которые могут быть связаны и со склонностью к занятиям физкультурой, и с доходами (например, возраст, здоровье, страна проживания)? Для ответа потребуется нечто большее, чем простой парный коэффициент корреляции, так как он не позволяет учесть влияние прочих факторов. Например, тут может пригодиться множественная регрессия (см. гл. 3). Тем не менее, какой бы инструмент вы ни использовали (коэффициент корреляции, диаграмму рассеяния, регрессию и т.д.), пока вы не задаетесь вопросом о том, где причина, а где следствие1, подобный анализ остается дескриптивным. 
Выявление причинно-следственных связей 

между переменными 
В отличие от предыдущего случая здесь речь идет не просто о наличии корреляции, а о попытке ответа на вопрос: является ли изменение переменной X причиной изменения переменной Y? Идея о том, что корреляция и причинно-следственная связь — это совсем не одно и то же, — одна из ключевых идей эконометрики, и в рамках нашего курса мы будем возвращаться к ней снова и снова, сопровождая рассказ примерами (в том числе уже в следующем параграфе). 
Приведем несколько вопросов о причинно-следственных связях, на которые умеют отвечать эконометристы: 
1. Что произойдет с уровнем преступности, если принять закон, разрешающий гражданам носить личное огнестрельное оружие? Это нетривиальный вопрос, дискуссия по поводу которого ведется и среди политиков, и среди экспертов, и среди простых обывателей. Сторонники закона утверждают, что его введение позволит снизить преступность, так как граждане получат возможность защититься от злоумышленников. Их оппоненты возражают, что в результате введения такого закона преступность, наоборот, вырастет из-за избыточного количества 
1 Мы сознательно выбрали пример, в котором причинно-следственная связь может быть направлена в обе стороны: с одной стороны, люди в хорошей спортивной форме могут иметь более высокую производительность на работе, что способствует увеличению зарплаты; с другой стороны, более состоятельные люди имеют больше возможностей для занятий спортом, так как им легче позволить себе необходимую экипировку или абонемент в спортзал. 
огнестрельного оружия на руках у населения и его спонтанного использования. Оказывается, что при наличии достаточного массива данных ответ на этот вопрос вполне может быть получен с помощью подходящих эконометрических методов. Мы обратимся к этому примеру в главе, посвященной панельным данным. 
2. 
Увеличится ли уровень инфляции в результате ускорения темпов роста денежной массы? Если да, то на сколько процентных пунктов? Произойдет ли это сразу или через некоторое время? Через какое? Макроэкономическая теория подсказывает нам, что, когда центральный банк наращивает количество денег в экономике, общий уровень цен должен расти. Проверка этой гипотезы — достаточно трудная задача, потому что на уровень инфляции в стране оказывают влияние не только решения центрального банка, но и многие другие факторы, скажем, изменения тарифов на услуги естественных монополий (на перевозки грузов по железной дороге или жилищно-коммунальные услуги). Тем не менее в рамках эконометрики временных рядов можно не только выявить эффект воздействия изменений денежной массы на инфляцию, но и понять его распределение во времени. Например, можно выяснить, как сильно изменится общий уровень цен через три месяца, если увеличить предложение денег сегодня. 

Отдельно отметим, что ответ на этот вопрос интересен не только государству, но и частному сектору, например коммерческим банкам, которым для назначения оптимальных процентных ставок нужно понимать, как будущая инфляция среагирует на сегодняшние действия центрального банка. 

3.
 Влияет ли образование индивида на уровень его доходов? Сложность ответа в этом случае состоит в том, что обычный подсчет средних уровней дохода более и менее образованных людей вряд ли даст корректный результат. Образование обычно коррелировано с ненаблюдаемыми характеристиками (например, уровнем таланта, интеллекта и мотивации), которые тоже влияют на заработную плату индивида. Например, более талантливым людям легче поступить в университет, поэтому они чаще это делают. 


Таким образом, может оказаться, что более образованные люди получают более высокую зарплату не потому, что они более образованные, а потому, что они более талантливые. 
В результате сравнение средних приведет к преувеличенной оценке эффекта от образования. Такую ситуацию называют смещением из-за самоотбора (selection bias). 
Поскольку важные факторы оказываются ненаблюдаемыми (получить надежный измеритель уровня таланта очень трудно), чтобы отделить эффект их влияния от эффекта самого образования, приходится использовать довольно тонкие методы, которые мы обсудим в главе, посвященной инструментальным переменным. 

Прогнозирование 
В данном случае речь идет о прогнозировании/предсказании значений тех или иных переменных, и примеры тут привести проще всего. 
• 
Сколько будет стоить однокомнатная квартира с заданными характеристиками на вторичном рынке недвижимости Москвы через полгода? 

• 
С какой вероятностью в следующем году в России начнется экономический спад? 

• 
Если выдать кредит этому клиенту с известными характеристиками, вернет ли он его в будущем или нет? 


Все эти вопросы в том или ином смысле являются вопросами о прогнозировании, и нет сомнений в практической пользе от умения отвечать на них. 
Лирическое отступление о моих личных наблюдениях по поводу востребованности эконометрики 
Вокруг экономического факультета МГУ, где я со своими коллегами преподаю эконометрику, сформировалось значительное сообщество выпускников, для которых применение эконометрических методов стало основой профессии, источником вдохновения (да и денег тоже). 
Они используют эконометрику и другие продвинутые методы анализа данных в совершенно разных областях: 
1. 
В корпоративном секторе, например в Яндексе, ВТБ Капитале, в ведущих российских операторах мобильной связи и многих других компаниях, принимающих решения на основе работы с данными. 

2. 
В Центральном банке Российской Федерации, Министерстве экономического развития и других подобных государственных структурах. 

3. 
Наконец, в науке — в ведущих российских университетах и исследовательских центрах, а также в лучших университетах по всему миру, например в Принстоне, Чикаго и Мадриде. 


Истории всех этих людей заставляют меня верить в то, что инвестиции времени и сил в изучение эконометрики определенно окупаются, а знание этой науки является важным преимуществом на соответствующем рынке труда. 
Можно ли быть успешным экономистом, совсем не зная эконометрики? Конечно, можно. Однако с эконометрикой эта задача становится гораздо более реалистичной. 



1 .2 . Корреляция и причинно-следственная связь: некоторые подводные камни 
В этом параграфе мы обсудим несколько важных эконометрических идей. Обойдемся без продвинутых методов (которые нам только предстоит изучить в будущем), вместо этого ограничимся пока анализом простых таблиц и графиков. 
Пример 1.1. Подготовительные курсы 
В таблице 1.1 приведены статистические данные, которые характеризуют платные курсы по подготовке к поступлению в магистратуру экономического факультета одного из ведущих российских университетов. 
Интуитивно кажется, что ходить на курсы полезно. Однако разглядывание табл. 1.1 подталкивает нас к противоположному выводу. Курсы выглядят не просто бесполезными, а даже вредными: их посетители пишут экзамен хуже тех, кто готовился к экзамену сам. В таблице приведена информация о 150 абитуриентах, 50 из которых ходили на эти подготовительные курсы, а остальные 100 не ходили, готовясь к поступлению как-то иначе (скорее всего самостоятельно). Кроме того, можно видеть, что представители первой группы получили в среднем 43 балла за вступительный экзамен (экзамен оценивался по 100-балльной шкале). Представители второй группы, в свою очередь, в среднем набрали на этом экзамене 48,5 балла. 
Таблица 1.1 
Результаты вступительного экзамена в магистратуру для 150 абитуриентов 
Ходили на курсы  Не ходили на курсы  
Средний балл за экзамен  43 балла (50 человек)  48,5 балла (100 человек)  

Примечание: экзамен оценивался по 100-балльной шкале. 
Иными словами, между посещением курсов и результатом экзамена наблюдается отрицательная корреляция. Означает ли это, что посещение курсов является причиной более скверных результатов экзамена? На самом деле вовсе не обязательно. И если мы немного поразмыслим, откуда возникла такая корреляция, то найдем альтернативное объяснение. 
Одна из причин может состоять в том, что на курсы обычно ходят менее подготовленные и, следовательно, менее уверенные в своих силах абитуриенты. 
Можем ли мы как-то учесть данный фактор? Один из способов сделать это — разделить всех абитуриентов на две группы: выпускники бакалавриата факультета университета и выпускники других вузов. Естественно предположить, что выпускники университета лучше готовы к экзамену: во-первых, университет, данные по которому мы анализируем, является одним из ведущих учебных заведений; во-вторых, выпускники, окончившие его бакалавриат, точнее представляют требования экзаменаторов и поэтому лучше готовы к поступлению в его магистратуру. 
Подобное разделение учтено в табл. 1.2. Здесь данные про тех же абитуриентов, что и в табл. 1.1, представлены несколько иначе. Из таблицы видно, что для каждой из групп в отдельности подготовительные курсы полезны. Действительно, бакалавры этого факультета, посетившие курсы, получают в среднем на 5 баллов больше не посетивших (55 баллов вместо 50). А для выпускников других вузов посещение курсов соответствует увеличению результата экзамена аж на 20 баллов (40 баллов вместо 20). 
Таблица 1.2 
Результаты вступительного экзамена в магистратуру для 150 абитуриентов (с учетом дополнительного фактора) 
Ходили на курсы  Не ходили на курсы  
Выпускники бакалавриата университета  55 баллов (10 человек)  50 баллов (95 человек)  
Выпускники других вузов  40 баллов (40 человек)  20 баллов (5 человек)  
Средний балл за экзамен  43 балла (50 человек)  48,5 балла (100 человек)  

Примечание: экзамен оценивался по 100-балльной шкале. 
Еще раз подчеркнем, что это те же самые 150 абитуриентов, что и в табл. 1.1. Если посчитать средние взвешенные по каждому из столбцов, то мы получим числа из этой таблицы (см. нижнюю строчку табл. 1.2). 
Откуда же возникла видимость негативного эффекта от посещения курсов в табл. 1.1? Дело в том, что, как мы и предположили, абитуриенты из «сильной» группы гораздо реже ходят на курсы, чем абитуриенты из «слабой» группы: среди этих групп курсы посетили 10 и 40 человек соответственно. Поэтому и общий средний балл всех посетителей курсов оказался не слишком высок, несмотря на то что для каждой отдельной группы абитуриентов курсы были полезны. 
Из примера 1.1 можно извлечь два важных вывода. 
Вывод № 1: если вы будете игнорировать существенные переменные, вы получите смещенные результаты1. Такой эффект также называют смещением из-за пропуска существенных переменных (omitted-variable bias). Он подробно анализируется в гл. 3. 
Вывод № 2: корреляция — это не то же самое, что причинно-следственная связь. В первой таблице между посещением курсов и результатами отрицательная корреляция, однако на самом деле это ничего не говорит о качестве курсов. Подсчитать корреляцию, как правило, легко. Были бы данные. Выявить причинно-следственную связь — сложно. Пожалуй, это самая сложная (но и самая интересная!) задача в современной эконометрике. 
Пример 1.2. Источник роста 
Какие факторы определяют рост валового внутреннего продукта (ВВП)? Это важный вопрос, так как ВВП, несмотря на некоторые недостатки, является одним из ключевых показателей состояния экономики страны. Предположим, мы задались этим вопросом применительно к России и, собрав данные, построили график, характеризующий зависимость ВВП от некоторой переменной (рис. 1.1). 
Каждая точка на рисунке соответствует данным за определенный год. Прямая линия представляет тенденцию, отражающую эту взаимосвязь. На рис 1.1 также есть уравнение этой прямой и коэффициент R2. Подробнее о том, как определять это уравнение и вычислять коэффициент, мы обсудим в гл. 2. Пока отметим, что значение R2, близкое к единице (как это наблюдается в нашем случае), говорит о хорошем соответствии модели данным. Это соответствие видно невооруженным глазом: на рисунке большему значению фактора N соответствует большее значение ВВП, и зависимость очень близка к линейной. Коэффициент корреляции между двумя рассматриваемыми переменными также близок к единице и составляет примерно 0,96. 
1 Слово «смещенный» тут можно понимать в математико-статистическом смысле. Напомним, что оценка называется смещенной, если ее математическое ожидание не совпадает с истинным значением оцениваемого параметра (в данном случае оцениваемым параметром является изменение балла за экзамен в результате посещения курсов). Более детально формальный смысл термина «смещенная оценка» мы обсудим в гл. 2 и 3. 
40 
35 
30 
25 
20 

 

 
GDP  = 5,1 · N – 71,5  

 R² = 0,93  

 

 
 

18 19 20 21 22 23 
Рис. 1.1. Зависимость реального ВВП России (вертикальная ось) 
от некоторого фактора N (горизонтальная ось) Примечание. Реальный ВВП в ценах 2008 г. измерен в триллионах рублей. Использованы данные за 1995–2012 гг. 
После анализа рис. 1.1 возникает соблазн сказать, что мы нашли тот самый важный фактор, который определяет динамику ВВП России. Достаточно увеличить его, чтобы и совокупный выпуск конечных товаров и услуг на территории страны также стал больше. Иногда, читая лекцию, я показываю этот график на экране и спрашиваю слушателей: что это за такой важный для российской экономики фактор N? Самый популярный ответ — цены на нефть — невероятно далек от истины. 
В действительности переменная N — это… численность населения Австралии. Здравый смысл подсказывает, что такая переменная вряд ли критична для российского ВВП, а значит, вывод о наличии тесной причинно-следственной связи на основе рис. 1.1 является ошибочным. В данном случае источником ошибки является одна из типичных ловушек, с которыми сталкиваются начинающие эконометристы при работе с временными рядами, — так называемая ложная регрессия (spurious regression). 
Чтобы понять источник проблемы, обратимся к рис. 1.2а и 1.2б, где изображены графики ВВП России и численности населения Австралии по отдельности. Легко видеть, что каждая из этих переменных характеризуется возрастающим трендом. Поэтому, когда мы считаем корреляцию между указанными переменными, технически она оказывается чрезвычайно высокой. Однако в действительности возрастающие тенденции этих переменных определяются совершенно разными факторами и механизмами, и поэтому существенной причинно-следственной связи между ВВП России и населением Австралии, конечно, нет. 
40 35 30 25 

20 
1 2 3 4 5 6 7 8 9101112131415161718 
Рис. 1.2а. Динамика реального ВВП России в 1995–2012 гг. 

1 2 3 4 5 6 7 8 9 101112131415161718 
Рис. 1.2б. Динамика численности населения Австралии в 1995–2012 гг. 
Ложная регрессия — ситуация, когда между объясняющей и зависимой переменной в действительности нет причинно-следственной связи, однако коэффициент корреляции между ними по модулю близок к единице, а уравнение, описывающее их взаимосвязь, с высокой точностью соответствует данным. Эта ситуация обычно возникает в случае работы с временными рядами, которые характеризуются наличием тренда, детерминированного или случайного. Эконометристы называют такие временные ряды нестационарными. 
Избавиться от возникновения ложной зависимости можно, устранив из данных указанные тренды. Для этого, например, вместо самих переменных можно анализировать их изменения; в нашем случае — изменение ВВП в году t по сравнению с годом t – 1 и изменение численности населения Австралии. Такой прием в эконометрике называют переходом к первым разностям переменных. Результат этого перехода представлен на рис. 1.3. Легко видеть, что в этом случае «злые чары» ложной регрессии рассеиваются, и кажущаяся связь между в действительности не связанными переменными пропадает. 
4 
3 
2 
1 
0 0,50 
–1 
–2 
–3 
–4 
0, 



10  0,15  0,20  0,25  0,30  0,35 0,40 0,45  

˜GDP = −1,3 · ˜N + 1,5 R² = 0,005  


Рис. 1.3. Изменение реального ВВП России (вертикальная ось) 
и изменение некоторого фактора N (горизонтальная ось) Примечание. Можно заметить, что после перехода к изменениям переменных между ними больше не наблюдается явной взаимосвязи (в отличие от ситуации на рис. 1.1). 
Из примера 1.2, как и из примера 1.1, можно извлечь важное правило. 
Вывод № 3: если вы будете игнорировать свойства временных рядов, с которыми работаете (наличие трендов и нестационарность), вы получите искаженные результаты. 
Много других примеров ложных зависимостей представлено на сайте: http://tylervigen.com/spurious-correlations. 
Приведенные кейсы охватывают лишь малую долю подводных камней, которые могут возникать в процессе попыток выявить причинно-следственные связи. Например, пока за кадром остался вопрос об определении того, какая из переменных является причиной, а какая — следствием (скажем, влияет ли религиозность нации на ее благосостояние или, наоборот, рост благосостояния является первопричиной изменения популярности религии в обществе?). Эта проблема рассматривается в гл. 7. 









Но даже те ситуации, которые мы уже обсудили, позволяют проиллюстрировать важность корректного применения методов работы с данными. Их неправильное использование опасно тем, что вместо истинных ответов на исследовательские вопросы вы получите полную чепуху. Именно неверное применение статистических методов, приводящее к сомнительным результатам, сделало популярной присказку про ложь, наглую ложь и статистику1. Главы этого учебника призваны помочь вам избежать этой опасности и научиться, используя эконометрику, узнавать о мире нечто ценное. 

1 .3 . Типы данных, используемых в эконометрике 
Один из важных способов классификации данных в эконометрике — это классификация с точки зрения структуры данных. В ней выделяют следующие типы: 
• 
Пространственные данные (cross section data). Пространственными называются данные, собранные о множестве объектов за один момент времени, например данные о ценах однокомнатных квартир в Москве в мае 2020 г. или данные о росте и весе тысячи индивидов по состоянию на 1 сентября 2020 г. 

• 
Временные ряды (time series). Под временным рядом понимаются данные об одном объекте, собранные в течение нескольких последовательных тактов времени, например ежедневные данные о курсе доллара, собранные за год, или данные о росте и весе Ивана Петровича Сидорова, которые собирались 1-го числа каждого месяца на протяжении пяти лет. 

• 
Панельные данные (panel data). Панельными называются данные о нескольких объектах, измеренные в течение нескольких тактов времени, например ежегодные данные об уровне инфляции в 50 развивающихся странах, собранные за 10 лет, или данные о росте и весе тысячи индивидов, по каждому из которых доступна информация за 12 месяцев. 


В ближайших главах мы сконцентрируемся в основном на пространственных данных, так как они лучше всего подходят для первого 
1 «Существует три вида лжи: ложь, наглая ложь и статистика». Выражение известно благодаря Марку Твену, который приписывал его премьер-министру Великобритании Бенджамину Дизраэли. 
знакомства с эконометрикой. В гл. 9 мы обсудим преимущества, дополнительные трудности и специальные методы, которые возникают при работе с панельными данными. Подробный анализ временных рядов выходит за рамки первого издания этого учебника, и с ними лучше знакомиться в рамках отдельного продвинутого курса, так как работа с данными подобной структуры имеет много специфических особенностей. Тем не менее мы будем обращаться к временным рядам с целью иллюстрации некоторых важных идей (как мы уже сделали в примере 1.2). 
Альтернативная классификация данных определяется источником их возникновения. По этому критерию выделяют экспериментальные данные и наблюдаемые статистические данные (их еще называют историческими). 
Экспериментальные данные получаются из контролируемых случайных экспериментов (randomized controlled experiments). Наблюдаемые данные, в свою очередь, возникают исторически в течение развития неконтролируемых экспериментатором процессов. 
Удобно пояснить различие между двумя этими типами данных, вспомнив пример 1.1 про подготовительные курсы. В нем каждый абитуриент сам решал, посещать ему подготовительные курсы или нет. В итоге на это решение воздействовали разные характеристики абитуриента (скажем, уровень его подготовки), которые также влияли на результат вступительного экзамена. Это порождало трудности с выявлением истинной пользы от посещения подготовительных курсов в связи с проблемой самоотбора и проблемой пропуска существенных факторов. Возникновение таких трудностей весьма характерно для неэкспериментальных данных. 
Представим теперь на минуту, что абитуриенты лишились возможности самостоятельно выбирать, посещать ли им курсы. Теперь мы решаем за каждого абитуриента, будет ли он ходить на курсы. Мы делаем это при помощи специальной лотереи, победители которой в принудительном порядке отправляются на занятия, а всем остальным запрещается это делать. Ясно, что в этом случае индивидуальные характеристики каждого из абитуриентов перестанут влиять на то, попал он на курсы или нет. Следовательно, полезный эффект от посещения курсов будет гораздо проще измерить, так как проблемы, описанные в примере 1.1, автоматически пропадут. Такую лотерею, если она реализована аккуратно, можно считать контролируемым экспериментом, а данные, полученные на основе такого исследования, — экспериментальными. 
Второй (более традиционный) пример экспериментальных данных — это медицинские данные, собираемые в ходе тестирования эффективности новых лекарств. Процедура такова: все испытуемые случайным образом разбиваются на две группы, и одной группе выдает
ся новое лекарство, а другой — плацебо. 
Из этих примеров следуют два вывода. 
Во-первых, становится ясно, почему эконометристы очень любят работать именно с экспериментальными данными. В этом случае пропадает ряд типичных подводных камней, которые мешают получить корректные результаты (проблема самоотбора, проблема смещения из-за пропуска существенных факторов и другие проблемы, которые обсуждаются в последующих главах учебника). Это позволяет получать надежные новые знания о мире, используя элементарные методы и модели. 
Во-вторых, становится понятно, почему на практике эконометристам гораздо чаще приходится работать с неэкспериментальными историческими данными. Действительно, во многих ситуациях проведение экспериментов либо аморально, либо очень дорого, либо просто невозможно. Скажем, в примере 1.1 история с отбором участников подготовительных курсов по лотерее вряд ли вызвала бы энтузиазм у абитуриентов. А представьте, что вас интересует менее безобидный вопрос: например, влияет ли введение смертной казни на уровень преступности? Маловероятно, что общество благосклонно отнеслось бы к избирательному случайному применению смертной казни в рамках эксперимента. 
В итоге в большинстве случаев экспериментальные данные остаются для эконометристов недостижимым идеалом, а все продвинутые эконометрические методы направлены на то, чтобы «заставить» исторические данные давать ответы на вопросы так же, как если бы они являлись экспериментальными. 
Тем не менее в некоторых случаях экспериментальные данные эконометристам все-таки доступны. А иногда обстоятельства складываются столь удачно, что и без вмешательства исследователя ситуация оказывается очень похожей на контролируемый эксперимент. Подобное счастливое стечение обстоятельств называется квазиэкспериментом, или естественным экспериментом (natural experiment). Про эксперименты и квазиэксперименты мы подробно поговорим в гл. 11. 
Задания для самостоятельного решения 
Задание 1 . Используя данные о десяти тысячах человек, исследователь оценил коэффициент корреляции между количеством обращений пациента к врачу в 2012 г. и качеством его здоровья в 2013 г. Коэффициент корреляции оказался отрицательным. Иными словами, выяснилось, что люди, которые чаще обращались к врачу, впоследствии чувствовали себя хуже, чем те, кто к врачу не обращался. На основе этого результата исследователь сделал вывод о том, что обращаться к врачам вредно для здоровья: 
а) объясните, в чем состоит изъян в логике исследователя; 
б) предложите гипотетический идеальный контролируемый экспе
римент, позволяющий выяснить эффект от обращения к врачу. 
Объясните, в чем заключается трудность реализации такого экс
перимента. 
Задание 2 . Исследователь планирует изучить эффективность нового лекарства от горной болезни, с которой сталкиваются люди, оказавшись на большой высоте. У него будет возможность собрать данные о 200 альпинистах, часть из которых, находясь на высоте, принимала новое лекарство, а часть — нет. Впоследствии в результате комплексного обследования уровень здоровья каждого из альпинистов будет оценен по специальной 10-балльной шкале (1 — очень плохо, 10 — очень хорошо). После этого исследователь планирует сравнить средний уровень здоровья альпинистов из группы, принимавшей лекарство, со средним уровнем здоровья альпинистов, которые обходились без него. 
Рассматривается три варианта реализации этого эксперимента с лекарствами. 
•	 
Вариант 1: каждый альпинист, участвующий в эксперименте, самостоятельно решает, принимать ему лекарство или нет. 

•	 
Вариант 2: альпинисты-женщины принимают лекарство, а альпинисты-мужчины — нет (в исследовании участвуют поровну мужчин и женщин). 

•	 
Вариант 3: альпинисты участвуют в лотерее, в ходе которой случайным образом определяется, кто из них будет принимать лекарство, а кто не будет. 


Какой из трех вариантов предпочтителен, если цель исследователя состоит в получении корректной оценки эффективности лекарства? Аргументируйте свой ответ. 


ГЛАВА 2 
ПАРНАЯ РЕГРЕССИЯ 
В этой главе мы обсудим парную регрессию. Это простой и удобный инструмент, который обычно является отправной точкой в знакомстве с эконометрической наукой. Конечно, кроме преимуществ у модели парной регрессии есть и существенные ограничения, которые вынудят нас в последующих главах изучить более совершенные методы и модели. 
2 .1 . Предварительные замечания 
Нам будет удобно использовать следующее определение выборочной ковариации: 
 n 
cov(,) = (xi− x)(yi− y),
xy 1 ˛
n
i=1 x+x+…+xy+ y+…+ y
12 n 12 n
где x= , а y= . 
nn 
Здесь и далее значок «крышки» над некоторой величиной будет означать, что эта величина подсчитана по выборке. В данном случае, например, cov xy — ковариация между двумя переменными, под
(,) считанная по выборке из n наблюдений. Ее не следует путать с теоретической ковариацией между двумя случайными величинами xи y, которую мы будем обозначать cov(x, y) и которая, напомним, определяется так: 
cov(,) =(( − )( − y)).
xy ExExyE 
Принципиальное различие между теоретической и выборочной ковариацией состоит, в частности, в том, что первая на практике почти никогда не известна и не может быть точно вычислена, в то время как вторая может быть подсчитана для каждой конкретной выборки. 
Выборочная ковариация обладает рядом удобных свойств, каждое из которых может быть доказано путем непосредственных вычислений: 
cov(,) ;
 xb= 0 
cov(,) =°bcov( ,);
xby xy 
cov( , + ) = cov(x,)y;
xy b 
cov(xy, + z) = cov(x,)y+ cov(x,)z, 
где b— некоторая константа. Кроме того, нам будет полезен альтернативный способ вычисления 

выборочной ковариации: cov( ,) =˛ .
xy xy− xy 
Также нам пригодится выборочная дисперсия переменной, которую мы будем обозначать так: 
 n 
var(x) = 1 ˛(x− x)2 = x2 − (x).2 
i
n
i=1 
Свойства выборочной дисперсии, которые нам понадобятся, таковы: 
 b= 0
var() ; 

var(bx) = b2 ° var()x; 

var(xb)var();= x
+ 
˜ ˜˜° 
var(xy)var()= x+ var( y) + 2cov(, ),
+ xy 
где b— снова некоторая константа. 
Наконец, выборочный коэффициент корреляции договоримся обозначать следующим образом: 
˜
cov(,xy)
˜
corr( ,) = 
.
xy 
°° 
var()x° var()y 

2 .2 . Метод наименьших квадратов 
Рассмотрим следующую задачу: у нас есть данные про две переменные, и требуется численно оценить, как одна переменная зависит от другой. 
Для удобства введем следующие обозначения: x— объясняющая переменная (ее также называют независимой переменной или регрессором); y— объясняемая переменная (ее также называют зависимой); n— количество наблюдений, которое имеется в нашем распоряжении (размер выборки). Например, x— площадь однокомнатной квартиры (в квадратных метрах), y — цена квартиры (в миллионах рублей). Понятно, что большие квартиры в среднем стоят дороже, чем маленькие, однако было бы ценно получить конкретное уравнение, которое описывает эту зависимость. Другой пример: x — образование индивида (число лет обучения), y— его ежегодный доход (в рублях). Есть гипотеза, что более образованные индивиды в среднем зарабатывают больше, чем менее образованные, и интересно было бы выяснить, действительно ли это так, и если да, то какую прибавку к доходу дает один дополнительный год обучения. 
Тогда формально нашу задачу можно записать так: имеется выборка из nпар наблюдений (,ii) 1, n
xy, i=…,, требуется подобрать функцию, которая наилучшим образом описывает зависимость переменной yот переменной x. Парный регрессионный анализ как раз и состоит в решении такой задачи. 
Для начала предположим, что искомая функция является линейной. Конечно, это сильное упрощение, поэтому в будущем мы от него откажемся. Мир устроен сложно, и далеко не все зависимости являются линейными. 
Эту задачу удобно решать, глядя на картинку. Если мы каждой паре наблюдений (,xy) поставим в соответствие точку на плоскости, то
ii
у нас получится что-то похожее на рис. 2.1а. В терминах примера про квартиры можно считать, что каждая точка на этом рисунке соответствует определенной квартире (по оси абсцисс отложена площадь квартиры, а по оси ординат — ее цена). Тогда нашу задачу поиска линейной функции, описывающей влияние переменной xна переменную y, можно воспринимать как задачу подбора прямой линии на графике, которая наилучшим образом описывает изображенное на нем облако точек. Пример такой прямой изображен на рис. 2.1б. Мы будем называть ее линией регрессии. 
30 25 20 15 10 5 0 

30 25 20 15 10 5 0 

0 2 4 6 810 
б) Рис. 2.1. Диаграмма рассеяния (а) и диаграмма рассеяния с линией регрессии (б) 
Если вы нарисовали картинку, как в нашем примере, то линию регрессии можно провести и «на глазок». Это будет быстро и не вызовет трудностей. Однако в большинстве случаев удобно делать это более технологично: во-первых, чтобы за вас это мог сделать компьютер; во-вторых, чтобы вы могли быть уверены в том, что если другой исследователь воспользуется теми же самыми данными, то у него получится в точности та же самая линия (с рисованием «на глазок» это требование, очевидно, не выполняется). Давайте разберемся, как этого можно достичь. 
Чтобы получить уравнение прямой, нам нужно подобрать численные значения двух коэффициентов: свободного члена, который мы обо
значим 
^ 
можно записать так: 
^^
^ 
y =+ x
˛˛ ,
i 12 i 
^
где yi — предсказываемое нашим уравнением значение переменной y. Поскольку наша линия лишь приближенно описывает облако точек,
° 
^
предсказанное значение yi может не совпадать с фактическим значением yi (т.е. с тем значением, которое действительно наблюдается в данных). Отклонения предсказанных значений от фактических будем называть остатками регрессии и обозначать e = y − y ^ . Геометрически
iii 
остатки регрессии характеризуют отклонение соответствующих наблюдений от линии регрессии по вертикали. Положительным остаткам соответствует отклонение вверх, а отрицательным — вниз. 
Естественно, следует подбирать уравнение таким образом, чтобы отклонения предсказаний от фактических значений были не слишком большими, т.е. чтобы остатки ei были маленькими. На первый взгляд 
^^ 
^ 1, 
°
 и коэффициента наклона 
 Тогда нашу линию регрессии 
2. 
°
° 
1 и бы сумма остатков e + e2 +…+e была как можно ближе к нулю. Но
1 n 
ограничиваться только этим подходом не стоит. Проблема заключается в том, что в этом случае возможны и очень большие положительные отклонения, и очень большие по абсолютному значению отрицательные отклонения (т.е. наше уравнение сильно «ошибается» в обе стороны), однако эти положительные и отрицательные отклонения компенсируют друг друга так, что сумма остатков равна нулю. 
Поэтому обычно вместо простой суммы остатков минимизируют сумму квадратов остатков, т.е. решают такую задачу: 
22 2
e +e +…+e ˛ min .
12 n 
^^
˝˝,
12 
кажется, что хорошей будет идея подбирать 
2 таким образом, что
°
^ 
ется методом наименьших квадратов (МНК, или ordinary least squares, OLS). Внимательный читатель спросит: почему нужно минимизировать именно сумму квадратов, а не, например, сумму модулей остатков 
e 
+ 
e 
+…+ 
e 
? Оказывается, что применение МНК приводит к полу
2 
n 
чению результатов, которые обладают очень хорошими свойствами, часть 
Такой метод поиска интересующих нас величин
°
^ 
1 
и 
 называ
2 
из которых мы обсудим уже в этой главе, а часть — несколько позже. Поэтому МНК и стал одной из главных «рабочих лошадок» эконометристов. Решим задачу минимизации суммы квадратов остатков: 
2 
nn˛ˆ
2 ^^ 
e =˙y−−&#21;&#21;x˘&#23;min . 
° i ° i 12 i &#21;&#21;,

i=1 i=1 ˝ˇ 12 
^^ 
1 и 
экстремума функции: ° 
&#21; n
°˙
^^ 
°
&#19;−2 ˝y−−&#22;&#22;xˇ=0
&#23;i 12 i
&#19;˛ ˆ
i=1
&#20; (2.1) 
° 
&#19; n 
°˙
^^
−2 xy−−&#22;&#22;x =0.
&#19;&#23;i˝i 12 iˇ 
° ˛ˆ
&#18;i=1 
Поскольку анализируемая нами функция представляет собой положительно определенную квадратичную форму (сумма квадратов точно не может быть отрицательной), решение этой системы будет именно точкой минимума. 
Раскроем скобки: 
˙ nn 
^^
ˇ°yi−n1 −2 °xi =0
˝˝ ˇ 
i=1 i=1
ˆ 
n nn 
^^
ˇ xy−˝ x−˝ x2 =00.
ˇ° ii 1 ° i 2 ° i ˘i=1 i=1 i=1 
Поделим каждое уравнение системы на n: 
˛ ^^ 
y−− x=0ˇˇ
˙ 12 
˝ 
˙ ^ ^2
xy−ˇx−ˇx =0.
ˆ 12 ^^ 
1 и 
Возьмем производные по 
2 и получим необходимые условия 
Наконец, выразим из этой системы 
2: 
˜
−˝ cov(,xy)
xy xy
^
˜= = ;22 
°
2 x −x var()x 
˜
cov(,xy)
^^
˜=−y ˜2 xy=− x.
°
1 var()x 
Пример 2 .1 . Имеются следующие данные о переменных xи y: 
y  1  3  1  3  7  
x  2  2  6  4  6  

Найдите МНК-оценки параметров в линейной регрессии yна x. 
Решение . 
Конечно, на практике МНК-оценки всегда вычисляются при помощи компьютера, но для того чтобы разобраться, как это работает, полезно проделать это сначала вручную. Для этого удобно организовать промежуточные вычисления в виде такой таблицы: 
Сумма Среднее 
y  x  x2  x · y  
1  2  4  2  
3  2  4  6  
1  6  36  6  
3  4  16  12  
7  6  36  42  
15  20  96  68  
3  4  19,2  13,6  

Теперь можно посчитать МНК-оценки: 
xy−˝xy , −˝
1364 3
^
˜== =05,;2 x −x , −2
2 2 1924 
^^
˜ y ˜x 3405 =1.
=− ˝=−˝,
12 
^
Ответ: y =+,
105˛x.
ii 
*** 
Остатки регрессии, получаемые в результате применения МНК, обладают рядом свойств, которые пригодятся нам в будущем: 
n
Свойство 1: ° e= 0.
i=1 i 
Свойство 2: °n xe= 0.
i=1 ii nn 
^
Свойство 3: ° y=° yi.
i=1 ii=1 n 
^^
Свойство 4: или, что то же самое, cov (y− ye) = 0, (,ye) = 0.
˛i=1 ii 
Для доказательства первых двух свойств достаточно взглянуть на необходимое условие экстремума в нашей задаче [см. систему (2.1)].
^^
С учетом того, что e=y ˛˛ из первого уравнения этой систе
−− x,
ii 12 i
мы следует первое свойство, а из второго — второе. Третье свойство следует из первого: 
nnn n 
^^
° y=° y ˛°(y− y) = 0 ˛° e= 0.
iiii i i=1 i=1 i=1 i=1 
Наконец, четвертое свойство следует из первых двух: 
n nnn
1 111
^^ ^^ 
cov ye= ( y− y)(e− e) = (y− )
(, ) ye= ye− ye=
˛ ii ˛ ii ˛ ii ˛ i
n nnn
i=1 i=1 i=1 i=1 
nn nn
11 11
^^ ˇ ^^^ 
= ye−0 = ˙&#23;&#23;+ xe &#23; e+&#23; xe
˜ii ˜ˆ12 i˘i = 1 ˜i 2 ˜ii = 
nn nn
i=1 i=1 i=1 i=1 
11
^^ 
=˛ 0 +˛ 00.
= 
12
nn 
Мы научились при помощи МНК находить функцию, описывающую влияние переменной xна переменную y. Следующий важный шаг — научиться измерять то, насколько полученное нами уравнение хорошо соответствует данным. Например, глядя на рис. 2.2, легко увидеть, что в первом случае (рис. 2.2а) наше уравнение очень хорошо соответствует данным, так как все фактические значения зависимой переменной оказываются очень близки к предсказанным. Иными словами, все точки лежат близко к нашей линии регрессии. Однако на рис. 2.2б точно такая же линия регрессии соответствует данным довольно скверно, так как мы видим, что многие точки лежат от нее очень далеко. Зная 
^^
только значения ° и ° 2, оценить степень этого (не)соответствия не
1 
получится, поэтому нам понадобится специальный измеритель. Чтобы его получить, выразим переменную yчерез остатки и y ^: 
^^ 
e= y− y ˛ y= e+ y.
iii iii 
Теперь подсчитаем выборочную дисперсию этой переменной, используя стандартные свойства выборочной дисперсии: 
˜˜ ˜˜ ^ ° 
^^ 
var()y=var(e+y) =var()e+var()y+˛2 cov(,ey) = 
 ^  ^
+˛= e var()y.
=var()e+var()y 20 var() + 
30 25 20 15 10 5 0 

0 2 4 6 810 
а) 
30 25 20 15 10 5 0 

0 2 4 6 810 
б) Рис. 2.2. (а) Хорошее соответствие линии регрессии данным; (б) плохое соответствие линии регрессии данным 
В последней строчке мы воспользовались свойством остатков № 4 
˜ ^ ˛
˜(, ) Таким образом, мы доказали, что
cov ye= 0˝.
° 
  ^ 
var()y = var()e + var()y . 
Или, что то же самое: 
n nn
1 11
2 2^2
˝( yi − y) =˝(ei − e ) +˝(yi − y). 
n nn
i=1 i=1 i=1 
Если умножить правую и левую части данного равенства на n, а также вспомнить, что среднее значение остатков равно нулю (так как по свойству № 1 сумма остатков равна нулю), то мы получим следующее тождество: 
n nn 
2 2 ^2
°(yi − y) =°ei +°(yi − y); 
i=1 i=1 i=1 
Общая сумма квадратов = 
= Сумма квадратов остатков + Объясненная сумма квадратов. 
Отметим, что если наше уравнение очень хорошо соответствует данным (т.е. если наблюдается картина, похожая на рис. 2.2а), то сумма квадратов остатков в модели должна быть очень маленькой (так как каждый из остатков регрессии близок к нулю), и, следовательно, вели
nn
чина ˛ (y ^ − y)2 должна быть очень близка к ˛ ( y − y)2. Иными
i=1 ii=1 i
словами, если наше уравнение хорошо соответствует данным, то дробь 
˛n (y ^ − y)2 
i=1 
i должна быть близка к единице. В крайнем случае, когда ˛n ( y − y)2 
i=1 i 
уравнение идеально соответствует данным и сумма квадратов остатков равна нулю, эта дробь будет в точности равна единице. 
Напротив, если линия регрессии плохо описывает фактические данные (т.е. если наблюдается картина, похожая на рис. 2.2б), то сумма ква
nn
2 ^2
дратов остатков ° ei будет большой. Тогда выражение (y − y),
i=1 ˛i=1 i 
наоборот, будет сравнительно маленьким, и, следовательно, дробь 
˛ ˛ 
= 
n ^2
(y − y)
i 1 i n 2 
1 i − ) 
будет близка к нулю. 
( 
y 
y
i
= 
На этой идее основывается использование коэффициента R-квадрат (его еще иногда называют коэффициентом детерминации): 
n nn
2 2^2
ee (y −y)
2 ˝i=1 i =− ˝i=1 i ˝i=1 i =
R =−11 = 
n 2 n 2
(y −y) n 2 n 2(y −y)
˝i=1 ie + (y ^ −y) ˝i=1 i
˝i=1 i ˝i=1 i ^2
1 ˛n (yi − y)  ^
i=1 var()y
n
== .
1 n 
2 var()y˛ ( y − y)
i=1 i
n 
В силу соображений, которые мы обсудили выше, R2 ˜ °˛01,,˝˙ причем чем лучше наша линия регрессии соответствует данным, тем ближе этот коэффициент к единице. И наоборот, чем хуже наше уравнение согласуется с фактическими наблюдениями, тем ближе он к нулю. 
Лирическое отступление о разнообразии обозначений 
2
Для общей суммы квадратов ˛n (y − y) в литературе обычно исполь
i=1 i 
зуется обозначение TSS (total sum of squares). 
n 
2
Сумма квадратов остатков ° ei в некоторых источниках [Dougherty,
i=1 
2011] обозначается как RSS (residual sum of squares), в некоторых работах [Сток, Уотсон, 2015] она называется SSR (sum of squared residuals), а в других [Магнус, Катышев, Пересецкий, 2004] используется обозначение ESS (error sum of squares). 
n
Объясненная сумма квадратов (y^ − y)2 в некоторых учебниках
˛i=1 i 
[Dougherty, 2011] тоже обозначается ESS (estimated sum of squares), а в некоторых [Магнус, Катышев, Пересецкий, 2004] — RSS (regression sum of squares). 
Поэтому мы советуем читателю быть внимательным при работе с разными учебниками. Мы же, чтобы избежать путаницы, как правило, вместо аббревиатур будем использовать соответствующие формулы в явном виде или их расшифровки словами. 
Пример 2 .2 (продолжение примера 2 .1) . Для полученного в примере 
2.1 уравнения вычислите сумму квадратов остатков и R2. 
Решение . 
Для вычисления суммы квадратов остатков удобно дополнить нашу 
^
таблицу еще несколькими столбцами. В этой таблице yi вычисляется по формуле, которую мы нашли в примере 2.1, а остатки регрессии вычисляются по определению: e = y − y ^:
iii 
y  x  x2  x · y  ^ y  e  e2  
1  2  4  2  2  −1  1  
3  2  4  6  2  1  1  
1  6  36  6  4  −3  9  
3  4  16  12  3  0  0  
7  6  36  42  4  3  9  
15  20  96  68  15  0  20  
3  4  19,2  13,6  

Сумма 
Среднее 
Таким образом, сумма квадратов остатков равна 20. Обратите вни
^
мание, что сумму предсказанных значений зависимой переменной yi и сумму остатков (без квадратов) вычислять для решения задания было не обязательно. Мы сделали это для проверки. Если все вычисления вер
^
ны, то в нашей регрессии сумма ˛y должна совпадать с суммой ˛yi ,
i
а сумма остатков всегда должна быть равна нулю. В нашем случае так и получается. 
Коэффициент детерминации R2 можно вычислять разными способами. Поскольку у нас уже подсчитана сумма квадратов остатков, удобно воспользоваться той формулой для R2, где эта сумма используется: 
2
e
2
R 1 ˛i =
=− ( y −y)2
˛i 
20 1
=−1 = . 13 ( −)213 33( 2
( −)2 +33 +( −)2 +( −)2 +73−)6 
22
Ответ: ˜ei = 20, R = 1.
6 



2 .3 . Классическая линейная модель парной регрессии 
В предыдущем параграфе мы научились описывать облако точек некоторой прямой, не делая никаких предположений по поводу природы анализируемых данных. Иными словами, мы не предполагали никакой конкретной модели, описывающей процесс порождения наших данных. Для дальнейшего продвижения, однако, это будет нам необходимо. 
Вернемся к нашему примеру с квартирами. Естественно ожидать, что на цену квартиры (y) влияет ее площадь (x), а также прочие факторы, например, удаленность квартиры от метро, этаж, наличие балкона и т.д. Обозначим прочие факторы переменной ˝. С учетом этих соображений естественно предположить следующую модель цены квартиры: 
y =˝ +˝ x +˙ , i =12, , …, n,
i 12 ii 
где xi— площадь i-й квартиры в квадратных метрах; yi — цена i-й квартиры в миллионах рублей; εi — прочие факторы, которые оказывают влияние на цену квартиры yi. 
Переменную ε принято называть случайной ошибкой модели. Буквой n будем обозначать число наблюдений в доступной нам выборке. 
В целом такая модель выглядит достаточно разумно. Если бы мы знали точные значения коэффициентов ° 1 и ° 2, мы могли бы использовать ее в практических целях. Например, зная, что ˜2 = 03,, строительная компания могла бы учитывать при планировании продаж, что один дополнительный квадратный метр площади квартиры оценивается рынком в 0,3 млн руб. К сожалению, на практике значения параметров ° 1 и ° 2 нам не известны, зато мы можем собрать статистические данные и получить их приблизительные оценки. 
Здесь уместно подчеркнуть важное различие между: 
•	 параметрами (без «крышек») в выражении y=˛ +˛ x+˝ ,
° ki 12 ii ^^ =+ 
^^
˛˛x.
•	 и их оценками ° k(c «крышками») в выражении yi 12 
i 
Это различие состоит в том, что ° 1 и ° 2 — это некоторые истинные значения параметров модели, которые на практике никогда не известны исследователю. Все, что исследователь в силах сделать, — собрать 
^^
данные и эти значения оценить приближенно. ° и ° — это оценки
12 
истинных значений, которые мы получаем, используя наши выбороч
^^
ные данные. Так как ° 1 и ° 2 рассчитываются на основе случайной выборки, то они являются случайными величинами. 
^^
Естественно, мы хотим, чтобы оценки ° 1 и ° 2 были близки к истинным значениям оцениваемых параметров. Поэтому нам важно знать, при каких условиях мы можем доверять этим оценкам, т.е. рассчитывать на то, что результат использования МНК будет близок к истине. Эти условия называют предпосылками классической линейной модели парной регрессии. 
Предпосылки классической линейной модели 
парной регрессии (КЛМПР) 
1. 
Модель линейна по параметрам и корректно специфицирована: 

2. xx,, … , xyxiniii=++=…˝˝˙1212,,,,. — детерминированные (неслучайные) величины, не все

12 n
одинаковые. 
3. Математическое ожидание случайных ошибок равно нулю: 
E˜=0.
i
4. 
Дисперсия случайной ошибки одинакова для всех наблюдений: 

var(˜i) =°2. 

5. 
Случайные ошибки, относящиеся к разным наблюдениям, взаимно независимы. 

6. 
Случайные ошибки имеют нормальное распределение: 


2
˜ N0 ° 
i~(, ). 
Мы обсудили выше соображения, исходя из которых может быть сформулирована предпосылка № 1. Как мы увидим в дальнейшем, правильная спецификация подразумевает в первую очередь отсутствие среди прочих факторов других переменных, которые одновременно влияют на yи коррелируют с x. Нарушение этого требования приводит к серьезным проблемам, которые мы осветим в конце данной главы. 
Предпосылка № 2 касается двух важных аспектов. Во-первых, мы предполагаем, что регрессоры xiявляются неслучайными величинами. Это техническое предположение, которое упростит некоторые выкладки в данном разделе. Обратите внимание, что ˝i в отличие от регрессоров являются случайными величинами, а следовательно, и yi тоже случайны, так как представляют собой сумму неслучайной компоненты ˜ +˜ x и случайной величины ˝i. В терминах нашего примера с
12 i
квартирами про эту предпосылку можно думать так: представим, что вы собрали случайную выборку из 100 квартир площадью 30 м2, 100 квартир площадью 35 м2 и 100 квартир площадью 40 м2. Если вы соберете другую выборку из 300 квартир с такими же площадями, то значения регрессоров xi останутся теми же самыми, а вот значения объясняемой переменной yiпоменяются, поэтому в данном примере разумно думать про регрессоры как про неслучайные величины, а про величины yi — как про случайные. 
Во-вторых, в рамках предпосылки № 2 мы предполагаем, что не все значения регрессоров одинаковы. Нетрудно понять, зачем нужно это предположение, если взглянуть на формулу оценки коэффициента 
˜
cov(,xy)
^
˜2 = . Обратите внимание, что в знаменателе формулы стоит 
° 
var()x выборочная дисперсия переменной x, но если все значения этой переменной в выборке будут одинаковы, то дисперсия окажется равной
^
нулю, и из-за этого мы не сможем рассчитать МНК-оценку ° 2. 
Предпосылка № 3 говорит о том, что прочие факторы могут приводить к отклонению yот величины ˜ +˜ xкак вверх, так и вниз, но в
i 12 i
среднем эти отклонения компенсируют друг друга. 
Предпосылка № 4 требует, чтобы разброс случайных ошибок в среднем был постоянен для всех наблюдений. Ее смысл удобно пояснить, используя картинку. Посмотрите на рис. 2.3а и 2.3б. В первом случае предпосылка о постоянстве дисперсии случайной ошибки выполнена, а во втором — нет, так как разброс точек вокруг линии регрессии растет по мере увеличения объясняющей переменной, следовательно, мы можем заключить, что дисперсия случайной ошибки не является одинаковой для всех наблюдений. Ситуация, когда предпосылка № 4 выполнена (т.е. ситуация, соответствующая рис. 2.3а), называется гомоскедастичностью случайных ошибок. Альтернативная ситуация называется гетероскедастичностью случайных ошибок. 
30 25 20 15 10 5 0 

0 2 4 6 810 
а) 
60 50 40 30 20 10 0 

0 2 4 6 810 
б) Рис . 2 .3 . (а) Гомоскедастичность случайных ошибок; (б) гетероскедастичность случайных ошибок 
Из предпосылки № 5 следует, что случайные ошибки, относящиеся к разным наблюдениям, не коррелированы друг с другом: cov(˜˜,) =0
ij
при i ˆ j. 
Предпосылка № 6 не требуется для обеспечения хороших свойств оценок коэффициентов (обратите внимание, что ниже, в формулировке теоремы Гаусса — Маркова, она не фигурирует), однако будет полезна для тестирования гипотез и построения доверительных интервалов. 
Теорема Гаусса — Маркова . Если выполнены предпосылки № 1−5 классической линейной модели парной регрессии, то МНК-оценки 
^^
коэффициентов ° и ° будут:
12 
а) несмещенными; б) эффективными в классе всех несмещенных и линейных по y оценок1. 
Напомним, что оценка называется несмещенной, если ее математическое ожидание совпадает с истинным значением оцениваемого 
^
параметра: E˜ =˜ . Свойство эффективности означает, что оценка
22
характеризуется минимальной дисперсией среди всех альтернативных оценок в данном классе, т.е. является «наиболее точной» оценкой интересующего нас параметра. Линейность по y означает, что мы рассматриваем все оценки, которые могут быть представлены в виде линейной комбинации значений объясняемой переменной, т.е. записаны в виде 
n
˛ cy˜ .
i=1 ii 
Если переформулировать свойства несмещенности и эффективности нестрого, то можно сказать, что при выполнении предпосылок № 1−5 МНК-оценки параметров окажутся хорошими: они будут «в среднем правильными» и наиболее точными. Теорема Гаусса — Маркова дает нам важную мотивацию для того, чтобы оценивать параметры нашей модели именно методом наименьших квадратов, а не каким-то альтернативным способом. 

Лирическое отступление о предпосылках 
Каждый раз, когда я рассказываю студентам об этой теореме, в моей го
лове разыгрывается примерно такой диалог между двумя эконометристами 
(назовем их Филипп и Дима). 
Дима: Реалистичны ли предпосылки КЛМПР? 
1 Несмещенность и эффективность — это свойства оценок при фиксированном объеме выборки (при фиксированном n). Во многих случаях удобно также использовать асимптотические свойства оценок, т.е. свойства, которые имеют место при n˜° (например, состоятельность). Об асимптотических свойствах МНК-оценок мы подробно поговорим в одной из последующих глав. 
Филипп: Не очень. Например, в реальных исследованиях на пространственных данных ты почти всегда будешь сталкиваться с нарушением требования постоянства дисперсии случайной ошибки (нарушением предпосылки № 4). Во многих прикладных исследованиях также окажется более целесообразным думать про регрессоры как про случайные, а не детерминированные случайные величины (это отклонение от предпосылки № 2). На нормальность случайных ошибок (предпосылка № 6) я бы тоже не рассчитывал… 
Дима: Зачем же тогда мы ее изучаем? Давайте сразу перейдем к более реалистичной модели. 
Филипп: Мы начинаем с КЛМПР, так как это самая простая модель, на примере которой мы можем обсудить ряд важных эконометрических идей и при этом не погрязнуть в технических трудностях. В последующих главах мы будем постепенно отказываться от предпосылок КЛМПР и в результате получим набор моделей и методов, которые хорошо подходят для реальных исследований на живых данных. Кроме того, мы научимся проверять выполнение тех или иных предположений КЛМПР, чтобы понять, когда стоит их использовать, а когда — нет. 
В частности, последствия нарушения предпосылки № 3 читателю предлагается проанализировать уже в этом параграфе, в одном из заданий для самостоятельного решения. 


2 .4 . Свойства МНК-оценок 
Этот параграф содержит ряд формальных доказательств. Читатель, не заинтересованный в технических деталях, может сразу перейти к следующему параграфу, где полученные здесь результаты используются для тестирования гипотез и построения доверительных интервалов. 
Математическое ожидание и дисперсия МНК-оценок 
Прежде чем непосредственно доказать сформулированную теорему, сконцентрируемся на анализе ряда важных свойств МНК-оценок. Для этого нам пригодится следующий факт: (x − x ) = 0. Действительно:
˛ i 
i
(x −x ) = x − x = x −nx =˛x −n ˛=0.
˛i ˛˛˛i i inx 
^
Перепишем формулу для оценки ° 2, используя это соображение (мы применяем его в самом последнем переходе): 
1
˜ (x− x)( y− y)
cov(,xy) ˝ ii
^ n
˜== = 
° 
1
2 var()x ˝(x− x)2 
i
n 
(x− x)(˙ +˙ x+ˆ −˙ −˙ x−ˆ)
˝ i 12 ii 12
== 
2
˝(x− x)
i 
2
ˆ(x− x)(ˇ (x− x) +˘ −˘) ˇˆ(x− x) +ˆ(x− x)(˘ −˘)
i 2 ii 2 i ii
== = ˆ(xi− x)2 ˆ(xi− x)2 
˙(x− x)ˇ − ˇ˝˙(x− x) ˙(x− x)ˇ −ˇ˝0
iii ii
=ˆ+ =ˆ+ .
22
˙(xi− x)2 ˙(xi− x)2 
Таким образом, мы получили следующее представление для МНКоценки: 
(x− x)° 
^ ˆ ii (2.2)
˜ =˜ + .22 ˆ(xi− x)2 
Еще раз подчеркнем, что МНК-оценка является случайной величиной (хотя для каждой конкретной реализации данных это будет какое-то конкретное число). Полученное представление дает нам возможность удобно исследовать свойства этой случайной величины, в частности вычислить ее математическое ожидание и дисперсию. 
Начнем с математического ожидания: 
ˆ 
&#20;&#20;
&#23;
°
(xi− x) i (xi− x)2
E
=
E
˜
˘˘ˇ 
&#21;&#21;&#22; 
+ 
,
˜
^
()
2 
2 
где β2 — это число (неслучайная величина), которое по свойству математического ожидания можно вынести из-под знака математического ожидания; xi− x– тоже неслучайные величины (предпосылка № 2), с которыми можно сделать то же самое. 
В результате под знаком математического ожидания осталось только ˝i. ˜=0, следовательно:
Но в силу предпосылки № 3 Ei 
x− xE)() (x− x0
( ° )
^ ˆ ii ˆ i
E()˜ =˜+ =˜+ =˜ .
22 2222
(x− x)(x− x)


ˆ i ˆ i 
^
Мы выяснили, что E() т.е. доказали несмещенность оцен
˜ =˜ ,
22
^^
ки ° 2 . По аналогии можно доказать то, что ° 1 также является несмещенной оценкой. Стоит отметить, что в этих рассуждениях нам потребовались не все предпосылки теоремы Гаусса − Маркова. Были использованы первая предпосылка о спецификации модели, вторая предпосылка о том, что xi — детерминированные (неслучайные) величины, и третья предпосылка о математическом ожидании случайной ошибки. 
^
Для вычисления дисперсии ° нам потребуются дополнительно
2 
предпосылки № 4 и № 5. Также придется вспомнить некоторые свойства дисперсии: добавление константы к случайной величине на дисперсию не влияет, значит, справедливо следующее: 
ˆ
ˆ&#23;
&#23;
°
&#20;
° 
^(xi − x ) i (xi − x ))var i
&#20; 
Дисперсия константы, умноженной на случайную величину, равна квадрату константы, умноженному на дисперсию этой случайной величины. Используем это свойство и вынесем знаменатель из-под знака 
= 
дисперсии как константу: 
˜ 
^
var(˜2) = 1 22 ˇ var (˘(xi − x)° i ). (˘(xi − x) ) 
Остается дисперсия суммы °(x − x)˛ . В случае независимости
ii
слагаемых дисперсия суммы равняется сумме дисперсий. В силу пятой предпосылки о независимости случайных ошибок, соответствующих разным наблюдениям, можно утверждать, что слагаемые действительно независимы и поэтому: 
1
^
var(˜ ) = ˇ˘var ((x − x)°).
2 ii(˘(x − x)2 )2 
i 
Следующий шаг — вынести (xi − x ) из-под знака дисперсии, что законно, так как в силу второй предпосылки xi — это неслучайные величины: 
var(
˜
˘˘ˇ 
&#21;&#21;&#22; 
˘˘ˇ 
&#21;&#21;&#22; 
+ 
var
=
.
2 
2
&#20;
)2
&#20;
)2
( 
(
− 
−
x 
x 
x 
x
i 
i 
1
^2
var(˜2) = 22 ˇ(˘(xi − x) ˇ var()i ). (˘(x − x ) )° 
i 
Воспользуемся четвертой предпосылкой о том, что для всех наблюдений дисперсия случайной ошибки равна константе ˘2: 
1
^ 22
var(˜ ) = ˇ(˘(x− x) ˇ° ).2 (˘(xi− x)2 )2 i 
Величину ˘2 можно вынести за скобки: 
(x− x)2 2
^ ˘ i ° 
var(˜ ) = ˇ°2 = .
2
22 (x− x)
2 (˘(xi− x) )˘ i 
^
Таким образом, мы нашли дисперсию МНК-оценки ° 2: 
2
° 
^
var(˜ ) = .
2 (2.3)
˙(xi− x)2 
Используя аналогичные рассуждения, можно вычислить математи
^
ческое ожидание и дисперсию оценки ° 1, а также ковариацию между ^^
оценками ° 1 и ° 2: ^
E()˜ =˜ ;
11 
2 ^ 
°2 ˆxi
var(˜1) =˝ ; (2.4)
2
nˆ(x− x)
i 
2
° 
^^ ^
cov(˜˜,) =−˙ ˜ =−˙x
xvar() . (2.5)
12 2 2
ˆ(xi−x) 
Читателю предлагается сделать это самостоятельно (см. соответствующее упражнение в конце главы). 
Доказательство теоремы Гаусса — Маркова 
Докажем теорему для МНК-оценки параметра ° 2. Рассмотрим произвольную линейную по yоценку. Обозначим ее ° 2. В силу линейности: 
n ˜ 2 =˝cy˛ .
ii i=1 
Так как эта оценка должна быть несмещенной, то для нее при любых данных должно выполняться следующее условие: 
E˜ 2 =˜2; 
°
n
˙ 
cy
ii i1 
ˇ n &#22; E&#23;°ci˛(&#19;1 +&#19;2 xi+&#18;i)&#20; =&#19;2;
&#23;&#20;
˘i=1 &#21; 
˜&#23;= 
&#22;2;
E
˝˛ 
ˇˆ 
= 
˝
˝ˇ
n
ˇ
n 
cx
&#21;1 ii 
= 
˛ 11 
12 n
nn° i=1 i ˛i=1 ii 
= ной оценки параметра: 
nn 
˜ Это равенство верно при любом наборе тогда и толькоxxx,, …, тогда, когда 0 и ˜ 1==ccx . Теперь сформулируем задачу минимизации дисперсии несмещен- °˛var(˜ ) ° min при условии, что и0 ˜ 1;==ccx2 212iiii11ii== Последнее равенство корректно в силу предпосылок № 4 и № 5 КЛМПР. Так как мы имеем дело с задачей на условный экстремум, то 
i=1 ii=1 iic, … , c
1 n 
n 2 n 2
var(˜ )var= (&#23; c˘(˜ +˜ x+° )) =˛ &#23; c. 
мы можем написать соответствующую функцию Лагранжа: 
c
˛i
˜
˜
ˆˆ˙ 
&#23;&#23;˘ 
ˆˆ˙ 
=
&#23;&#23;˘ 
+ 
2 
2
. 
i 
i 
˝
˝ˇ
ˇ
n n n 
2
&#21;i
c
&#22;
&#21;i
cx
&#21;i
c 
=
= 
ˆˆ˙
= 
1 11 1 
Возьмем частные производные по ˜µи ci, = ,, …, . Прирав
, i 12 n 
няем их к нулю. Получим необходимые условия экстремума (так как мы минимизируем положительно определенную квадратичную форму при линейных ограничениях, то это условие будет и достаточным условием минимума): 
ˆ n ˘ cx˛=1; 
˘° ii˘ i=1 ˘
ˇ n c= 0;
˘° i ˘ i=1 
˘2c−&#22;x−µ= 0; i=12, ,…,n.
&#23; ii 
&#20;
− 
0 −
L
&#23;&#23;˘ 
ˆˆ˙ 
&#23;&#23;˘ 
+ 
+
=
µ
.
i 
i 
i 
i 
x− x
i
Решая эту систему, находим: ci = . 
n 
(x − x)2
˛ j=1 j 
n nx− x
i
Следовательно:  = cy˛= ˛ y.
˜2 ˙i=1 ii ˙i=1 ni
˙ (x − x)2 
j=1 j 
Осталось заметить, что полученная нами оценка — это и есть МНКоценка, записанная немного другим способом. Действительно: 
nn 
n 
x− x (x− xy)(x− xy) − 0
 i ˙i=1 ii ˙i=1 ii 
=˝ y== =
˜2 ˙ nin n
2 22
i=1(x − x) ˙ (x − x) ˙ (x − x)
˙ j=1 jj=1 jj=1 j 
n nn
(xi− xy) − y (xi− x)(x− x)( y− y)
˛i=1 i ˛i=1 ˛i=1 ii 
= == 
n 2 n 2
˛ (x − x)(x − x)
j=1 j ˛ j=1 j 
1 n 
(x− x)( y− y) ˜
˛i=1 ii cov(,xy)
n
== .
1 n ° 
2 var()x
(x − x)
n˛ j=1 j 
Таким образом, мы доказали, что решение задачи минимизации дисперсии несмещенной оценки параметра приводит нас в точности к МНК-оценке. Следовательно, МНК-оценка является эффективной и несмещенной, что и требовалось доказать. 
Для МНК-оценки параметра ° 1 доказательство может быть осуществлено аналогичным образом. 
2 .5 . Тестирование гипотез и построение доверительных интервалов 
^
В предыдущем параграфе мы выяснили, что дисперсия оценки ° равна: 
2
° 
^
var(˜ ) = .
2 
2
˙(x− x)
i 
^
Это полезная информация, так как дисперсия ° характеризует
2 
точность результатов оценивания соответствующего параметра (чем меньше дисперсия, тем точнее наша оценка). Проблема в том, что непо
^
средственно величину var(° ) мы вычислить не можем: хотя мы наблю
2 даем значения xi, i=12 … n
,, ,, но мы не наблюдаем величину ˘2. Этот параметр является неизвестным параметром классической линейной модели подобно величинам ° 1 и ° 2. Впрочем, как и в случае с ° 1 и ° 2, мы можем получить оценку неизвестного параметра ˘2. Несмещенная оценка дисперсии случайной ошибки ˘2 имеет вид: 
1 n 22
S =˛ e. 
n− 2 ˝ i 
i=1 
Чтобы доказать ее несмещенность, достаточно осуществить выкладки, аналогичные преобразованиям из предыдущего параграфа, и убедиться, что ES( 2) =°2. 
^
Если в формуле для var(° ) вместо дисперсии случайной ошибки
2 ˘2 подставить ее оценку S2, мы получим несмещенную оценку ди^
сперсии МНК-оценки ° 2, которая будет иметь вид: 
2
S
^ 
var ˜2 = . 
() ˝(xi− x)2 
Корень из этой величины называется стандартной ошибкой оценки 
^
коэффициента ° 2:  
S2
^
^
se()˜= var(˜2) = .
2 2
˝(xi− x) 
Аналогичным образом вычисляется стандартная ошибка оценки ко
^
эффициента ° 1 (здесь мы опираемся на равенство (2.4), заменяя в нем дисперсию случайной ошибки ее оценкой): 
2 ^ 
 ^ 
S ˙ i
2 x
se() = var(˜˛
˜ ) = .
11 2
n ˙(xi− x) 
Стандартные ошибки оценок коэффициентов пригодятся нам для тестирования гипотез. 
Представим, что мы хотим выяснить, влияет ли уровень образования (переменная x) на заработную плату работника в некоторой отрасли (переменная y)? Ответы на подобные вопросы, как мы обсудили в первой главе, и есть одна из главных задач эконометрики. 
Представим также, что все предпосылки классической линейной модели парной регрессии выполнены. Тогда в терминах нашей модели вопрос «Верно ли, что образование не влияет на заработную плату?» эквивалентен вопросу «Верно ли, что в регрессии y =˛ +˛ x +˝ коэф
i 12 iiфициент ° 2 равен нулю?» Как мы могли бы ответить на этот вопрос? Естественная идея состоит в том, чтобы посмотреть оценки коэф
^^ ^
фициентов ° 1 и ° 2 и увидеть, равен ли коэффициент ° 2 нулю. Однако ^^
при этом возникает следующая проблема: ° 1 и ° 2 — оценки, полученные при помощи МНК на основе случайной выборки. Следовательно, они сами являются случайными величинами, которые могут принимать значения, лишь «приблизительно» равные истинным. Поэтому, даже если истинное значение коэффициента ° 2 равно нулю, его оценка ° 2 скорее всего будет отклоняться от нуля. 
^
Следовательно, нужно уметь определять, достаточно ли сильно ° 
2 
отличается от нуля, для того чтобы можно было с уверенностью утверждать, что и истинное значение коэффициента ° 2 также не равно нулю. Опишем процедуру, которая позволяет это сделать. 
Процедура тестирования незначимости коэффициента: 
1. Формулируем тестируемую гипотезу H0: ˜=0 («переменная x не вли
2 яет на переменную y») и альтернативную гипотезу H1: ˜°0 («пере
2
менная x влияет на переменную y»)1. 
2. Находим расчетное значение тестовой статистики по формуле 
^
˜
2 
.
^
˜
se()
2 
3. 
Выбираем уровень значимости &#23;. Уровнем значимости в математической статистике называется вероятность ошибки первого рода, т.е. вероятность отклонить тестируемую гипотезу при условии, что в действительности эта гипотеза верна. Разумеется, нам хотелось бы ошибаться не слишком часто, поэтому данную вероятность обычно выбирают маленькой. Чаще всего в эконометрике используются уровни значимости 1% и 5%. 

4. 
Из таблиц распределения Стьюдента находим критическое значение 


°
тестовой статистики t для выбранного уровня значимости и так 
n−2
называемого числа степеней свободы, которое в нашем случае равно 
(n − 2). 
1 Здесь и далее во всех тестах, если явно не указано иное, мы предполагаем альтернативную гипотезу именно вида ˜2 °c, а не ˜2 < c или ˜2 > c. Поэтому под критическими значениями из таблиц распределения Стьюдента по умолчанию подразумеваются критические значения для двусторонних (а не односторонних) тестов. Все стандартные эконометрические пакеты используют такой же подход. 
^
˜
2 
° ^
5. Если > , т.е. ° достаточно велик по абсолютной величи
tn−22^
˜
se()
2 
не, следует отвергнуть гипотезу H0: ˜=0 и сделать вывод в пользу
2
альтернативной гипотезы, т.е. заключить, что переменная x влияет на переменную y. В этом случае переменную x называют статистически значимой при уровне значимости &#23;. В противном случае соответственно гипотеза H0 не может быть отвергнута, и переменную x называют статистически незначимой при уровне значимости &#23;. 
Замечание 1 . В этой процедуре мы опираемся на тот факт, что тестовая статистика имеет t-распределение Стьюдента. Чтобы это было верно, как раз и нужна предпосылка № 6 КЛМПР, которую мы до этого не использовали. 
В соответствии с этой предпосылкой случайные ошибки имеют нор
^
мальное распределение. Мы показали (см. равенство (2.2)), что ° 2 — это линейная комбинация случайных ошибок, т.е. независимых, одинаково и нормально распределенных случайных величин. 
Из математической статистики известно, что отсюда следуют два утверждения: 
^
во-первых, ° 2 имеет нормальное распределение (так как линейная комбинация нормальных случайных величин является нормальной случайной величиной), дисперсию и математическое ожидание которого мы вычислили в предыдущем параграфе: 
˝
ˇ
2
° 
˜
^ ^
˜ −˜
22
во-вторых, случайная величина имеет t-распределение Стью
^
˜
se()
2 
дента. В нашем случае это будет распределение с (n − 2) степенями свободы: 
^
˜ −˜
22 
~t .
^ n−2
˜
se()
2 
˜
ˆˆ˙ 
N
&#23;&#23;˘ 
;
~ 
,
2 
2
&#22;
(xi − x)2 
В частности, если верна сформулированная нами гипотеза ˜2 = 0, то 
^ 2
распределение Стьюдента имеет дробь ˜ , которую мы используем 
^
˜
se()
2 
в нашей процедуре. В этом случае критическое значение определяется 
из вот такого условия (его геометрическая интерпретация представлена 
в примере 2.3): 
˝
ˆ
P 
ˆ
ˆ
˙ 
^
˜
2 
^
˜
se()
2 
ˇ
&#23;
° 
<t =−1 °. 
n−2 &#23;
&#23;
˘ 
Замечание 2 . Аналогичным образом можно тестировать гипотезу 
H : ˜=c (против альтернативной гипотезы H : ˜°c ), где c — это
02 02
некоторая константа. В этом случае процедура тестирования остается такой же с одним исключением: расчетное значение тестовой статисти
^
˜− c
2
ки будет иметь вид .
^
˜
se()
2 
Замечание 3 . Раньше для определения величины критического значе
° 
ния t было необходимо использовать таблицы распределения Стью
n−2 
дента. Сейчас этот способ тоже доступен (например, соответствующая таблица представлена в Приложении 3А в конце гл. 3), однако теперь это значение можно рассчитать непосредственно в эконометрическом пакете или, например, в MS Excel (см. пример ниже). 
Альтернативным способом является использование для тестирования гипотезы так называемого P-значения. P-значением называют такой уровень значимости, при котором тестируемая гипотеза находится на грани между отвержением и принятием. 
Использовать P-значение при принятии решения очень просто: если оно меньше заранее выбранного уровня значимости &#23;, то тестируемая гипотеза отвергается при уровне значимости &#23;. Например, если при тестировании незначимости коэффициента вы используете пятипроцентный уровень значимости (˜=005, ), а P-значение оказалось равно 0,0002, следует заключить, что соответствующий коэффициент является значимым. Удобство использования P-значения состоит в том, что эта величина автоматически рассчитывается всеми стандартными эконометрическими пакетами, поэтому для принятия решения о значимости или незначимости того или иного коэффициента (а также для проведения любых других тестов, которые мы обсудим далее) вам не требуется никаких таблиц распределения и никаких дополнительных расчетов. 
Рассмотрим для большей наглядности еще один пример. 
Пример 2 .3 . Тестирование незначимости коэффициента и графическая иллюстрация . Представим, что у нас 10 наблюдений (n =10), оцен^
ка коэффициента оказалась равна ˜2 = 80,, а ее стандартная ошибка 






2,5%  2,5%  

 
 

^
se() ,. Если использовать подход, связанный с критическими
˜= 40
2 
значениями, нужно открыть таблицу распределения Стьюдента (см. Приложение 3А) и найти критическое значение для пятипроцентного уровня значимости и (n − 2) = 8 степеней свободы1. Это критическое 
,
значение tt005 ° 23,. Расчетное значение t-статистики здесь тоже
êð = 8
посчитать несложно: 
^
° 8 
= == 2.
t÷ 2 
^4
°
se()
2 
Если мы нанесем все указанные значения на картинку, у нас получится рис. 2.4а. Критическое значение отсекает по 2,5% слева и справа (всего 5%). Следовательно, вероятность попасть между −têð и têð составляет 95%. Нанесем также −tðàñ÷ и tðàñ÷ . Эти значения отсекают по 3% справа и слева, как это показано на рис. 2.4б. 
Обозначим &#22; случайную величину, имеющую распределение Стьюдента с (n − 2) = 8 степенями свободы. Тогда формально P-значение в нашем случае — это вот такая вероятность: 
˙ 
> 2) .
P-значение = P ( 
То есть в нашем примере P-значение — это вероятность такого события, что случайная величина, имеющая t-распределение Стьюдента с 8 степенями свободы, по модулю превысит tðàñ÷ = 2. Как видно из рисунка, в нашем случае эта вероятность равна 0,03 + 0,03 = 0,06. 





94 %  
3%  3%  


–tкр–tрасч–1 0 1 tрасч tкр3 –tкр–tрасч–1 0 1 tрасч tкр 3 
а) б) 
Рис. 2.4. (а) Расчетное и критическое значения тестовой статистики для примера 2.3; (б) P-значение для примера 2.3 


Как видно из нашего примера, P-значение больше заранее выбранного уровня значимости только тогда, когда 
t 
< têð, что подтверждает
ðàñ÷ 
1 Вместо использования готовых таблиц распределения можно, например, ввести в MS Excel формулу =СТЬЮДЕНТ.ОБР(1-0,05/2;10-2). 
сформулированное нами правило принятия решения при помощи P-значения: если P-значение больше уровня значимости, то нулевая гипотеза не отвергается. Если P-значение меньше уровня значимости, то нулевая гипотеза отвергается. 
*** 
^
˜ −˜
22 
°
Решив неравенство < tn−2 относительно ° 2, получим:
^
˜
se()
2 
^^ ^^
°°
˜− ˜˝t <˜ <˜+ se()˝t .
se() ˜
22 n−222 2 n−2 
Иными словами, с вероятностью (1−°) интервал 
ˆ ^ ° ^^ °˘
˜− se()˜˝t , ˜+ se()˜˝t
ˇ 22 n−22 2 n−2 &#23; 
содержит истинное значение оцениваемого параметра. Например, если ˜=005, и, следовательно, 1 −=0 95 
˛ ,, этот интервал и называют 95%-м доверительным интервалом для параметра ° 2. Возможность построения доверительных интервалов важна с пра
^
ктической точки зрения. Дело в том, что, так как ° является лишь
2 приблизительной оценкой параметра ° 2, эта точечная оценка сама по себе несет гораздо меньше информации, чем интервал. Ведь без доверительного интервала невозможно понять, насколько эта оценка на 
^
самом деле (не)точная. Например, утверждение « ° 2 равно 23,4» менее информативно, чем утверждение «истинное значение оцениваемого параметра с вероятностью 95 процентов содержится в пределах от 23,1 до 23,7». 
Завершим раздел еще двумя примерами. В первом из них все расчеты проделаны вручную, чтобы, проследив их, можно было еще раз разобраться во взаимосвязях между введенными нами понятиями. Во втором примере используется эконометрический пакет, что позволяет продемонстрировать, как подобные вычисления осуществляются в реальных прикладных исследованиях. 
Пример 2 .4 . Доходы индивидов и потребление риса . Исследователь анализирует зависимость потребления риса от уровня дохода (кривую Энгеля) для однородной группы из 20 потребителей. Все потребители из этой группы сталкиваются с одинаковыми ценами на рис и другие товары, и только уровни дохода у них различны, поэтому исследователь использует модель парной регрессии. 
Обозначим: xi — ежемесячный располагаемый доход i-го потребителя (в тысячах денежных единиц); yi — ежемесячное потребление риса i-м потребителем (в килограммах). Имеются следующие данные о переменных x и y: 
20 20 2020 20 22
x = 20; x = 40; y = 42; y =108; xy˛= 60. 
° i ° i ° i ° i ° ii i=1 i=1 i=1 i=1 i=1 
1 . Вычислите МНК-оценки коэффициентов в регрессии 
y =˝+˝ ˛ x +˙ .
i 12 ii 
Напишите полученное уравнение регрессии и коэффициент R2. 
2
 . При уровне значимости 5% проверьте значимость переменной x. 

3
 . Дайте содержательную интерпретацию коэффициента при переменной x. 

4
 . Вспомнив соответствующие определения из курса микроэкономики и вычислив необходимую эластичность, определите: является ли рис для этой группы потребителей низкокачественным товаром, товаром первой необходимости или предметом роскоши? 

5
 . При уровне значимости 5% проверьте гипотезу о том, что коэффициент ° 2 равен единице. 

6
 . Постройте 95%-й доверительный интервал для коэффициента ° 2. Решение: 

1
 . Вычислим средние значения: 


x = 1; x2 = 2; y = 21,; y2 = 54,; xy = 3. 
Найдем оценки коэффициентов: 
^ xy −˝ −˝,
xy 3121
˜= ==09,;
2 
−
22 21
x −x 
^^
˜=−˜˝x =21, −˝, =,.
y 10912
12 
^
Таким образом, y =12, + 09, ˛ x .
ii Теперь вычислим R2. Для этого воспользуемся тем, что по определению он равен отношению объясненной суммы квадратов к общей сумме квадратов: 
20 
(y ^ − y)2 
2 ˛i=1 i
R = .
20 
( y − y)2
˛i=1 i 
Вычислим каждую из этих сумм по отдельности. Сначала найдем общую сумму квадратов: 
20 20 2020 22 2
TSS = ( y − y) = y − 2 ˛ y ˛ y + y =
˙ i ˙ i ˙ i ˙ i=1 i=1 i=1 i=1 
20 20 22 2
= y −˛˛ y +20 ˛y =108 221422021, =
2 y −˛, ˛+˛ 198,.
˙i ˙i i=1 i=1 
Теперь найдем объясненную сумму квадратов: 
2020 20 ^2 22
y −y) = 12 +09 ˙−21 = 09 x
( (,, x ,) (, ˙−09, ) =
°i ° i ° i i=1 i=1 i=1 
20 ˙20 20 ˘ 22 2
), ˇ−˛ =16,.2
=09, (x −1 =0 81˛ x 2 x +20&#22; ,
&#21;i ˇ&#21;i &#21;i &#22;i=1 ˆi=1 i=1 &#23; 
Теперь можно вычислить коэффициент детерминации: 
20 ^ 
2 ˛i=1(yi − y)2 162,R = == 082
20 2198, ,. 
(y − y)
˛i=1 i 
Ответ на пункт 1: y ^ i = , + , ˛ xi ; R2 = 082.
1209 , 
2 . Тестируемая гипотеза — H0: ˜=0. Альтернативная гипотеза —
2 : ˜°0.
H12
Чтобы проверить значимость, нам понадобится стандартная ошибка оценки коэффициента. Для этого нам придется оценить сумму квадратов остатков. Воспользуемся тем фактом, что для регрессии с константой верно равенство: 
20 2020 2 ^22
˝(yi − y) =˝( yi − y) +˝ei . i=1 i=1 i=1 
В этой формуле мы вычислили все элементы, кроме суммы квадратов остатков: 
20 2
198162= , +˛ei
,. i=1 
20 
2 
=1, − 36,.
Следовательно, ˛i ei =198162, = 
Вычислим оценку дисперсии случайной ошибки: 
20 
2
e 
2 ˛i=1 i 36,
S = == 02,. 
n − 2 20 − 2 
Теперь вычислим стандартную ошибку оценки коэффициента: 
S 2 
02, 
02,
^
se() =
= ==,.˜ 01
2 
20 2040 −20
(x −x)2 x 2 −˝n ()x 2
˙i=1 i ˙i=1 i 
^
˜2 09,
Расчетное значение t-статистики равно == 9.
^
se()˜ 01,
2 
Критическое значение t-статистики из таблицы распределения Стьюдента при уровне значимости 5% и (20 – 2) = 18 степенях свободы составляет 2,101. Расчетное значение больше критического, следовательно, мы отклоняем нулевую гипотезу и делаем вывод о том, что уровень дохода индивида значимо влияет на его спрос на рис. 
Ответ на пункт 2: Переменная значима. 
Ответ на пункт 3: При увеличении располагаемого дохода потребителя на одну тысячу денежных единиц его спрос на рис увеличивается в среднем на 0,9 кг. 
4 . Вычислим эластичность спроса на рис по доходу. По определению эластичность равна: 
^
dy x 09, ˜x
˜= . 
dx y ^ 12, +09, ˜x 
Легко видеть, что при любых положительных значениях x эластичность спроса по доходу лежит между нулем и единицей, следовательно, для рассматриваемой группы потребителей рис является товаром первой необходимости. Что, в общем-то, неудивительно. 
Ответ на пункт 4: Товар первой необходимости. 
5 . Тестируемая гипотеза — H0: ˜=1. Альтернативная гипотеза —
2 : ˜°1.
H12 
Для проверки значимости нам понадобится стандартная ошибка оценки коэффициента. 
^
˜2 −1 09, −1
Расчетное значение t-статистики равно = =−1.
^
˜2 01,
se() 
Критическое значение t-статистики из таблицы распределения Стьюдента при уровне значимости 5% и (20 – 2) = 18 степенях свободы составляет 2,101. Расчетное значение по модулю меньше критического, следовательно, мы принимаем (не отклоняем) нулевую гипотезу. 
Ответ на пункт 5: Гипотеза не отклоняется. 
6 . В рамках предпосылок классической линейной модели парной регрессии доверительный интервал может быть подсчитан следующим образом: 
^^ ^^
( − ˜˛t , ˜+ ˜˛t )
˜ se() se() 
22 n−22 2 n−2 
(,09 − , ° , ,,09 + , ° ,
01 2101 01 2101). Таким образом, c вероятностью 95% интервал ( ,, , ) содержит
069111 истинное значение коэффициента ° 2. 
Ответ на пункт 6: (,,,).
069111 
*** Пример 2 .5 . Площадь однокомнатной квартиры и ее цена . В этом задании вам предлагается проанализировать взаимосвязь между площадью квартиры и ее ценой. Вам доступны следующие данные о московском рынке недвижимости в 2012 г. (файл Price2012): Price — рыночная цена однокомнатной квартиры в Москве (в тыс. руб.), выкуп которой был осуществлен с 10.01.2012 по 28.09.2012. TotalArea — общая площадь квартиры (кв. м). 
1 . Оцените регрессию переменной Price на переменную TotalArea. Запишите оцененное уравнение регрессии, указав коэффициент детерминации и (в скобках под соответствующими коэффициентами) стандартные ошибки. Постройте диаграмму рассеяния с линией регрессии. 
2 . Является ли коэффициент при переменной TotalArea статистически значимым при уровне значимости 1%? Дайте содержательную интерпретацию этого коэффициента. 

Решение: 
1 . Ниже представлена распечатка результатов оценивания уравнения в эконометрическом пакете Gretl1. (Любой стандартный эконометрический 
1 Для получения этого результата достаточно запустить Gretl; используя пункт меню «Импорт», импортировать данные из файла MS Excel (или просто мышкой «перетащить» нужный файл в рабочую область эконометрического пакета); выбрать в меню «Модель» пункт «Метод наименьших квадратов» и указать в качестве зависимой переменной переменную Price, а в качестве объясняющей — переменную TotalArea. 
пакет, например R, Stata или Econometric Views, выдаст аналогичную табличку. Пользуйтесь тем из них, который вам больше нравится, или тем, который есть под рукой.) 
Модель 1: МНК, использованы наблюдения 1-121 Зависимая переменная: Price 
Коэффициент Ст. ошибка t-статистика P-значение const 786,456 583,051 1,349 0,1799TotalArea 135,317 16,5144 8,194 <0,0001 *** 
Среднее зав. перемен 5540,335 Ст. откл. зав. перемен 792,7127Сумма кв. остатков 48208118 Ст. ошибка модели 636,4827R-квадрат 0,360696 Испр. R-квадрат 0,355324F(1, 119) 67,14000 Р-значение (F) 3,30e-13Лог. правдоподобие −951,8540 Крит. Акаике 1907,708Крит. Шварца 1913,300 Крит. Хеннана-Куинна 1909,979 
В столбце «Коэффициент» указаны оценки коэффициентов, а в столбце «Ст. ошибка» — их стандартные ошибки. В нижней части таблицы среди прочих показателей можно найти и коэффициент R-квадрат. 
Общепринятый формат записи полученных результатов имеет следующий вид (в скобках под оценками коэффициентов указаны соответствующие стандартные ошибки): 
 2
Pricei = 786 456 + 135 317 ˛ TotalAreai ,.
,, , R = 0,36 (583 051, )(16 514)
, 
Обратите внимание, что в скобках под оценками коэффициентов мы указали их стандартные ошибки. Такой формат является хорошим тоном при записи результатов эконометрического моделирования, так как позволяет читателю оценить точность ваших результатов и прикинуть доверительные интервалы для коэффициентов. 
2 . В столбце «P-значение» указано, что P-значение для оценки коэффициента при переменной TotalArea меньше, чем 0,0001 (и тем более меньше, чем 0,01). Следовательно, этот коэффициент является статистически значимым при уровне значимости 1%. 
Содержательная интерпретация: при увеличении общей площади квартиры на один квадратный метр ее цена в среднем при прочих равных условиях увеличивается на 135 тыс. руб. 
Отметим, что свободное слагаемое в данном случае отличается от нуля статистически незначимо, так как соответствующее P-значение равно 0,18, что больше любого разумного уровня значимости. Даже если бы эта константа была значима, все равно отдельно интерпретировать ее смысла не было бы, ведь константа показывает значение зависимой переменной при условии, что регрессор TotalArea равен нулю (т.е. при условии, что анализируемая квартира имеет нулевую площадь). Вряд ли кто-то всерьез интересуется ценой квартиры площадью 0 квадратных метров. 


2 .6 . Прогнозирование 
В зависимости от контекста термин «прогнозирование» в эконометрике может трактоваться по-разному. Применительно к данным временных рядов речь обычно идет о прогнозировании будущего значения зависимой переменной, например курса рубля или ВВП. Когда же речь идет о пространственных выборках, под прогнозированием понимают предсказание значения зависимой переменной для заданных значений объясняющих переменных, например предсказание цены квартиры с заданной жилой площадью. 
Формально задачу построения прогноза можно представить следующим образом. Имеется модель, для которой выполнены все предпосылки КЛМПР: 
y=˛ +˛ x+˝ .
i 12 ii 
Представим, что мы уже воспользовались МНК и получили оцененную на основе nнаблюдений линию регрессии: 
^^
^ 
y=+ x
˛˛ .
i 12 i 
Теперь пусть у нас есть известное (n+ 1)-е наблюдение регрессора x+1, но неизвестно соответствующее значение зависимой переменной 
n yn+1 и нужно построить его прогноз. Естественной идеей будет подста
вить известное значение в оцененную регрессию: 
^^
^ 
y 1 =+2 x .
n+ ˛˛1 n+1 
Оказывается, что это хорошая мысль: такой прогноз будет несмещенным и эффективным (т.е. будет характеризоваться минимальной ожидаемой квадратичной ошибкой прогноза). 
Докажем несмещенность этого прогноза. 
Вычислим математическое ожидание фактического значения y+1 и
n
^
нашего прогноза y . Если прогноз несмещенный, то эти математиче
n+1 
ские ожидания будут совпадать. 
^^
Воспользуемся тем, что, как мы доказали выше, ° 1 и ° — несме
2 щенные оценки коэффициентов ° 1 и ° 2: 
^^ ^^
^
Ey() = E(˛+˛ x ) = E() + E()x
˛ ˛ =˛+˛ x .
n+1 12 n+1 12 n+11 2 n+1 
Кроме того: 
Ey() = E(˛ +˛ x +˝ ) =˛ +˛ x + E(˝ ) =˛ +˛ x . 
n+1 12 n+1 n+1 12 n+1 n+1 12 n+1 
^
Следовательно, Ey() = Ey( ). 
n+1 n+1 
Кроме самого прогноза нас интересует его точность. Чтобы ее оценить, целесообразно вычислить математические ожидания квадрата ошибки прогноза: 
^ 2^^ 2
Ey( − y ) = E(˝+˝ x −˝ −˝ x −˙ ) = 
n+1 n+1 12 n+11 2 n+1 n+1 
2
°^^ ˝
E ( −)+( −)x −ˇ =
= ˆˆ ˆˆ
˛11 22 n+1 n+1 ˙ 
^22^2 2 ˆ^^ ˘
=E( −) +xE( −) +E(˙ ) +2xE ( −)( −
˝˝ ˝˝ ˝˝˝˝) −
11 n+1 22 n+1 n+1 ˇ112 2 &#23; 
˙^ −ˇ ˙^ −ˇ
−2E (˛˛)°−2xE (˛ ˛°) = 
ˆ11 n+1˘ n+1 ˆ22 n+1 ˘ 
^2^2 ^^ 
=var(˝) +x var() +˙+2x cov(˝˝)00
˝ , −−= 
1 n+12 n+1 12 
2 x 22
ˆ˙ 2 ˆˆ
i 22
=° + x +ˆ − 2xx°= 
2 n+12 n+12
n ˙(xi− x) ˙(xi− x) ˙(xi− x) 
˝ (x − x)2 ˇ 
1
ˆ n+1 &#23;
=&#21;21++ .
ˆ n &#23;
ˆ n (x− x)2 &#23;
˙&#22;i=1 i ˘ 
Здесь в предпоследнем равенстве мы воспользовались формулами 
^^ ^^
для var(°) ) и cov(°°, представленными выше.
1 , var(° ,)
2 12 Дисперсия ошибки прогноза ˘2, неизвестная нам в реальности, 2
может быть заменена несмещенной оценкой S. Если проделать эту замену, а затем извлечь из полученного результата корень, то получим стандартную ошибку прогноза: 
2 ˙ˇ 1(xn+1 −x)2 ˘&#22;˜= 
S 1 ++ .
ˇ nn &#22;
ˇ (x−x)2 &#22;
ˆ&#21;i=1 i &#23; 
Эту стандартную ошибку прогноза можно использовать для построения доверительного интервала прогноза. 95%-й доверительный интервал для прогноза — это такой интервал, который накрывает истинное прогнозное значение зависимой переменной с вероятностью 95%. Он имеет вид: 
^ ˙ ^ ˙
(y −˛˝t , y +˛˝t ).
n+1 n−2 n+1 n−2 
Обратите внимание, что величина стандартной ошибки прогноза зависит от соотношения x и x. Если x1 = x, то последняя дробь в 
n+1 n+
этой большой формуле окажется равной нулю, и стандартная ошибка прогноза будет минимальной. Чем значительнее xn+1 отличается от x, тем больше будет эта дробь. Таким образом, чем меньше наблюдение, для которого вы строите прогноз, похоже на вашу исходную выборку, тем менее точным этот прогноз окажется. 
Пример 2 .6 . Построение прогноза . Рассматривается классическая линейная модель парной регрессии y=˝+˝ ˛ x+˙ . Имеется сле
i 12 ii
дующая информация о 10 наблюдениях анализируемых переменных: 
10 10 1010 10 x= 20; x2 = 50; y= 8; y2 = 26; xxy˛=10. 
° i ° i ° i ° i ° ii i=1 i=1 i=1 i=1 i=1 
Для одиннадцатого наблюдения дано x11 = 5. Предполагая, что это наблюдение удовлетворяет исходной модели, вычислите наилучший линейный несмещенный прогноз y11 и оцените его точность, построив для него 95%-й доверительный интервал. 
Решение: 
−˝
xy xy
^
˜= =−06,;
2 
22
x−x 
^^
˜=−˜˝x=2.
y
12 
^^
^
Прогноз y =˙+˙˝x =−, ˝=−1.
2065
11 1211 
Сумма квадратов остатков равна: 
10 10 2 ^^ 
e=°e˝( y−˙1−˙ ˝ x) =
° i ii 2 i 
i=1 i=1 
10 10 1010 ^^ ^^ 
= ey−˙ e−˙ ex= ey−˙ ˛0 −˙ ˛0.
˝ ii 1 ˝ i 2 ˝ ii ˝ ii 12 i=1 i=1 i=1 i=1 
Последнее равенство верно в силу свойств остатков регрессии. Таким образом: 
1010 10 2 ^^ 
e=ey=(y ˙˙˝
−− xy) =
° i ° ii ° i 12 ii i=1 i=1 i=1 
1010 10 2^ ^ 
= y−ˆ y−ˆ˛ xy=2628 , ˛
−˛+06 10 =16;
˙i 1 ˙i 2 ˙ii i=1 i=1 i=1 
2
2 2 
2 ˙ 1(x11 −x) ˘&#20;ei ˙ 11 (x11 −x) ˘=˜=
S&#21;1++ =&#21;++
ˇ &#22;ˇ &#22;
ˇ n 2 &#22; n−2 ˇ n )2 &#22;
ˆ&#20;(x−x) &#23; ˆ&#20;(xi−x &#23;
i 
16 ˙ 1( −2 ˘
52)
= 
˛++1 =2.
ˇ&#22;
10 −2 ˆ 10 10 &#23; 
Теперь можно подсчитать доверительный интервал прогноза: 
^^
( y−°˝t, y+°˝t)
11811 8 
(−− °,, −+°,)
12 2306 12 2306 
(, ,,3612
−5 612 ). 
Заметим, что в этом примере точность прогноза не слишком высока, что объясняется маленьким количеством наблюдений и тем, что x11 довольно далек от среднего по выборке значения переменной x. 
Для получения более точного прогноза лучше, конечно, использовать больше данных. 
^
Ответ: y , доверительный интервал: (, 3 612).
=−1 −5 612,,
11 

2 .7 . Заключение 
В этой главе мы выяснили, как, используя статистические данные, анализировать влияние одной переменной на другую в рамках классической линейной модели парной регрессии: 
•	 
как оценивать параметры уравнения, описывающего эту связь; 

•	 
каким образом тестировать гипотезы по поводу этих параметров и строить доверительные интервалы; 

•	 
наконец, мы выяснили, как на основе полученного уравнения можно строить прогнозы и оценивать точность этих прогнозов. 


Еще раз подчеркнем, что в этой главе мы предполагали выполнение довольно жесткого набора предпосылок. В прикладных исследованиях часть из них, как правило, нарушается. Например, во многих ситуациях естественно анализировать влияние на зависимую переменную не одного, а нескольких факторов. Это приводит нас к необходимости перейти к следующей главе, где мы обсудим модель множественной регрессии. 
Задания для самостоятельного решения 
Задание 1 . Имеются некоторые данные о переменных x и y: 
y  16  9  7  5  3  
x  12  9  6  3  0  

а . Вычислите МНК-оценки коэффициентов в регрессии 
y =˝+˝ ˛ x +˙ .
i 12 ii 
б . Вычислите сумму квадратов остатков и R2. 
в . При уровне значимости 5% проверьте значимость коэффициента при переменной. 
г . Постройте 95%-й доверительный интервал для коэффициента ° 2. 
Задание 2 . Докажите, что в парной регрессии y на x (с константой) коэффициент детерминации R2 равен квадрату выборочного коэффициента корреляции между переменными x и y. 
Задание 3 . Формально обоснуйте свой ответ на каждый из вопросов: 
а . Что произойдет с МНК-оценками коэффициентов в парной регрессии y на x, если добавить константу c к каждому наблюдению x ? Как изменится (если изменится) коэффициент детерминации R2? 
б . Что произойдет с МНК-оценками коэффициентов в парной регрессии y на x, если домножить каждое наблюдение x на константу c ˆ 0? Как изменится (если изменится) коэффициент детермина
ции R2? 
Задание 4 . Анализируется модель парной регрессии y на x (с константой). В ходе МНК-оценивания модели на основе данных о 150 наблюдениях исследователь получил следующие результаты: 
y ^ = , + , ˛ x ; R2 = 0 8.
10420 ,
ii 
Если теперь, используя те же самые данные, оценить параметры мо
^ ^^
дели x + , то чему будет равна МНК-оценка коэффициента
=˛˛y
i 12 i
при переменной y? 
Задание 5 . Исходные данные для этого задания содержатся в файле Training. 
Руководство крупной торговой сети планирует выяснить, насколько лучше опытные работники справляются со своими обязанностями по сравнению с новичками. 
Для решения этой задачи вы располагаете следующими данными: 
sales — объем продаж данного менеджера (в тысячах рублей за период); 
experience — опыт работы менеджера в годах; 
training — фиктивная переменная, равная единице, если в самом начале данного периода менеджер прошел тренинг по продажам (работники, которые направлялись на курсы, выбирались из общей совокупности работников компании при помощи специальной лотереи). 
Примечание: в файле содержатся данные и о других переменных, которые пригодятся нам в одной из следующих глав. 
а . Оцените регрессию переменной sales на переменную experience. Запишите уравнение регрессии в стандартной форме, указав коэффициент детерминации и (в скобках под соответствующими коэффициентами) стандартные ошибки. 
Какие из коэффициентов являются значимыми (при уровне значимости 5%)? 
Дайте содержательную интерпретацию коэффициента при переменной training. 
б . Разделите всех работников на две группы: тех, кто проходил тренинг по продажам, и тех, кто его не проходил. Оцените регрессии переменной sales на переменную experience отдельно для каждой из групп. Сопоставьте полученные уравнения и интерпретируйте полученные результаты. 
Задание 6 . Рассматривается классическая линейная модель парной регрессии с детерминированным регрессором: y =˝+˝ ˛ x +˙ . Вы
i 12 ii
^
числите дисперсию оценки ° 1 (т.е. докажите равенство (2.4) из данной главы.) Какие из предпосылок классической линейной модели вы использовали? 
Задание 7 . Рассматривается классическая линейная модель парной регрессии с детерминированным регрессором: y =˝+˝ ˛ x +˙i .
i 12 i
Вычислите теоретическую ковариацию между оценками коэффици
^^
ентов: cov(°°) (т.е. докажите равенство (2.5) из данной главы).
1, 2
Какие из предпосылок классической линейной модели вы использовали? 
Задание 8 . Рассмотрим модель регрессии без константы: 
y =˝x +˙ , i =12, , …, n.
i ii 
При решении предполагайте выполнение предпосылок классической линейной модели регрессии. 
а . Найдите МНК-оценку для коэффициента &#19;. Покажите, что оценка является несмещенной. 
^
б . Вычислите дисперсию оценки &#19;. Как меняется точность оценки с ростом числа наблюдений? 
в . Приведите пример данных, при которых значение коэффициента R2 для этой модели меньше нуля или больше единицы. Из-за чего такая ситуация возможна? 
Задание 9 . Рассмотрим модель регрессии на константу: 
yi =+i , i =,, …
˝˙ 12 , n. 
При решении предполагайте выполнение предпосылок классической линейной модели регрессии. 
а . Найдите МНК-оценку для коэффициента &#19;. Покажите, что оценка является несмещенной. 
^
б . Вычислите дисперсию оценки &#19;. Как меняется точность оценки с 
ростом числа наблюдений? 
в . Вычислите R2. 
Задание 10 . Рассматривается модель парной регрессии: 
y =˝+˝ ˛ x +˙ .
i 12 ii 
Для модели выполнены все предпосылки КЛМПР, за исключением предпосылки № 3, которая заменена условием Ei =˝
˜µ0. Покажите, что МНК-оценка коэффициента ° 2 по-прежнему будет несмещенной. 



ГЛАВА 3 
МНОЖЕСТВЕННАЯ РЕГРЕССИЯ: ОСНОВЫ 
В первом параграфе этой главы мы обсудим мотивацию для изучения множественной регрессии, во втором сформулируем предпосылки классической линейной модели множественной регрессии (КЛММР). 
Третий и шестой параграфы являются техническими: они содержат векторно-матричную форму записи для КЛММР и ряд доказательств. Если вы хотите ограничиться прикладными аспектами множественной регрессии, а все соответствующие вычисления готовы доверить эконометрическому пакету, можете пропустить эти параграфы. 
В четвертом и пятом параграфах рассматриваются способы измерения качества соответствия модели данным, тестирование гипотез и построение доверительных интервалов. 
В последнем, седьмом, параграфе мы кратко обобщим основные идеи главы. 
3 .1 . Почему не стоит ограничиваться парной регрессией 
Предположим, что выполнены все предпосылки классической линейной модели парной регрессии за одним исключением — на зависимую переменную влияют не один, а два регрессора: 
y =˛ +˛ x +˛ w +˝ .
i 12 i 3 ii 
Например, мы заинтересованы в оценке влияния уровня образования индивида (переменная x) на его уровень дохода (переменная y). Иными словами, мы заинтересованы в получении корректной оценки коэффициента ° 2. Однако вполне естественно ожидать, что на уровень дохода работника влияет еще и стаж его работы (переменная w). 
Представим, что мы игнорируем второй фактор и оцениваем парную регрессию переменной y по переменной x: 
^^
^ 
y =+ x
˛˛ .
i 12 i 
^
Будет ли в этом случае оценка коэффициента ° 2 несмещенной? Для ответа на этот вопрос преобразуем ее следующим образом: 
˜˜ 
cov(,xy) cov(,x ˜+˜ ˙ x+˜ ˙ w+°)
^ 123
˜== = 
°°
2 var()x var()x 
˜ ˜˜ 
2 cov xx+˝3 ˛cov(,) + x
˝˛ (, ) xw cov(, ˙) == 
° 
var()x 
˜˜
cov(,xw) cov(,x˝)
=˛+˛ + .
23 °° 
var()x var()x 
Теперь для проверки несмещенности следует вычислить ее математическое ожидание: 
˜
˙ ˜˜ ˘ ˜ Ecov(,x°)cov(,xw) cov(,x°) cov(,xw) ()
^
E˜= Eˇ˜+˜ + &#22;=˜+˜ + .
2 ˇ 23 °° &#22; 23 °° 
ˆ var()x var()x &#23; var()x var()x 
Последнее равенство верно, так как все слагаемые, кроме cov
(,x˝), 
являются неслучайными и, следовательно, могут быть вынесены за знак математического ожидания. Однако E(cov x˜ )= 0. 
(, ) Действительно: 
ˆ n &#23; n
11
(, ))&#20; ii &#21;&#20; i− x)(E˜i− E˜) =
E(cov x˜= E˘ (x− x)(˜ −˜) = (x
˘ n &#21; n
ˇ i=1 &#22; i=1 
n = 1 ˛(xi− x)(00 =
− ) 0. 
n
i=1 
Поэтому 
˜
cov(,xw)
^
E˜ =˜ +˜ .
22 3 ° 
var()x 
Из этого равенства видно, что оценка коэффициента при интересующей нас переменной, вообще говоря, смещена. Например, если увеличение стажа работы приводит к увеличению дохода ˜3 > 0 и более образованные работники в среднем имеют более высокий стаж работы 
˜
cov(,xw)^ 
cov xw) > 0 то ˜3 0 и, следовательно, E˜2 >˜2. В этом слу(, , >
° 
var()x 
чае оценку коэффициента называют завышенной. 
Если, напротив, образование отрицательно коррелировано со ста
cov(,xw)^
жем (cov xw) < 0), то ˜3 ˜ < и E˜ <˜2 
(, 0 2 . В этом случае оценка
° 
var()x коэффициента называется заниженной. Отметим, что в нашем примере этот случай более вероятен, так как обычно продолжение обучения связано с отказом от немедленного выхода на рынок труда. Таким образом, в нашем примере, оценив парную регрессию, мы будем получать заниженную оценку коэффициента при переменной x, т.е. будем, как правило, недооценивать вклад образования в доходы работника. 
Рассмотренный пример показывает, что использование парной регрессии вместо множественной может привести к неверным выводам. 
Описанная ситуация называется смещением из-за пропуска существенной переменной (omitted variable bias). Для того чтобы избежать этого смещения, необходимо учитывать в вашей регрессии все существенные факторы (т.е. все коррелированные с интересующей вас переменной факторы, коэффициенты при которых в истинной модели регрессии отличны от нуля). Это приводит нас к необходимости анализа модели множественной регрессии. 
Прежде чем мы перейдем к этому анализу, подчеркнем, что смещение возникает только в том случае, если пропущенная переменная коррелирована с переменной, коэффициент при которой нас интересует. Действительно, если в нашем примере образование и стаж не связаны 
^
между собой cov xw) = 0 то E˜ =˜ , (, , и смещение отсутствует. Поэто
22
му если нас интересует эффект от уровня образования, то в регрессию следует включать переменные, которые коррелированы с уровнем образования, а прочие факторы можно игнорировать. 

3 .2 . Классическая линейная модель множественной регрессии 
При записи уравнения множественной регрессии мы будем использовать следующие обозначения: 
()2 ()3 ()k ,,
y=˙+˙ ˝x +˙ ˝x +…+˙ ˝x +ˆ, i=12 …, n,
i 12 i 3 i kii 
где yi— зависимая (объясняемая) переменная; 
m
x() — объясняющие переменные (регрессоры), m=…2, ,;k
i˝i — случайные ошибки; k— число коэффициентов в модели; n— по-прежнему число наблюдений. 
Чтобы подчеркнуть, что константа — тоже своеобразный регрессор, это уравнение иногда удобно записывать так: 
()1 ()2 ()3 ()k
y =˙ x +˙ ˝x +˙ ˝x +…+ ˙ ˝x +ˆ , i =12, , …, n,
i 1 i 2 i 3 i kii 
()1
где xi =1 для всех наблюдений. 
Предпосылки классической линейной модели множественной регрессии во многом схожи с предпосылками аналогичной модели для парной регрессии. 
Предпосылки классической линейной модели множественной 
регрессии (КЛММР) 
1. Модель линейна по параметрам и корректно специфицирована: 
()2 ()3 ()k
y =˙+˙ ˝x +˙ ˝x +…+˙ ˝x +ˆ, i =12, , …, n.
i 12 i 3 i kii m
()
2. 
Объясняющие переменные xi , m =12, , … , k, являются детерминированными и линейно независимыми. 

3. 
Математическое ожидание случайных ошибок равно нулю Ei


˜=0. 
4. Дисперсия случайной ошибки одинакова для всех наблюдений 
var(˜ ) =°2.
i
5. 
Случайные ошибки, относящиеся к разным наблюдениям, взаимно независимы. 

6. 
Случайные ошибки имеют нормальное распределение ˜ ~(N 0, °2). 


i 
Очевидно, что отличия от парной регрессии касаются только первых двух предпосылок. В первой предпосылке теперь фигурирует уравнение, в котором не 2 коэффициента, а целых k штук. 
Вторая предпосылка теперь требует, чтобы все регрессоры были линейно независимыми. Иными словами, не должно возникать ситуации, когда один регрессор линейно выражается через другие. Скажем, ситуация, когда для каждого наблюдения верно равенство 
()2 ()3 ()4
x = 6x + 5x , 
будет означать нарушение этой предпосылки. Такая ситуация представляет собой пример так называемой мультиколлинеарности. Мы подробно обсудим эту проблему в гл. 4. 
Для КЛММР также может быть сформулирована теорема Гаусса — Маркова. 

Теорема Гаусса — Маркова для модели множественной регрессии 
Если выполнены предпосылки 1−5 классической линейной модели множественной регрессии, то МНК-оценки коэффициентов модели будут: 
а) несмещенными; 
б) эффективными в классе всех несмещенных и линейных по y оценок. 


3 .3 . Векторно-матричная форма записи и некоторые доказательства 
Введем следующие обозначения. 
Вектор значений зависимой переменной: 
y
n−1 y
n 
Вектор случайных ошибок: 
Вектор коэффициентов модели: 
˝˜ˇ
1
ˆ&#23;
˜=…
ˆ&#23; ˆ˜&#23;
˙˘
k 
ˆ 
˘ ˘ ˘ ˘ ˘ ˘ ˘˘ˇ 
y
1 
y
2 
y
3 
… 
˛ 
˙ ˙ ˙ ˙ ˙ ˙ ˙˙˝ 
=
y 
ˇ 
&#23; &#23; &#23; &#23; &#23; &#23; &#23;&#23;˘ 
n−1 
˜˜˜ 
1 
2 3 
… 
n 
˜ 
˜ 
˝ 
ˆ ˆ ˆ ˆ ˆ ˆ ˆˆ˙ 
=
˜ 
Вектор МНК-оценок коэффициентов модели: 
˝^ ˇ
˜
1
^ ˆ&#23;
˜=…
ˆ&#23;
ˆ^ &#23;
˜
˙k ˘ 
Матрица регрессоров: 
° 
˝ ˝ ˝ ˝ ˝˛ 
()1 ()k
x ˜ x
11 
°° 
˛ 
°° 
()1 ()k
x ˜ x 
nn 
˙ 
ˇ ˇ ˇ ˇ ˇˆ 
X
= 
Таким образом, матрица регрессоров представляет собой таблицу, где число столбцов равно числу регрессоров, и в каждом столбце записаны данные об одном из них. Число строк в ней соответственно равно числу наблюдений. По умолчанию мы по-прежнему будем предполагать, что рассматривается регрессия с константой и, следовательно, 
()1
xi =1 для всех наблюдений. То есть первый столбец в матрице регрессоров заполнен исключительно единицами. Это предположение некритично для вывода формул МНК-оценок и исследования их свойств, однако полезно для некоторых других целей, например чтобы коэффициент R-квадрат в нашей модели гарантированно лежал на отрезке от 0 до 1. 
Выведем МНК-оценки коэффициентов в модели множественной регрессии. Напомним, что метод наименьших квадратов состоит в подборе оценок коэффициентов, которые минимизируют сумму квадратов остатков модели: 
22 ˙ ^ ()1 ^ ()k ˇ2 
^
˜e =˜(y − y ) =˜ y −&#23; x −…−&#23; x .
i ii ˆ i 1 i ki ˘ 
^^
Эту сумму квадратов мы будем минимизировать по ˜1, …, ˜k . Так как рассматриваемая квадратичная форма является положительно определенной, то необходимое условие экстремума будет и достаточным условием минимума. Поэтому, чтобы найти нужные нам оценки, 
^^
следует просто взять производные по ˜ , …, ˜ и приравнять каждую из
1 k 
них к нулю. В итоге получим систему из k уравнений: 
()1 ˆ ^ ()1 ^ ()k ˇ
−2 xy −˜ x −…−˜ x =0;
&#23; i ° i 1 i ki ˛ 
()2˛ ^ ()1 ^ ()k ˙
−2˘xy −&#23; x −…−&#23; x =0;
i ˝ i 1 i ki ˆ 
… 
()k ˛ ^ ()1 ^ ()k ˙
−2˘xy −&#23; x −…−&#23; x =0.
i ˝ i 1 i ki ˆ 
Эту систему можно переписать так: 
()1 ()1 ˙^ ()1 ^ ()kˇ
xy= x &#23; x+…+&#23; x ;
˜ii ˜iˆ 1 i ki ˘ 
()2 ()2˙^ ()1 ^ ()kˇ
xy= x &#23; x+…+&#23; x ;
˜ii ˜iˆ 1 i ki˘ 
… 
()k ()k ˙^ ()1 ^ ()k ˇ
xy = x &#23; x +…+&#23; x .
˜ii ˜i ˆ 1 i ki ˘ 
Или, что то же самое: 
()1 ˛ ()1 ˛^ ()1 ^ ()kˆˆ
˛ˆ x &#21; x+…+&#21; x
xy ˜˝ 1 ki ˇ
˙˜ii˘˙ ii ˘ 
˙˘
˙…˘= … .
˙˘˙˘
()k ˙ ()k˛^ ()1 ^ ()kˆ˘
˝˜xyˇ˙ x &#21; x+…+&#21; x ˘
ii ˝˜i ˝ 1 i ki ˇˇ 
С учетом введенных нами обозначений данную систему можно гораздо более лаконично записать в матричной форме: 
^
Xy˜= XX˜˛. (3.1) 
Действительно, для левой части равенства (3.1) верны преобразования: 
˛
ˆ
y
1 
y
2 
… 
˛
()1 ()1
ˆ
()1
˜˜
x
1 
x 
x
˙˙˙˙ 
˘˘˘˘ 
2
˙˙˙ 
n
˘˘˘ 
˜˛ 
Xy
&#23;
°˛° 
()k ()k ()k
xx ˜˜ x
12 n 
=
= 
˝
ˇ
˝
ˇ
y
n 
()1 
()1
+…+ xy
˛ˆ
&#20;
()1
ˆ
xy
11 
nn 
……… 
xy
ii 
… 
˙˙˙ 
˙˙˙ 
= 
˘˘˘ 
˘˘˘ 
= 
. 
()k 
x
()k 
i 
y
i
()k
+…+
&#20;
˝
˝ˇ
x
1 
y
1 
x 
y
ˇ
n n 
А для правой части равенства (3.1) можно записать: 
ˇn 2 n &#22;()1 
1 k
() ()
&#23; x xx &#20;
˙(i )˙ii ˇ^ &#22;
&#23; &#20;ˆ
i=1 i=11
&#23;&#20;
^ &#23; 
&#20;&#23;&#20;
XX˜ˆ= &#19;…= 
&#23; &#20;&#23;&#20; &#23;nn 2&#20;&#23;ˆ^ &#20; 
k 1 
() ˘k &#21;
() () k
&#23; xx &#20;
˙ii ˙(xi )
&#23;&#20;
˘&#21;11ii== ˇ
^^ 1
ˇ 
˘
˘&#21;
&#21;
n 
n 
^ 
11 
… 
nn 
= ˇ
)
=
(
˘&#23;
&#21;&#20;
()1 ()1 ()k 
ˇ ˇ 
ˇˆ 11i= 
^ 1 
)
2
^^ ^^ 
…+
11
ˇ 
^
Решая уравнение (3.1) относительно °, находим формулу для расчета вектора МНК-оценок коэффициентов: 
… 
−1
^
˜=(XX˙) Xy˙ . 
Для исследования свойств этих коэффициентов нам потребуется ввести еще один объект: ковариационную матрицу вектора случайных 
ˇ 
ошибок. Это такая таблица размером nна n, в которой на пересечении i-й строки и j-го столбца стоит коэффициент ковариации между случайными ошибками, относящимися к i-му и к j-му наблюдениям: cov(˝˝) Ковариационную матрицу для вектора ˝будем обозна
,.
ij
чать V().
˝ Таким образом, ковариационная матрица вектора оценок коэффициентов имеет вид: 
˛cov(˜˜,) ˜ cov(˜˜,) ˆ
11 1 n
˙˘
V()˜= °˛° .
˙˘ ˙cov(˜˜,) ˜ cov(˜˜,)˘
˝ n 1 nn ˇ 
Напомним несколько полезных для нас свойств ковариационной матрицы. 
Свойство 1 . Ковариационная матрица симметрична и положительно определена. 
Свойство 2 . На главной диагонали ковариационной матрицы расположены дисперсии соответствующих элементов случайного вектора. 
()1 2 
() ()k
1
x
ˆ
ˆ
ˆ
&#22;&#22;&#22;&#22;&#22;&#22; 
&#19;&#19;&#19; 
&#22;&#22;&#22;&#22;&#22;&#22; 
&#19;&#19;&#19;&#19;&#19;&#19; 
+…+
+…+ 
x 
x
i 
x
x
i 
x
i 
kk 
i 
i
i 
i 
i 
=
= 
…
.
&#19;&#19;&#19;
(
˘&#23;
&#21;&#20;
()k ()1 ()k
() ()1
k 
x 
()k
ˆ 
= 
ˆ
+…+
+ 
x 
x 
x
x 
x 
kk 
i 
i 
i
ii 
i
&#22;&#23;&#19;&#20;
&#22;&#23;
&#19;&#20;
i 
Свойство 3 . Добавление вектора констант не меняет ковариационную матрицу: 
V(˜+ b) =V().
˜ 
Свойство 4 . Умножение на матрицу констант меняет ковариационную матрицу следующим образом: 
VC( ˜=˜˝) CV()˝C
˜˛. 
Отметим, что указанные свойства верны для произвольной ковариационной матрицы, а не только для ковариационной матрицы вектора случайных ошибок. 
С учетом сформулированных определений можно переписать предпосылки КЛММР в матричной форме. Сравните их с предпосылками, сформулированными в предыдущем параграфе, и убедитесь, что это в точности одно и то же. 
Предпосылки классической линейной модели 
множественной регрессии в матричной форме 
1. yX +.
= ˛˝ 
2. Матрица X — детерминированная матрица, имеющая максимальный 
ранг k. 3. E˜=0. 
n 
˝ˇ
2 
00
° ˆ ˆ ˆ ˆ ˆ˙ &#23; &#23; &#23; &#23; &#23;˘ 

20
°
0
°
=
2
I . 
n 
˜
4−5. V() 
6*. ˜ 
= 

2
°
00 
2
° I

~(0
N 
).,
n n 
Здесь I — единичная матрица размером nна n, а 0 — нулевой вектор
nn
столбец длины n. 
Исследуем свойства МНК-оценок в случае выполнения указанных предпосылок. Для начала отметим, что вторая предпосылка гарантирует 
^
существование вектора МНК-оценок ˜= (XX˛ )−1 Xy˛ . Действительно, если матрица X имеет максимальный ранг k, то матрица XX&#17; имеет ранг k. Следовательно, она является невырожденной, поэтому существует (XX˜ )−1. 
Теперь вычислим математическое ожидание вектора МНК-оценок: 
^ −1 −1
E˜= E (XX) ˇ= EXX) X (X˜+°)
(ˇ Xy)(( ˇˇ )= 
−1 −1 −1
= EXX˙ ) XXˇ+ ( ˙ ) X ˘= E ˇ+( ˙
(( ˙ XX ˙) ( XX) X˙˘) = 
−1 −1
=+(XX˛) ˛ˆ=+˙(XX˛) X˛0
˙ XE() =˙. 
n 
Таким образом, мы показали, что МНК-оценка не смещена, т.е. доказали первую часть теоремы Гаусса — Маркова для множественной регрессии. Здесь мы использовали предпосылку № 1 (когда подставляли выражение X˜°
+ вместо вектора y), предпосылку № 2 о том, что матрица регрессоров детерминированная (когда выносили ее за знак математического ожидания), и предпосылку № 3 о том, что математическое ожидание вектора случайных ошибок равно нулю. 
Предпосылки № 4−6 для несмещенности МНК-оценок не нужны. Однако они понадобятся нам для вычисления ковариационной ма
^
трицы вектора оценок коэффициентов V(), т.е. матрицы размером
° 
k на k, где на пересечении i-й строки и j-го столбца стоит ковариа
^^
ция cov(°°)
,.
ij
Эта матрица пригодится нам для тестирования гипотез относительно коэффициентов модели. Например, на главной диагонали такой 
^^ ^
матрицы стоят дисперсии оценок коэффициентов cov(˜˜, )var()=˜.
ii i 
Нам потребуется оценить их для тестирования незначимости соответствующих коэффициентов: 
^ −1 −1
V() =V(( ˇ ) Xy)= (( ˇ ) X (X )
˜ XX ˇ VXX ˇ ˜+°) = 
−1 −1 −1
=VXX˙ ) XXˇ+( ˙ ) X ˘=V ˇ+ ( ˙
(( ˙ XX ˙) ( XX) X˙˘) = 
= {воспользуемся третьим свойством ковариационной матрицы} = 
=(( ˝ )1 X˝ˆ) =
VXX − 
= {воспользуемся четвертым свойством ковариационной матрицы} = 
˝
−1 −1
= (XX˝ ) ˝ˆ( ˝ ) X˝=
XV()(XX ) 
= {воспользуемся предпосылками № 4−5 КЛММР} = 
−12 −1 −1 −12 −12
= (XX° ) XI° ˛˙ )( ° ) = (XX) XXXX) ˙= (XX) ˙ .
( XXX °° ( °° 
n 
Таким образом, ковариационная матрица вектора оценок коэффициентов имеет вид: 
^ −12
V ()˜= (XX˝ ) ° . 
Обратите внимание: чтобы это равенство было корректно, требуется выполнение всех предпосылок КЛММР с первой по пятую. Например, при нарушении предпосылки о постоянстве дисперсии случайной ошибки ковариационная матрица вектора оценок коэффициентов будет иметь другой вид (мы обсудим этот вариант в гл. 5). 
Непосредственно эту матрицу на практике вычислить мы не можем, так как не знаем величину дисперсии случайной ошибки ˘2. Однако мы можем получить несмещенную оценку этой матрицы, если заменим величину ˘2 на ее несмещенную оценку: 
1 n 22
S =˛ e . 
nk ˝ i
− 
i=1 
В этом случае мы получим оценку ковариационной матрицы вектора оценок коэффициентов: 
^^ ˛−12
V ()˜=(XX ) S . 
Это таблица размером k на k, где на пересечении i-й строки и j-го столбца стоит несмещенная оценка коэффициента ковариации между 
^^
° и ° j . А на главной диагонали этой матрицы в j-м столбце стоит не
i 
^ ^
смещенная оценка дисперсии коэффициента ° j — var ° j Корень из(). 
этой дисперсии — стандартная ошибка оценки коэффициента: 
^
se() =
˜
j 
Далее мы увидим, что эта стандартная ошибка может использоваться, например, для тестирования незначимости соответствующего коэффициента. 
Чтобы лучше разобраться во взаимосвязях между введенными нами векторами и матрицами, рассмотрим числовой пример. 
Пример 3.1. Оценка параметров в модели множественной регрессии 
Рассматривается классическая линейная модель множественной 
()2 ()3
регрессии y =˛ +˛ x +˛ x +˝ . Имеются следующие данные
i 12 i 3 ii
о тысяче наблюдений соответствующих переменных: 

1000 1000 1000 1000 
2
()2 ()3 ()2 (3) (2)
x =1000; x = 1000; xx =1000; x = 3000;
° i ° i ° ii °( i)
i=1 i=1 i=1 i=1 
1000 1000 1000 1000
2
()3 ()2 (3)
x = 2000; xy=1000; xy= 2000; y= 0. 
°( i)° ii ° ii ° i 
i=1 i=1 i=1 i=1 
а . Вычислите МНК-оценки коэффициентов модели. 
б . Пусть также известно, что сумма квадратов остатков в оцененной регрессии оказалась равна 997 000. Вычислите оценку ковариационной матрицы вектора оценок коэффициентов. Укажите, чему равна, напри
^^
мер, оценка коэффициента ковариации между ° 2 и ° 3. 
в . Напишите оцененное уравнение регрессии в стандартной форме, указав в скобках под оценками коэффициентов соответствующие стандартные ошибки. 
Решение: 
а . ˜^ = (XX˛ )−1 Xy˛= 
−1
˙
˙
˘
1000
˘
1000 1000 
x
()2 
i 
x
()3 
i
˝ 1 ˝ 1
= 
˝
ˇ ˇ ˇ ˇ ˇ ˇ ˇ ˇˇˆ 
ˇ ˇ ˇ ˇ ˇ ˇ ˇ ˇˇˆ 
&#21; &#22; &#22; &#22; &#22; &#22; &#22; &#22; &#22;&#22;&#23; 
&#22; &#22; &#22; &#22; &#22; &#22; &#22; &#22;&#22;&#23; 
n y
i 
1 ()2 
i 
i 
i
= 
1000 1000 
= 
1000 1000 
˝ 
=
)
= 
° 
= 
2 
11 1 1000 1000 1000 
1000 1000 
(
()2 ()2 ()2 ()3
xx
˝
˝
˝
=
=
x 
x
i 
i 
ii 
xy
ii 
=
1 1000 
i 
i 
i 
i 
° 
)
2
(
()3 ()2 ()3
xx 
()3 
i 
()3
xy
ii 
= 
˝ 1
= 
˝ 1
= 
˝ 1 
˝= = 
i1 
x 
x
i 
ii 
i 
i 
i 
−1
˙
˙
1000 1000 
0 
˝ ˝˝˛
1000 
1000 
˝ ˝˝˛ 
˘ˇ ˇˇˆ 
ˇ ˇˇˆ 
3000 1000 
1000 
2000 
= 
1000 2000 
˛
˛ˆ
ˆ
˛−
ˆ
25, −05, −1 
0 
25,
1
˙ ˙˙˝ 
˙ ˙˙˝ 
&#23;
˘ ˘˘ˇ ˙ ˙˙˝ 
=
˘ ˘˘ˇ 
˘ ˘˘ˇ 
−05, 05, 0 
1000 
2000 
05, 
2 
= 
. 
−1 01 
e
2 ˛ i 2 997000
б . S== =1000 .
nk1000 −
− 3 
Оценка ковариационной матрицы вектора оценок коэффициентов: 
˝25, −05, −1ˇ ^^ −1 &#21; 2 ˆ&#23;
V()˜=(X&#22;X) S=−05, 05, 0.
ˆ&#23;
ˆ&#23;
˙−1 01 ˘ 
^^
Оценка коэффициента ковариации между ° 2 и ° равна нулю, так
3 
как именно это число стоит на пересечении второй строки и третьего столбца в нашей матрице. 
в . Стандартные ошибки оценок коэффициентов составляют 
^
^ 
^
se() = , =158, ˜= 05, = , ,se() = 
11.
˜ 25 , se() 071 ˜= 
12 3 
Теперь можно записать оцененное уравнение в стандартной форме: 
()2 ()3
y=− , + , xi 200 i 
^ i 250050 + , x . (158, ) (071, ) (100, ) 
Этими результатами мы воспользуемся в примере 3.2 в параграфе, посвященном тестированию гипотез. 

3 .4 . Степень соответствия модели данным 
Для множественной регрессии формула несмещенной оценки дисперсии случайной ошибки имеет вид 
n
1 ˙ i
˜^2 = S2 =˝ e2.
−
nk
i=1 
Она почти такая же, как для парной регрессии, за тем исключением, что в знаменателе вместо выражения (n− 2) стоит (nk Если извлечь
− ). корень из этой величины, то можно получить стандартную ошибку регрессии: 
1 n 2
2
SEE = 
S= ˛˝ei.
−
nk
i=1 
Расчет стандартной ошибки регрессии — это один из способов оценить точность вашей модели в целом, т.е. понять, насколько хорошо она соответствует данным. Чем меньше стандартная ошибка регрессии, тем лучше ваша модель соответствует доступным вам наблюдениям. 
Следующая характеристика качества подгонки — это коэффициент 
2
детерминации R. 
Для множественной регрессии с константой, так же как и для парной, верно, что общая сумма квадратов может быть представлена как сумма квадратов остатков и объясненная сумма квадратов: 
n nn 
2 2^2
˝(y − y) =˝e +˝(y − y).
i ii i=1 i=1 i=1 
Поэтому и R2 может быть рассчитан в точности таким же образом, как и для модели парной регрессии: 
n 2 n ^2
e (y −y)  ^)
=− ˛i=i ˛ i var( y
21 i=1
R 1 == . 
nn 
(y −y)2 (y −y)2 var()y
˛i=1 i ˛i=1 i 
И точно так же, как и в случае парной регрессии, он будет лежать между нулем и единицей. Если ваша модель хорошо соответствует данным, то R2 будет близок к единице, если нет − то к нулю. Еще раз под
2
nn 2 n ^
черкнем, что условие ( y − y) = e + (y − y)2 выполня
˝i=1 i ˝i=1 i ˝i=1 i ется только тогда, когда в модели есть константа. Если же ее нет, то указанное равенство, вообще говоря, неверно, и R2 не обязан лежать между нулем и единицей и интерпретировать стандартным образом его нельзя. 
Некоторые эконометристы старой школы придают важное значение величине коэффициента R2. Действительно, если он близок к единице, то это, как правило, приятная новость. Однако не стоит переоценивать эту характеристику качества модели потому, что у коэффициента R2 есть существенные ограничения: 
1. 
Высокий R2 характеризует наличие множественной корреляции между регрессорами и зависимой переменной, но ничего не говорит о наличии или отсутствии причинно-следственной связи между анализируемыми переменными. Вспомните примеры из первой главы, где мы обсуждали, что высокая корреляция не гарантирует причинно-следственной связи. 

2. 
R2 не может быть использован для принятия решения о том, стоит ли добавлять в модель новые переменные или нет. Дело в том, что, когда вы добавляете новые переменные в ваше уравнение, качество подгонки данных не может стать хуже, следовательно, и сумма квадратов остатков не может увеличиться. В теории она может остаться неизменной, но на практике она всегда будет уменьшаться. А в этом случае, как видно из расчетной формулы, 


R2 будет увеличиваться. Получается, что какие бы странные но
вые переменные вы ни добавляли в модель, коэффициент R2 бу
дет увеличиваться (или в крайнем случае оставаться неизменным). 
Последний из указанных недостатков легко можно преодолеть. Для этого есть усовершенствованная версия R2, которую называют скорректированным (или нормированным) коэффициентом R2(R2 adjusted): 
k −1 
2
2 ˛−R ).
R2 =R − (1
adj 
nk
− 
k −1
2 R22
меньше, чем обычный , на величину (1 R ),°− которая
Radj nk
− 
представляет собой штраф за добавление избыточных переменных. Обратите внимание, что при прочих равных этот штраф растет по мере увеличения параметра k, характеризующего число коэффициентов в вашей модели. Если вы будете добавлять в модель много регрессоров, которые не вносят существенного вклада в объяснение зависимой пере
2
менной, то Radj будет снижаться. 
Поэтому, если вы хотите сравнить межу собой модели с разным числом объясняющих переменных, то лучше использовать 2 , чем
Radj обычный R2. А еще лучше обращать внимание не только на этот коэффициент, но и на прочие характеристики адекватности вашей модели, которые мы обсудим в данной книге. Чтобы понять, откуда берется формула для скорректированного R-квадрата, запишем обычный R-квадрат следующим образом: 
˛n 2
e 
ni=1 i
2 2 ˛i=1ei 1 n
R =−1 =− . 
n 2 n 2
( y −y) ˛( y −y)
˛i=1 ii=1 i n 
В числителе дроби стоит выборочная дисперсия остатков, а в знаменателе — выборочная дисперсия зависимой переменной. Если и ту, и другую дисперсии заменить их несмещенными аналогами, то получим следующее выражение: 
e
˛in =1 i 2 
2
S 
−
nk
1− 1
=− . 
nn
(y −y)2 ( y −y)2
˛i=1 i ˛i=1 i n −1 n −1 
Легко проверить, что это и есть скорректированный R-квадрат: 
˛ni 2 n 
e
i=1 
2
e
− =−n−1 ˛i1 in−11 2
nk =
1 − 1 =1− ( −R) = 
2 nk 2 nk
n − n −
˛(yi−y) ˛( yi−y)
i=1 i=1 n−1 
k−1
2 22
=R− (1 R) =˛− R
adj.
−
nk 
3 .5 . Тестирование гипотез и построение доверительных интервалов 
Начнем с тестирования гипотез для отдельных коэффициентов. Пусть вы имеете дело с классической линейной моделью: 
()2 ()3 ()k
y=˙+˙ ˝x +˙ ˝x +…+˙ ˝x +ˆ.
i 12 i 3 i kii 
j
Если вас интересует, влияет ли регрессор x() на зависимую переменную, то для этого нужно осуществить тест на незначимость соответствующего коэффициента. 
Процедура тестирования незначимости коэффициента в модели множественной регрессии: 
j
1. Формулируем тестируемую гипотезу H: ˜=0 («переменная x()не
0 jвлияет на переменную y») и альтернативную гипотезу H: ˜°0 («пе
1 j
j
ременная x() влияет на переменную y»). ^
° 
j
2. Находим расчетное значение тестовой статистики по формуле .
^
°
se()
j 
3. 
Выбираем уровень значимости &#23;. 

4. 
Из таблиц распределения Стьюдента находим критическое значение 


°
тестовой статистики t для выбранного уровня значимости и так
nk
−
называемого числа степеней свободы, которое в нашем случае равно (nk).
− 
^
˜ 
j 
^
°
5. Если 
> t− , т.е. ° достаточно велик по абсолютной величи
nk j
^
˜
se()
j не, следует отвергнуть гипотезу H: ˜=0 и сделать вывод в пользу
0 j 
j
альтернативной гипотезы, т.е. заключить, что переменная x() влияет j
на переменную y. В этом случае переменную x() называют статистически значимой при уровне значимости &#23;. В противном случае соот()j
ветственно гипотеза Hне может быть отвергнута и переменную x
0
называют статистически незначимой при уровне значимости &#23;. 
Легко заметить, что описанная процедура в целом такая же, как и для парной регрессии. Отличие состоит в том, что число степеней свободы теперь равно ( − ),
nk и в том, что оценки коэффициентов и их стандартные ошибки рассчитываются по формулам для множественной регрессии. Как именно их рассчитать, мы обсудили в § 3.3, но на практике вы можете доверить эту скучную работу компьютеру. 
Аналогичным образом можно тестировать гипотезу H0: ˜=c(про
jтив альтернативной гипотезы H ˜°c), где c— это некоторая кон
1: j
станта. В этом случае процедура тестирования остается такой же с одним исключением: расчетное значение тестовой статистики будет иметь 
^
˜− c
j
вид .
^
˜
se()
j 
Такая же аналогия с парной регрессией работает и при построении доверительных интервалов. Например, 95%-й доверительный интервал для коэффициента ° jимеет вид: 
˙˜^ −˜^ ˛ t005, , ˜^ +˜^ 0 05, ˇ
se() se()˛ t ,
j jnk− j jnk˘
ˆ− 
005
где t, — критическое значение распределения Стьюдента для уровня
nk
− 
значимости 5% и (nk) степеней свободы.
− 
Так как каждая из оценок коэффициентов имеет t-распределение Стьюдента, то и любая их линейная комбинация также имеет такое распределение, что позволяет тестировать гипотезы по поводу линейных комбинаций коэффициентов, например гипотезы следующего вида: 
H: a˜˝ + b˜˝ = c.
01 2 
В этом случае процедура тестирования снова остается такой же с одним исключением − расчетное значение тестовой статистики будет иметь вид: 
^^^^ ^^
˜+˜− ˙
ab ˙ a˜+˜−˙ ca ˙b ˙ c
˙ cb ˜+˜−
1212 12
=
= . 

^^ ^^ ^^^^
a ˙b ˙) var(a˜+˜˙) a2 ˜var ˙)+b ˜var( )+2ab˜cov ˙˙se( ˜+˜ ˙b (2 ˙ (,
1212 12 12) 
Пример 3.2. Тестирование гипотез в модели множественной регрессии (продолжение примера 3.1) 
Рассматривается классическая линейная модель множественной 
()2 ()3
регрессии y =˛ +˛ x +˛ x +˝ . В ходе оценивания модели на
i 12 i 3 ii
основе данных по тысяче наблюдений при помощи МНК были получены следующие результаты: 
()2 ()3^ 
y =− , + , x +200250050 , x .
i ii
(158, ) (071, ) (100, ) 
Кроме того, была вычислена оценка коэффициента ковариации 
^^ ^^
между °° (, ) =0.
2 и которая составляет cov ˜˜
3, 23 3
а . Значима ли переменная x() (при уровне значимости 5%)? 
б . Проверьте гипотезу ˜+˜= 5.
2 23 
Решение: 
а . Критическое значение тестовой статистики из таблиц распределения Стьюдента при уровне значимости 5% и (1000 −=3) 997 степенях свободы составляет 1,96. Расчетное значение тестовой статистики: 
^
˜ 2
3 x()3
21 96 Следует сделать вывод о том, что переменная
==>,.
^
˜
se() 1
3
статистически значима при уровне значимости 5%. б . H0:1˜˝ + 2 ˜˝ = 5:
23 
1°ˇ+°2 ˇ−51°ˇ+°2 ˇ−5
23 23
== =
tðàñ÷ ˜ 
° 
se 1°ˇ+°2 ˇ
(23 ) 
var(1°ˇ++°2 ˇ)
23 
05, +˛−
22 5 
== 
˜˜ ° 
var ˇ +˛4 var ˇ +˛4 cov ,



() () (ˇˇ)
23 23 

05, +˛−22 5 −05,
= 
==−0236,
,22 , +˛+˛
05 41 40
˙ ^ ˇ˙ ^ ˇ ^^
&#23; 4 &#23; (,se()˘+˛se()˘+˛4 cov˜ &#23;&#23;)
ˆ 2 ˆ 3 23 
−0 236 <196, следовательно, тестируемая гипотеза не отвергается.
, , 
*** 
Во всех рассмотренных выше случаях мы тестировали гипотезу по поводу выполнения единственного линейного ограничения (например, ˜3 = 0 или ˜+ 2˜= 5). Однако на практике часто возникает необходи
23
мость тестировать одновременное выполнение сразу нескольких ограничений. 
Представим, например, что вы сначала оценили параметры регрессии, в которой есть m коэффициентов: 
()2 ()m
y =˙+˙ ˝x +…+˙ ˝x +ˆ .
i 12 i mii 
После этого вы задались вопросом по поводу того, стоит ли добавить в эту модель еще q новых переменных, т.е. о том, стоит ли переходить вот к такому уравнению: 
()2 ()m
y =˙+˙ ˝x +…+˙ ˝x +
i 12 i mi 
(m+1) (mq+ )
+˝ ˛x +…+ ˝ ˛x +˙ .
+1 i + ii
m mq 
Для удобства назовем первую из двух моделей «короткой» (так как в ней меньше переменных), а вторую — «длинной» (так как в ней переменных больше). Как сделать выбор между этими моделями? 
«Короткая» регрессия будет предпочтительной, если ни одна из добавленных в «длинную» регрессию переменных не является значимой. Иными словами, следует выбрать «короткую» регрессию, если верна следующая гипотеза: 
H : ˜ =…=˜ =0,
0 m+1 m+q 
т.е. в том случае, если одновременно выполнено q ограничений. Для этого можно использовать так называемый F-тест. 
Процедура теста на сравнение «короткой» и «длинной» регрессий 
Оцените «короткую» регрессию, получите коэффициент R-квадрат из 
2
этой регрессии, обозначьте его RR(R2 restricted), т.е. R-квадрат в регрес
сии, для которой выполнено ограничение (restriction). 
Оцените «длинную» регрессию, получите коэффициент R-квадрат из 
2
этой регрессии, обозначьте его RUR (R2 unrestricted). Вычислите расчетное значение тестовой статистики: 
22
RUR − RR nk
−
F ˛ ,
ðàñ÷ = 2
1− Rq
UR 
=+— количество коэффициентов в «длинной» регрессии.
где kmq 
Если верна нулевая гипотеза, то расчетное значение тестовой статистики имеет распределение Фишера с qи (nkстепенями свободы. Поэтому,
− ) 
если расчетное значение больше критического значения из таблиц распределения Фишера, т.е. Fðàñ÷ > F qnk), то тестируемая гипотеза отвер
˛(, − 
гается при уровне значимости &#23;. Таким образом, следует сделать выбор в 
пользу «длинной регрессии». 
Если же F F qnk− ), то тестируемая гипотеза не отвергается при
˜˛(,
ðàñ÷
уровне значимости &#23;, т.е. следует сделать выбор в пользу «короткой» регрессии. 
Таблицы распределения для осуществления всех тестов из этой главы содержатся в Приложении 3А. 
Важным частным случаем F-теста является ситуация, когда «короткая» регрессия включает в себя только константу 
y=˛ +˝ ,
i 1 i 
а «длинная» регрессия по-прежнему содержит много переменных: 
()2 ()k
y=˙+˙ ˝x +…+˙ ˝x +ˆ .
i 12 i kii 
В этой ситуации сравнение «короткой» и «длинной» регрессий состоит в проверке гипотезы ˜2 =…=˜k =0, т.е. гипотезы о том, что ни один из регрессоров не влияет на зависимую переменную. Разумеется, если эта гипотеза не отвергается, то стоит заключить, что факторы для вашей модели мы выбрали скверные (раз уж ни один из них не помогает объяснить зависимую переменную). В таком случае уравнение называют в целом незначимым, а саму процедуру проверки гипотезы ˜ =…=˜ =0 — тестом на незначимость уравнения в целом.
2 k
Так как в уравнении, содержащем только константу, R-квадрат всегда равен нулю (см. задачу 9 из гл. 2), то можно упростить формулу расчетного значения тестовой статистики. Подставим в нее 0 вместо величины R2 , а величину R2 обозначим просто R2. Кроме того, не
R URзабудем, что в нашем случае qk1. Получим:
=− 
2
R nk
−
F =˛ .
ðàñ÷ 2
1 − Rk−1 
Это и есть расчетное значение тестовой статистики для теста на незначимость уравнения в целом. Сравнивать его нужно с критическим значением из таблиц распределения Фишера Fk−1, nk).
˜( − 
Тест на сравнение «короткой» и «длинной» регрессий можно обобщить на случай сравнения невложенных моделей. Представим, например, что вам нужно сделать выбор между двумя такими моделями: 
()2 ()3
y =˛ +˛ x +˛ x +˝ (А)
i 12 i 3 ii 
и 
()2 ()3
y =˛ +˛ z +˛ z +˝ .(В)
i 12 i 3 ii 
Они называются невложенными (nonnested), так как по крайней мере некоторые переменные из модели А не входят в модель B и, наоборот, по крайней мере некоторые переменные из модели B не входят в модель A. Указанные модели не получится сопоставить, используя тест на сравнение «короткой» и «длинной» регрессий, так как ни одна из моделей не вложена в другую (т.е. не является ее частным случаем, «короткой» версией). Чтобы преодолеть это ограничение, можно прибегнуть к следующему трюку — рассмотреть новую модель, которая обобщает две предыдущие: 
()2 ()3 ()2 ()3
y =˛ +˛ x +˛ x +˝ z +˝ z +˙ .
i 12 i 3 i 2 i 3 ii 
Для этой модели нужно провести два теста на сравнение «короткой» и «длинной» регрессий: 
•	 
Сначала проверить гипотезу о том, что незначимыми являются все переменные, которые входят в модель А, но не входят в модель B. 

•	 
Затем проверить гипотезу о том, что, наоборот, незначимыми являются все переменные, которые входят в модель B, но не входят в модель A. 

Вывод на основе этого теста следует делать так: 

•	 
Если первая гипотеза будет отвергнута, а вторая — нет, то следует сделать выбор в пользу модели A. 

•	 
Если же, наоборот, вторая гипотеза будет отвергнута, а первая — нет, то следует сделать выбор в пользу модели B. 


Конечно, возможна ситуация, в которой обе гипотезы будут отвергнуты. В этом случае следует сделать выбор в пользу наиболее общей объединенной модели. Если же не удастся отвергнуть ни одну из гипотез, то, по всей видимости, ни одна из моделей не является удовлетворительной. 
Описанная процедура называется тестом на сравнение невложенных моделей. 
Пример 3.3. Разные тесты 
для модели множественной регрессии 
На основе 20 наблюдений была оценена следующая модель регрессии (в скобках указаны стандартные ошибки оценок коэффициентов): 
y ^ = 24, + 69, x + 51, w .
i ii
(06, ) (03, ) (98, ) 
Кроме того, известно, что общая сумма квадратов равна 2000, а сумма квадратов остатков равна 200. а . Вычислите значение коэффициента R2, значение скорректиро2
ванного коэффициента Radj и стандартную ошибку регрессии. 
б . Проверьте значимость уравнения в целом: сформулируйте и проверьте гипотезу о том, что все коэффициенты при переменных уравнения одновременно равны нулю. 
в . Значим ли коэффициент при переменной х? Сформулируйте и проверьте соответствующую гипотезу. 
г . Проверьте гипотезу о том, что коэффициент при переменной х равен 7. 
д . Постройте 99%-й доверительный интервал для коэффициента при переменной х. 
е . После того как исследователь добавил в уравнение еще две переменные (назовем их р и s), R2 в этой модели увеличился до 0,95. Осуществив соответствующий тест, определите, стоило ли добавлять в модель эти переменные? 
Примечание: все гипотезы в этой задаче проверяйте при уровне значимости 1%. 
Решение: 
n 2
e 
2 =− ˛i=1 i 1 200
а . R 1 =− =09,;
n 
2 2000
y −y)
˛i=1( i 
k −1 31
−
22 2 
09 ˛−,) =0 89 
R =R − (1 −R ) =, − (109 ,.
adj 
nk 20 −
− 3 
200
Стандартная ошибка регрессии: 
= 343
,.
20 − 3 
б . Если обозначить коэффициенты в рассматриваемой модели стандартным образом: y =˛ +˛ x +˛ w +˝ , то тестируемая гипотеза
i 12 i 3 ii
может быть записана так: 
: ˜ =˜ = 0.
H02 3 
Расчетное значение: 
R2 nk 09,
− 17
F= ˛ =˛= 765,.
1− R2 k−1 01, 2 
) = 6 11.
Критическое значение при уровне значимости 1% F(,217 , 
76,5 > 6,11, поэтому тестируемая гипотеза отвергается. Следует сделать вывод о том, что уравнение в целом значимо. 
в . Проверяемая гипотеза: H: ˜=0.
02
Расчетное значение 6,9/0,3 = 23. Критическое значение при уровне значимости 1% составляет t(20 −=) 2 898, .
3 23 > 2 898,
, поэтому тестируемая гипотеза отвергается. Следует сделать вывод о том, что переменная значима. г . Проверяемая гипотеза: H: ˜=7.
02
Расчетное значение: 69, −7 =−033 
03, ,. 
Критическое значение при уровне значимости 1% составляет 
t(203) ,
−=2 898. 0332 898, < , , поэтому мы не можем отклонить гипотезу о том, что коэффициент ° 2 равен 7. д . С вероятностью 99% ˜2 ° 69 − 03, ˝2 898, 69 + , ˝ ,
(, ,, 03 2898); 
˜2 ° (603777, .
,, ) 
е . Если обозначить коэффициенты в новой модели стандартным образом: y=˛ +˛ x+˛ w+˛ p+˛ s+˝ , то тестируемая гипоте
i 12 i 3 i 4 i 5 ii
за может быть записана так: 
H: ˜ =˜ = 0.
04 5 
Расчетное значение: 
R2 − R2 nk 09509− ,5
− , 20 −
F= UR R ˛= ˛= 75,.
1 − R2 q 1095− ,2
UR 
Критическое значение при уровне значимости 1% F(,215 ,
) = 6 36. 
7,5 > 6,36, поэтому тестируемая гипотеза отвергается. «Длинная» регрессия значимо лучше, чем «короткая», т.е. переменные добавлять стоило. Хотя, конечно, в реальных исследованиях лучше не оценивать уравнение с четырьмя переменными всего по 20 точкам. 

3 .6 . Тест на линейное ограничение общего вида 
F-тест из предыдущего параграфа можно использовать для тестирования гипотез не только о том, что группа коэффициентов одновременно равна нулю. Его можно обобщить для случая тестирования произвольного набора линейных ограничений на параметры модели. 
Чтобы это сделать, удобно использовать матричную форму записи из § 3.3. 
Пусть тестируемая гипотеза имеет вид: H˜=r. Здесь ° по-прежнему обозначает вектор коэффициентов модели, H— матрица размером qна k, r— вектор-столбец длины q, q— количество тестируемых ограничений, т.е. количество уравнений в системе ограничений, k— число коэффициентов в модели. 
Например, если вы анализируете модель с тремя (k= 3) коэффици()2 ()3
ентами y=˝+˝ ˛ x +˝ ˛ x +˙ и хотите проверить одновремен
i 12 i 3 ii ное выполнение двух (q= 2) вот таких ограничений: 
H: ˜= 9˜ и ˜+˜ +˜ = 5,
02 3123 
то матрица Hи вектор rбудут иметь следующий вид: 
˛01 −9ˆ˛0ˆ 
H= , r= . 
˝˙11 1 ˇ˘ ˝˙5ˇ˘ 
Расчетное значение тестовой статистики для тестирования гипотезы H˜=rимеет вид: 
−1
^ −1^
( XH) r)
(Hˇ− r)˛(HX˛ ) ˛ (Hˇ− 
q
F = .
ðàñ÷ 
n 2
e
ˆi=1 i (nk− ) 
Если тестируемая гипотеза верна, то эта величина снова имеет распределение Фишера с qи (nkстепенями свободы.
− ) 

3 .7 . Обобщающий пример 
В заключение этой главы рассмотрим пример, позволяющий обобщить все, что мы в ней выяснили. 
Пример 3.4. Размер класса и эффективность обучения 
Одним из дискуссионных вопросов в организации школьного образования является вопрос о том, действительно ли более эффективно учить школьников в маленьких классах (например, в классах по 10−15 человек) по сравнению с большими классами (например, в классах по 20−25 человек)? И если в маленьких классах школьники учатся лучше, то насколько велико это улучшение качества? 
Вопрос важен в том числе и с экономической точки зрения. Действительно, если мы хотим улучшить качество школьного образования за счет уменьшения численности учеников в каждом классе, то нам придется нанять больше учителей, что потребует более значительных расходов на оплату их труда. Кроме того, мы столкнемся с издержками на организацию большего количества помещений, подходящих для обучения. Поэтому количественной оценке воздействия размера класса на эффективность обучения посвящен ряд исследований1. В представленном примере вам также предлагается проанализировать массив данных, посвященный этому вопросу. В файле Students вам доступны следующие данные о двух сотнях школьников: 
CLASS — размер класса, в котором обучается школьник. Воздействие именно этой переменной на качество обучения будет интересовать нас в этом примере; 
EXPN — средние расходы на одного школьника в школе, где он учится, измеренные в тысячах долларов в год; 
INCOME — средний доход на одного члена семьи в семье школьника, измеренный в тысячах долларов в год; 
TEST — результат итогового стандартизированного теста, который писали все школьники в конце учебного года. Эта переменная будет выступать в нашей регрессии в качестве зависимой переменной, так как она характеризует качество обучения (конечно, результаты тестов не являются совершенным измерителем качества обучения, однако в условиях отсутствия иных данных придется использовать их). 
а . Оцените параметры модели № 1: 
TEST =˛ +˛ CLASS +˝ .
i 12 ii 
Является переменная CLASS значимой? Интерпретируйте полученные результаты. 
1 См., напр., Kreuger (1999) Experimental Estimates of Education Production Functions // The Quarterly Journal of Economics. 
б . Оцените параметры модели № 2: 
TEST =˛ +˛ CLASS +˛ EXPN +˝ .
i 12 i 3 ii 
Является ли уравнение в целом статистически значимым? 
Как изменилась оценка коэффициента при переменной CLASS. Чем можно объяснить такое изменение? 
в . Оцените параметры модели № 3: 
TEST =˛ +˛ CLASS +˛ EXPN +˛ INCOME +˝ .
i 12 i 3 i 4 ii 
Используя тест на сравнение «короткой» и «длинной» регрессий сравните модели № 1 и № 3. Оправдано ли включение в модель новых переменных? Остается ли в новой модели переменная CLASS значимой? Как теперь можно интерпретировать коэффициент при этой переменной? 
Решение: 
а . Результаты оценивания параметров модели № 1 представлены ниже: 
Модель 1: МНК, использованы наблюдения 1-200 Зависимая переменная: TEST 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const  83,6554  6,27855  13,32  2,47e-029  ***  
CLASS  −1,30921  0,280996  −4,659  5,82e-06  ***  
Среднее зав. перемен  55,18000  Ст. откл. зав. перемен  21,36774  

Сумма кв. остатков 81882,25 Ст. ошибка модели 20,33585 R-квадрат 0,098804 Испр. R-квадрат 0,094252 F(1, 198) 21,70799 Р-значение (F) 5,82e-06 Лог. правдоподобие −885,2597 Крит. Акаике 1774,519 Крит. Шварца 1781,116 Крит. Хеннана-Куинна 1777,189 
Мы видим, что переменная CLASS статистически значима при уровне значимости 1%, так как соответствующее P-значение меньше одной сотой1. Коэффициент при этой переменной равен (–1,3), что можно интерпретировать так: увеличение размера класса на одного ученика в среднем приводит к снижению результата школьника, который в этом классе учится, на 1,3 балла. 
1 Запись «5,82e-06», используемая в таблице, означает 5,82 · 10–6, что заметно меньше, чем 0,01. 
б . Оценим теперь модель № 2: 
Модель 2: МНК, использованы наблюдения 1-200 Зависимая переменная: TEST 
Коэффициент Ст. ошибка t-статистика P-значение const 60,1560 7,97117 7,547 1,62e-012 *** CLASS −0,908844 0,282915 −3,212 0,0015 *** EXPN 2,53712 0,566948 4,475 1,29e-05 *** 
Среднее зав. перемен 55,18000 Ст. откл. зав. перемен 21,36774 Сумма кв. остатков 74326,57 Ст. ошибка модели 19,42401 R-квадрат 0,181962 Испр. R-квадрат 0,173657 F(2, 197) 21,91000 Р-значение (F) 2,56e-09 Лог. правдоподобие −875,5783 Крит. Акаике 1757,157 Крит. Шварца 1767,052 Крит. Хеннана-Куинна 1761,161 
Обратите внимание, что в этой таблице приведено расчетное значение F-статистики для проверки значимости уравнения в целом. И соответствующее P-значение: 
F(2, 197) 21,91000 Р-значение (F) 2,56e-09 
Так как это P-значение меньше одной сотой, можно заключить, что уравнение в целом является значимым. 
Заметим, что коэффициент при переменной CLASS по-прежнему значимый и отрицательный, однако по абсолютной величине он стал меньше. Теперь увеличение размера класса на единицу снижает результаты школьника за тест в среднем (при неизменных расходах на одного школьника) всего на 0,9 балла вместо прежних 1,3. 
Такой результат легко объяснить, если вспомнить самое начало нашей главы. По всей видимости, переменная EXPN, которую мы добавили в модель, является существенной: она тоже значимо влияет на успехи школьника. Кроме того, она коррелирована с переменной CLASS. Если вычислить соответствующий выборочный коэффициент корреляции, то он окажется равен (–0,31). В модели № 1 эта переменная была пропущена, поэтому в модели оценка коэффициента ° 2 была смещена из-за пропуска существенной переменной. 
Теперь мы добавили пропущенную переменную в модель и устранили указанное смещение, поэтому оценка интересующего нас коэффициента изменилась. Следовательно, новая оценка (–0,9) вызывает больше доверия, чем предыдущая оценка (–1,3). Однако, возможно, мы по-прежнему упускаем что-то важное. Поэтому добавим в модель еще один регрессор. 
в . Добавление в модель переменной INCOME позволяет получить следующие результаты: 
Модель 3: МНК, использованы наблюдения 1-200 Зависимая переменная: TEST 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const  29,1786  4,84720  6,020  8,46e-09  ***  
CLASS  −1,07250  0,163173  −6,573  4,36e-010  ***  
EXPN  2,05022  0,327487  6,260  2,37e-09  ***  
INCOME  1,04899  0,0525994  19,94  4,69e-049  ***  
Среднее зав. перемен  55,18000  Ст. откл. зав. перемен  21,36774  

Сумма кв. остатков 24536,68 Ст. ошибка модели 11,18871 R-квадрат 0,729949 Испр. R-квадрат 0,725816 F(3, 196) 176,5965 Р-значение (F) 1,84e-55 Лог. правдоподобие −764,7484 Крит. Акаике 1537,497 Крит. Шварца 1550,690 Крит. Хеннана-Куинна 1542,836 
Третья модель также позволяет заключить, что размер класса значимо влияет на эффективность обучения. Теперь коэффициент при этой переменной можно интерпретировать так: увеличение размера класса на одного ученика в среднем приводит при прочих равных условиях к снижению результата школьника, который в этом классе учится, на 1,1 балла. Формулировка «при прочих равных» важна. В данном случае она означает, что мы сравниваем успехи школьников при прочих равных значениях двух других регрессоров: расходах на одного ученика и уровне благосостояния семьи школьника. Преимущество множественной регрессии как раз и состоит в том, что можно давать количественные оценки изменений при фиксированных значениях прочих важных факторов. 
В таблице 3.1 содержатся сводные результаты оценки трех моделей. Обратите внимание, что при представлении результатов моделирования хорошим тоном является использование именно таких сводных таблиц, содержащих только необходимую информацию, а не необработанных таблиц, выданных эконометрическим пакетом, которые мы в учебных целях приводили выше. 
Сопоставим первую и третью модели, используя тест на сравнение «короткой» и «длинной» регрессий. 
Нулевая гипотеза: ˜ =˜ = 0.
34 
Расчетное значение тестовой статистики составит: 
22
R − R
UR R nk 0 730, − , 200
− 0 099 − 4
F = ˛= ˛= 2290,.
1 − R2 q 10 730− ,2
UR 
Таблица 3.1
 Влияние размера класса на качество обучения 
Модель 1  Модель 2  Модель 3  
Константа  83,655***  60,156***  29,179***  
(6,279) (7,971) (4,847)  
CLASS  –1,309***  –0,909***  –1,073***  
(0,281) (0,283) (0,163)  
EXPN  —  2,537***  2,050***  
(0,567) (0,327)  
INCOME  —  —  1,049***  
(0,053)  
Число наблюдений  200  200  200  
R2  0,099  0,182  0,730  
Исправленный R2  0,094  0,174  0,726  

Примечания: зависимая переменная — балл за итоговый тест. В скобках под оценками коэффициентов указаны стандартные ошибки. *** обозначают значимость на однопроцентном уровне. 
Критическое значение из таблицы распределения Фишера для уровня значимости 1%, 2 и 196 степеней свободы примерно равно 4,6. Так как расчетное значение больше критического, мы отвергаем нулевую гипотезу и делаем вывод в пользу «длинной» регрессии. Таким образом, включение дополнительных переменных оправдано. 
Аналогичный результат может быть получен в результате автоматического проведения теста в эконометрическом пакете: 
Нулевая гипотеза: параметры регрессии нулевые 
EXPN, INCOME Тестовая статистика: F(2, 196) = 229,039, P-значение 5,12105e-052 
Легко видеть, что соответствующее P-значение меньше одной сотой, следовательно, тестируемая гипотеза действительно должна быть отвергнута. 
С точки зрения исправленного R-квадрата третья модель также лучше всех, так как там этот коэффициент принимает самое большое значение (напомним, что сравнивать модели с разным числом регрессоров корректно при помощи именно исправленного, а не обычного коэффициента R-квадрат). 
Задания для самостоятельного решения 
Задание 1 . Руководство фирмы АВС решило исследовать эффективность курсов по повышению квалификации, которые иногда проводятся для ее сотрудников. В исследовании принимали участие 1000 работников фирмы. Среди них случайным образом были отобраны несколько сотен сотрудников, которые приняли участие в курсах повышения квалификации различной продолжительности. После этого на основе полученных данных при помощи МНК было оценено следующее уравнение регрессии (в скобках указаны стандартные ошибки оценок коэффициентов): 
y ^ = 22, + 05, x + 07, z , R2 = 02,,
i ii
(04, ) 01, (05)
() , 
где xi — количество недель, которое i-й сотрудник провел на курсах повышения квалификации; zi — стаж работы i-го сотрудника в фирме АВС (в годах); yi — производительность труда i-го сотрудника. 
а . Проверьте значимость переменной z (при уровне значимости 1%). Не забудьте сформулировать тестируемую гипотезу. 
б . Проверьте значимость уравнения в целом (при уровне значимости 1%). Не забудьте сформулировать тестируемую гипотезу. 
в . После добавления в модель еще двух переменных (характеризующих возраст и образование работника) коэффициент R2 в оцененной модели увеличился до 0,3. Используя соответствующий тест при уровне значимости 1%, определите, стоило ли добавлять эти переменные. Не забудьте сформулировать тестируемую гипотезу. 
Задание 2 . Исследуется зависимость среднедушевого потребления алкоголя по странам мира от различных факторов. 
Модель № 1: 
ALCO =˝+˝ ˛GDP +˝ ˛ MUSL +˝ ˛ BUDD +˝ ˛ HINDU +˙ ,
i 12 i 3 i 4 i 5 ii 
где ALCOi — среднедушевое потребление чистого спирта на человека (л); GDPi — ВВП на душу населения (долларов США); MUSLi , BUDDi , HINDUi — доли населения, исповедующего соответственно мусульманство, буддизм и индуизм (в % от общей численности населения). В ходе МНК-оценивания модели на основе данных о 180 странах получены следующие результаты: сумма квадратов остатков составила 200, объясненная сумма квадратов оказалась равна 300. 
Также для проверки гипотезы о том, что религия не оказывает существенного влияния на потребление алкоголя, были оценены параметры второй модели. 
Модель № 2: 
ALCO =˝+˝ ˛GDP +˙ .
i 12 ii 
Во второй модели по сравнению с первой значение объясненной суммы квадратов изменилось на 100. 
а . Вычислите R2 в модели № 1. 
б . Во второй модели по сравнению с первой значение объясненной 
суммы квадратов увеличилось или уменьшилось? Почему? Вычислите R2 в модели № 2. в . Влияет ли религия на потребление алкоголя? Сделайте вывод на основе соответствующего статистического теста. Задание 3 . Пусть истинная (но не известная исследователю) зависимость между переменными у, x()1 и x()2 описывается уравнением: 
()1 ()2
y =˝+˝ ˛ x +˝ ˛ x +˙ ,
i 12 i 3 ii 
где ˜3 < 0 и cov(x()1, x()2 x )()2 > 0. Исследователь ошибочно не включил в уравнение переменную  и оценил параметры модели парной регрессии: 
^^
^ 
y =+ ˛xi
˝˝ 
i 1 2. 
а . Будет ли оценка коэффициента при переменной x()1 смещенной? Если нет, то почему? Если да, то будет ли она завышена или занижена? б . Как изменится ваш ответ, если cov(x()1, x()2) < 0? ( ()1 ()2
в . Как изменится ваш ответ, если cov x , x ) = 0? Всегда ли пропуск существенной переменной приводит к смещению оценок коэффициентов при оставшихся в модели регрессорах? 
Задание 4 . На рынке ноутбуков в стране M цена ноутбука (обозначим эту переменную price) линейно зависит от времени его автономной работы (time), диагонали экрана (diag) и веса (weight). Покупатели любят компьютеры с большим экраном, умеющие долго работать без подзарядки и как можно более легкие. Увы, в действительности компьютеры с большой диагональю в среднем весят тяжелее маленьких ноутбуков, да и время автономной работы у них меньше. Исследователь хочет оценить, на сколько рублей увеличивается цена ноутбука в результате увеличения диагонали его экрана на один дюйм. Не включая в уравнение прочие упомянутые факторы, он оценивает параметры модели парной регрессии: 
^^
price ˝˝diag 
 =+ ˛ .
i 12 i 
Будет ли оценка коэффициента при переменной diag завышенной, заниженной или несмещенной? Формально обоснуйте свой ответ. 
Задание 5 . Отдача от образования 
Исходный файл с данными: EARNINGS.xls. В задаче используются данные National Longitudinal of Youth. Эта база данных представляет собой результаты обследования общенациональной американской репрезентативной выборки мужчин и женщин. Цель нашего исследования состоит в том, чтобы определить, влияет ли образование на уровень заработной платы типичного работника в США. В вашем распоряжении имеются следующие данные о 540 работниках: 
EARNINGS — текущий часовой заработок в долларах США; 
S — продолжительность обучения (число полных лет обучения); 
EXP — общий стаж работы после окончания учебы; 
FEMALE — пол респондента (0 — для мужчин, 1 — для женщин). 
а . Импортируйте данные в эконометрический пакет. Вычислите и проанализируйте описательные статистики для переменных EARNINGS, S, EXP, FEMALE. 
б . Вычислите матрицу парных коэффициентов корреляции между переменными. Интерпретируйте полученные результаты: соответствуют ли знаки коэффициентов вашим ожиданиям? 
в . Постройте диаграмму рассеяния, характеризующую зависимость EARNINGS от S. Постройте диаграмму рассеяния, характеризующую зависимость EARNINGS от EXP. Интерпретируйте результаты. 
г . Оцените параметры модели парной регрессии 
EARNINGS =˛ +˛ S +˝ .
i 12 ii 
Запишите полученное уравнение регрессии, указав коэффициент R2 и стандартные ошибки оценок коэффициентов. 
Значимо ли уровень образования влияет на заработок? 
Охарактеризуйте общее качество уравнения регрессии. 
д . Оцените параметры модели множественной регрессии: 
EARNINGS =˛ +˛ S +˛ EXP +˝ .
i 12 i 3 ii 
Запишите полученное уравнение регрессии, указав коэффициент R2 и стандартные ошибки оценок коэффициентов. 
Значимо ли уравнение в целом? 
Используя 1%-й уровень значимости, укажите, какие из факторов значимо влияют на заработок. Соответствуют ли знаки коэффициентов вашим ожиданиям? 
Дайте содержательную интерпретацию коэффициента при переменной EXP. 
Дайте содержательную интерпретацию коэффициента при переменной S. 
е . Оцените регрессию заново, добавив в модель переменную FEMALE1. Оправдано ли включение этой переменной в модель с содержательной точки зрения? Оправдано ли включение этой переменной с точки зрения теста на значимость? Как можно интерпретировать полученный результат? 
ж . Представьте три оцененных модели в виде единой сводной таблицы. 
з . Используя тест для сравнения «короткой» и «длинной» регрессий, сопоставьте модель из пункта (е) и модель парной регрессии из пункта (г). Интерпретируйте полученный результат. 
и . Оцените модель из пункта (д) отдельно для мужчин и для женщин. Сравните результаты. 
Дополнительные замечания: модели, полученные в рамках этого задания, трудно признать полностью удовлетворительными, поэтому мы еще вернемся к истории об отдаче от образования, когда будем анализировать более продвинутые методы анализа пространственных выборок. Возможно, дело в том, что мы учли не все важные контрольные переменные или неправильно выбрали форму зависимости. 
Кроме того, следует осторожно относиться к интерпретации полученных оценок влияния образования на заработную плату. Дело в том, что образование обычно коррелировано с ненаблюдаемыми характеристиками (например, с уровнем интеллекта), которые тоже влияют на заработную плату индивида. Таким образом, может оказаться, что более образованные люди получают более высокую зарплату не потому, что они более образованные, а потому, что они более способные. С другой стороны, возможно, что от образования все-таки есть прок2. Чтобы отделить эффект влияния ненаблюдаемых характеристик от эффекта самого образования, используют, например, метод инструментальных переменных, который будет обсуждаться в дальнейшем. 
Задание 6 . Рассматривается классическая линейная модель множественной регрессии y =˛ +˛ x +˛ w +˝ . Имеются следующие
i 12 i 3 ii
данные о тысяче наблюдений соответствующих переменных: 
1 Обратите внимание, что это специфическая бинарная переменная. Подробно о таких переменных мы поговорим в следующей главе. 
2 Преподавателям эконометрики хотелось бы в это верить 

1000 1000 1000 1000 w= ; xw=1000; x2 =
x= 0 ˛ 3000;
° i ° i ° ii ° i i=1 i=1 i=1 i=1 
1000 1000 1000 1000 w2 = 2000; y= xy˛=1000; wy˛= 2000. 
° i ° i ° ii ° ii i=1 i=1 i=1 i=1 
а . Вычислите МНК-оценки коэффициентов модели. 
б . Пусть также известно, что сумма квадратов остатков в оцененной регрессии оказалась равна 39 880. При уровне значимости 1% проверьте значимость переменной w. 
в . При уровне значимости 1% проверьте гипотезу ˜+˜ = 2.
12 
Задание 7 . Рассматривается модель без константы 
()1 ()2
y=˛ x +˛ x +˝ ,
i 1 i 2 ii 
для которой выполнены все предпосылки классической линейной модели множественной регрессии (включая нормальность случайных ошибок). Имеются следующие данные о 500 наблюдениях соответствующих переменных: 
500 500 500
22
()1 ()2 ()1 ()2
°xx =°(x)= 05,; °(x )=1,,;
00
iii i i=1 i=1 i=1 
500 500 ()1 ()2
xy=100; xy= 400. 
° ii ° ii i=1 i=1 
а . Вычислите МНК-оценки коэффициентов модели. б . Пусть также известно, что сумма квадратов остатков в оцененной регрессии оказалась равна 996. При уровне значимости 5% проверьте 
()1
значимость переменной x. в . Постройте 95%-й доверительный интервал для суммы коэффициентов ˜ +˜ .
12 
Задание 8 . Оценивание модели 
()1 ()2 ()3
y=˝+˝ ˛ x +˝ ˛ x +˝ ˛ x +˙
i 12 i 3 i 4 ii 
методом наименьших квадратов по 26 наблюдениям дало следующие результаты: 
()1 ()2 ()3
y ^ =+, ˛x −, ˛x +2,0 ˛x, R2 =0 882.
535 07 ,
i iii 
Оценивание той же модели при ограничении ˜ =˜ дало следую
24 
щие результаты: 
^ ()1 ()3 ()2 2
y= , + , ˛ x+ x − 09, ˛ x, R= 0 876.
4530 ,


i ()
ii i 
Проверьте гипотезу о том, что ˜2 =˜4. 
Подсказка: используйте тест на сравнение «короткой» и «длинной» регрессий и тот факт, что вторая модель представляет собой первую модель, на которую наложено одно линейное ограничение. 
Задание 9 . Рассматривается классическая линейная модель с детерминированным регрессором: y=˝+˝ ˛ x+˙ . Докажите, что рас
i 12 ii
четное значение статистики для теста на значимость уравнения в целом 
(F) и расчетное значение статистики для теста на значимость коэффициента при переменной (t) соотносятся следующим образом: 
2
Ft.
= 
Задание 10 . Исследователь сравнивает две модели множественной регрессии, оцененные на одинаковых данных и с одинаковой зависимой переменной (при этом наборы регрессоров для двух моделей различаются). Верно ли, что не важно, на основе какого из показателей делать выбор: скорректированного коэффициента R-квадрат или стандартной ошибки регрессии? То есть верно ли, что результат выбора на основе любого из этих показателей всегда будет одинаковым? Обоснуйте свой ответ. 
ПРИЛОЖЕНИЕ 3А 
Таблицы распределения Стьюдента и Фишера 
t-распределение: критические значения, двусторонний тест 
Число степеней свободы  Уровень значимости  
5%  1%  
1  12,706  63,657  
2  4,303  9,925  
3  3,182  5,841  
4  2,776  4,604  
5  2,571  4,032  
6  2,447  3,707  
7  2,365  3,499  
8  2,306  3,355  
9  2,262  3,250  
10  2,228  3,169  
11  2,201  3,106  
12  2,179  3,055  
13  2,160  3,012  
14  2,145  2,977  
15  2,131  2,947  
16  2,120  2,921  
17  2,110  2,898  
18  2,101  2,878  
19  2,093  2,861  
20  2,086  2,845  

Число степеней свободы  Уровень значимости  
5%  1%  
21  2,080  2,831  
22  2,074  2,819  
23  2,069  2,807  
24  2,064  2,797  
25  2,060  2,787  
26  2,056  2,779  
27  2,052  2,771  
28  2,048  2,763  
29  2,045  2,756  
30  2,042  2,750  
31  2,040  2,744  
32  2,037  2,738  
33  2,035  2,733  
34  2,032  2,728  
35  2,030  2,724  
36  2,028  2,719  
37  2,026  2,715  
38  2,024  2,712  
39  2,023  2,708  
40  2,021  2,704  
41  2,020  2,701  
42  2,018  2,698  
43  2,017  2,695  
44  2,015  2,692  
45  2,014  2,690  
46  2,013  2,687  
47  2,012  2,685  
Число степеней свободы  Уровень значимости  
5%  1%  
48  2,011  2,682  
49  2,010  2,680  
50  2,009  2,678  
60  2,000  2,660  
70  1,994  2,648  
80  1,990  2,639  
90  1,987  2,632  
100  1,984  2,626  
120  1,980  2,617  
∞  1,960  2,576  

F-распределение: критические значения F с v1 и v2 степенями свободы при уровне значимости 5% 
v1 v2  1  2  3  4  5  6  7  8  9  10  
1  161,4  199,5  215,7  224,6  230,2  234,0  236,8  238,9  240,5  241,9  
2  18,51  19,00  19,16  19,25  19,30  19,33  19,35  19,37  19,38  19,40  
3  10,13  9,55  9,28  9,12  9,01  8,94  8,89  8,85  8,81  8,79  
4  7,71  6,94  6,59  6,39  6,26  6,16  6,09  6,04  6,00  5,96  
5  6,61  5,79  5,41  5,19  5,05  4,95  4,88  4,82  4,77  4,74  
6  5,99  5,14  4,76  4,53  4,39  4,28  4,21  4,15  4,10  4,06  
7  5,59  4,74  4,35  4,12  3,97  3,87  3,79  3,73  3,68  3,64  
8  5,32  4,46  4,07  3,84  3,69  3,58  3,50  3,44  3,39  3,35  
9  5,12  4,26  3,86  3,63  3,48  3,37  3,29  3,23  3,18  3,14  
10  4,96  4,10  3,71  3,48  3,33  3,22  3,14  3,07  3,02  2,98  
11  4,84  3,98  3,59  3,36  3,20  3,09  3,01  2,95  2,90  2,85  
v1 v2  1  2  3  4  5  6  7  8  9  10  
12  4,75  3,89  3,49  3,26  3,11  3,00  2,91  2,85  2,80  2,75  
13  4,67  3,81  3,41  3,18  3,03  2,92  2,83  2,77  2,71  2,67  
14  4,60  3,74  3,34  3,11  2,96  2,85  2,76  2,70  2,65  2,60  
15  4,54  3,68  3,29  3,06  2,90  2,79  2,71  2,64  2,59  2,54  
16  4,49  3,63  3,24  3,01  2,85  2,74  2,66  2,59  2,54  2,49  
17  4,45  3,59  3,20  2,96  2,81  2,70  2,61  2,55  2,49  2,45  
18  4,41  3,55  3,16  2,93  2,77  2,66  2,58  2,51  2,46  2,41  
19  4,38  3,52  3,13  2,90  2,74  2,63  2,54  2,48  2,42  2,38  
20  4,35  3,49  3,10  2,87  2,71  2,60  2,51  2,45  2,39  2,35  
21  4,32  3,47  3,07  2,84  2,68  2,57  2,49  2,42  2,37  2,32  
22  4,30  3,44  3,05  2,82  2,66  2,55  2,46  2,40  2,34  2,30  
23  4,28  3,42  3,03  2,80  2,64  2,53  2,44  2,37  2,32  2,27  
24  4,26  3,40  3,01  2,78  2,62  2,51  2,42  2,36  2,30  2,25  
25  4,24  3,39  2,99  2,76  2,60  2,49  2,40  2,34  2,28  2,24  
26  4,23  3,37  2,98  2,74  2,59  2,47  2,39  2,32  2,27  2,22  
27  4,21  3,35  2,96  2,73  2,57  2,46  2,37  2,31  2,25  2,20  
28  4,20  3,34  2,95  2,71  2,56  2,45  2,36  2,29  2,24  2,19  
29  4,18  3,33  2,93  2,70  2,55  2,43  2,35  2,28  2,22  2,18  
30  4,17  3,32  2,92  2,69  2,53  2,42  2,33  2,27  2,21  2,16  
40  4,08  3,23  2,84  2,61  2,45  2,34  2,25  2,18  2,12  2,08  
60  4,00  3,15  2,76  2,53  2,37  2,25  2,17  2,10  2,04  1,99  
120  3,92  3,07  2,68  2,45  2,29  2,18  2,09  2,02  1,96  1,91  
∞  3,84  3,00  2,60  2,37  2,21  2,10  2,01  1,94  1,88  1,83  

F-распределение: критические значения F с v1 и v2 степенями свободы при уровне значимости 1% 
v1 v2  1  2  3  4  5  6  7  8  9  10  
1  4052  5000  5403  5625  5764  5859  5928  5981  6022  6056  
2  98,50  99,00  99,17  99,25  99,30  99,33  99,36  99,37  99,39  99,40  
3  34,12  30,82  29,46  28,71  28,24  27,91  27,67  27,49  27,35  27,23  
4  21,20  18,00  16,69  15,98  15,52  15,21  14,98  14,80  14,66  14,55  
5  16,26  13,27  12,06  11,39  10,97  10,67  10,46  10,29  10,16  10,05  
6  13,75  10,92  9,78  9,15  8,75  8,47  8,26  8,10  7,98  7,87  
7  12,25  9,55  8,45  7,85  7,46  7,19  6,99  6,84  6,72  6,62  
8  11,26  8,65  7,59  7,01  6,63  6,37  6,18  6,03  5,91  5,81  
9  10,56  8,02  6,99  6,42  6,06  5,80  5,61  5,47  5,35  5,26  
10  10,04  7,56  6,55  5,99  5,64  5,39  5,20  5,06  4,94  4,85  
11  9,65  7,21  6,22  5,67  5,32  5,07  4,89  4,74  4,63  4,54  
12  9,33  6,93  5,95  5,41  5,06  4,82  4,64  4,50  4,39  4,30  
13  9,07  6,70  5,74  5,21  4,86  4,62  4,44  4,30  4,19  4,10  
14  8,86  6,51  5,56  5,04  4,69  4,46  4,28  4,14  4,03  3,94  
15  8,68  6,36  5,42  4,89  4,56  4,32  4,14  4,00  3,89  3,80  
16  8,53  6,23  5,29  4,77  4,44  4,20  4,03  3,89  3,78  3,69  
17  8,40  6,11  5,18  4,67  4,34  4,10  3,93  3,79  3,68  3,59  
18  8,29  6,01  5,09  4,58  4,25  4,01  3,84  3,71  3,60  3,51  
19  8,18  5,93  5,01  4,50  4,17  3,94  3,77  3,63  3,52  3,43  
20  8,10  5,85  4,94  4,43  4,10  3,87  3,70  3,56  3,46  3,37  
21  8,02  5,78  4,87  4,37  4,04  3,81  3,64  3,51  3,40  3,31  
22  7,95  5,72  4,82  4,31  3,99  3,76  3,59  3,45  3,35  3,26  
23  7,88  5,66  4,76  4,26  3,94  3,71  3,54  3,41  3,30  3,21  
24  7,82  5,61  4,72  4,22  3,90  3,67  3,50  3,36  3,26  3,17  
25  7,77  5,57  4,68  4,18  3,85  3,63  3,46  3,32  3,22  3,13  
v1 v2  1  2  3  4  5  6  7  8  9  10  
26  7,72  5,53  4,64  4,14  3,82  3,59  3,42  3,29  3,18  3,09  
27  7,68  5,49  4,60  4,11  3,78  3,56  3,39  3,26  3,15  3,06  
28  7,64  5,45  4,57  4,07  3,75  3,53  3,36  3,23  3,12  3,03  
29  7,60  5,42  4,54  4,04  3,73  3,50  3,33  3,20  3,09  3,00  
30  7,56  5,39  4,51  4,02  3,70  3,47  3,30  3,17  3,07  2,98  
40  7,31  5,18  4,31  3,83  3,51  3,29  3,12  2,99  2,89  2,80  
60  7,08  4,98  4,13  3,65  3,34  3,12  2,95  2,82  2,72  2,63  
120  6,85  4,79  3,95  3,48  3,17  2,96  2,79  2,66  2,56  2,47  
∞  6,63  4,61  3,78  3,32  3,02  2,80  2,64  2,51  2,41  2,32  


ГЛАВА 4 
МНОЖЕСТВЕННАЯ РЕГРЕССИЯ: МУЛЬТИКОЛЛИНЕАРНОСТЬ, ФИКТИВНЫЕ ПЕРЕМЕННЫЕ, НЕЛИНЕЙНЫЕ МОДЕЛИ 
В этой главе обсуждаются важные с прикладной точки зрения аспекты, касающиеся множественной регрессии. Речь будет идти о мультиколлинеарности, фиктивных переменных и нелинейных моделях. Кроме того, в заключительной части главы мы обсудим правила хорошего тона, которым стоит следовать при оформлении результатов ваших собственных эконометрических работ. 
4 .1 . Мультиколлинеарность 
Выделяют два вида мультиколлинеарности: 
•	 
строгая мультиколлинеарность (ее также называют полной или точной); 

•	 
нестрогая мультиколлинеарность (ее также называют частичной). 


Под строгой мультиколлинеарностью понимается ситуация, когда между регрессорами в модели есть точная линейная связь, т.е. когда одна объясняющая переменная точным образом линейно выражается через другие. 
Представим, например, что при анализе макроэкономической модели в качестве переменных в нее включили экспорт, импорт и чистый экспорт. Чистый экспорт равен разности между экспортом и импортом и, следовательно, при включении в модель этих трех переменных окажется, что регрессоры модели линейно выражаются друг через друга. 
В терминах матричной записи точная мультиколлинеарность предполагает линейную зависимость столбцов матрицы регрессоров, откуда следует неполный ранг матрицы регрессоров. Это означает, что при полной мультиколлинеарности невозможно вычислить МНК-оценки коэффициентов, потому что матрица XX&#17; является вырожденной и матрица (XX˜ )−1 не определена. 
Из определения и из приведенного выше примера легко догадаться, как можно решить проблему строгой мультиколлинеарности. Для этого следует исключить лишнюю переменную. Например, если в модели уже учтены экспорт и импорт, то понятно, что включение еще и чистого экспорта не принесет никакой дополнительной информации, и этой третьей переменной можно безболезненно пожертвовать. 
Современные эконометрические пакеты при возникновении чистой мультиколлинеарности сами избавляются от одной из линейно зависимых переменных, чтобы вычисление МНК-оценок стало технически возможным. 
Частичная мультиколлинеарность — это ситуация, когда между объясняющими переменными нет точной линейной связи, но эти переменные сильно коррелируют между собой. Иными словами, они не линейно зависимы, а «почти» линейно зависимы. При частичной мультиколлинеарности вычислить МНК-оценки можно, однако стандартные ошибки оценок коэффициентов оказываются высокими, а точность оценок коэффициентов — низкой. Так происходит потому, что при сильной корреляции двух регрессоров в выборке они, как правило, меняются одновременно, и оказывается трудно отличить влияние одного регрессора на зависимую переменную от влияния другого. Таким образом, основным негативным последствием мультиколлинеарности является снижение точности оценки отдельных коэффициентов. 
Частичная мультиколлинеарность не нарушает ни одну из предпосылок классической линейной модели множественной регрессии и поэтому не приводит к смещению оценок коэффициентов модели. 
Это особенно хорошая новость потому, что на практике почти в любой множественной регрессии объясняющие переменные в той или иной степени коррелированы. Поэтому частичная мультиколлинеарность в данных наблюдается очень часто. Представьте, например, что вы моделируете выпуск фирмы некоторой отрасли в зависимости от количества используемых фирмой труда и физического капитала (т.е., как сказали бы экономисты, моделируете производственную функцию). Скорее всего в вашей выборке будут большие фирмы и маленькие, причем большие фирмы в среднем будут использовать относительно много каждого из факторов производства, а маленькие, напротив, относительно мало. В результате переменные, характеризующие количество труда и количество капитала, будут положительно коррелированы друг с другом. 
Есть несколько способов выявить мультиколлинеарность на этапе предварительного анализа данных (т.е. еще до оценки параметров уравнения регрессии). О наличии существенной частичной мультиколлинеарности в модели говорят: 
1) большие по абсолютной величине (больше 0,9) парные коэффициенты корреляции между регрессорами; 
2) близость к нулю определителя матрицы XX&#17; ; 
3) большие (больше 10) значения коэффициентов VIF. 
Коэффициенты VIF (variance inflation factor) показывают, насколько сильно связаны друг с другом регрессоры модели. Чтобы определить 
()j
коэффициент VIF, соответствующий регрессору x , нужно оценить ()j
вспомогательную регрессию, в которой слева стоит x , а справа — все остальные объясняющие переменные исходной модели. После этого нужно вычислить коэффициент VIF по формуле 
1
VIF = ,1− R2 где R2 — это коэффициент детерминации из оцененной вспомогательной регрессии. Если коэффициенты VIF для всех регрессоров оказались меньше 10, это значит, что существенной мультиколлинеарности в модели не наблюдается. В противном случае стоит сделать вывод о том, что в модели есть мультиколлинеарность. 
Пример 4.1. Мультиколлинеарность 
Эконометрист исследует модель: 
y =˛ +˛ x +˛ w +˛ z +˝ .
i 12 i 3 i 4 ii 
На этапе предварительного анализа данных он оценил следующие вспомогательные уравнения: 
^ i 10119 i 23 i 2 = ,;x = , + , w + , z , R 0 95 
^ i 18708 i 48 i 2 = ,;
w = , + , x + , z , R 0 99 
z ^ i =−50, + , wi + , xi , R2 020 
01 03 = ,. 
Что можно сказать о наличии мультиколлинеарности в исходной модели? 
Решение: 
Коэффициенты VIF для переменных xw равны соответственно:
,, z 11 1 
= 20, =100 и =125
,. Так как некоторые из коэф
1095− , 1099, − ,− 102 
фициентов больше 10, можно заключить, что в модели присутствует существенная мультиколлинеарность. 
*** 
Некоторые признаки мультиколлинеарности можно увидеть уже после оценки параметров модели. Перечислим их. 
• 
Неустойчивость результатов . Небольшое изменение исходных данных приводит к существенному изменению оценок коэффициентов, например если после оценки уравнения по 200 наблюдениям вы исключили из выборки несколько точек, оценили модель заново и обнаружили сильное изменение результатов. 

• 
Незначимость большинства переменных . Каждая переменная в отдельности является незначимой, а уравнение в целом является значимым и характеризуется близким к единице коэффициентом R2. 

• 
Неправдоподобность результатов . Оценки коэффициентов имеют неправильные с точки зрения экономической теории знаки или неоправданно большие значения. Стоит отметить, что причиной возникновения такой ситуации может быть не только потеря точности оценивания из-за мультиколлинеарности, но и гораздо более серьезные проблемы, например смещение из-за пропуска существенной переменной (не говоря уж о том, что не все экономические теории прошлого проходят испытание современными данными). 


Что можно предпринять, если вы столкнулись с негативными последствиями мультиколлинеарности в вашей модели? Существует несколько путей решения этой проблемы. 
Если есть возможность увеличить количество наблюдений, то это отличный вариант, так как больший размер выборки увеличит точность результатов, компенсировав ее потерю из-за мультиколлинеарности. 
Мультиколлинеарность будет устранена, если вы исключите из уравнения тот регрессор, который сильно коррелирован с остальными объясняющими переменными модели. Однако следует помнить, что применение этого способа не всегда целесообразно, так как может привести к гораздо более серьезным последствиям: смещению оценок в результате пропуска существенной переменной. Скажем, в нашем примере про производственную функцию ни труд, ни капитал из уравнения исключать не хотелось бы, так как ясно, что выпуск фирмы зависит от каждого из этих факторов производства. 
Решением проблемы может быть использование вместо отдельных переменных их линейных комбинаций. Возвращаясь к нашему примеру с экспортом и импортом, заметим, что эти переменные, включенные в модель по отдельности, могут быть причиной мультиколлинеарности, так как обычно коррелированы друг с другом. Однако, заменив их чистым экспортом (который как раз и представляет собой их линейную комбинацию), вы сможете избежать этой проблемы. Приведем другой пример. Представим, что вы оцениваете зависимость успеваемости студента физического факультета от баллов за ЕГЭ по математике и по физике, которые этот студент получил, будучи школьником. Так как два этих регрессора наверняка коррелированы, то вместо включения в модель каждого из них по отдельности вы могли бы оставить в уравнении одну переменную — средний балл ЕГЭ по двум этим предметам. 
Использование альтернативных (нелинейных) форм зависимостей в некоторых случаях также может снизить остроту проблемы мультиколлинеарности. Оценивание такого рода моделей мы обсудим в конце данной главы. 
В заключение еще раз подчеркнем, что мультиколлинеарность сама по себе не вызывает смещения оценок коэффициентов. Поэтому бороться с ней нужно только в том случае, если она приводит к существенным проблемам (например, к огромным стандартным ошибкам оценок коэффициентов или заведомой неадекватности полученных результатов). Во всех остальных случаях данную проблему можно игнорировать1. 

4 .2 . Фиктивные переменные 
Иногда в процессе эконометрического моделирования у исследователя возникает потребность учитывать в качестве объясняющих факторов не только количественные, но и качественные характеристики. Например, на цену квартиры могут влиять не только ее жилая площадь и расстояние до ближайшей станции метро (количественные переменные), но и материал, из которого изготовлен дом, или наличие в этой квартире балкона (качественные переменные). На величину заработной платы работника могут влиять не только его стаж работы (количественный признак), но и факт наличия у него высшего образования или пол (качественные признаки). Во всех этих случаях удобно использовать так называемые фиктивные переменные. 
Фиктивные переменные — это такие переменные, которые принимают одно из двух значений — 0 или 1. Их также называют бинарными, или дамми-переменными (dummy variable). 
1 Некоторые специфические инструменты, которые иногда тоже могут быть полезны в борьбе с мультиколлинеарностью, обсуждаются в рамках курсов машинного обучения и многомерного статистического анализа. См.: метод главных компонент, LASSO и ridge-регрессии, метод эластичной сети. 
Представим, например, что заработная плата описывается следующим уравнением, для которого выполнены все предпосылки классической линейной модели множественной регрессии: 
Y =˝+˝ ˛ X +˝ ˛ D +˙ ,
i 12 i 3 ii 
где Yi — зарплата i-го работника в долларах в час; Xi — стаж работы i-го работника в годах; Di — фиктивная переменная, которая равна единице, если i-й работник — женщина, и равна нулю, если мужчина. Исследователь включает в модель эту переменную потому, что подозревает наличие на рассматриваемом рынке труда дискриминации по гендерному признаку. 
В результате МНК-оценивания параметров модели на основе данных о 1000 работниках исследователь получил следующее уравнение: 
^
Y = 42, + 21, X − 35, D .
i ii
(03, ) ()01, (02, ) 
Результаты построения модели с фиктивной переменной удобно интерпретировать, если записать ее для двух случаев: когда фиктивная переменная равна 0 и когда она равна 1. В нашем примере это приведет к двум вот таким уравнениям: 
мужчины (Di = 0): Y = 42, + 21, ˛ X ,
iiженщины ( =1): Y = 42, + 21, ˛ X − 35, = 07, + 21, ˛ X .
Diii i
Отсюда видно, что при прочих равных условиях (при равном стаже работы) женщины получают на 3,5 долл. меньше, чем мужчины. Подчеркнем, что оценка такой модели гораздо лучше, чем просто сравнение средней по выборке заработной платы мужчин со средней по выборке заработной платой женщин, так как гипотетически различие между этими средними могло бы объясняться не гендерной дискриминацией, а разным стажем работы у мужчин и женщин. Мы же в нашем примере контролируем это различие, включая стаж работы в модель. В реальном исследовании, разумеется, было бы целесообразно включить в модель и прочие факторы, которые могут влиять на заработную плату (скажем, образование), однако нам для целей объяснения идеи фиктивных переменных пока хватит этого упрощенного примера. 
Графически полученные уравнения представлены на рис. 4.1. Мы видим, что наша фиктивная переменная отражает сдвиг линии, характеризующей зависимость заработной платы от стажа работы. Поэтому фиктивные переменные такого сорта иногда называют фиктивными переменными сдвига. 
Yi 


Мужчины (Di = 0) Женщины (Di = 1) 
4,2 4,2 – 3,5 = 0,7 


Xi 
Рис. 4.1. Зависимость между стажем работы и заработной платой для мужчин и для женщин в случае использования фиктивной переменной сдвига 
У модели, которую оценил наш исследователь, есть важное ограничение. Мы видим, что женщины получают «штраф» к зарплате в размере 3,5 долл. Причем этот «штраф» фиксирован и не зависит от стажа работы. В действительности возможна ситуация, когда с ростом опыта работы зарплата у мужчин растет быстрее, чем у женщин. Иными словами, разрыв между зарплатами мужчин и женщин может становиться больше по мере увеличения стажа работы. Чтобы выявить подобную тенденцию, нам потребуется новый вид фиктивных переменных — фиктивные переменные наклона. Это произведение переменных Xi и Di . 
Включив такое произведение в модель, исследователь получит следующее уравнение: 
Y =˝+˝ ˛ X +˝ ˛ D +˝ ˛ XD +˙ .
i 12 i 3 i 4 ii i 
И снова, чтобы понять, как его интерпретировать, удобно переписать уравнение отдельно для женщин и мужчин: 
мужчины (Di = 0): Y =˝+˝ ˛ X +˙ ;
i 12 ii женщины ( =1): Y = (˝ +˝ ) + (˝ +˝ )˛ X +˙ .
Di i 13 24 ii 
Получается, что в «мужской» модели коэффициент перед переменной X равен ° 2, т.е. каждый дополнительный год стажа увеличивает зарплату мужчины на ° 2. А для женщин коэффициент при X равен ˜2 +˜4, т.е. каждый дополнительный год стажа работы увеличивает зарплату на ˜ +˜ . И если, например, ˜4 < 0, то это означает, что
24 
наклон линии регрессии для женщин более пологий, чем для мужчин (рис. 4.2), т.е. каждый дополнительный год опыта работы дает женщинам меньшую прибавку к зарплате по сравнению с мужчинами. 
SALARY 

Мужчины (Di = 0) наклон β 
Женщины (Di = 1) 
β
2 
наклон β2 + β4 β1 + β3 

TOTAL YEARS OF EXPERIENCE 
Рис. 4.2. Зависимость между стажем работы и заработной платой для мужчин и для женщин в случае использования фиктивных переменных сдвига и наклона (˜3 < 0, ˜4 < 0) 
Фиктивные переменные могут помочь выявить структурные различия в моделях для разных подвыборок. В нашем примере мы можем проверить наличие или отсутствие структурных различий в моделях заработных плат для мужчин и женщин. Для этого достаточно проверить гипотезу 
˜ =˜ = 0.
34 
Действительно, если эта гипотеза верна, то уравнения заработной платы для мужчин и для женщин являются одинаковыми. Чтобы тестировать эту гипотезу, следует осуществить уже знакомый нам тест для сравнения «короткой» и «длинной» регрессий. Применительно к фиктивным переменным этот тест иногда называют тестом Чоу или тестом на структурный сдвиг. Он устроен следующим образом: необходимо добавить в модель фиктивную переменную сдвига и все соответствующие фиктивные переменные наклона, а затем тестировать гипотезу о том, что коэффициенты при этой фиктивной переменной сдвига и всех фиктивных переменных наклона одновременно равны нулю. 
Пример 4.2. Тест на структурный сдвиг 
Опираясь на одну и ту же выборку из 1000 работников, исследователь оценил параметры двух моделей: 
Y =˝+˝ ˛ X +˙ ;
i 12 ii 
Y =˝+˝ ˛ X +˝ ˛ D +˝ ˛ XD +˙ .
i 12 i 3 i 4 ii i 
В первой модели R-квадрат оказался равен 0,6, а во второй — 0,8. Осуществите тест на структурный сдвиг и интерпретируйте его результаты. 
Решение: 
Нужно тестировать гипотезу ˜ =˜ = 0 против альтернативной ги
34
потезы о том, что хотя бы один из двух указанных коэффициентов отличен от нуля. 
Расчетное значение тестовой статистики может быть определено по формуле 
R2 − R2 nk− 08, − 06, 1000 − 4
UR R
F = ˛= ˛= 498.
ðàñ÷ 2
1− Rq 108− ,2
UR 
Это больше, чем критическое значение соответствующей тестовой статистики при любом разумном уровне значимости, например при уровне значимости 1% Fq(, nk− ) = F(2, 996) = ,. Поэтому нулевая
461 гипотеза должна быть отвергнута, и следует сделать вывод о наличии структурного сдвига между моделями заработной платы для мужчин и для женщин. Иными словами, сделать вывод о том, что в рассматриваемой отрасли присутствует дискриминация по гендерному признаку. 
*** 
В рассмотренном нами примере качественный признак может принимать два возможных значения: работник является либо мужчиной, либо женщиной. При помощи фиктивных переменных можно анализировать и случаи большего количества возможных значений. 
Представим, что мы в качестве моделируемого признака рассматриваем университет, который окончил работник, и что в выборке есть выпускники ровно трех университетов: A, Bи C (и нет работников, которые не окончили никакого университета). Ясно, что одной бинарной переменной нам уже не хватит, и этот качественный признак нужно закодировать каким-то другим образом. Оказывается, это просто сделать, добавив в модель не одну, а две фиктивные переменные. Тогда уравнение будет выглядеть так: 
Y=˝+˝ ˛ X+˝ ˛ A+˝ ˛ B+˙ ,
i 12 i 3 i 4 ii 
где Ai— фиктивная переменная, которая равна 1, если i-й респондент является выпускником вуза А, и равна 0 в противном случае; Bi — аналогичная переменная для вуза B. 
Конечно, есть некоторый соблазн добавить три фиктивные переменные, по одной для каждого университета. Действительно, почему бы не добавить в модель фиктивную переменную Ci , равную единице для выпускников университета C и нулю для выпускников остальных университетов? Ответ на этот вопрос дает нам первая часть данной главы. 
Дело в том, что если мы добавим третью фиктивную переменную, то столкнемся с чистой мультиколлинеарностью. Если i-й работник окончил университет B, тогда для него A = 0, B =1, C = 0 и, следовательно,
i ii 
A + B +C =1.
iii 
Аналогично для работника, окончившего любой университет (т.е. для каждого работника в нашей выборке), сумма трех указанных переменных будет равна единице. Тем самым наблюдается строгая линейная связь между переменными модели, что соответствует определению строгой мультиколлинеарности. Поэтому оценка модели, включающей константу и три этих переменных, невозможна. Ситуация возникновения чистой мультиколлинеарности из-за добавления в модель избыточного количества фиктивных переменных называется ловушкой фиктивных переменных. Избежать этой ловушки легко: нужно добавлять в модель на одну переменную меньше, чем есть значений признака. То есть если моделируемый признак принимает m возможных значений, то для его описания в уравнение следует добавить (m −1) фиктивную переменную1. 
Представим, что мы в нашем примере ограничились двумя фиктивными переменными, собрали данные о трех тысячах выпускников и, проведя необходимые расчеты, получили следующие оценки параметров: 
^
Y = 52, + 11, X + 20, A + 30, B .
i iii 
,)(,) (), (,
(05 02 01 02) 
Как интерпретировать полученные оценки коэффициентов? Снова запишем модель для каждого типа выпускников отдельно: 
^
вуз А (A =1, B = 0): Y = 52, +11, ˛ X + 20, ;
iii i
^
вуз В (A = 0, B =1): Y = 52, +11, ˛ X + 30, ;
iii i
^
вуз С (A = 0, B = 0): Y = 52, +11, ˛ X .
iii i
Коэффициент при фиктивной переменной А, оценка которого равна 2, означает, что при прочих равных условиях выпускник вуза А зарабатывает на 2 долл. в час больше, чем выпускник вуза С. Важно помнить, что, когда мы интерпретируем коэффициент, мы должны не просто говорить, что кто-то зарабатывает больше, а указывать, по сравнению с кем больше. 
1 Или добавить все m фиктивных переменных, но тогда не добавлять константу. Этот вариант менее удобен для содержательной интерпретации результатов, поэтому используется сравнительно редко. 
В данном случае фраза «выпускник вуза Ав среднем получает на 2 долл. в час больше, чем выпускник вуза С» — это корректная фраза. А фраза «выпускник вуза А получает на 2 долл. больше, чем выпускники других вузов» — это некорректная фраза, так как в модели видно, что выпускник вуза А по сравнению с выпускниками вуза Вполучает не больше, а меньше. 
Обычно в качестве базы для сравнения (или так называемой эталонной категории) выступает та категория, для которой мы не стали добавлять фиктивную переменную. В нашем примере эталонным университетом выступает вуз С(эталонным не в том смысле, что он самый хороший, а в том смысле, что с ним все сравнивается). 
Еще раз подчеркнем, что подобная содержательная интерпретация коэффициентов осмыслена только в том случае, если эти коэффициенты статистически значимы. Если же они статистически не значимы, то у нас нет уверенности в том, что они отличаются от нуля, и это должно отразиться на наших выводах. Например, если бы в уравнении выше стандартная ошибка оценки коэффициента при переменной Aiбыла бы равна не 0,1, а 10,0, то расчетное значение соответствующей t-статистики оказалось бы равно 2,0/10,0 = 0,2, что меньше критического значения при любом разумном уровне значимости. Следовательно, мы не могли бы отвергнуть гипотезу о том, что ˜3 = 0, и должны были бы заключить, что различия в заработных платах между выпускниками вузов Аи Сотсутствуют. 

4 .3 . Нелинейные модели 
До этого момента мы концентрировались на линейных зависимостях между переменными. Однако мир многообразен, и в процессе эконометрического моделирования часто приходится сталкиваться с нелинейными взаимосвязями. Обычно их использование мотивируется одной из двух причин: 
1. 
Графическим анализом данных . Например, если на этапе предварительного исследования данных вы построили график, характеризующий взаимосвязь между вашими переменными и увидели нечто подобное рис. 4.3, то скорее всего вы придете к выводу, что связь нелинейна. 

2. 
Содержательными теоретическими соображениями . К примеру, если вы анализируете зависимость между количеством используемых фирмой факторов производства и ее объемом выпуска, вы наверняка захотите проверить, не описывается ли эта взаимосвязь производственной функцией Кобба — Дугласа, которая 


°
имеет следующий (нелинейный) вид: Y= AKL˛ .
i ii 
Рассмотрим несколько нелинейных моделей, которые часто встречаются в эконометрическом анализе. 
1200 1000 800 600 400 200 0 

0 2 4 6 810 
Рис. 4.3. Пример нелинейной связи между переменными 
Логарифмическая модель 
Во многих случаях зависимость между переменными в экономике носит степенной характер: 
a
yi = Axi . 
Прологарифмируем правую и левую части этого равенства: 
ln yi = ln A + axi .
ln 
Обозначим переменные более привычным нам образом: ˜1 = ln A и ˜2 = a: ln y =˛ +˛ ln x .
i 12 i 
Наконец, чтобы сделать модель пригодной для эконометрического моделирования, добавим в нее случайные ошибки: 
ln y =˛ +˛ ln x +˝ .
i 12 ii 
Поскольку в новом уравнении в правой и левой частях стоят логарифмы исходных переменных, эту модель называют логарифмической (или двойной логарифмической). 
Смысл проведенного преобразования состоит в том, что относительно параметров (° 1 и ° 2) новая модель является линейной. Поэтому к ней можно применять все стандартные методы оценивания, которые обсуждались в предшествующих главах. Точно так же можно вычислять МНК-оценки коэффициентов, рассчитывать их стандартные ошибки, тестировать гипотезы и т.д. Таким образом, стандартный трюк, который используют эконометристы, заключается в переходе от нелиней
a
ной по параметрам модели (yi = Axi ) к линейной по параметрам1. 
Единственное существенное отличие будет возникать в интерпретации полученного результата. Действительно, в линейной модели 
y =˛ +˛ x +˝
i 12 ii 
коэффициент при переменной xi может быть интерпретирован так: увеличение переменной xi на одну единицу приводит к увеличению переменной yi на ° 2 единиц. 
Однако в логарифмической модели интерпретация коэффициента ° 2 будет отличаться. Чтобы понять, как она устроена, перепишем логарифмическую модель следующим образом: 
° 
2
y = e ° 1 xe˛i
ii 
и вычислим производную зависимой переменной по объясняющей переменной: 
˛1 ˛2 ˝i
dy ˛−1 ˛ exe y
i ˛ 2 ˝ 2 ii
1 i
=˛ ex e = =˛ .
2 i 2
dx xx
i ii 
Преобразуем это выражение, выразим темп прироста зависимой переменной: 
dyi dxi
=° 2. 
yx
ii 
Или, что приближенно то же самое: 
˜yi ˜xi°100% ˛˝ °100%.
2
yx
ii 
1 Для того чтобы случайные ошибки в нашем преобразовании не брались «ниоткуда», можно предположить, что исходная модель тоже их включает, т.е. имеет вот такой
° 
вид: y = Axea i.
ii 
Таким образом, мы получаем следующую интерпретацию коэффициента при регрессоре: увеличение объясняющей переменной на один процент приводит к увеличению зависимой переменной в среднем на ° 2 процентов. Иными словами, коэффициент ° 2 характеризует эластичность зависимой переменной по объясняющей переменной1. 

Линейно-логарифмическая модель 
Аналогичным образом можно разобраться с тем, как интерпретировать коэффициент при переменной в линейно-логарифмической модели, т.е. в модели следующего вида: 
y =˛ +˛ ln x +˝ .
i 12 ii 
Возьмем производную зависимой переменной по объясняющей переменной: 
dyi 1
=° 2;
dx x
ii 
dx
i
dy =° 2;
i 
x
i 
˜x
i
˜y °˛2.
i 
x
i 
Отсюда легко видеть, что если объясняющая переменная увеличива
˜x 
1ется на один процент, т.е. i = , то зависимая переменная увеличи
x 100
i 
вается на величину ˜yi =˝2 ˛ 1 . Таким образом, коэффициент при100 
переменной в линейно-логарифмической модели может быть интерпретирован следующим образом: увеличение объясняющей переменной на один процент приводит к увеличению зависимой переменной в среднем 
° 2
на единиц . 
100 
1 Для читателя, знакомого с микроэкономикой, этот результат скорее всего является вполне ожидаемым: действительно, показатель степени в степенной зависимости численно равен соответствующей эластичности. 

Логарифмически-линейная модель 
Для полноты картины осталось рассмотреть экспоненциальную зависимость: 
+˝
˛˛ +
yi =e 12xi i. 
Такая модель так же легко может быть приспособлена к оцениванию путем перехода к логарифмам (так как в этом случае она снова становится линейной по параметрам): 
ln y =˛ +˛ x +˝ .
i 12 ii 
Так как в левой части этого уравнения стоит логарифм исходной зависимой переменной, а справа регрессор входит в уравнение линейно, такие модели называются логарифмически-линейными. 
Чтобы понять, как можно интерпретировать результаты моделирования в этом случае, посмотрим, насколько меняется зависимая переменная при изменении объясняющей переменной на &#16;xi : 
˙˙(x +˜x )+ˆ ˙+˙
+ x +ˆ
˜y =e 12 i ii −e 12 ii ;
i 
˙˙(x +˜x )+ˆ ˙+˙
+ x +ˆ
˜yi e 12 i ii −e 12 ii = ;
˙˙+x +ˆ
yi e 12 ii 
˜y
i ˝2˜xi
= e −1; 
y
i 
˜y
i ˙˜
°100%(=e 2 xi −°) 100%.
1 
y
i 
˜yЕсли ˜xi =1, то i °100%(=e˙−°) 100%.
21 
y
i 
Поэтому интерпретировать коэффициент в модели в этом случае можно так: увеличение регрессора на единицу приводит к увеличению зависимой переменной на (e˜2 −˛1) 100%. 
Если коэффициент ° 2 близок к нулю, то e˜21 ˜. В этом случае
°+ 
2
˜
(e 2 1) 100% ˝˜2 ˛100%, и можно интерпретировать соответствующий
−˛ 
коэффициент так: увеличение регрессора на единицу приводит к увеличению зависимой переменной на ˜2 °100%. 
На практике приближение является вполне удовлетворительным при 
< 01,. В этом случае погрешность меньше одного процента. При бльших по абсолютной величине значениях коэффициента ° 2 лучше использовать точную формулу. 
Все полученные нами выводы об интерпретации коэффициентов в линейной, логарифмической, логарифмически-линейной и линейнологарифмической моделях обобщены в табл. 4.1. 
˜2 
Таблица 4.1 
Интерпретация коэффициентов в разных моделях 
Зависимость  Интерпретация  
Линейная y = ˛ + ˛ x1 2  Увеличение x на единицу приводит к увеличению y на ° 2 единиц  
Логарифмическая ln y = ˛ + ˛ ln x1 2  Увеличение x на один процент приводит к увеличению y на ° 2 процентов  
Линейно-логарифмическая y = ˛ + ˛ ln x1 2  Увеличение x на один процент приводит к увеличению y на ° 2 / 100 единиц  
Логарифмически-линейная ln y = ˛ + ˛ x1 2  Увеличение x на единицу приводит к увеличению y на ˜2 °100 процентов  

Примечания: 1. Разумеется, если коэффициент отрицательный, то увеличение рег
° 2
рессора приводит не к увеличению, а, наоборот, к уменьшению зависимой переменной. 
2. Следует помнить, что указанные интерпретации получены на основе приближенных формул. В последнем случае (для логарифмически-линейной модели) приближением можно пользоваться только в том случае, если коэффициент  не слишком велик 
° 2
(см. пояснения в тексте параграфа). 
Пример 4.3. Интерпретация коэффициента 
в логарифмически-линейной модели 
Исследователь анализирует, как меняется ВВП некоторой страны во времени. Изучив график ВВП, исследователь заключил, что он растет экспоненциально, следовательно, для моделирования его динамики подойдет логарифмически-линейная модель: 
lnGDP =˝+˝ ˛t +˙ .
t 12 t 
Оценка параметров модели на ежегодных данных за 50 лет приводит к следующей линии регрессии: 

lnGDP = , + 0 02 ˛t.
102 ,t (,)(, )
0 301 0 001 
Интерпретируйте полученные результаты. 
Решение: 
Для начала отметим, что коэффициент при переменной t является статистически значимым, так как гипотеза H0: ˜=0 уверенно отвер
2
гается при уровне значимости 1% (соответствующее расчетное значение тестовой статистики равно 0,02/0,001 = 20, что больше критического значения, которое составляет 2,68). Поэтому можно заключить, что со временем ВВП в рассматриваемой экономике действительно в среднем растет. 
После этого можно перейти к интерпретации. В соответствии с полученным нами правилом интерпретации можно сказать, что увеличение переменной t на единицу приводит к увеличению переменной GDP
t
на 0,02 · 100%. Иными словами, в среднем ВВП в рассматриваемой экономике увеличивается на 2% в год. 

Полиномиальные модели 
В некоторых ситуациях зависимость между регрессором и объясняемой переменной носит немонотонный характер (см., например, рис. 4.4). В таких случаях оправдано использование полиномиальных зависимостей. Например, квадратичных: 
y =˛ +˛ x +˛ x2 +˝ .
i 12 i 3 ii 
В это уравнение все коэффициенты снова входят линейно, а значит, параметры соответствующей модели также легко могут быть оценены обычным МНК. 
35 30 25 20 15 10 5 0 

0 2 4 6 810 
Рис. 4.4. Немонотонный характер зависимости между переменными 
Чувствительность зависимой переменной к изменению регрессора будет существенно зависеть от его величины: 
dyi 
=˛ + 2˛ x .
23 i
dx
i 
Поэтому при интерпретации коэффициента указанную чувствительность обычно вычисляют в конкретной точке, например в точке среднего по выборке значения регрессора. 
Иногда полиномиальные модели могут быть удобным инструментом, особенно если немонотонный характер зависимости следует из содержательных соображений. Однако не следует увлекаться оценкой полиномов высоких степеней просто в угоду получению большого коэффициента R-квадрат. Конечно, технически через n точек всегда можно провести кривую, описываемую полиномом степени (n −1), и R-квадрат при этом будет равен единице. Однако содержательно интерпретировать подобную зависимость будет невозможно, результаты оценивания будут крайне неустойчивыми, а точность прогнозирования вне выборки — низкой. Поэтому на практике, как правило, ограничиваются квадратичными функциями. 
Обратите внимание, что во всех рассмотренных ситуациях путем простых преобразований мы приводили модель к виду, в котором параметры входят в уравнение линейно. Конечно, можно привести пример функции, которая не сводится к линейной по параметрам: 
y =˛ +˛ we˛3xi + ln(˛ z +˝ ).
i 12 i 4 ii 
В этом случае для оценивания параметров приходится использовать альтернативные методы (например, нелинейный МНК или метод максимального правдоподобия), обсуждение которых выходит за рамки этой главы. К счастью, в прикладных исследованиях часто можно обойтись теми моделями, которые мы разобрали выше. 
Естественный вопрос, возникающий после рассмотрения разнообразных нелинейных моделей, состоит в том, как выбрать подходящий вид зависимости для ваших данных: использовать линейную модель, логарифмическую или еще какую-то? Тут следует принимать во внимание следующие соображения: 
1. 
Графический анализ исходных данных . Например, ясно, что если диаграммы рассеяния для ваших данных выглядят как рис. 4.3 или 4.4, то использовать линейную модель будет не слишком хорошей идеей. 

2. 
Графический анализ остатков . После построения модели отсортируйте наблюдения по возрастанию одного из регрессоров и постройте график остатков. Если остатки равномерно колеблются вокруг нуля (т.е. если их поведение не противоречит предпосылке о том, что они являются независимыми случайными величинами), то это аргумент в пользу корректной спецификации. Подобный пример приведен на рис. 4.5. Если же остатки имеют некоторый регулярный вид, например как на рис. 4.6, то скорее всего спецификация выбрана неверно1. 

3. 
Экономическая теория . Как было сказано в самом начале данного параграфа, если в основе ваших эмпирических расчетов лежит теоретическая модель, то это может быть хорошим подспорьем в выборе корректной формы функциональной зависимости. Например, если вы моделируете кривую Лаффера2, то естественно использовать немонотонную функцию. 

4. 
Формальные статистические критерии . Речь о них пойдет в заключительной части этого параграфа. 


Одним из распространенных вариантов тестирования корректности выбранной функциональной формы модели является тест Рамсея (Ramsey test). Иногда его также называют RESET (Regression Equation Specification Error Test). Нулевая гипотеза в этом тесте состоит в том, что спецификация уравнения регрессии верна. 
Процедура его проведения такова: Оцениваем исходное уравнение, корректность спецификации которого хотим проверить, например такое: 
()2 ()k
y =˝ +˝ x +…+ ˝ x +˙ .
i 12 i kii ^
Извлекаем предсказанные значения объясняемой переменной yi . 
Оцениваем вспомогательное уравнение – в него включены все исходные переменные и дополнительно y ^ i 2 и y ^3:
i 
()2 ()k ^2 ^3
y =˝ +˝ x +…+ ˝ x +˙ y +˙ y +ˆ .
i 12 i ki 2 i 3 ii 
Теперь для имеющихся двух уравнений (исходного и вспомогательного) осуществляем тест на сравнение «короткой» и «длинной» 
1 Дополнительные полезные соображения о том, какую информацию можно извлечь из анализа остатков уравнения регрессии, содержатся в следующей главе, посвященной гетероскедастичности. 
2 Зависимость между ставкой налога и суммарными налоговыми поступлениями в государственный бюджет. 
регрессий, чтобы проверить гипотезу H0: ˜ =˜ = 0. Если эта гипо
23
теза отвергается, то следует отвергнуть исходную гипотезу теста Рамсея и заключить, что спецификация уравнения неверна. Если же гипотеза H0: ˜ =˜ = 0 не отвергается, то следует сделать вывод, что специфи
23
кация исходного уравнения верна. Иногда, если в выборке доступно мало наблюдений, вместо двух сла
^2 ^3
гаемых &#23;2 y и &#23;3 y в уравнение добавляют только одно из них.
ii 
30 25 20 15 10 5 0 

0 2 4 6 810 
а) 
15 
10 5 0 
–5 –10 –15 

б) Рис. 4.5. Линия регрессии (а) и соответствующий ей график остатков (б) в случае, когда линейная функциональная форма связи между переменными является корректным предположением 
32,5 27,5 22,5 17,5 12,5 7,5 2,5 

0 2 4 6 810 
а) 
15 
10 
5 
0 
–5 –10 –15 

б) 
Рис. 4.6. Линия регрессии (а) и соответствующий ей график остатков (б) в случае, когда линейная функциональная форма связи между переменными является некорректным предположением, а в действительности зависимость носит нелинейный характер 
Тест Рамсея может отвергать нулевую гипотезу по двум причинам: либо функциональная форма для уравнения выбрана ошибочно, либо в уравнении пропущены важные переменные. К сожалению, этот тест не дает четкого указания, что именно надо сделать для исправления ситуации, так что тут исследователю придется принимать решение самому. Однако в любом случае отвержение нулевой гипотезы тестом Рамсея — это повод задуматься о том, чтобы усовершенствовать спецификацию вашей модели1. 
Иногда выбор функциональной формы осуществляют и на основе качества соответствия модели данным. Например, линейную модель 
y =˛ +˛ x +˝
i 12 ii 
и линейно-логарифмическую модель 
y =˛ +˛ ln x +˝
i 12 ii 
можно сравнить при помощи коэффициента R-квадрат или суммы квадратов остатков. Такое сравнение будет корректным, так как у рассматриваемых типов моделей одинаковая зависимая переменная (). В то же вре
yi 
мя сравнивать линейную модель и логарифмическую модель подобным образом не следует, так как у логарифмической модели другая зависимая переменная (ln). Поэтому сумма квадратов и общая сумма квадратов
yi 
в таких моделях будут существенно отличаться просто из-за того, что измеряются в разных шкалах. В любом случае, как мы обсуждали выше, R-квадрат имеет существенные ограничения, поэтому в современных исследованиях при выборе функциональной формы гораздо чаще опираются на соображения экономической теории и спецификационные тесты. 


4 .4 . Обобщающий пример 
В заключение этой главы рассмотрим пример, позволяющий обобщить все, что мы в ней выяснили. 
Пример 4.4. Цена коттеджа 
В файле Cottage.xlsx имеются следующие данные о двух сотнях коттеджей: 
living_area — жилая площадь коттеджа, м2; 
total_area — общая площадь коттеджа, м2; 
land — площадь участка, на котором расположен коттедж, сотки; 
dist — расстояние от города до участка с коттеджем, км; 
lake — фиктивная переменная, равная единице для коттеджей, расположенных на берегу естественного водоема − реки или озера; 
price — цена коттеджа, млн руб. 
1 В более ранних исследованиях для выбора функциональной формы также использовались тесты Зарембки и Бокса — Кокса [см., напр., Доугерти, 2009]. 
Мы не будем переходить сразу к построению моделей с этой переменной, а начнем с предварительного анализа данных. В табл. 4.2 и 4.3 представлены описательные статистики для анализируемых переменных. 
Из таблицы 4.2 видно, например, что общая площадь коттеджей в нашей выборке изменяется от 54 до 175 м2, а средняя цена коттеджа с участком, на котором он расположен, равна 16,6 млн руб. Среднее значение переменной lake, равное 0,055, говорит о том, что 5,5% коттеджей в выборке расположены непосредственно рядом с водоемом. 
Таблица 4.3 позволяет заключить, что знаки коэффициентов корреляции между ценой коттеджа и прочими факторами соответствуют нашим ожиданиям: цена коттеджа положительно коррелирована с его площадью (как жилой, так и общей), площадью участка и близостью к водоему. Между ценой коттеджа и расстоянием от него до города, напротив, наблюдается отрицательная корреляция. 
Таблица 4.2 
Описательные статистики для всех переменных 
Переменная Среднее Медиана S.D. Min Max 
living_area 89,8 92,0 28,7 41,0 140,0 
total_area 113,0 115,0 29,7 54,0 175,0 
land 24,6 24,0 8,96 10,0 40,0 
dist 60,9 58,5 27,9 10,0 109,0 
lake 0,055 0,000 0,229 0,000 1,000 
price 16,6 13,0 14,2 2,00 99,0 
Таблица 4.3 
Матрица парных коэффициентов корреляции 
living_area  total_area  land  dist  lake  price  
1,000  0,963  −0,069  −0,192  −0,006  0,379  living_area  
1,000  −0,083  −0,187  −0,018  0,380  total_area  
1,000  −0,061  0,003  0,076  land  
1,000  0,090  −0,293  dist  
1,000  0,471  lake  
1,000  price  

Еще одно важное наблюдение, которое можно сделать на основе данных табл. 4.3: жилая площадь и общая площадь коттеджа сильно коррелированы, что может говорить о мультиколлинеарности, которая скорее всего возникнет в модели с обеими этими переменными. Убедимся в этом, построив модель для цены, включающую две эти переменные, площадь участка и расстояние до города. 
Результаты обработки эконометрическим пакетом представлены в табл. 4.4. Мы видим, что ряд переменных, которые в соответствии с соображениями здравого смысла должны влиять на цену коттеджа, оказались незначимыми. Проверим наше предположение о мультиколлинеарности, сформулированное абзацем выше, вычислив коэффициенты VIF для представленной модели. Значения коэффициентов VIF для переменных living_area, total_area, land и dist составляют, соответственно, 13,616, 13,820, 1,015, 1,045. Первые два из них больше 10, что является дополнительным аргументов в пользу сильной мультиколлинеарности. Попробуем решить эту проблему, оставив в нашей модели только одну из двух площадей, например общую. Новая модель представлена в табл. 4.5. Для нее все коэффициенты VIF меньше 10, так что существенной мультиколлинеарности в ней нет. Отметим, что это хорошо сказалось на точности оценивания коэффициента при переменной total_area: его стандартная ошибка уменьшилась, и он оказался значимым на однопроцентном уровне (о чем свидетельствует P-значение, которое существенно меньше 0,01). Обратите внимание, что по критерию исправленного R-квадрата новая модель также стала немного лучше: этот коэффициент увеличился с 0,188 до 0,191. 
Таблица 4.4 
Результаты оценивания модели № 1 (линейной) 
Модель 1: МНК, использованы наблюдения 1-200 Зависимая переменная: price 
Коэффициент Ст. ошибка t-статистика P-значение const 2,25967 5,65823 0,3994 0,6901 living_area 0,0652513 0,117412 0,5557 0,5790 total_area 0,104345 0,113172 0,9220 0,3577 land 0,141501 0,101732 1,391 0,1658 dist −0,112346 0,0331773 −3,386 0,0009 *** 
Сумма кв. остатков 31797,57 Ст. ошибка модели 12,76967 R-квадрат 0,204604 Испр. R-квадрат 0,188288 F(4, 195) 12,54020 Р-значение (F) 4,25e-09 
Таблица 4.5 
Результаты оценивания модели № 2 (линейной) 
Модель 2: МНК, использованы наблюдения 1-200 Зависимая переменная: price 
Коэффициент Ст. ошибка t-статистика P-значение const 1,26480 5,35810 0,2361 0,8136 total_area 0,164814 0,0310774 5,303 <0,0001 *** land 0,143690 0,101477 1,416 0,1584 dist −0,113168 0,0330858 −3,420 0,0008 *** 
Сумма кв. остатков 31847,94 Ст. ошибка модели 12,74714 R-квадрат 0,203344 Испр. R-квадрат 0,191150 F(3, 196) 16,67612 Р-значение (F) 1,09e-09 
Запишем полученную модель в виде уравнения: 
price = , + , total area + 014 land − 0 11
 126016 _ , , disti .
i ii
(536, ) (003, ) (010) ( ,
, 003) 
Как можно интерпретировать полученные результаты? Увеличение площади коттеджа на один квадратный метр увеличивает его цену в среднем при прочих равных условиях на 0,16 млн руб. Каждый дополнительный километр расстояния до города в среднем при прочих равных условиях снижает цену коттеджа на 0,11 млн руб. 
Коэффициент при переменной land в данном случае является статистически незначимым, так что его интерпретировать смысла нет (так как нет уверенности в том, что он отличен от нуля). Как объяснить подобное наблюдение? Возможно, конечно, дело в том, что площадь участка не слишком важна для цены коттеджа, а возможно, спецификация модели пока несовершенна. Попробуем проанализировать нелинейную спецификацию. В табл. 4.6 представлены результаты оценки логарифмической модели с тем же самым набором переменных. 
Таблица 4.6 
Результаты оценивания модели № 3 (логарифмической) 
Модель 3: МНК, использованы наблюдения 1-200 Зависимая переменная: l_price 
Коэффициент Ст. ошибка t-статистика P-значение const −1,66295 0,945301 −1,759 0,0801 * l_total_area 1,04244 0,157187 6,632 <0,0001 *** l_land 0,265954 0,109011 2,440 0,0156 ** l_dist −0,383089 0,0750266 −5,106 <0,0001 *** 
Сумма кв. остатков 72,16836 Ст. ошибка модели 0,606800 R-квадрат 0,315417 Испр. R-квадрат 0,304939 F(3, 196) 30,10192 Р-значение (F) 4,74e-16 
Отметим, что в новой модели коэффициент при переменной land является статистически значимым при уровне значимости 5%, так как соответствующее P-значение меньше пяти сотых. Коэффициенты при двух остальных регрессорах значимы на однопроцентном уровне. 
Запишем полученную модель в виде уравнения: 
ln price , + , lntotal _ area + , lnlland −038 .
 =−166104 027 ,ln dist 
i iii
(,)(,) (,) (,
095 016 011 008) 
Поскольку теперь модель является логарифмической, то интерпретировать результаты можно так: увеличение общей площади коттеджа на 1% увеличивает ее цену в среднем при прочих равных тоже примерно на 1%. Однопроцентное увеличение площади участка, в свою очередь, соответствует увеличению цены примерно на 0,3%. Наконец, увеличение расстояния от коттеджа до города на 1% снижает цену коттеджа на 0,4%. 
Обратимся теперь к влиянию на цену коттеджа его близости к водоему. Для начала воспользуемся тестом Чоу, чтобы проверить гипотезу о том, что близость к водоему не приводит к структурному сдвигу в модели для цены. В нашем случае для этого требуется добавить в рассматриваемую модель одну фиктивную переменную сдвига (переменную lake) и три фиктивные переменные наклона (три произведения lake × total_area, lake × land, lake × dist), а затем проверить гипотезу о том, что коэффициенты при всех этих переменных одновременно равны нулю (для этого будем использовать обычный тест на сравнение «короткой» и «длинной» регрессий). Это приводит к следующим результатам. 
Тест Чоу для структурных изменений в точке lake: 
F(4, 192) = 11,487; P-значение = 0,000. 
Поскольку P-значение теста Чоу меньше одной сотой, при уровне значимости 1% можно заключить, что структурный сдвиг в данных присутствует, и близость к водоему влияет на цену коттеджа. Рассмотрим несколько спецификаций, учитывающих это влияние. Начнем с модели, включающей переменную сдвига (табл. 4.7). 
Таблица 4.7 
Результаты оценивания модели № 4 
Модель 4: МНК, использованы наблюдения 1-200 Зависимая переменная: l_price 
Коэффициент Ст. ошибка t-статистика P-значение const −1,54847 0,863024 −1,794 0,0743 * l_total_area 1,03798 0,143476 7,235 <0,0001 *** l_land 0,260242 0,0995056 2,615 0,0096 *** l_dist −0,417305 0,0686934 −6,075 <0,0001 *** lake 1,09338 0,172327 6,345 <0,0001 *** 
Сумма кв. остатков 59,81914 Ст. ошибка модели 0,553864R-квадрат 0,432561 Испр. R-квадрат 0,420921F(4, 195) 37,16229 Р-значение (F) 4,39e-23 
Отметим, что в новой модели все переменные статистически значимы при уровне значимости 1%, в том числе добавленная нами фиктивная переменная lake. Так как эта переменная входит в уравнение линейно, а зависимая переменная — под логарифмом, то для интерпретации результатов нам потребуется воспользоваться формулой для логарифмически-линейной модели, которую мы получили в предыдущем параграфе. В соответствии с ней можно заключить, что в среднем при прочих равных условиях коттеджи, расположенные рядом с водоемом, дороже остальных коттеджей на 
e109,
( 1) 100% =197%. 
−° 
Получается, что в нашей выборке коттеджи рядом с водоемом почти в три раза дороже коттеджей, расположенных не рядом с ним (при условии равенства всех прочих характеристик). Альтернативная (и, возможно, более реалистичная гипотеза) состоит в том, что прибавка к цене коттеджа за близость к водоему не является фиксированной, а зависит от его площади. Это приводит нас к спецификации с фиктивной переменной наклона, представленной в табл. 4.8. 
Таблица 4.8 
Результаты оценивания модели № 5 
Модель 5: МНК, использованы наблюдения 1-200 Зависимая переменная: l_price 
Коэффициент Ст. ошибка t-статистика P-значение const −1,49135 0,863459 −1,727 0,0857 * l_total_area 1,02785 0,143526 7,161 <0,0001 *** l_land 0,257921 0,0995325 2,591 0,0103 ** l_dist −0,417855 0,0687166 −6,081 <0,0001 *** Lake × l_total_area 0,232968 0,0367676 6,336 <0,0001 *** 
Сумма кв. остатков 59,84676 Ст. ошибка модели 0,553991R-квадрат 0,432299 Испр. R-квадрат 0,420654F(4, 195) 37,12264 Р-значение (F) 4,59e-23 
Записав эту модель в виде уравнения, получим следующий результат: 
ln price 1491 03, + , lntotal_area +026 llandi −
 =− ,ln 
ii
(,)(,) (,)086 014 010 
− 042, ln dist + 0 23 lake ˛ lntotal area .
,_
ii i
007, ) (004 
( ,) 
Чтобы понять, как близость к водоему влияет на цену коттеджа в данном случае, воспользуемся уже знакомым нам приемом: запишем уравнение отдельно для коттеджей, расположенных не рядом с водоемом (т.е. для тех наблюдений, где переменная lake равна нулю), и для коттеджей, расположенных рядом с водоемом (переменная lake равна единице). 
Случай lakei = 0: 
ln price , +1,03 lntotal area + , lnland − ,ln
 =−149 _ 026 042 dist .
i iii 
Случай lakei =1: 
ln price , +1,26lntotal area + , lnland − ,ln
 =−149 _ 026 042 dist .
i iii 
Таким образом, для коттеджей, расположенных не рядом с водоемом, один дополнительный процент площади увеличивает цену на 1,03%, а для коттеджей, расположенных рядом с водоемом, — аж на 1,26%. Иными словами, для коттеджей рядом с водой эластичность цены по площади больше на 0,23. 
Проверим корректность спецификации последней рассмотренной модели при помощи теста Рамсея. Соответствующие результаты представлены в табл. 4.9. Обратите внимание, что в соответствии с процедурой теста в уравнение для модели № 5 добавлены квадраты и кубы зависимой переменной. Гипотеза о том, что коэффициенты при этих переменных равны нулю, не отвергается (это видно из того, что указанное внизу таблицы P-значение = 0,568 > 0,05). Поэтому гипотеза о том, что предложенная спецификация корректна, не отвергается. 
Таблица 4.9 
Результаты теста Рамсея для модели № 5 
Вспомогательная регрессия для теста Рамсея МНК, использованы наблюдения 1-200 Зависимая переменная: l_price 
Коэффициент Ст. ошибка t-статистика P-значение const −4,53589 7,39461 −0,6134 0,5403l_total_area 2,43723 3,24327 0,7515 0,4533l_land 0,606548 0,815676 0,7436 0,4580l_dist −0,975025 1,33506 −0,7303 0,4661lake_l×total_area 0,522222 0,737288 0,7083 0,4796yhat^2 −0,624421 1,17952 −0,5294 0,5971yhat^3 0,0906579 0,143396 0,6322 0,5280 
Тестовая статистика: F = 0,567765, P-значение = P(F(2,193) > 0,567765) = 0,568. 

4 .5 . Рекомендации по оформлению результатов эконометрических расчетов 
Еще раз подчеркнем, что последние несколько таблиц, которые мы привели в примере выше, — это практически необработанные технические таблицы, выдаваемые эконометрическим пакетом при оценивании соответствующих моделей. Мы сознательно приводим их на страницах данной книги в учебных целях, однако в реальном академическом исследовании представлять результаты подобным образом — дурной тон, потому что это неудобно для читателя. 
Гораздо более удачным вариантом представления результатов являются сводные таблицы, позволяющие сопоставить несколько анализируемых моделей и содержащие только необходимую информацию. В качестве примера хорошего оформления результатов эконометрического моделирования обратимся к табл. 4.10, где представлены сводные результаты оценивания трех моделей из последнего примера. Помимо прочего, обратите внимание на следующие аспекты: 
•	 
Количество знаков после запятой. Оно не должно быть слишком большим (двух-трех знаков после запятой чаще всего достаточно), так как в действительности вы редко можете оценить коэффициенты в модели с точностью даже до одного знака после запятой, так что подобное количество цифр будет только вводить читателя в заблуждение. 

•	 
Понятные названия переменных. Вместо технических сокращений, которые вы используете в эконометрическом пакете, лучше добавить в таблицу понятные названия переменных. Если речь идет о русскоязычной статье или, например, дипломе на русском языке, то и названия лучше писать по-русски. Если же вы готовите публикацию на английском, то и названия должны быть записаны на нем. 

•	 
Лучше сопровождать таблицу примечаниями, в которых следует пояснять все необходимые детали. Скажем, если в таблице приведены результаты каких-то специфических тестов или разные модели в одной таблице оценены на разных подвыборках (или относятся к разным периодам времени), то все это стоит прокомментировать под ней. 


Как проверить себя? Если можно открыть вашу таблицу и, не читая остальную часть работы, разобраться во всем, что в этой таблице происходит, значит, вы все сделали правильно. 
Таблица 4.10 
Влияние различных факторов на цену коттеджа 
Модель 3 Модель 4 Модель 5 
Константа −1,66* −1,55* −1,49* (0,95) (0,86) (0,86) 
Логарифм общей площади дома 1,04*** 1,04*** 1,03*** (0,16) (0,14) (0,14) 
Логарифм площади участка 0,27** 0,26*** 0,26** (0,11) (0,10) (0,10) 
Логарифм расстояния до города −0,38*** −0,42*** −0,42*** (0,08) (0,07) (0,07) 
Близость к водоему — 1,09*** — (0,17) 
Произведение близости к водоему — — 0,23*** и общей площади дома (0,04) 
Число наблюдений 200 200 200 
Исправленный R2 0,30 0,42 0,42 
Примечания. Все модели оценены при помощи обычного МНК. Зависимая переменная — логарифм цены коттеджа. В скобках указаны стандартные ошибки. * обозначает значимость на 10%-м уровне; ** обозначает значимость на 5%-м уровне; *** обозначает значимость на 1%-м уровне. 
Задания для самостоятельного решения 
Задание 1 . По 1000 наблюдений было оценено следующее уравнение регрессии (в скобках указаны стандартные ошибки оценок коэффициентов): 
^ 1170200 200 2 = ,.
y =− , + , ˝ln x + , ˝z , R 0 95 
i ii
( ,) (42, ) 51,
191 () 
а . Дайте интерпретацию коэффициента при переменной z: выберите единственную нужную формулировку из предложенного списка и впишите соответствующее число. При прочих равных условиях: 
•	 
при увеличении переменной z на 1% переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной z на единицу переменная y увеличивается на ___ процентов; 

•	 
при увеличении переменной z на 1% переменная y увеличивается на ____ единиц; 

•	 
при увеличении переменной z на единицу переменная y увеличивается на ____ единиц. 


б . Дайте интерпретацию коэффициента при переменной ln x : выберите единственную нужную формулировку из предложенного списка и впишите соответствующее число. При прочих равных условиях: 
•	 
при увеличении переменной x на 1% переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной x на единицу переменная y увеличивается на ___ процентов; 

•	 
при увеличении переменной x на 1% переменная y увеличивается на ____ единиц; 

•	 
при увеличении переменной x на единицу переменная y увеличивается на ____ единиц. 


Задание 2 . По 1000 наблюдений было оценено следующее уравнение регрессии (в скобках указаны стандартные ошибки оценок коэффициентов): 
, 090 ˝d , R2 =095.
lny =−100007, + , ˝ln x +007 ˝z + ,,
i iii
001 (),
(20,) (, ) (001, ) 01 
а . Дайте интерпретацию коэффициента при переменной ln x: выберите единственную нужную формулировку из предложенного списка и впишите соответствующее число. При прочих равных условиях: 
•	 
при увеличении переменной x на 1% переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной x на единицу переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной x на 1% переменная y увеличивается на ____ единиц; 

•	 
при увеличении переменной x на единицу переменная y увеличивается на ____ единиц. 


б . Дайте интерпретацию коэффициента при переменной z: выберите единственную нужную формулировку из предложенного списка и впишите соответствующее число. При прочих равных условиях: 
•	 
при увеличении переменной z на 1% переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной z на единицу переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной z на 1% переменная y увеличивается на ____ единиц; 

•	 
при увеличении переменной z на единицу переменная y увеличивается на ____ единиц. 


в . Дайте интерпретацию коэффициента при переменной d: выберите единственную нужную формулировку из предложенного списка и впишите соответствующее число. При прочих равных условиях: 
•	 
при увеличении переменной d на 1% переменная y увеличивается на ____ процентов; 

•	 
при увеличении переменной d на единицу переменная y увеличивается на ___ процентов; 

•	 
при увеличении переменной d на 1% переменная y увеличивается на ____ единиц; 

•	 
при увеличении переменной d на единицу переменная y увеличивается на ____ единиц. 


Задание 3 . Исследуется зависимость потребления индивида от его располагаемого дохода: 
c =˝+˝ ˛income +˙ .
i 12 ii 
а . Пусть в выборке есть представители только двух регионов: А и Б. Как при помощи фиктивных переменных учесть потенциальное различие функций потребления в двух регионах, если вы считаете, что предельная склонность к потреблению в них одинакова, в то время как автономное потребление может быть разным? 
б . Как при помощи фиктивных переменных проверить гипотезу о том, что предельные склонности к потреблению индивидуумов с доходом выше и ниже уровня 100 тыс. руб. различаются? 
Задание 4 . Оценивается производственная функция типичной фирмы некоторой отрасли: 
lnY =˝+˝ ˛ln K +˝ ˛ln L +˙ .
i 12 i 3 ii 
Выборка состоит из 100 отечественных фирм и 100 иностранных фирм. Исследователь предполагает, что у двух этих групп фирм различаются эластичности выпуска по труду, в то время как все остальные параметры производственной функции идентичны. Как можно учесть это различие при помощи фиктивной переменной? Опишите переменную, которую следует добавить в модель, и запишите уравнение, которое следует оценить. 
Задание 5 . На основе данных о 200 квартирах города Готэм было оценено следующее уравнение регрессии (все переменные оказались значимыми, R2 = 094
,): 

ln P = , + , ˛ln S + 02, 0 ˛Center ˛ ln S + 0,03˛Center +i 100090 
i iii 
+ 004 ° Metro + 0 05° Metro °Center ,
,,
i ii 
где Pi — цена i-й квартиры, тыс. долл.; Si — площадь i-й квартиры, м2; Centeri — фиктивная переменная, равная единице, если i-я квартира расположена в центре города, и равная нулю в противном случае; Metroi — фиктивная переменная, равная единице, если i-я квартира расположена в пешей доступности от метро, и равная нулю, если от квартиры до метро надо добираться на общественном транспорте. 
а . На сколько процентов при прочих равных условиях увеличивается цена квартиры в центре города при увеличении ее площади на 1%? 
б . Для квартир, расположенных в центре города, на сколько процентов дороже квартира рядом с метро по сравнению с такой же квартирой, расположенной не рядом с метро? 
в . Для квартир, расположенных не в центре города, на сколько процентов дороже квартира рядом с метро по сравнению с такой же квартирой, расположенной не рядом с метро? 
Задание 6 . На рынке телевизоров некоторого города продаются телевизоры только трех фирм: «Альфа», «Бета» и «Гамма». Исследователь анализирует зависимость цены телевизора от диагонали экрана и марки производителя. В его распоряжении имеется информация о 100 моделях телевизоров. Для каждого наблюдения ему известна цена телевизора в долларах (обозначим ее P), длина диагонали экрана в дюймах (обозначим ее Diag) и марка производителя. Исследователь ввел следующие фиктивные переменные: 
Alfai — фиктивная переменная, равная единице, если i-я модель телевизора произведена фирмой «Альфа», и равная нулю во всех остальных случаях; 
Betai — фиктивная переменная, равная единице, если i-я модель телевизора произведена фирмой «Бета», и равная нулю во всех остальных случаях. 
На основе доступных данных было оценено следующее уравнение регрессии (все переменные оказались значимыми): 
 200005 007 , 003˛ DiagBetai ,
ln Pi = , + , ˛ Diag + , ˛ Alfa + 0 06 ˛ Beta + , ˛
iii i 
R2 ,.
= 095 
а . На сколько процентов увеличивается цена телевизора фирмы «Бета» при увеличении диагонали его экрана на один дюйм? 
б . На сколько процентов увеличивается цена телевизора фирмы «Гамма» при увеличении диагонали его экрана на один дюйм? 
в . Как можно интерпретировать коэффициент при переменной 
Alfai ? Заполните пропуски в формулировке: При прочих равных условиях телевизоры фирмы «Альфа» на ___________ процентов дороже, чем __ _____________________________________________. 
Задание 7 . Исходный файл с данными: ef.xls. 
Имеются следующие данные о 150 абитуриентах, сдававших вступительный экзамен в магистратуру экономического факультета: 
Y — количество баллов за вступительный экзамен по экономической теории; 
D — фиктивная переменная, равная единице, если соответствующий абитуриент посещал подготовительные курсы для поступающих, и равная нулю в противном случае; 
EF — фиктивная переменная, равная единице, если соответствующий абитуриент является выпускником бакалавриата данного экономического факультета, и равная нулю в противном случае. 
Вас интересует ответ на следующий вопрос: помогают ли курсы подготовиться к экзамену? 
а . Оцените регрессию переменной Y на константу и переменную D. Интерпретируйте полученный результат. 
б . Оцените регрессию переменной Y на константу, переменную D и переменную EF. Интерпретируйте полученные результаты. Что можно сказать об уравнении из предыдущего пункта в свете полученных вами результатов − была ли смещена оценка коэффициента при переменной D из-за пропуска существенной переменной (omitted variable bias)? 
в . Осуществите тест Рамсея для модели из пункта (б). Интерпретируйте его результат. Стоит ли останавливаться на указанной спецификации или следует продолжить поиск? 
г . Оцените регрессию переменной Y на константу и переменные D, EF и (D×EF). Интерпретируйте полученные результаты: на сколько баллов увеличится ожидаемый результат экзамена для выпускника экономического факультета, если он посетит подготовительные курсы? А для выпускника другого вуза? 
д . Оцените модель из пункта (г), используя теперь в качестве зависимой переменной логарифм количества баллов по экономической теории. Интерпретируйте полученные результаты: на сколько процентов увеличится ожидаемый результат экзамена для выпускника экономического факультета, если он посетит подготовительные курсы? А для выпускника другого вуза? 
Задание 8 . Рассматривается следующая модель: 
y=˛ +˛ ln x+˛ dln x+˝ ,
i 12 i 3 i ii 
где yi — величина спроса i-го индивида на товар Ф, кг; xi — доход индивида, тыс. руб.; di— бинарная переменная, равная единице для мужчин и нулю для женщин. 
Оценка параметров модели при помощи МНК на основе данных о 1000 индивидов дала следующие результаты: 
^ 
y= , + , ln x− , dx234800 600 ln. 
i iii
(212, ) (200, ) (,400) 
^^
Также известно, что cov(,˜˜) =, (ln, ln xi) = 07, .
250 и corr xd
23 ii 
а . Влияет ли изменение дохода на потребление товара Ф женщинами (сформулируйте и проверьте соответствующую гипотезу при уровне значимости 1%)? Если да, то укажите, на сколько килограммов (или процентов) и в каком направлении меняется спрос на товар Ф в результате увеличения дохода женщины на 1%? 
б . Влияет ли изменение дохода на потребление товара Ф мужчинами (сформулируйте и проверьте соответствующую гипотезу при уровне значимости 1%)? Если да, то укажите, на сколько килограммов (или процентов) и в каком направлении меняется спрос на товар Ф в результате увеличения дохода мужчины на 1%? 
в . Есть ли в рассматриваемой модели существенная мультиколлинеарность? Обоснуйте свой ответ, вычислив соответствующий коэффициент VIF. 
Задание 9 . Рассматривается следующая модель: 
ln y=˛ +˛ ln x+˛ dln x+˝ ,
i 12 i 3 i ii 
где yi— величина спроса i-го индивида на товар N, кг; xi — доход индивида, тыс. руб.; di — бинарная переменная, равная единице для женщин и нулю для мужчин. 
Оценка параметров модели при помощи МНК на основе данных о 1000 индивидов дала следующие результаты: 

ln y= , + , ln x−1100dln. 
1221000 , x
i iii
(,) (,) (,)012 100 200 
^^
Известно, что cov(,˜˜) =20, (ln,xdln xi) = 004.
и corr ,
23 ii 
а . Влияет ли изменение дохода на потребление товара N женщинами (сформулируйте и проверьте соответствующую гипотезу при уровне значимости 5%)? Если да, то укажите, на сколько килограммов (или процентов) и в каком направлении меняется спрос на товар N в результате увеличения дохода женщины на 1%? 
б . Влияет ли изменение дохода на потребление товара N мужчинами (сформулируйте и проверьте соответствующую гипотезу при уровне значимости 5%)? Если да, то укажите, на сколько килограммов (или процентов) и в каком направлении меняется спрос на товар N в результате увеличения дохода мужчины на 1%? 
в . Есть ли в рассматриваемой модели существенная мультиколлинеарность? Обоснуйте свой ответ, вычислив соответствующий коэффициент VIF. 
Задание 10 . В вашем распоряжении имеются следующие данные о заработной плате сотрудников компании АВС в июне 2020 г. 
Сотрудник Заработная плата, тыс . руб . 
Иван Петрович 30 
Сергей Васильевич 20 
Василий Иванович 26 
Петр Сергеевич 23 
Марк Ильич 26 
Елена Владимировна 25 
Людмила Игоревна 19 
Светлана Васильевна 21 
Анна Петровна 24 
Юлия Сергеевна 21 
Рассматривается классическая линейная модель парной регрессии: 
y =˝+˝ ˛ x +˙ ,
i 12 ii 
где yi — заработная плата i-го работника; xi — фиктивная переменная, равная единице, если i-й работник женщина, и нулю, если i-й работник мужчина. 
а . Найдите МНК-оценки для коэффициентов модели. Вычислите стандартную ошибку для оценки коэффициента ° 2. Проверьте гипотезу ˜2 = 0. Можно ли утверждать, что пол работника статистически значимо влияет на уровень его заработной платы в фирме АВС? 
б . Естественно ожидать, что на заработную плату работника влияет также его образование. Предположим, что истинная модель для заработной платы имеет вид: 
y =˝+˝ ˛ x +˝ ˛ z +˙ ,
i 12 i 3 ii 
где zi — переменная, характеризующая количество лет обучения, для i-го работника. Предположим также, что в фирме АВС мужчины и женщины в среднем имеют одинаковый уровень образования, и при этом более образованные работники в среднем получают более высокую заработную плату, чем менее образованные. 
Что в этой ситуации можно сказать об оценке коэффициента ° 2, полученной в пункте (а)? Будет ли она смещена? Если ответ «да», то будет ли она завышена или занижена? Формально обоснуйте свой ответ. 
в . Как изменится ответ на вопрос предыдущего пункта, если теперь женщины в фирме АВС имеют более высокий уровень образования, чем мужчины? 


ГЛАВА 5 
ГЕТЕРОСКЕДАСТИЧНОСТЬ, ОБОБЩЕННАЯ ЛИНЕЙНАЯ МОДЕЛЬ 
В этой главе мы выясним, как меняются свойства эконометрических оценок, если отказаться от двух предпосылок классической линейной модели множественной регрессии: о постоянстве дисперсии случайных ошибок, а также (ближе к концу главы) об отсутствии корреляции между случайными ошибками, относящимися к разным наблюдениям. 
Это важно сделать, так как в реальных прикладных исследованиях хотя бы одна из этих проблем возникает почти всегда. К счастью, существуют простые и действенные средства, позволяющие избежать основных негативных последствий нарушения указанных предпосылок. Их мы тоже обсудим. 
5 .1 . Гетероскедастичность: определение и последствия 
Вспомните предпосылки классической линейной модели парной регрессии (сформулированы в § 2.3) и множественной регрессии (в § 3.2). В обоих случаях предпосылка 4 состояла в том, что дисперсия случайной ошибки постоянна: var(˜ ) =°2 = const (гомоскедастичность
i
случайных ошибок). Если же дисперсия случайной ошибки не является постоянной: var(˜ ) =°2 ˝const, т.е. четвертая предпосылка классической модели не
ii
выполняется, такая ситуация называется гетероскедастичностью. 
Напомним, что интуитивно понять различие между двумя этими ситуациями можно, взглянув на рис. 2.3а и 2.3б, приведенные в § 2.3 гл. 2. Первый из них соответствует ситуации, когда дисперсия случайной ошибки постоянна, и поэтому разброс точек вокруг линии регрессии более-менее равномерен. Во втором случае наблюдается частный случай гетероскедастичности, а именно, ситуация, когда дисперсия случайной ошибки var(˝i ) положительно зависит от xi , и поэтому разброс точек вокруг линии регрессии увеличивается по мере увеличения значения этой переменной. 
Когда можно ожидать, что в реальном исследовании в данных будет наблюдаться гетероскедастичность? Представим, например, что мы анализируем зависимость потребления индивида от его располагаемого дохода. Тогда располагаемый доход индивида является объясняющей переменной x. Понятно, что для групп индивидов с маленьким доходом, который измеряется десятками долларов в месяц, потребление будет разным, но оно скорее всего тоже будет измеряться десятками долларов в месяц. Соответственно и разброс потребления (отклонение от линии регрессии) для этих индивидов также будет измеряться в десятках долларов. Если же взять очень богатых индивидов, у которых доход измеряется десятками тысяч долларов, то и разброс потребления у них тоже будет составлять несколько тысяч долларов. Получается, что для бедных индивидов разброс потребления будет маленьким, а для богатых индивидов — большим. Это и есть ситуация гетероскедастичности. 
Подчеркнем, что гетероскедастичность не обязательно имеет вид, приведенный на рис. 2.3б, т.е. дисперсия случайной ошибки не обязательно должна расти пропорционально какому-то регрессору. Зависимость дисперсии случайной ошибки от тех или иных переменных может иметь и более сложный характер. 
Допустим, что выполнены все предпосылки классической линейной модели множественной регрессии за одним исключением: в данных наблюдается гетероскедастичность. Как это скажется на свойствах МНКоценок коэффициентов? 
Перечислим основные последствия: 
1 . МНК-оценки коэффициентов останутся несмещенными . В этом легко убедиться, если вернуться к § 2.4 и обратить внимание, что предпосылка 4 об отсутствии гетероскедастичности никак не используется при доказательстве несмещенности. 
2 . МНК-оценки коэффициентов больше не являются эффективными . 

Из § 2.4 также видно, что соответствующая предпосылка критична для доказательства эффективности. 
3 . Стандартные ошибки оценок коэффициентов, рассчитанные по формуле для случая гомоскедастичности, оказываются смещенными и несостоятельными . Следовательно, их использование для тестирования гипотез и построения доверительных интервалов может привести к некорректным выводам. 
Первые два перечисленных следствия говорят о том, что МНКоценки коэффициентов в условиях гетероскедастичности хотя теряют точность, однако остаются в среднем правильными. Третье же последствие весьма критично, так как увеличивает вероятность неверной интерпретации результатов моделирования. Поэтому в следующем параграфе мы сконцентрируемся на методе решения этой проблемы. 

5 .2 . Состоятельные в условиях гетероскедастичности стандартные ошибки 
Так как гетероскедастичность не приводит к смещению оценок коэффициентов, можно по-прежнему использовать МНК. Смещены и несостоятельны оказываются не сами оценки коэффициентов, а их стандартные ошибки, поэтому формула для расчета стандартных ошибок в условиях гомоскедастичности не подходит для случая гетероскедастичности. 
Естественной идеей в этой ситуации является корректировка формулы расчета стандартных ошибок, чтобы она давала «правильный» (состоятельный) результат. Тогда можно снова будет корректно проводить тесты, проверяющие, например, незначимость коэффициентов, и строить доверительные интервалы. Соответствующие «правильные» стандартные ошибки называются состоятельными в условиях гетероскедастичности стандартными ошибками (heteroskedasticity consistent (heteroskedasticity robust) standard errors)1. Первоначальная формула для их расчета была предложена Уайтом, поэтому иногда их также называют стандартными ошибками в форме Уайта (White standard errors). 
Предложенная Уайтом состоятельная оценка ковариационной матрицы вектора оценок коэффициентов имеет вид: 
˝ n ˇ
^^ −12 −1
V ()˜=n(XX˛) exx˛(XX˛),
ˆ1 &#21;sss &#23;
ˆn &#23;
˙ s=1 ˘ 
где xs – это s-я строка матрицы регрессоров X. 
Очевидно, что эта формула более громоздка, чем формула 
^^ 12
V ()˜=(X ˛X )−S , которую мы вывели в гл. 3 для случая гомоскедастичности. К счастью, на практике соответствующие вычисления не представляют сложности, так как возможность автоматически рассчитывать 
1 Поскольку довольно утомительно каждый раз произносить это название полностью в англоязычном варианте, их часто называют просто robust standard errors, что на русском языке в эконометрике превратилось в «робастные стандартные ошибки». Кому-то подобный англицизм, конечно, режет слух, однако в устной речи он гораздо удобнее своей длинной альтернативы. 
стандартные ошибки в форме Уайта реализована во всех современных эконометрических пакетах. Общепринятое обозначение для этой версии стандартных ошибок «HC0». В работах Маккиннона, Уайта [MacKinnon, White, 1985] и Дэвидсона, Маккиннона [Davidson, MacKinnon, 2004] были предложены и альтернативные версии, которые обычно обозначаются в эконометрических пакетах как «HC1», «HC2» и «HC3». Их расчетные формулы несколько отличаются, однако суть остается прежней: они позволяют состоятельно оценивать стандартные отклонения МНК-оценок коэффициентов в условиях гетероскедастичности. 
Для случая парной регрессии состоятельная в условиях гетероскедастичности стандартная ошибка оценки коэффициента при регрессоре имеет вид: 
1 n (x − x )22e 
^
1 n − 2 ˝i=1 ii
se() = .
˜ 
n  2
2 var()x 
Формальное доказательство состоятельности будет приведено в следующей главе. Пока же обсудим пример, иллюстрирующий важность использования робастных стандартных ошибок. 
Пример 5.1. Оценка эффективности использования удобрений 
В файле Agriculture в материалах к этому учебнику содержатся следующие данные 2010 г. об урожайности яровой и озимой пшеницы в Спасском районе Пензенской области: 
PRODP − урожайность в денежном выражении, в тысячах рублей с 1 га; 
SIZE – размер пахотного поля, в гектарах; 
LABOUR – трудозатраты, в рублях на 1 га; 
FUNG1 – фунгициды, протравители семян, расходы на удобрение, в рублях на 1 га; 
FUNG2 – фунгициды, во время роста, расходы на удобрение, в рублях на 1 га; 
GIRB – гербициды, расходы на удобрение, в рублях на 1 га; 
INSEC – инсектициды, расходы на удобрение, в рублях на 1 га; 
YDOB1 – аммофос, во время сева, расходы на удобрение, в рублях на 1 га; 
YDOB2 – аммиачная селитра, во время роста, расходы на удобрение, в рублях на 1 га. 
Представим, что вас интересует ответ на вопрос: влияет ли использование фунгицидов на урожайность поля? 
а . Оцените зависимость урожайности в денежном выражении от константы и переменных FUNG1, FUNG2, YDOB1, YDOB2, GIRB, INSEC, LABOUR. Запишите уравнение регрессии в стандартной форме, указав коэффициент детерминации и (в скобках под соответствующими коэффициентами) стандартные ошибки для случая гомоскедастичности. Какие из переменных значимы на 5%-м уровне значимости? 
б . Решите предыдущий пункт заново, используя теперь состоятельные в условиях гетероскедастичности стандартные ошибки. Сопоставьте выводы по поводу значимости (при 5%-м уровне) переменных, характеризующих использование фунгицидов. 
Решение . 
а . Оценим требуемое уравнение: 
Модель 1: МНК, использованы наблюдения 1-200 Зависимая переменная: PRODP 
Коэффициент Ст. ошибка t-статистика P-значение const −38,4019 7,5273 −5,1017 <0,00001 *** FUNG1 0,0445755 0,0487615 0,9142 0,36178 FUNG2 0,103625 0,049254 2,1039 0,03669 ** GIRB 0,0776059 0,0523553 1,4823 0,13990 INSEC 0,0782521 0,0484667 1,6146 0,10805 LABOUR 0,0415064 0,00275277 15,0781 <0,00001 *** YDOB1 0,0492168 0,0233328 2,1093 0,03621 ** YDOB2 −0,0906824 0,025864 −3,5061 0,00057 *** 
Сумма кв. остатков 150575,6 Ст. ошибка модели 28,00443 R-квадрат 0,801958 Испр. R-квадрат 0,794738 F (7, 192) 111,0701 Р-значение (F) 5,08e-64 
Переменные FUNG2, LABOUR, YDOB1 и YDOB2 значимы на 5%-м уровне значимости (причем LABOUR и YDOB2 — еще и на 1%-м уровне). 
Если представить те же самые результаты в форме уравнения, то получим следующее: 
PRODP 38 40+004˝FUNG1 +010˝FUNG 2 +
 =− ,, ,
i ii
005)
(753, ) (005, ) (, 
+ 008°GIRB + 0 08° INSEC + 004 ° LABOUR +
,, ,
ii i
0 003)(005, ) (005, ) (, 
+ 005˝ 1i − , ˝YDOB2i , R2 = 0 802.
, YDOB 009 , 002, ) (003 
( ,) 
б . При использовании альтернативных стандартных ошибок получим следующий результат: 
Модель 2: МНК, использованы наблюдения 1-200 Зависимая переменная: PRODP Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const −38,4019 7,40425 −5,1865 <0,00001 *** FUNG1 0,0445755 0,0629524 0,7081 0,47975 FUNG2 0,103625 0,0624082 1,6604 0,09846 * GIRB 0,0776059 0,0623777 1,2441 0,21497 INSEC 0,0782521 0,0536527 1,4585 0,14634 LABOUR 0,0415064 0,00300121 13,8299 <0,00001 *** YDOB1 0,0492168 0,0197491 2,4921 0,01355 ** YDOB2 −0,0906824 0,030999 −2,9253 0,00386 *** 
Сумма кв. остатков 150575,6 Ст. ошибка модели 28,00443 R-квадрат 0,801958 Испр. R-квадрат 0,794738 F (7, 192) 119,2263 Р-значение (F) 2,16e-66 
Оценки коэффициентов по сравнению с пунктом (а) не поменялись, что естественно: мы ведь по-прежнему используем обычный МНК. Однако стандартные ошибки теперь немного другие. В некоторых случаях это меняет выводы тестов на незначимость. 
Переменные LABOUR, YDOB1 и YDOB2 значимы на 5%-м уровне значимости (причем LABOUR и YDOB2 — еще и на 1%-м уровне). 
Переменная FUNG2 перестала быть значимой на 5%-м уровне. Таким образом, при использовании корректных стандартных ошибок следует сделать вывод о том, что соответствующий вид удобрений не важен для урожайности. Обратите внимание, что если бы мы использовали «обычные» стандартные ошибки, то пришли бы к противоположному заключению (см. пункт а). 
*** 
Важно подчеркнуть, что в реальных пространственных данных гетероскедастичность в той или иной степени наблюдается практически всегда. А даже если ее нет, то состоятельные в условиях гетероскедастичности стандартные ошибки по-прежнему будут… состоятельными (и будут близки к «обычным» стандартным ошибкам, подсчитанным по формулам из гл. 3). Поэтому в современных прикладных исследованиях при оценке уравнений по умолчанию используются именно робастные стандартные ошибки, а не стандартные ошибки для случая гомоскедастичности. Мы настоятельно рекомендуем читателю поступать так же1. 
1 Просто не забывайте включать соответствующую опцию в своем эконометрическом пакете. 
В нашем учебнике с этого момента и во всех последующих главах, если прямо не оговорено иное, для МНК-оценок параметров всегда используются состоятельные в условиях гетероскедастичности стандартные ошибки. 

5 .3 . Взвешенный метод наименьших квадратов 
Рассмотренные в предыдущем параграфе стандартные ошибки позволяют успешно тестировать гипотезы и строить доверительные интервалы в условиях гетероскедастичности, однако не устраняют другого ее негативного последствия, упомянутого в начале главы: неэффективности МНКоценок. Для получения эффективных оценок параметров можно воспользоваться так называемым взвешенным МНК (weighted least squares, WLS). Чтобы понять, как он работает, рассмотрим несколько важных случаев. 
Случай 1. Дисперсия случайных ошибок var(˜ ) =°2 известна.
ii 
Пусть рассматривается модель 
()2 ()k
y =˝ +˝ x +…+˝ x +˙ ,
i 12 i kii 
для которой выполнены все предпосылки классической линейной модели множественной регрессии за одним исключением − в данных наблюдается гетероскедастичность var(˜ ) =°2.
ii
В этом случае можно разделить правую и левую части уравнения регрессии на ˘i: 
()2 ()k
y ° +° x +…+ ° x +˛
i 12 i kii
= .
˜˜
ii 
После этого сделаем простую замену переменных: 
()2 ()k
y xx ˝
i ()1 1 ()2 i ()ki i
y = ; x = ; x = ; … ; x = ; ˝= .
iii ii
˛˛˛ ˛˛
iii ii 
В результате замены переменных переходим к новой модели: 
()1 ()2 ()k
y =˝x +˝ x +…+˝ x +˙.
i 1 i 2 i kii 
Новая модель полезна тем, что в ней гетероскедастичности нет, так как дисперсия случайной ошибки является константой: 
˝˜ˇ
i 2
var( )var= ˆ&#23;= 12 var(˜) = 12 1
˜ °==const.
i ii
°
˙˘° ° 
ii i 
Следовательно, МНК, примененный к новой модели, будет давать не только несмещенный, но и эффективный результат. Таким образом, суть взвешенного МНК состоит в том, чтобы сделать правильную замену переменных так, чтобы применение к новой модели (с измененными переменными) обычного МНК приводило к получению эффективных оценок коэффициентов. После этого для интерпретации результатов можно вернуться к исходным переменным. 
Чтобы понять, почему этот метод называется взвешенным МНК, сравним оптимизационные задачи в рамках обычного МНК и в рамках взвешенного МНК. В первом случае мы минимизируем сумму квадратов остатков: 
n 
˛ min.
°ei 2^
˝
i=1 
В случае взвешенного МНК мы минимизируем сумму квадратов остатков новой модели: 
2
nn n
˛ e ˆ
2 i 2
e == e min 
() &#23; . 
° i °˙&#22;˘ ° 12 i ^
˝ˇ&#22; &#21;
i=1 i=1 ii=1 i 
Получается, что мы минимизируем сумму квадратов остатков, но каждое слагаемое домножается на весовой коэффициент 1 / ˘i 2, т.е. мы минимизируем сумму квадратов остатков с определенными весами. Чем меньше дисперсия для i-го наблюдения (т.е. чем меньше фактор случайности для этого наблюдения), тем больший вес это наблюдение имеет в той сумме, которую мы минимизируем. Тем самым наибольший вес мы придаем наиболее «надежным» наблюдениям, что и позволяет улучшить качество получаемых оценок. 
Обратите внимание на то, что даже если в исходной модели был свободный член, в новой модели в результате замены переменных констан
()1 1
та пропадает (вместо нее возникает переменная xi = ). Поэтому, в
° 
i 
частности, привычный коэффициент R2 для такой модели неприменим и не может интерпретироваться стандартным образом (хотя, если его все-таки посчитать, он часто оказывается выше по сравнению c аналогичным коэффициентом для обычного МНК). 
Разумеется, в реальности дисперсия случайной ошибки обычно неизвестна исследователю, что приводит нас к необходимости рассмотрения более реалистичного случая. 
Случай 2. Дисперсия случайных ошибок var(˜ ) =°2 неизвестна.
iiВ этой ситуации сначала следует получить оценки дисперсий ˘i 2. Как правило, это делают так: сначала оценивают исходную модель при помощи обычного МНК и получают остатки регрессии ei ; затем оценивают вспомогательную модель для остатков следующего вида: 
2 ()1 ()p 2 ()1 ()p
e =˝ +˝ z +…+ ˝ z +u èëè ln e =˝ +˝ z +…+ ˝ z + ui ,
i 01 i pii i 01 i pi 
()1 ()2 ()p
где z , z , …, z — набор переменных, которые предположительно
ii i
влияют на дисперсию случайной ошибки. Обычно в качестве таких переменных берутся регрессоры из исходной модели, а также их квадраты. ln ei 2 иногда используется в левой части вспомогательного уравнения вместо ei 2, для того чтобы предсказанное значение квадрата остатков никогда не было отрицательным (что было бы нелогично). 
Оценив вспомогательное уравнение, получаем предсказанные зна
^
чения квадратов остатков ei 2 . Их и используют для оценки дисперсии случайной ошибки: 
22
^^
˜= ei .
i 
После этого следует действовать аналогично первому случаю, только 
2^
вместо дисперсии ˘i 2 брать для замены переменных ее оценку ˘i . 
Пример 5.2. Оценка эффективности использования 
удобрений (продолжение) 
Продолжим рассмотрение модели урожайности, которое мы начали в примере 5.1. Теперь оценим модель, используя взвешенный МНК. Сравним полученные результаты с результатами из примера 5.1. 
Решение . 
В качестве вспомогательного уравнения оценивалась следующая спецификация, включающая все регрессоры исходной модели, а также их квадраты: 
2
ln e =˛ +˛ FUNG1 +˛ FUNG 2 +˛ GIRB +
i 01 i 2 i 3 i 
+° INSEC +° LABOUR +° YDOB1 +° YDOB2 +
4 i 5 i 6 i 7 i 
2 22
+° FUNG1 +° FUNG2 +° GIRB +
8 i 9 i 10 i 
2 222
+° INSEC +° LABOUR +° YDOB1 +° YDOB2 + u
i.
11 i 12 i 13 i 14 i 

В результате оценки этого уравнения были получены расчетные зна
2
^
чения lnei 2 и затем ei . После этого был осуществлен переход к взвешенной модели, как это описано выше, при помощи деления обеих 
^
частей уравнения из примера 5.1 на ˜i = . Наконец, при помощи обычного МНК были оценены параметры последней модели. Результаты оценивания представлены ниже. 
Модель 3. С поправкой на гетероскедастичность использованы наблюдения 1-200 Зависимая переменная: PRODP 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const  −36,6762  6,17857  −5,9360  <0,00001  ***  
FUNG1  0,0827277  0,0496946  1,6647  0,09760  *  
FUNG2  0,114722  0,0519986  2,2063  0,02855  **  
GIRB  0,0528989  0,0566521  0,9338  0,35161  
INSEC  0,0447185  0,0424588  1,0532  0,29356  
LABOUR  0,0411533  0,0026617  15,4613  <0,00001  ***  
YDOB1  0,0412047  0,0199716  2,0632  0,04044  **  
YDOB2  −0,0817552  0,0232718  −3,5131  0,00055  ***  
Статистика, полученная по взвешенным данным:  

Сумма кв. остатков 798,3622 Ст. ошибка модели 2,039151 F (7, 192) 169,9013 Р-значение (F) 1,05e-78 
То же самое в виде уравнения: 
PRODP 36 68 +008 ˝FUNG1 +011 ˝FUNG 2 +
 =− ,, ,
i 
ii
005)(618, ) (005, ) (, 
+ 005 °GIRB + 0 04 °INSEC + 004 ° LABOUR +
,, ,
ii i
(006, ) (004, ) (0003
,) 
+ 004 ˛YDOB1i − , i
, 008 ˛YDOB2. 002) (0 02)
(, , 
При оценивании модели с коррекцией на гетероскедастичность изменились коэффициенты, а их стандартные ошибки в целом стали меньше. 
Напомним, что обычная гетероскедастичность не приводит к смещению оценок коэффициентов, поэтому неудивительно, что полученные результаты совсем немного отличаются от оценок коэффициентов, вычисленных на основе обычного МНК (см. числа в примере 5.1). Тем не менее, если мы корректно оценили дисперсию случайной ошибки, есть надежда, что новые результаты являются немного более точными. 
*** 
В заключение данного параграфа рассмотрим еще один случай применения взвешенного МНК. Этот случай является более частным, чем случай 2, однако также может быть полезен в некоторых ситуациях. 
Случай 3. Дисперсия случайной ошибки прямо пропорциональна квадрату единственной переменной: var(˜ ) =°2 =°22zi > 0.
ii 0 Подразумевается, что величина ˘02 неизвестна, но это нам не помешает. Оказывается, столкнувшись с таким частным случаем гетероскедастичности, можно легко ее устранить. Действительно, для этого достаточно поделить правую и левую части исходного уравнения на переменную zi : 
()2 ()k
y ˝ +˝ x +…+ ˝ x +˙
i 12 i kii
= . 
zz
ii 
Делаем замену переменных: 
()2
y 1 x ° 
i ()1* ()2* ii
y* = ; x = ; x = ; °* = .
iii i
zz zz
ii ii 
В результате замены переменных переходим к новой модели со звездочками: 
()1* ()2* ()k * 
y* =˝ x +˝ x +…+ ˝ x +˙*.
i 1 i 2 i kii 
В новой модели гетероскедастичности нет, так как дисперсия случайной ошибки является константой: 
˝˜ ˇ 
11
* i 22 2
var(˜ )var ˆ &#23;= var(˜ ) =° z= =°= const. 
i 2 i 20 i 0
˙ z ˘ zz
ii i 
Следовательно, для оценки параметров новой модели можно использовать обычный МНК, и оценки коэффициентов будут эффективными. 
Какой же метод устранения негативных последствий гетероскедастичности лучше использовать: состоятельные в условиях гетероскедастичности стандартные ошибки или взвешенный МНК? 
Казалось бы, взвешенный МНК предпочтительнее, потому что он дает возможность получить эффективные оценки коэффициентов, т.е. в ситуации гетероскедастичности он должен быть точнее обычного МНК. Однако это верно только при условии, что мы правильно специфицировали уравнение для дисперсии случайной ошибки (т.е. правильно поняли, как именно устроена гетероскедастичность в анализируемой модели). К сожалению, на практике это может быть проблематично. Кроме того, при наличии достаточно большой выборки обычный МНК и так дает удовлетворительные результаты. Поэтому в прикладных эконометрических работах гораздо чаще применяется обычный МНК в сочетании с робастными стандартными ошибками. 

5 .4 . Выявление гетероскедастичности 
Гетероскедастичность — это типичная «болезнь» пространственных данных, поэтому лучше по умолчанию исходить из того, что она в вашей модели есть. Тем не менее иногда бывает полезно уметь аккуратно проверить ее наличие. Для этого можно использовать два традиционных подхода: графический анализ данных и формальные статистические тесты. 
Один из способов выявления гетероскедастичности при помощи графического анализа состоит в том, чтобы построить диаграммы рассеяния, в каждой из которых по оси ординат стоит зависимая переменная, а по оси абсцисс — один из регрессоров. Если, разглядывая подобную диаграмму, вы видите нечто похожее на рис. 2.3б из гл. 2, то у вас есть гетероскедастичность, связанная с соответствующим регрессором. Другой вариант − анализ графика остатков регрессии. Отсортируйте остатки по возрастанию какой-либо объясняющей переменной и постройте их график. Если разброс остатков вокруг нуля равномерен (как, например, на рис. 5.1), то можно заключить, что гетероскедастичность, связанная с этим регрессором, в данных отсутствует. Если же на графике остатков явно видно, что их разброс вокруг нуля зависит от значения регрессора (как, например, на рис. 5.2), значит, гетероскедастичность есть. 
Анализ графиков не всегда позволяет сделать однозначный вывод по поводу наличия или отсутствия гетероскедастичности, поэтому помимо него могут быть полезны соответствующие формальные статистические тесты. Ниже приводятся два наиболее часто используемых в настоящее время теста. 
Тест Бреуша — Пагана 
Тестируемая гипотеза в данном тесте состоит в том, что гетероскедастичности в модели нет: 
22
H : ˜ =…=˜
01 n . 

x 
Рис. 5.1. Поведение остатков регрессии свидетельствует о гомоскедастичности 

x 
Рис. 5.2. Поведение остатков регрессии свидетельствует о гетероскедастичности 
Альтернативная гипотеза заключается в том, что дисперсия случайной ошибки ˝i некоторым образом зависит от группы переменных: 
2 ()1 ()p
H : ˜ =° +° z +…+ ° z ,
1 i 01 i pi 
()1 ()2 ()p
где z , z , …, z — набор переменных, которые предположительно
ii i
влияют на дисперсию случайной ошибки. Обычно в качестве таких переменных берутся регрессоры из исходной модели, а также их квадраты. 
Процедура осуществления теста устроена так: сначала при помощи обычного МНК оценивается исходная модель (для которой мы хотим проверить отсутствие гетероскедастичности) и вычисляются соответствующие остатки ei . Далее вычисляется вспомогательное значение 
2
˜2 = 1 ˛ei . После этого необходимо оценить вспомогательное уравне
n 
ние, в котором справа стоят переменные, потенциально влияющие на дисперсию случайной ошибки: 
ei 2 ()1 ()p
=° +° z +…+ ° z + u .
2 01 i pii
˜ 
Далее вычисляется расчетное значение тестовой статистики по формуле: 
Îáúÿñíåííàÿ&#23;ñóììà&#23;êâàäðàòîâ&#23;âî&#23;âñïîìîãàòåëüíîì&#23;óðàâíåíèè 
. 
2 
Если верна нулевая гипотеза, то указанная статистика асимптотически имеет распределение Хи-квадрат с p степенями свободы. Поэтому, если расчетное значение больше критического значения, взятого из таблиц распределения &#15;2 с p степенями свободы для выбранного исследователем уровня значимости, то следует отвергнуть нулевую гипотезу и заключить, что в данных есть гетероскедастичность (необходимые таблицы доступны, например, в приложении к гл. 6). В противном случае можно сделать вывод в пользу гомоскедастичности. 
Тест Уайта 
Тестируемая гипотеза в данном тесте снова состоит в том, что гетероскедастичности в модели нет: 
22
H : ˜ =…=˜ .
01 n 
Альтернативная гипотеза состоит в том, что дисперсия случайной ошибки ˝i произвольным (возможно, нелинейным) образом зависит от переменных модели. 
Процедура теста устроена так: сначала при помощи обычного МНК оценивается исходная модель (для которой мы хотим проверить отсутствие гетероскедастичности) и вычисляются соответствующие остатки ei . После этого необходимо оценить вспомогательное уравнение, в котором слева стоит ei 2, а справа — константа, регрессоры исходного уравнения, их квадраты и попарные произведения1. 
Далее вычисляется расчетное значение тестовой статистики по следующей формуле: 
(R2 ˜âî˜âñïîìîãàòåëüíîì˜óðàâíåíèè)&#14; n. 
Если верна нулевая гипотеза, то указанная статистика асимптотически имеет распределение Хи-квадрат с p степенями свободы ( p — число регрессоров во вспомогательном уравнении). Поэтому, если расчетное значение больше критического значения, взятого из таблиц распределения &#15;2 с p степенями свободы для выбранного исследователем уровня значимости, то следует отвергнуть нулевую гипотезу и заключить, что в данных есть гетероскедастичность. В противном случае можно сделать вывод в пользу гомоскедастичности2. 
Окончить обсуждение вопроса выявления гетероскедастичности следует предостережением по поводу ложной гетероскедастичности. Ложной гетероскедастичностью называется ситуация, при которой формальные тесты указывают на наличие гетероскедастичности, однако в действительности дело вовсе не в ней, а в неверной спецификации уравнения. Хорошим примером может служить рис. 4.5б из гл. 4, на котором представлена нелинейная зависимость между парой переменных. Если при этом ошибочно оценить линейную регрессию (соответствующая прямая линия изображена на рисунке), то статистические тесты будут говорить в пользу гетероскедастичности, так как поведение остатков технически будет зависеть от значения регрессора (см. нижний график на этом же рисунке). Однако в действительности гетероскедастичности в модели нет, а есть только нелинейная связь между переменными. 
Важно различать истинную и ложную гетероскедастичность, так как они приводят к совершенно разным последствиям. Истинная гетероскедастичность не вызывает смещения оценок коэффициентов модели, в то время как ошибочная спецификация уравнения регрессии вызывает его, т.е. является гораздо более серьезной проблемой. 
1 Обратите внимание, что добавлять нужно только такие квадраты и попарные произведения, включение которых в модель не приводит к чистой мультиколлинеарности. Например, квадраты фиктивных переменных добавлять не стоит, так как они будут принимать в точности такие же значения, что и исходные переменные (02 = 0 и 12 = 1). 
2 В XX в. для выявления гетероскедастичности использовался широкий спектр альтернативных тестов: Голдфелда — Квандта, Спирмена, Глейзера и Парка. Они остались за рамками этой книги, поскольку в современных исследованиях применяются редко. 
Пример 5.3. Оценка эффективности использования 
удобрений (окончание) 
Для модели, оцененной в примере 5.1, осуществите тест Уайта, используя 5%-й уровень значимости. Интерпретируйте полученные результаты. 
Решение . 
Результаты оценки вспомогательного уравнения для осуществления теста Уайта представлены ниже. 
Тест Уайта на гетероскедастичность МНК, использованы наблюдения 1-200 Зависимая переменная: квадраты остатков регрессии, оцененной в примере 5.1 
Коэффициент Ст. ошибка t-статистика P-значение const -2270,16 5654,83 -0,4015 0,6886FUNG1 0,482935 108,468 0,004452 0,9965FUNG2 -150,789 95,3876 -1,581 0,1158GIRB 1,82902 98,0229 0,01866 0,9851INSEC 129,035 72,6436 1,776 0,0775 * LABOUR 2,05511 4,84800 0,4239 0,6722YDOB1 30,5354 43,6171 0,7001 0,4849YDOB2 3,43369 50,1279 0,06850 0,9455Квадрат_FUNG1 0,0956897 0,0549105 1,743 0,0833 * FUNG1*FUNG2 0,0294522 0,0492979 0,5974 0,5510FUNG1*GIRB -0,0332633 0,0480171 -0,6927 0,4895FUNG1*INSEC 0,0229300 0,0554156 0,4138 0,6796FUNG1*LABOUR -0,00259087 0,00348456 -0,7435 0,4582FUNG1*YDOB1 0,0104778 0,0246791 0,4246 0,6717FUNG1*YDOB2 -0,0536699 0,0501448 -1,070 0,2861Квадрат_FUNG2 0,0919819 0,0646201 1,423 0,1565FUNG2*GIRB -0,0931636 0,0529473 -1,760 0,0803 * FUNG2*INSEC -0,0878293 0,0548646 -1,601 0,1113FUNG2*LABOUR -0,00520969 0,00419928 -1,241 0,2165FUNG2*YDOB1 0,0829467 0,0471221 1,760 0,0802 * FUNG2*YDOB2 -0,0118900 0,0437395 -0,2718 0,7861Квадрат_GIRB -0,0598434 0,0581283 -1,030 0,3048GIRB*INSEC -0,0361947 0,0561232 -0,6449 0,5199GIRB*LABOUR 0,00279620 0,00413522 0,6762 0,4999GIRB*YDOB1 0,0287539 0,0384965 0,7469 0,4562GIRB*YDOB2 0,0537695 0,0489420 1,099 0,2735Квадрат_INSEC -0,0406052 0,0570708 -0,7115 0,4778INSEC*LABOUR -0,00562133 0,00477862 -1,176 0,2412INSEC*YDOB1 0,0367439 0,0296061 1,241 0,2163INSEC*YDOB2 -0,0599689 0,0474392 -1,264 0,2080Квадрат_LABOUR -0,000342326 0,000950427 -0,3602 0,7192LABOUR*YDOB1 -0,00130669 0,00215676 -0,6059 0,5454LABOUR*YDOB2 0,00492378 0,00240166 2,050 0,0419 ** Квадрат_YDOB1 -0,0176598 0,00913794 -1,933 0,0550 * YDOB1*YDOB2 -0,0352604 0,0255207 -1,382 0,1690Квадрат_YDOB2 0,0194422 0,0232499 0,8362 0,4042 
Неисправленный R-квадрат = 0,280856 
Тестовая статистика: n*R-квадрат = 56,171138, P-значение = P(Хи-квадрат(35) > 56,171138) = 0,013059 
В учебных целях мы привели оцененное уравнение полностью, хотя обычно в этом нет нужды, так как для осуществления теста достаточно знать только количество переменных в этом уравнении, его R-квадрат и число наблюдений. Обратите внимание, что число регрессоров тут действительно велико из-за добавления квадратов и попарных произведений переменных из исходного уравнения. 
В нашем случае P-значение для осуществляемого теста (представленное в самом низу таблицы с результатами) составляет 0,013. Это меньше, чем 0,05. Поэтому при уровне значимости 5% следует отвергнуть нулевую гипотезу данного теста. Напомним, что нулевая гипотеза теста Уайта состоит в том, что в модели нет гетероскедастичности. Следовательно, отвергая ее, мы должны заключить: в нашем случае в данных наблюдается гетероскедастичность. 

5 .5 . Обобщенная линейная модель и обобщенный МНК 
В предыдущих параграфах данной главы мы рассматривали случай отказа от одной предпосылки классической линейной модели множественной регрессии. Теперь мы расширим наш анализ и откажемся сразу от двух предпосылок: от предпосылок 4 и 5 (о постоянстве дисперсии случайной ошибки и о некоррелированности разных случайных ошибок между собой). В техническом смысле этот параграф несколько сложнее предыдущих (в частности, тут более широко используется линейная алгебра). Поэтому, если вы заинтересованы в том, чтобы разобраться только в прикладных аспектах множественной регрессии, а в соответствующих вычислениях готовы полностью довериться эконометрическому пакету, можете его пропустить. 
Отказ от указанных двух предпосылок означает, что ковариационная матрица вектора случайных ошибок (таблица, в которой записаны все ковариации между ˝i и ˝ j , см. § 3.3) больше не является диагональной матрицей с одинаковыми числами на главной диагонали, как это было в первоначальной классической модели. Теперь ковариационная матрица вектора случайных ошибок Ω — это произвольная ковариационная матрица (разумеется, так как это не совсем любая матрица, а именно ковариационная матрица, то по своим свойствам она является симметричной и положительно определенной). 
Модель, в которой сохранены только первые три предпосылки классической линейной модели множественной регрессии, называется обобщенной линейной моделью множественной регрессии. 
Проанализируем, к каким последствиям приводит отказ от предпосылок 4 и 5. 
Во-первых, полученная обычным методом наименьших квадратов оценка ˜^ = (XX˛ )−1 Xy˛  остается несмещенной (это свойство мы доказывали, опираясь лишь на первые три предпосылки). 
Во-вторых, МНК-оценки хоть и остаются несмещенными, но больше не являются эффективными. 
В-третьих, если мы оцениваем ковариационную матрицу вектора оценок коэффициентов (которая нужна для тестирования всевозмож
^^
ных гипотез), то оценка V () X ˛X )−12 смещена и больше не являет
˜=( S 
ся корректной. 
^
Чтобы убедиться в этом, подсчитаем ковариационную матрицу от ° в условиях обобщенной модели (при этом мы используем свойства ковариационной матрицы, перечисленные в § 3.3): 
^ ˙−1 ˇ˙ −1 ˇ
V () =V ( ˝ ) Xy ( ˝ ) X ˝ X ˜+ )
˜ XX ˝ ˘=VXX ( ° ˘= 
ˆˆ 
˛−1 ˙−1 −1
=V (( ° ) X °) (( ° ) °) ˘ (( ° ) X °)°=
XX ˘ˆ = XX XV ˛˝ ˙ˆ XX
˝ 
−1 −1 −1 −1
= (XX° ) X °˝((XX° ) X °)°= (XX° ) X °˝X (XX° ). 
Так выглядит ковариационная матрица вектора МНК-оценок в обобщенной модели. Ясно, что она не может быть корректно оценена 
12
стандартной оценкой (XX˜ )− S . Следовательно, прежней формулой пользоваться нельзя: если мы будем использовать стандартные ошибки, рассчитанные по обычной формуле (предполагая выполнение предпосылок классической линейной модели), то получим некорректные стандартные ошибки, что может привести нас к неверным выводам по поводу значимости или незначимости тех или иных регрессоров. 
Таким образом, последствия перехода к обобщенной модели аналогичны тем, что мы наблюдали для случая гетероскедастичности. Это неудивительно, так как гетероскедастичность — частный случай обобщенной линейной модели. 
Поэтому для получения эффективных оценок обычный МНК не подойдет и придется воспользоваться альтернативным методом — обобщенным МНК (ОМНК, generalized least squares, GLS). Формулу для расчета оценок коэффициентов при помощи ОМНК позволяет получить специальная теорема. 
Теорема Айткена 
Если: 
1) модель линейна по параметрам и правильно специфицирована 
yX +;
= ˛˝ 
2) матрица Х — детерминированная матрица, имеющая максимальный ранг k;
 
3) E()˜=0; 
4) V ()˜=˛ — произвольная положительно определенная и симметричная матрица, то оценка вектора коэффициентов модели 
^ −1 −1 −1
˜* = (X ˛˙ X ) X ˛˙ y является: 
•	 
несмещенной 

•	 
и эффективной, т.е. имеет наименьшую ковариационную матрицу в классе всех несмещенных и линейных по y оценок. 


Предпосылки теоремы Айткена — это предпосылки обобщенной линейной модели множественной регрессии. Из них первые три — стандартные, как в классической модели, а четвертая ничего особого не требует (у вектора случайных ошибок может быть любая ковариационная матрица без каких-либо дополнительных специальных ограничений). Сама теорема Айткена является аналогом теоремы Гаусса — Маркова для случая обобщенной модели. 
Докажем эту теорему. 
Из линейной алгебры известно: если матрица  симметрична и положительно определена, то существует такая матрица P, что 
−1 −1 −1
˜°=ˆ˝P ˜=ˆ°P .
PP 
А раз такое представление возможно, то воспользуемся им для замены переменных. От вектора значений зависимой переменной у перейдем к вектору (Py), обозначив его как вектор y =°y. Аналогичным
&#14; * P образом введем матрицу X * =°P и вектор ошибок ˜* =˛
XP ˜. 
Вернемся к исходной модели, параметры которой нас интересуют: 
yX +.
=˛˝ 
Умножим левую и правую части равенства на матрицу P : 
Py = PX ˛+ P˝. 
С учетом новых обозначений это равенство можно записать так: 
y* =X *˛˝*.
+ 
Для новой модели (со звездочками) выполняются предпосылки теоремы Гаусса − Маркова. Чтобы в этом убедиться, достаточно показать, что математическое ожидание вектора случайных ошибок является нулевым вектором (третья предпосылка классической модели), а ковариационная матрица вектора случайных ошибок − диагональной с одинаковыми элементами на главной диагонали (четвертая и пятая предпосылки). 
Для этого вычислим математическое ожидание нового вектора ошибок: 
 
E()˜* =EP˜=P ˛E() =P ˛=
() ˜ 00. 
Теперь вычислим ковариационную матрицу вектора ˝*: 
* −1 ˛−1
V () =V (P ˜) PV () P ˝P ˆP ˝P ˆˆ P
˜ ˛=˛˜˛ =˛˛ =˛˛ =I ,
n 
где I обозначает единичную матрицу размером n на n. 
n
Следовательно, для модели со звездочками выполняются все предпосылки теоремы Гаусса — Маркова. Поэтому получить несмещенную и эффективную оценку вектора коэффициентов можно, применив к этой измененной модели обычный МНК: 
^* ** − *
˜= (XX˛ )1 Xy˛ *. 
Теперь осталось вернуться к исходным обозначениям, чтобы получить формулу несмещенной и эффективной оценки интересующего нас вектора в терминах обобщенной модели: 
^* ** −1* −1 −1
˛ * ˛˛ ) XP Py˛˛
˜=(XX ) Xy˛=((PX )˛PX )(PX )˛Py =(XP PX = 
−1 −1 −1 −1 −1 −1 −1 −1
= (X °˝ P PX ) X °˝ P Py = (X °˝ X ) X °˝ y. 
Что и требовалось доказать. 
Взвешенный МНК, который мы обсуждали ранее, — это частный вариант обобщенного МНК (для случая, когда только предпосылка 4 нарушена, а предпосылка 5 сохраняется). 
Как и при использовании взвешенного МНК, в ситуации применения ОМНК коэффициент R-квадрат не обязан лежать между нулем и единицей и не может быть интерпретирован стандартным образом. 
Слабая сторона ОМНК состоит в том, что для его реализации нужно знать не только матрицу регрессоров X с вектором значений зависимой переменной y, но и ковариационную матрицу вектора случайных ошибок . На практике, однако, эта матрица почти никогда не известна. Поэтому в прикладных исследованиях практически всегда вместо ОМНК используется так называемый доступный ОМНК (его еще называют практически реализуемый ОМНК, или feasible GLS). Идея доступного ОМНК состоит в том, что следует сначала оценить матрицу 
(традиционно обозначим ее оценку ^ ), а уже затем получить оценку вектора коэффициентов модели, заменив в формуле ОМНК на ^ : 
−1 −1
^* ^ −1^
˜= (X ˛˙ X ) X ˛˙ y. 
^
Применение этого подхода осложняется тем, что не может быть оценена непосредственно без дополнительных предпосылок, так как в ней слишком много неизвестных элементов. Действительно, в матрице размером n на n всего n2 элементов, и оценить их все, имея всего n наблюдений, представляется слишком амбициозной задачей. Даже если воспользоваться тем, что матрица  является симметричной, в результате чего достаточно оценить только элементы на главной диагонали и над ней, мы все равно столкнемся с необходимостью оценивать (n +1)n / 2 элементов, что всегда больше числа доступных нам наблюдений. 
Поэтому процедура доступного ОМНК устроена так: 
1. Делаются некоторые предпосылки по поводу того, как устроена 
ковариационная матрица вектора случайных ошибок . На ос^ 
нове этих предпосылок оценивается матрица . ^ −1 − ^ −1
2. После этого по формуле (X ˜˛ X )1X ˜˛ y вычисляется вектор оценок коэффициентов модели. 
Из сказанного следует, что доступный ОМНК может быть реализован только в ситуации, когда есть разумные основания сформулировать 
^
те или иные предпосылки по поводу матрицы . Рассмотрим некоторые примеры таких ситуаций. 
Пример 5.4. Автокорреляция и ОМНК-оценка 
Рассмотрим линейную модель yX +, для которой дисперсия
=˛˝ случайных ошибок постоянна, однако наблюдается так называемая автокорреляция первого порядка: 
˜=˝°˜ ,
ii−1 +ui 
где ui — независимые и одинаково распределенные случайные величины с дисперсией ˘2; ˜° −(, ) — коэффициент автокорреляции.
11 
u 
а . Найдите ковариационную матрицу вектора случайных ошибок для представленной модели. 
б . Запишите в явном виде формулу ОМНК-оценки вектора коэффициентов модели, предполагая, что коэффициент известен. 
Примечание: в отличие от гетероскедастичности автокорреляция случайных ошибок обычно наблюдается не в пространственных данных, а во временных рядах. Для временных рядов вполне естественна подобная связь будущих случайных ошибок с предыдущими их значениями. 
Решение . 
а . Используя условие о постоянстве дисперсии случайной ошибки, т.е. условие var() = var(˜
˜ ) , найдем эту дисперсию:
ii−1 
var(˜ )var(°˝˜ + ui ; var(˜ ) =° var(˜ ) + var(ui 
= )2 );
ii−1 ii−1 
2
° var(˜ ) =° ˜+˛2; var(˜ ) =
2var() u .
i iui 2
1−˛ 
Таким образом, мы нашли элементы, которые будут стоять на главной диагонали ковариационной матрицы вектора случайных ошибок. Теперь найдем элементы, которые будут находиться непосредственно на соседних с главной диагональю клетках: 
cov(˜˜ )cov(°˜˙ +u , ˜ ) =°˙cov(˜ , ˜+ u ,
, = )cov( ˜ ) = 
ii−1 i −1 ii−1 i−1 i −1 ii−1 
2
ˇ =°var(ˆ ) +=° .
˙ 0 ˙ u 
i−12
1−˙ 
По аналогии легко убедиться, что 
2
˛ k° 
ku 2
cov(˜˜ ) =°ˆ =˛ˆ .
,
ii−k 2 u 2
1 −° 1 −° 
Следовательно, ковариационная матрица вектора случайных ошибок имеет вид: 
n−2 n−1
ˇ 1 ˆ ˆˆ&#22; 
…
&#23;&#20;
ˆ 1 n−3 n−2
ˆˆ
2 &#23;&#20;˙ u &#23;&#20;
˜= ……… .
2 &#23;&#20;1−ˆ 
n−2 n−3
&#23;ˆ ˆ 1 ˆ&#20; &#23;&#20;
n−1 n−2 … 
˘ˆˆ ˆ 1 &#21; 
^* −1 −1 −1
˜= (X ˛˙ X ) X ˛˙ y = 
ˆ 1  ˙  n−2˙  1− n−1˙ &#23;  
˘ ˘  ˙  1  …  n−3˙  &#21;n−2˙ &#21;  
×  ˘X ° …˘ n−2 n−3˘˙ ˙  …  1  …  &#21; &#21; ˙ &#21;  .y  
˘ −n 1ˇ ˙  −n 2˙  …  ˙  1  &#21; &#22;  
2˜  

u
Обратите внимание, что дробь 2 при расчете представленной 
1−° оценки сокращается. Поэтому для вычисления оценки знать величину ˘2 не нужно. 
u 
Примечание: если коэффициент автокорреляции неизвестен, то его можно легко оценить. Например, для этого можно применить обычный МНК к исходной регрессии, получить вектор остатков и оценить 
^^ ^
регрессию ei =°˝ei−1. Полученной оценки достаточно, чтобы вычислить ОМНК-оценку вектора параметров модели. Тем самым в представленном примере для применения доступного ОМНК достаточно оценить всего один параметр ковариационной матрицы вектора оценок коэффициентов. 
Пример 5.5. Гетероскедастичность и ОМНК-оценка 
=˛˝
Рассмотрим линейную модель yX +, для которой выполнены все предпосылки классической линейной модели множественной регрессии за одним исключением: дисперсия случайной ошибки прямо пропорциональна квадрату некоторой известной переменной 
var(˜ ) =°2 =°22 > 0.
ii 0zi 
−1−1 
−2 
X 
X 
−1 
−2 
−1 
n 
n 
&#23; 
× 
&#21;&#21;&#21;&#21;&#21;&#21;&#21;
&#22; 
&#23;
n
˙
−2
n
˙
˙
1
ˆ 
&#21;&#21;&#21;&#21;&#21;&#21;
&#22; 
n
˙
−3
n
˙ 
… 
……… 
˙
−3 
1
n
˙
˙ 
1
˙…
−2
n
˙
˙ 
1
˙
˘˘˘˘˘˘
ˇ 
ˆ 
° 
˘˘˘˘˘˘˘ 
= 
ˇ 
а . Найдите ковариационную матрицу вектора случайных ошибок для представленной модели. 
б . Запишите в явном виде формулу ОМНК-оценки вектора коэффициентов модели. 
Решение . 
а . Так как в этом случае нарушена только четвертая предпосылка классической линейной модели множественной регрессии, то вне главной диагонали ковариационной матрицы вектора случайных ошибок будут стоять нули: 
˝
˘
22 
0
1
ˇ
0
z
…
0
ˆˆˆ 
&#22;&#22;&#22;&#22;&#22;&#23; 
22 
0 
… 
0
ˇ
z
…… 
0 
2
˜= 
. 
ˆˆ˙ 
…… 
22
00
ˇ
z
0 n 
… 
б . Обратите внимание, что при подстановке в общую формулу для ОМНК-оценки величина ˘02 сокращается, следовательно, для оценки вектора коэффициентов знать ее не нужно: 
^* −1 −1 −1
˜= (X ˛˙ X ) X ˛˙ y = 
−1
˝−1 ˇ−1
˝2 ˇ˝2 ˇ
z 0 …0 z 0 …0
ˆ 1 &#23; 1
ˆ &#23;ˆ &#23;
ˆ 0 z2 …0 &#23; 0 z2 …0
ˆ &#23;ˆ &#23; 
=ˆX ° 2 X &#23; X ° 2 y.
ˆ &#23;ˆ &#23;
ˆ ………… &#23; …………
ˆ &#23;ˆ &#23;
ˆ&#23;
ˆ00 …z2 &#23;ˆ00 …z2 &#23;
ˆ˙ ˘&#23;˙ ˘
nn
˙˘ 
*** 
Еще одна важная ситуация, когда с успехом может быть применен доступный ОМНК, — это модель со случайными эффектами, которую мы рассмотрим в главе, посвященной панельным данным. 
Задания для самостоятельного решения 
Задание 1 . Исследователь при помощи МНК оценил коэффициенты в следующем уравнении регрессии: 
()1 ()2 ()3
y =˝+˝ ˛ x +˝ ˛ x +˝ ˛ x +˙ .
i 12 i 3 i 4 ii 
Число наблюдений равно 180. После этого он решил провести тест Уайта (с перекрестными эффектами) на гетероскедастичность. 
а . Запишите в явном виде уравнение регрессии, которое должен оценить исследователь. 
б . Пусть в уравнении, которое вы записали в предыдущем пункте, коэффициент детерминации оказался равен 0,45. Закончите проведение теста. Сделайте соответствующий вывод. 
Задание 2 . Рассматривается модель y =˝+˝ ˛ x +˙ , для которой
i 12 ii
выполнены все предпосылки классической линейной модели множественной регрессии, за одним исключением: в модели присутствует гетероскедастичность. Известна ее функциональная форма: 
2 22
˜i = cx˛ i . 
Y  1,00  1,00  1,50  1,50  1,00 
 X  1,00  1,00  0,50  0,50  0,25  

а . Покажите, что если от исходной модели перейти к взвешенной: 
y 
1
i =˝˛ +˝+ u ,
12 i
xx
ii 
то в этой новой модели гетероскедастичность будет отсутствовать. 
б . Используя данные таблицы, вычислите оценки взвешенного метода наименьших квадратов параметров ° 1 и ° 2. 
Задание 3 . Исходные данные для этого задания содержатся в файле Training. 
Руководство крупной торговой сети планирует выяснить, помогает ли тренинг по продажам увеличить эффективность работы менеджеров по продажам. 
Для решения этой задачи вы располагаете следующими данными: 
sales — объем продаж данного менеджера (в тысячах рублей за период); 
training — фиктивная переменная, равная единице, если в самом начале данного периода менеджер прошел тренинг по продажам (работники, которые направлялись на курсы, выбирались из общей совокупности работников компании при помощи специальной лотереи); 
female — фиктивная переменная, равная единице для менеджеровженщин и нулю для мужчин; 
experience — опыт работы менеджера в годах; 
capital — фиктивная переменная, равная единице, если менеджер работает в столичном отделении компании, и равная нулю в противном случае; IQ — все менеджеры при приеме на работу в данную компанию проходят IQ-тест, эта переменная характеризует результаты менеджера. 
а . Оцените регрессию переменной sales на переменные training, female, experience, capital и IQ. В этом и последующих пунктах не забудьте использовать состоятельные в условиях гетероскедастичности стандартные ошибки. 
Значимо ли уравнение в целом (при уровне значимости 5%)? Какие из переменных являются значимыми (при уровне значимости 5%)? Дайте содержательную интерпретацию коэффициента при переменной training. 
б . Оцените модель заново, исключив из нее переменную capital и добавив переменную training × capital. Дайте содержательную интерпретацию коэффициента при добавленной переменной, а также коэффициента при переменной training в новой модели. 
в . Для каждой из моделей, оцененных в пунктах (а−б), осуществите тесты Уайта и Бреуша — Пагана на гетероскедастичность. Интерпретируйте их результаты. 
Задание 4 . Решите все пункты предыдущего задания, используя в качестве зависимой переменной логарифм переменной sales. 
Как поменяется интерпретация коэффициентов при переменных training и training × capital? 
Сравните результаты тестов на гетероскедастичность в новой модели с предыдущей. 
Задание 5 . Это продолжение примеров 5.1−5.3. Напомним, что данные для этого примера содержатся в файле Agriculture, а их описание — в примере 5.1 в данной главе. 
В этом задании вам предлагается попробовать применить альтернативный способ устранения гетероскедастичности. 
а . Для оценки коэффициентов уравнения из примера 5.1 воспользуйтесь взвешенным МНК, предположив, что дисперсия случайной ошибки пропорциональна квадрату переменной LABOUR. Осуществите эту процедуру, самостоятельно создав в эконометрическом пакете новые переменные и оценив уравнение с их участием. Запишите его в стандартной форме, указав коэффициент детерминации и (в скобках под соответствующими коэффициентами) стандартные ошибки. 
б . Покажите, как можно интерпретировать коэффициенты в новой модели. Например, объясните, на сколько тысяч рублей (при прочих равных условиях) увеличивается урожайность при увеличении трудозатрат на 1 руб. 
в . Для полученного уравнения проведите тест Уайта. Удалось ли устранить гетероскедастичность? 
Задание 6 . Рассмотрим уравнение регрессии yi=+i, i=…,.n
˛˝ 1, 
Пусть ошибки регрессии удовлетворяют следующим условиям: 
E()˜= 0 E˜˜ ) =˜ ,(˙2) =ˆ2 ˝ x, x
,( 0 при i jE > 0.
i ij iii 
а . Вспомните оценку обычного метода наименьших квадратов 
^
° ÌÍÊ для этой модели. Вычислите ее дисперсию (обратите внимание, что раньше вы вычисляли эту дисперсию в условиях гомоскедастичности, а теперь вам нужно сделать это в условиях гетероскедастичности). 
б . Найдите оценку взвешенного метода наименьших квадратов. Покажите, что она является несмещенной. Вычислите ее дисперсию. 
в . Сравните дисперсии оценок, полученные в пунктах (а) и (б). Интерпретируйте результат. 
Задание 7 . Рассмотрим уравнение регрессии 
y=°˝x+˙,
i ii 
1, nгде i=…,. Пусть ошибки регрессии удовлетворяют следующим условиям: 
n 
˙2 22
E()˜= 0 E˜˜ ) = 0 при i jE ) = a˛ x, x= n
i ,( ij ˜ ,( ii ˝ i . i=1 
а . Вспомните оценку обычного метода наименьших квадратов 
^
° ÌÍÊ для этой модели. Вычислите ее дисперсию в случае перечисленных в задании предпосылок. б . Найдите оценку взвешенного метода наименьших квадратов. Покажите, что она является несмещенной. Вычислите ее дисперсию. в . Сравните дисперсии оценок, полученные в пунктах (а) и (б). Интерпретируйте результат. Задание 8 . Рассматривается модель регрессии 
y=˛x+˝ ,
i ii 
где ˝i— независимые случайные величины с нулевым математическим 2 05,
ожиданием и дисперсией V()i =° xi . В вашем распоряжении име
˜ 0 ˝ ется выборка из nнаблюдений (, ), > , i=1 …,.n
xy x 0,
ii i
Используя взвешенный метод наименьших квадратов, найдите эф
^
фективную оценку параметра &#23;. (Задайте оценку &#23; как функцию от исходных данных (,ii), =…,, n
xy i1 .) 
Задание 9 . Рассматривается модель регрессии 
y=˛x+˝ ,
i ii 
где ˝i— независимые случайные величины с нулевым математическим ожиданием и дисперсией V()˜ =° 02 ˝ z. В вашем распоряжении имеет
ii ся выборка из nнаблюдений (,xyz z> , i=1 …,
,), 0 , n.
iii i
Используя взвешенный метод наименьших квадратов, найдите эф
^
фективную оценку параметра °. (Задайте оценку ° как функцию от исходных данных (, , 1, n
xyz), i=…,.)
iii 
Задание 10 . Для обобщенной линейной модели множественной регрессии вычислите ковариационную матрицу вектора ОМНК-оценок коэффициентов. 


ГЛАВА 6 
МОДЕЛЬ СО СТОХАСТИЧЕСКИМИ РЕГРЕССОРАМИ И АСИМПТОТИЧЕСКИЙ ПОДХОД В ЭКОНОМЕТРИКЕ 
До этой главы мы предполагали, что объясняющие переменные в нашем уравнении являются детерминированными, а также опирались на свойства регрессоров для конечных выборок. Указанный подход удобен в рамках первого знакомства с эконометрическими моделями, однако имеет ряд ограничений. В современных прикладных исследованиях чаще используется асимптотический подход, который заключается в том, чтобы концентрироваться на асимптотических свойствах исследуемых объектов, а не на их свойствах для конечных выборок. 
Напомним, что асимптотические свойства (оценок параметров, тестовых статистик и доверительных интервалов) — это свойства при увеличении выборки до бесконечности. Формально это свойства, которые мы наблюдаем в пределе, при n ˜°. 
В реальном мире размер выборки, разумеется, всегда конечен. Однако всетаки есть серьезные причины популярности применения асимптотического подхода. Далее перечислены три из них (в порядке убывания важности): 
1 . Реалистичность предпосылок. Как мы увидим в этой главе, асимптотический подход позволит ослабить некоторые предпосылки наших эконометрических моделей, что сделает их максимально близкими к реальности. 
2 . Техническая простота. Асимптотические свойства эконометрических объектов часто оказываются проще, чем свойства для конечных выборок. 
3 . Увеличение доступности данных . В современном мире данные становятся все более доступными, и эконометристам чаще удается работать с действительно большими их массивами, которые позволяют быть уверенными, что применение асимптотических свойств вполне уместно1. 

1 Для обозначения особенно огромных массивов часто используется набравший популярность термин «большие данные» (big data). 
Все это делает данную главу одной из ключевых с точки зрения понимания современного взгляда на эконометрические исследования. 
Для освоения нового подхода нам потребуется вспомнить ряд важных определений и результатов из математической статистики. Этому посвящен первый параграф главы. Во втором параграфе мы сформулируем предпосылки новой модели со стохастическими регрессорами и обсудим, что делает их более реалистичными, чем предпосылки КЛММР. 
Третий и четвертый параграфы содержат несколько доказательств свойств МНК-оценок в рамках применения нового подхода. Это «технические» параграфы, и, если вы не заинтересованы в формальных доказательствах, используемых в главе фактов, их можно пропустить. 
Пятый параграф, напротив, важен прежде всего с прикладной точки зрения: в нем обсуждаются особенности тестирования гипотез и построения доверительных интервалов в рамках асимптотического подхода. 
6 .1 . Некоторые важные результаты математической статистики 
Этот раздел, разумеется, не претендует на то, чтобы заменить собой учебник по теории вероятностей и математической статистике, и мы не будем вспоминать здесь все используемые в эконометрике факты из этих наук. Однако последующие разделы учебника будут восприниматься легче, если перед непосредственным знакомством с ними вы освежите в памяти некоторые ключевые результаты, касающиеся асимптотической теории. 
Сходимость по вероятности . Рассмотрим последовательность случайных величин XX, …, X
,, …
12 nЕсли для любого ˜>0 вероятность события 
Xa
−>˛стремится к 
n нулю при n˜°, то говорят, что число a— это предел по вероятности 
для последовательности XX, …, X
,, …
12 n
Для предела по вероятности обычно используют обозначение X ˜°a = . Также в этом случае говорят, что последо
p˜ , или plim Xa 
nn
вательность сходится по вероятности к числу a. 
Состоятельность . Оценка параметра называется состоятельной, если ее предел по вероятности равен истинному значению оцениваемого па
^ p
раметра: ˜°˛˜
° . 
Проще говоря, если оценка параметра состоятельна, то все, что вам нужно, чтобы узнать его истинное значение, — собрать достаточно большую выборку. Поэтому эконометристы очень любят состоятельные оценки в сочетании с большими массивами данных. 
Достаточное условие состоятельности . Если оценка параметра является несмещенной (или асимптотически несмещенной) и ее дисперсия стремится к нулю при n ˜°, то эта оценка состоятельна. 
Пример 6.1. Регрессия на константу 
Рассмотрим модель регрессии на константу: 
yi =+i , i =,, …
˝˙ 12 , n. 
Пусть для нее выполнены все предпосылки классической линейной модели множественной регрессии. Докажите, что МНК-оценка параметра &#19; является состоятельной. 
Решение . 
^ 
МНК-оценка параметра &#19; может быть вычислена по формуле: ˜= y (см. задание 9 в гл. 2). 
Она является несмещенной: 
˝ n ˇ˝ n ˇ n
&#21;y (˜°) n +&#21;E()
&#21;+˜ ° 
^ ˆ i=1 i &#23;ˆ i=1 i &#23; i=1 i
E()˜=E =E = =˜.
ˆ n &#23;ˆ n &#23; n
ˆ&#23;ˆ &#23;
˙˘˙ ˘ 
Ее дисперсия равна: 
˛ n ˆ˙ n ˘˛ n ˆ
+)2
^ ˇ&#21;i=1(˜°i &#22; ˙&#22;i=1&#20;i ˘ var ˝˙&#22;i=1&#20;i ˇ˘ n &#23;&#19; &#19;2 
var(˜)var var &#21;+= =
== = .
ˇ n &#22;˙ n ˘ 22 n
ˇ &#22;˙˘ nn
ˆ &#23;˝ˇ 
Таким образом, МНК-оценка коэффициента является несмещенной, а при n ˜° ее дисперсия стремится к нулю. Поэтому выполнено достаточное условие состоятельности. 
Закон больших чисел в форме Чебышева . Если YY , …, Y
,, … — не
12 n 
зависимые и одинаково распределенные случайные величины, причем EY()i =µ, var(Yi ) <°, то Yp˜µ
˜° . 
Иными словами, для последовательности независимых и одинаково распределенных величин с конечной дисперсией среднее значение будет состоятельной оценкой математического ожидания. 
Неравенство Коши — Буняковского . Это неравенство является достаточно общим результатом, однако нам в рамках данной главы будет достаточно его частного случая для математических ожиданий. 
Пусть &#22; и — случайные величины, для которых определены конечные вторые моменты распределения. Тогда 
E 
E()˜2 ˛E °
˜°˛˝ 
()2. 
Замечание . Не удивляйтесь тому, что в англоязычной эконометрической литературе вы такого названия неравенства не встретите. Там этот результат принято называть неравенством Коши — Шварца (Cauchy− Schwarz inequality). 
Сходимость по распределению . Последовательность случайных величин XX , …, X
,, … сходится по распределению к случайной вели
12 n чине &#22;, если 
lim{ < x} = P ˙< x}
PX { n˜° n 
для всех точек, где функция Fx() = P{˛< x} непрерывна. d
Обозначение сходимости по распределению: X ˜° .
˜˛ 
n
Обратите внимание на важное отличие сходимости по вероятности от сходимости по распределению. В первом случае речь идет о том, что последовательность сходится к некоторой (неслучайной) константе, а во втором — к случайной величине. 
Сходимость по распределению главным образом понадобится нам для использования центральной предельной теоремы. 
Центральная предельная теорема (ЦПТ) . Если Y …, Y , … — неза
1, 
n
висимые и одинаково распределенные случайные величины, причем 
EY()i =µ, var(Yi ) =˝2 <˛, то 
nY( −µ) d

°N (, ). (6.1)
°˛ 01˙ 
Выражение (6.1) иногда записывают в одном из эквивалентных вариантов. 
°2 
Во-первых, напомним (см. пример 6.1), что var(Y ) = . Тогда, обо
n значив var(Y ) =°2 , можно переписать (6.1) вот так:
Y 
(Y −µ) d
°N (, ). 
°˛ 01 
˙
Y 
В этом случае говорят, что распределение Y является асимптотиче˘2 
ски нормальным с математическим ожиданием µ и дисперсией . 
n 
nY( −µ)
Во-вторых, если случайную величину 
 домножить на ко
˛ 
эффициент ˘, то ее дисперсия увеличится в ˘2 раз (по свойству дисперсии). Следовательно, выражение (6.1) эквивалентно следующему утверждению: 
2

nY( −µ) °d°˛N (,0 ˙ ). 
Центральная предельная теорема дает уверенность в том, что при указанных предпосылках и достаточно большой выборке среднее значение будет иметь приблизительно нормальное распределение. Причем для этого не требуется, чтобы отдельные случайные величины 
Y …, Y , … сами имели нормальное распределение. Они могут быть
1, 
n 
распределены как угодно, лишь бы имели конечную дисперсию. 
Для эконометристов этот результат важен, так как во многих ситуациях гарантирует асимптотическую нормальность оценок коэффициентов, что позволяет легко тестировать гипотезы и вообще упрощает работу, так как свойства нормального распределения изучены очень хорошо. 
Теорема Слуцкого (теорема Манна — Вальда) . Если: 
p
1) X ˜°a (т.е. последовательность случайных величин
˜ 
n XX , …, X
,, … сходится по вероятности к константе a);
12 n 
2) функция gx() непрерывна в точке a и некоторой ее окрестности, то gX ) p˜ ga
( ˜° (). 
n 
Пример 6.2. Регрессия на константу (продолжение) 
Вернемся к примеру 6.1. Вычислите предел по вероятности для &#19;^2. 
Решение . 
Так как gx x2 — это непрерывная функция, и ˜^ =˛p˝, то по
() = y ˛˜ ^2 p 2
только что сформулированной теореме получаем, что ˜ °˛˜
° . Замечание 1 . Эта теорема верна и в случае, когда X — это случай
n ный вектор, и в случае, когда a — это вектор констант. Замечание 2 . Эта теорема называется теоремой Слуцкого только в русскоязычной традиции. Если обратиться к англоязычным учебникам 
по статистике и эконометрике, то там она называется теоремой Манна — Вальда (Mann–Wald theorem) или даже теоремой о непрерывном отображении (continuous mapping theorem). А теоремой Слуцкого там называется приведенный ниже результат. 
Теорема Слуцкого . Если: 
p˜a XX ,
1) X ˜° (т.е. последовательность случайных величин ,
n 12 …, X , … сходится по вероятности к константе a);
n 
˜° ,
2) Yd˜˛ (т.е. последовательность случайных величин YY ,
n 12 …, Y , … сходится по распределению к случайной величи
n 
не &#22;); 
то 
d
X +Y °
°˛a +˝;
nn 
XY d˛a ˝;
˜ °°˜ 
nn 
Y 
˛
nd
˜° .
˜ 
Xa 
n 
Для последнего соотношения также требуется, чтобы случайная величина X не равнялась нулю с единичной вероятностью.
n 
Обратите внимание: чтобы указанные соотношения выполнялись, каждый из пределов в отдельности должен существовать. 
Обе сформулированные теоремы пригодятся нам в дальнейшем. Для определенности в контексте доказательств в данной главе договоримся, что, когда мы ссылаемся на теорему Слуцкого, мы подразумеваем последний из двух вариантов. 

6 .2 . Линейная регрессионная модель со стохастическими регрессорами 
Сформулируем новый набор предпосылок, который будем называть предпосылками линейной модели со стохастическими регрессорами. Начнем с модели парной регрессии. 
Предпосылки линейной модели со стохастическим регрессором (случай парной регрессии): 
1. Модель линейна по параметрам и правильно специфицирована: 
y =˝ +˝ x +˙ , i =12 … , n.
,,
i 12 ii 
2. 
Наблюдения {(,xy 1, n

ii ), i =…, } независимы и одинаково распределены. 

3. 
xi и yi имеют ненулевые конечные четвертые моменты распределения 


4 <° ()4
Ex()i , Eyi <°. 
4. Случайные ошибки имеют нулевое условное математическое ожидание при заданном x : E(˜ | x ) = 0.
i ii 
Сравним предпосылки этой модели с предпосылками классической линейной модели парной регрессии (КЛМПР) из гл. 2. 
Первая предпосылка стандартна и остается без изменений. 
Вторая предпосылка в КЛМПР требовала, чтобы регрессоры были неслучайными величинами. Теперь мы отказываемся от нее, допуская, что объясняющие переменные могут быть случайными. При этом мы требуем, чтобы наблюдения { ii ), i =…, } были независимыми
(, , n
xy 1 и одинаково распределенными (independent and identically distributed, i.i.d.). 
Это требование вовсе не означает, что yi не зависит от xi (ясно, что в данном случае анализировать модель их взаимосвязи было бы бессмысленно). Зато оно говорит о том, что векторы (x1, y1), (x2, y2), (x3, y3), ... независимы друг от друга в вероятностном смысле. Иными словами, отдельные наблюдения в нашей модели не оказывают взаимного влияния. 
Для пространственных данных эта предпосылка практически всегда выполняется1. В то же время следует помнить, что при работе с временными рядами данная предпосылка часто нарушается, так как для временных рядов естественно предполагать, что будущие значения переменных зависят от прошлых2. Поскольку пока мы в основном концентрируемся на пространственных данных, для нас она остается весьма реалистичной. 
1 Исключение составляет специфический класс моделей пространственной автокорреляции, которые обычно рассматриваются отдельно. 
2 Пример такой ситуации приведен далее в лирическом отступлении о неслучайных и случайных регрессорах. 
Лирическое отступление о неслучайных и случайных регрессорах 
Отвлечемся ненадолго от технических деталей и обратимся к вопросу: как следует думать об объясняющих переменных с содержательной точки зрения? Следует ли считать их скорее детерминированными величинами или скорее случайными? 
Ответ, разумеется, зависит от того, с какими данными вы работаете и какова процедура их сбора. 
Представим, например, что вы анализируете зависимость логарифма 
реального ВВП от номера года, т.е. оцениваете параметры линии тренда 
для временного ряда: 
ln y =˝+˝ ˛t +˙ ,
t 12 t 
где yt — ВВП в год t. В данном примере регрессор (номер года t) вполне естественно считать неслучайным (детерминированным). Действительно, мы точно знаем, что в принятой нами системе летоисчисления за 2020 г. последует 2021 г., а затем наступит 2022 г. Никакой случайности тут нет. 
Теперь представим, что вас интересуют параметры следующей модели для инфляции: 
˜=°+°˜ +°x +˛,
t 12 t −12 tt 
где πt — уровень инфляции в год t; xt — например, отклонение фактического ВВП от потенциального ВВП в год t1. Обратите внимание: здесь предполагается, что инфляция в текущем периоде зависит от инфляции в прошлом периоде. Однако инфляция прошлого периода πt–1, в свою очередь, зависит от εt–1, а значит, уж точно является случайной величиной. Следовательно, в данном примере по крайней мере один из регрессоров (переменная πt–1) заведомо является случайным (стохастическим). 
В двух приведенных примерах детерминированная или стохастическая природа объясняющих переменных может быть определена однозначно из соображений здравого смысла. В то же время во многих ситуациях решение о том, воспринимать ли регрессоры как неслучайные величины или как случайные — это исключительно вопрос технического удобства. В частности, при использовании асимптотического подхода второй вариант более удобен, поэтому в современных эконометрических приложениях по умолчанию используют его. 
1 Макроэкономист узнает в такой спецификации одну из возможных версий современной кривой Филлипса с адаптивными инфляционными ожиданиями. Однако даже человек, незнакомый с макроэкономическими моделями, наверняка согласится с тем, что если инфляция была высока в прошлом месяце, то и в этом она тоже наверняка будет высокой. Иными словами, текущая инфляция зависит от своих прошлых значений, что и отражено в данной модели. 
Третья предпосылка выглядит достаточно устрашающе, но в действительности никак не ограничивает исследователя. По существу, она означает, что очень большие выбросы в данных маловероятны. Это техническая предпосылка, которая, как мы увидим в дальнейшем, позволяет гарантировать асимптотическую нормальность оценок коэффициентов. Это даст нам возможность тестировать гипотезы и строить доверительные интервалы. 
Проверить эту предпосылку сложно, однако она достаточно слабая, и потому на практике обычно считают, что она выполнена. Во всяком случае, легко согласиться с тем, что она выполняется гораздо чаще, чем предпосылка 6 КЛМПР о нормальности случайных ошибок, а ведь именно ее она, в сущности, заменяет. 
Четвертая предпосылка играет ключевую роль в получении корректных результатов эконометрического моделирования. В последующих параграфах и главах мы увидим, что именно вопрос о выполнении или нарушении этой предпосылки оказывается в центре дискуссии об уместности применения тех или иных методов и спецификаций моделей в различных ситуациях. 
Содержательно эта предпосылка говорит о том, что «прочие факторы», которые «спрятаны» в случайной ошибке ˝i , никак не связаны с регрессором. Поэтому знание xi никак не влияет на ожидания по поводу случайной величины ˝i . 
Чтобы на конкретных числах «пощупать» эту предпосылку, а заодно вспомнить, что такое условное математическое ожидание и как его считать, рассмотрим следующий простой пример. 
Пример 6.3. Об условном математическом ожидании 
Пусть известен совместный закон распределения случайных величин xi и ˝i : 
˜i =−1  ˜i = 0  ˜i = 1  
xi = 0  0,2  0,1  0,2  
xi = 1  0,1  0,3  0,1  

а . Проверьте, выполняется ли в данном случае предпосылка 4 об условном математическом ожидании случайной ошибки? 
б . Вычислите безусловное математическое ожидание случайной ошибки. 
в . Вычислите cov(˝i , xi ). 
Решение . 
а . Напомним, что по определению условным математическим ожиданием случайной величины ˝i при условии xi называется математическое ожидание условного распределения случайной величины ˝i при условии x.
iЗапишем закон условного распределения ˝i при xi = 0. Для этого отметим, что вероятность события xi = 0 в нашем примере составляет 0,2 + 0,1 + 0,2 = 0,5: 
˜i=−1  ˜i = 0  ˜i = 1  
P(˜i x| = 0)i  02, 05,  01, 05,  02, 05,  

Зная этот закон распределения, легко подсчитать математическое ожидание: 
02, 01, 02,
E(|ix=0 =− ˝1 +0 ˝+1˝=0.
˜ )
i 05, 05, 05, 
Аналогично получаем условное математическое ожидание ˝i при условии, что xi =1: 
˜i=−1  ˜i = 0  ˜i = 1  
P(˜i x| = 1i ) 01, 05,  03, 05,  01, 05,  

01, 03, 01,
E(|ix=1 =− ˝1 +0 ˝+1˝=0.
˜ )
i 05, 05, 05, 
Таким образом, для любого возможного значения xi условие E(|˜i xi) = 0 соблюдается, т.е. предпосылка выполнена. б . E() =P(˜= )()−+P(˜=˝+00) P(˜ 11) () =
˜ −˝11 =˝
ii ii 
=03 ° ), °+0310.
−+ , °=
,(1040 
Следовательно, безусловное математическое ожидание случайной ошибки тоже равно нулю. 
в . cov(˜, x) =E(˜x) −E(˜˝Ex) =E(˜x) −˝Ex) =E(˜
)( 0( x);
iiiiiiii iii 
E(˜iix) =,(10 , ˛˛+, ˛˛+, ˛− ˛+11 , ˛˛+01˛˛11˛=0.
02 ) 0100 0210 01()
˛− ˛+ 0301 , 
В нашем примере оказалось, что предпосылке 4 соответствует выполнение условий E()˜=i 0 и cov(˜i, x) = 0. На самом деле это не слу
i 
чайный результат. Его можно обобщить, доказав два важных следствия из предпосылки 4. 
Следствие 1 . Если случайные ошибки имеют нулевое условное математическое ожидание при заданном x: E(˜ | x) = 0, то они имеют нуле
i ii вое безусловное математическое ожидание: E()i 0.
˜= 
Доказательство этого следствия является хорошим примером применения закона повторного математического ожидания. 
Напомним формулировку закона повторного математического ожидания: 
E()˜= EE
((˜|°)). 
В нашем случае в соответствии с этим законом: 
E()˜= EE˜ | x)) = E0
(( () = 0.
i ii 
Поэтому, сформулировав предпосылку 4, мы не нуждаемся в том, чтобы отдельно формулировать предположение по поводу безусловного математического ожидания случайной ошибки, которое мы делаем в КЛМПР. 
Подчеркнем, что обратное утверждение, вообще говоря, неверно. Вполне возможна ситуация, когда безусловное математическое ожидание случайной ошибки равно нулю, а ее условное математическое ожидание при условии xi— нет (см. пример 6.4 далее). 
Следствие 2 . Если случайные ошибки имеют нулевое условное математическое ожидание при любом заданном xi: E(˜ | x) = 0, то
ii 
регрессор и случайная ошибка не коррелированы друг с другом: 
cov(˜i, x) = 0.
i 
Для доказательства сначала отметим, что по свойству теоретической ковариации: 
cov(˜ , x) = E(˜ x) − E(˜ Ex) = E(˜ x
)( ) − 0 ˝ Ex() = E(˜ x).
iiiiiiii iii 
А затем снова воспользуемся законом повторного математического ожидания: 
(( |
E(˜ x) = EE˜ xx)) = Ex( E(˜ | x)) = Ex( ˛0) = E()0 = 0.
ii iii iiii 
Регрессор, который не коррелирован со случайной ошибкой модели, обычно называют экзогенным регрессором. Таким образом, предпосылку 4 иногда называют предпосылкой об экзогенности регрессора. 
Если же объясняющая переменная в модели, наоборот, коррелирована со случайной ошибкой cov(˜i , xi ) ° 0, то ее называют эндогенным регрессором. 
Пример 6.4. Об условном математическом ожидании 
(продолжение) 
Пусть теперь совместный закон распределения xi и ˝i имеет такой вид: 
˜i =−1  ˜i = 0  ˜i = 1  
xi = 0  0,3  0,1  0,1  
xi = 1  0,1  0,1  0,3  

Покажите, что в этом случае условие E()i 0 выполнено, а условие
˜= 
E(˜ | x ) = 0 нарушается.
ii 
Решение . 
E() =P(˜=1)()1 P(˜ ) P(˜ 11
˜ −˝−+ =˝+ ) () 
00 =˝ = 
ii ii 
=04 ° ), °+0410.
−+ , °=
,(1020 
Чтобы показать, что предпосылка E(|˜i xi ) = 0 не выполняется, достаточно привести любое значение xi , для которого указанное равенство нарушено. Рассмотрим, например, случай xi = 0: 
03, 01, 01,
E(|˜ x =0) =− ˝1 +0 ˝+1˝ =−04,.
ii 05, 05, 05, Следовательно, предпосылка E(|i xi ) = 0 не выполняется: регрес
˜ 
сор в модели является эндогенным. 
*** 
Выполнение четырех предпосылок линейной модели со стохастическими регрессорами (случай парной регрессии) гарантирует, что применение МНК будет приводить к хорошим результатам. 
Говоря более строго, эти гарантии можно сформулировать в следующем виде. 
Теорема о состоятельности и асимптотической нормальности МНК-оценок в парной регрессии . Если предпосылки 1–4 выполнены, то МНК-оценки коэффициентов ° 1 и ° 2 состоятельны и асимптотически нормальны. 
Доказательство этой теоремы приводится в § 6.3 и 6.4. В первом из них доказывается состоятельность, а во втором — асимптотическая нормальность. Однако прежде чем переходить к доказательству, обсудим значение теоремы для прикладных исследований. Забегая вперед, отметим, что оно велико. 
Первый результат — состоятельность — дает нам уверенность в том, что при достаточно слабых предположениях МНК будет обеспечивать верные ответы на интересующие нас вопросы о мире. Для получения этих ответов нужно лишь собрать достаточно много данных, чтобы асимптотические свойства были применимы. В практических исследованиях вполне хватает нескольких сотен точек (хотя, конечно, когда речь идет об асимптотических методах, то чем больше, тем лучше). 
Второй результат — асимптотическая нормальность — позволяет нам легко тестировать гипотезы и строить доверительные интервалы, не делая жестких предположений о распределении отдельных случайных ошибок и отдельных переменных (детали см. в § 6.5). Это ценно потому, что на практике обычно нет никакой уверенности в том, что случайные ошибки модели распределены нормально. А ведь в рамках КЛМПР, как вы помните, мы были вынуждены делать такую предпосылку. 
Отметим также, что в рамках нашей новой модели, в отличие от КЛМПР, мы не требуем гомоскедастичности. Действительно, мы сделали предположение по поводу того, что константой должно быть условное математическое ожидание случайной ошибки E(˝ | x), од
ii нако по поводу условной дисперсии случайной ошибки var( x мы 
˝ii|) 
никаких предпосылок не делали. Следовательно, эта величина может меняться при изменении xi, т.е. в модели может наблюдаться гетероскедастичность (в таком случае ее также называют условной гетероскедастичностью). 
Аналогичный набор предпосылок и аналогичная теорема могут быть, разумеется, сформулированы и для множественной регрессии. 


Предпосылки линейной модели со стохастическими регрессорами (случай множественной регрессии): 
1. Модель линейна по параметрам: 
()2 ()3 ()k ,,
y=˙+˙ ˝x +˙ ˝x +…+ ˙ ˝x +ˆ, i=12 …, n.
i 12 i 3 i ki i 
()2 ()k
2. Наблюдения {(x, … , x, y), i= 1, … , n} независимы и одина
i ii
ково распределены. 
()2 ()k
3. x, … , x, yимеют ненулевые конечные четвертые моменты.
i ii
4. Случайные ошибки имеют нулевое условное математическое ожидание при заданных значениях регрессоров: 
()2 ()k =…
E(˜| x, …, x) =0, i1, ,.n
ii i 
5. В модели с вероятностью единица отсутствует чистая мультиколлинеарность. 
Теорема о состоятельности и асимптотической нормальности МНК-оценок (случай множественной регрессии) . Если предпосылки 1–5 выполнены, то МНК-оценки коэффициентов модели множественной регрессии состоятельны и асимптотически нормальны. 
Легко видеть, что набор предпосылок полностью идентичен случаю парной регрессии за одним исключением: нам пришлось добавить требование отсутствия мультиколлинеарности. Как мы знаем, при его нарушении МНК-оценки в модели множественной регрессии в принципе невозможно определить однозначно. Упоминание вероятности в формулировке предпосылки связано с тем, что теперь регрессоры являются стохастическими, т.е. при каждой реализации их набор может отличаться. 
В таблице 6.1 содержится сопоставление предпосылок трех основных моделей, в условиях которых мы исследуем свойства МНК-оценок. Из нее легко видеть, что предпосылки нашей новой модели действительно являются сравнительно более мягкими, что делает ее максимально реалистичной моделью для практической работы с пространственными данными. 


6 .3 . Состоятельность МНК-оценок 
В этом параграфе мы докажем, что если выполнены предпосылки линейной модели со стохастическим регрессором: 
1. Модель представима следующим образом: 
y=˝ +˝ x+˙ , i= 12 …, n.
,,
i 12 ii 
Таблица 6.1 
Сопоставление различных регрессионных моделей 
Название модели  Классическая линейная модель множественной регрессии  Обобщенная линейная модель множественной регрессии  Линейная модель со стохастическими регрессорами  
Где эта модель описана  В § 3.2 (а также для случая парной регрессии в § 2.3)  В § 5.5  В § 6.2  
Предположение о детерминированности (неслучайности) регрессоров  Требуется  Требуется  Не требуется  
Предположение о нормальности случайных ошибок  Требуется для тестирования гипотез  Требуется для тестирования гипотез  Не требуется  
Предположение об отсутствии гетероскедастичности  Требуется  Не требуется  Не требуется  

2. 
Наблюдения {(,xy 1, n

ii ), i =…, } независимы и одинаково распределены. 

3. 
xi и yi имеют ненулевые конечные четвертые моменты распределения Exi 4 <° ()4

() , Eyi <°. 

4. 
Случайные ошибки имеют нулевое условное математическое ожидание при заданном xi : E(˜ | x ) = 0, то МНК-оценка коэф


ii 
фициента ° 2 является состоятельной. Иными словами, мы докажем первую часть теоремы, сформулированной в § 6.2. 
В процессе доказательства мы несколько раз будем использовать тот факт, что в условиях перечисленных предпосылок 1–4 выборочные моменты сходятся по вероятности к своим теоретическим аналогам. Например: 
p
var x ˜°var()i ;
() ˜ x 
cov(,xy) ˜°cov(xy
p˜ i , i ). 
Вполне возможно, что вы хорошо знакомы с этим фактом из курса математической статистики. Однако мы все-таки докажем одно из этих утверждений, чтобы продемонстрировать, почему сформулированные предпосылки действительно важны. 
Утверждение: если предпосылки 2−3 выполнены, то 
 p
cov(xy, )˛˝cov(, .
˛ xy)
ii 
Доказательство: 
Exy ( ˛ Ey 
cov(xy,) = () − Ex)();
ii iiii 
cov xy) =˛
(, xy− xy. 
Так как в силу предпосылки 2 все xi — независимые и одинаково распределенные, выполняется закон больших чисел: x˜°Exi 
p˜ (). Аналогично: y˜°Eyi 
p˜ (). Следовательно, по теореме Слуцкого: xy˜°p°˛Ex()˜Ey(). 
ii По закону больших чисел: xy˜°Exyii).
p˜ ( 
Наконец, применив теорему Слуцкого для разности, получим: 
xyxy p˛Exy) − ()°Ey =cov(x, y
−° ˛˝ ( Ex () ).
iiii ii 
Зачем для доказательства нам необходима предпосылка 3 о том, что 
Ex()4 <°, Ey()4 <°?
ii 
Чтобы применить закон больших чисел (в форме Чебышева) к последовательности {, нам необходимо, чтобы у xi сущест
xi=12,, …},
i 
вовали конечная дисперсия и математическое ожидание. Из конечности момента распределения четвертого порядка следует и конечность моментов распределения первого и второго порядков, следовательно, математическое ожидание и дисперсия xi существуют; аналогична ситуация и для yi . 
Наконец, для применения закона больших чисел к последовательности произведений {xyii, i=12, , …} нам необходимо, чтобы у 
xy
ii существовали конечная дисперсия и математическое ожидание: 
22 
44
Ex( ˜ y) ° Ex()˜ Ey() <˝,
ii ii 
где первый переход следует из неравенства Коши − Буняковского, а второй — из предпосылки 3. 
Это значит, что случайная величина xyiiимеет конечный второй момент. Тогда она имеет конечный первый момент Exyiiи конечную дисперсию: 
var(xy) = Ex(2 ˛ y2) − (Exy)2.
ii iiii 
Что и требовалось доказать. 
p
() ˜ x
Утверждение var x˜°var()i доказывается аналогичным образом. 
Теперь мы можем непосредственно доказать состоятельность МНКоценки коэффициента при переменной в модели парной регрессии: 
cov ) cov(,xy) cov(x, ˜+˜ ˆ x+ˇ )
^ ˜(,xypii i 12 ii
˜=˛ =
˛˝ = 
° 
()x var() )
2 xi var(xi
var 
x, ˝˛ x+˙ ) ˝˛cov(xx + x,˙ ) cov(x
cov( ,)cov( , ˙ )
i 2 ii 2 iiii ii
= = =˝+ .
var(x) var(x) 2 var()
x
ii i 
Таким образом, мы получили важное соотношение: 
cov(x,°)
^ p ii
˛ . (6.2)
˜ ˛˝˜ +
22 
var()i
x 
(˜ | x) ство нулю соответствующей ковариации: cov(x, ˜=) 0. Поэтому в слу
В § 6.2 мы доказали, что из предпосылки Eii = 0 следует равен
ii 
чае, когда данная предпосылка об экзогенности регрессора выполнена, получаем: 
cov(x, °)
^ p ii 0
˜˛˝˜+ =˜+ =˜
˛ .
22 22
xi) xi
var( var() 
^ p
° ,
Тем самым мы получили, что ˜2 °˛˜2 т.е. при увеличении выборки МНК-оценка коэффициента сходится по вероятности к истинному значению этого коэффициента, а значит, является состоятельной. Что и требовалось доказать. 
Из этого доказательства становится ясно, почему критически важно выполнение предпосылки 4 об экзогенности регрессора. Представим, что она нарушена, т.е. cov(xi, i) 0. Пусть, например, регрессор
˜° 
˜>
положительно коррелирован со случайной ошибкой: cov(xi, i) 0. 
В этом случае: cov(x, °)
^ p ii
˜ ˛˝˜ + >˜ .
˛
22 2
var(xi) 
Здесь МНК-оценка окажется несостоятельной и завышенной (и наоборот, если cov(xi, i)
˜<0, то она будет несостоятельной и заниженной). 

6 .4 . Асимптотическая нормальность МНК-оценок 
В этом параграфе мы докажем, что МНК-оценка коэффициента ° 2 имеет асимптотически нормальное распределение, если выполнены предпосылки линейной модели со стохастическим регрессором: 
1. Модель представима следующим образом: 
y=˝ +˝ x+˙ , i=12 …, n.
,,
i 12 ii 
2. Наблюдения {(,i ii=…,, независимы и одинаково распреxy), 1 n} 
делены. 
3. xi и yi имеют ненулевые конечные четвертые моменты распределения Ex()4 <°, Ey()4 <°.
ii 
4. Случайные ошибки имеют нулевое условное математическое ожидание при заданном xE(˜ | x) = 0.
i: ii 
Иными словами, мы докажем вторую часть теоремы, сформулированной в § 6.2. Для этого мы докажем, что: 

ˇ var((x−µ˛)) &#22;
^ d ixi
n( − ) ˙˙ˆN&#23;0, &#20;,
˜˜
22 2 &#20;
&#23;
˘ (var(xi)) &#21; 
где µxобозначает математическое ожидание регрессора, т.е. Ex()i =µ . 
x
^ 
Как было показано в гл. 2 (см. равенство (2.2) в § 2.4), оценка ° 2 может быть представлена следующим образом: 
(x− x)°
1 ˆin =1 ii
^ n
˜ =˜ + .
22 
1 n 
(x− x)2 
nˆi=1 i 
ˆ 1 n &#23; 
1 n
(x− x)° (x− x)° 
˘&#20;i=1 ii &#21;&#20;i=1 ii 

n(˜^ −˜ ) = 
n˜+ n −˜ = n = 
22 ˘ 22 &#21;
1 n 1 n
˘ (x− x)2 &#21; (x− x)2 
ˇ n&#20;i=1 i &#22; n&#20;i=1 i n
((x−µ − x−µ ))
)( ˙
1 ˛i=1 ix xi
n
=
= 
1 n
(x− x)2 
n˛i=1 i 1 n 
1 n
(x−µ˙)(x−µ) ˙ 
n˛i=1 i xi xn˛i=1 i 
=
− .
1 n 1 n
(x−x)2 (x−x)2 
n˛i=1 in˛i=1 i 
Для удобства введем следующие обозначения: 
1 n 

°(x−µ˙) =A;
ixi n
n
i=1 
1 n 
(x− x)2 = B;
° in
n
i=1 
1 n (x−µ ) 
˙= C. 
x ˛ in
n
i=1 
С учетом новых обозначений имеем: 
AC 

n(˜^2 −˜2) = n− n . 
BB 
nn Рассмотрим последовательности случайных величин ABC,
, по
nnn 
отдельности. 
Как мы обсудили в § 6.3 в рамках наших предпосылок, выборочная дисперсия регрессора сходится к своему теоретическому аналогу: 
n p
B= (x− x) = var() ˛˝ x 1 ˙ 2  x ˛ var(). 
ni i
n
i=1 
Далее, чтобы выяснить, куда сходится последовательность C , при
n 
меним закон больших чисел к первому ее множителю и центральную предельную теорему ко второму. Тогда получим: 
p
(x−µ ) ˛˝(µ −µ ) = ;
˛ 0 
x xx 

n1 d˛N(,0 ˆ2 ˙).
°˙ ˛˝
i
n
i=1 
Применим к произведению этих множителей теорему Слуцкого и увидим, что оно сходится по распределению к произведению нуля и нормальной случайной величины, т.е. к нулю: 
n
1 d
C = (x−µ )˛ 
˘ ˝˝˙0. 
nx ˆ i
n
i=1 
Осталось исследовать последовательность A: 
n 
1 n 
1 n A = 
(x−µ˙) = v,
n ˛i xi ˛i
nn
i=1 i=1 
где v=(x−µ˝).
i ixi Покажем, что A имеет асимптотически нормальное распределение.
n 
Для этого применим центральную предельную теорему. Чтобы ее применение было корректным, следует убедиться в выполнении ее условий. Для этого необходимо доказать, что дисперсия vi конечна: 
22 222
var(v) =Ev( −Ev) =Ev() =E((x−µ˝)) =E((x−µ) ˝).
i ii i ixi ixi 
По неравенству Коши − Буняковского получим: 
22 
44
Ex( −µ ) ˝ ) ° Ex−µ )
(( E˝ .
ixi ixi 
По предпосылке 3 получим: 
Ex( −µ )4 E˙4 <˛.
ix i 

Строго говоря, в предпосылке 3 накладывается ограничение на моменты распределения переменных xi и y, а не переменной ˝i. Однако
i в силу предпосылки 1 случайная величина ˝iлинейно выражается через 
xi и yi . Поэтому раз данные переменные имеют конечные четвертые моменты распределения, то и для ˝i это тоже верно. Итак, доказано, что var(vi ) <°, поэтому к случайным величинам vi применима центральная предельная теорема. В силу этой теоремы: 
n
n
11 d
A = 
(x −µˇ) = v ˛˛˝˘,
n ˙i xi ˙i
nn
i=1 i=1 
где случайная величина имеет распределение N (,0var(vi )). 
Обобщая все сказанное выше и снова применяя теорему Слуцкого, получаем: 

AC
^ n nd ° 
n( −˜ ) =−˙ˆ − ,˜˙ 0
22 
BB var(x )
nn i 
где случайная величина имеет распределение N (,0var()). Следователь
vi 
˜
˝
var(vi )
0, 
)
но, случайная величина имеет распределение N
˛˛° 
ˆˆ˙ 
.
2
var(xi ) ( xi
()
var 
Таким образом, мы доказали, что: 
˙
˘
var(vi )
˛
˜
^ d
( ˛˝ 
^
Иными словами, величина 
n(˜ −˜ ) имеет асимптотически нор
22
мальное распределение с математическим ожиданием 0 и дисперсией: 
var(vi ) . (var()x )2 
i 
^
Следовательно, величина (˜ −˜ ) имеет асимптотически нормаль
22
ное распределение с математическим ожиданием 0 и дисперсией: 
var(vi ) . n(var(x ))2 
i 
(Так как по свойству дисперсии, разделив случайную величину 

^ 
n(˜2 −˜ ) на 
n, мы уменьшим ее дисперсию в n раз.)
2 
^ 
И наконец, величина ° 2 имеет асимптотически нормальное распределение с математическим ожиданием ° 2 и той же дисперсией: 

−
˜
) 
0,
N
ˇˇˆ 
&#22;&#22;&#23; 
n 
.
2 
2 
(var xi 2
()) var(vi) 
2. n(var(xi)) 
^ 
(Так как добавив к случайной величине (˜2 −˜2) константу ° 2, мы увеличим ее математическое ожидание на эту константу, оставив дисперсию неизменной.) 
Осталось вспомнить, что v=(x−µ˝) , , и записать, что тем самым 
i ixi 
МНК-оценка коэффициента при регрессоре в модели парной регрес
^ 
сии ° имеет асимптотически нормальное распределение с математи
2 ческим ожиданием ° 2 и дисперсией: 
var((x−µ˛))
^ i xi
var(˜) = .
2
2 nˆ(var(xi)) 
Что и требовалось доказать. 
Последняя из формул дает подсказку, как можно получить состоятельную оценку дисперсии случайной ошибки. Для этого нужно теоретические дисперсии в числителе и знаменателе указанной дроби заменить их оценками, а случайные ошибки заменить остатками регрессии, например вот так: 
1 n 2 
2
x− xe
 ˜^2 n− 2 ˇi=1( i ) i 
var() = .
 2
nˆ(var(x)) 
В приложении 6А к этой главе показано, что такая оценка является состоятельной (даже в условиях гетероскедастичности) оценкой ди
^ 
сперсии ° 2. 

6 .5 . Тестирование гипотез и построение доверительных интервалов 
Во второй и третьей главах, обсуждая тестирование гипотез относительно отдельных коэффициентов, мы использовали тот факт, что от
^
° 
j
ношение имеет t-распределение Стьюдента с ( −nk) степенями
^ 
se °
()
j 
свободы. Однако в асимптотическом случае это число степеней свободы стремится к бесконечности. Из математической статистики известно, что при неограниченном увеличении числа степеней свободы случайная величина, имеющая распределение Стьюдента, сходится к нормальной случайной величине. Это несколько упрощает процедуру тестирования гипотезы о незначимости коэффициента, которая теперь устроена так, как показано ниже. 
Процедура тестирования незначимости коэффициента в модели множественной регрессии при использовании асимптотического подхода: 
()j
1. Формулируем тестируемую гипотезу H : ˜=0 («переменная x
0 j
не влияет на переменную y») и альтернативную гипотезу H : ˜°0 
(«переменная x()j влияет на переменную y»). 1 j 
2. Находим расчетное значение тестовой статистики по формуле 
^
° 
j 
.
^ 
se °
()
j 
3. Вычисляем P-значение по формуле 
˝ ˆ
P-значение =°2 &#22;ˆ−
ˆ
˙ 
^
&#21;
j 
^ 
se()
&#21;
j 
ˇ &#23;
&#23;,
&#23;
˘ 
где ˜()° обозначает функцию стандартного нормального распределения. 
4. 
Выбираем уровень значимости &#23;. 

5. 
Если P-значение меньше уровня значимости: 


˛ 2˜&#22; −
˙
˙ 
˝ 
^
&#21; 
j 
^ 
se &#21;
()
j 
ˆ ˘
˘<&#20;, ˇ 
то следует отвергнуть гипотезу H : ˜=0 и сделать вывод в пользу альтер
0 j
нативной гипотезы, т.е. заключить, что переменная x(j) влияет на переменную y. В этом случае переменную x(j) называют статистически значимой при уровне значимости &#23;. 
Замечание 1 . Как и прежде, вместо вычисления P-значения можно сравнивать расчетное значение тестовой статистики с критическим значением из таблицы стандартного нормального распределения. Например, при уровне значимости 1% ( , ) получаем следующее условие
˜=001 
для отвержения нулевой гипотезы: 
^
˛ ˆ
&#21; 
j
2˜&#22;˙˙˙− ˘˘˘ < 0 01
,.
^ 
se &#21;
()
j
˝ ˇ 
Это условие эквивалентно неравенству: 
^
˜ 
j 
,.
> 258
^ 
se ˜
()
j 
Поэтому при использовании асимптотического подхода критическое значение тестовой статистики при уровне значимости 1% составляет 2,58. Аналогично легко проверить, что при уровне значимости 5% оно равно 1,96. 
Отсюда следует, что 99%-й и 95%-й асимптотические доверительные интервалы для коэффициента соответственно составляют: 
^^ ^^
(˜− se(˜ )˛25,,8 ˜+ se(˜ )˛2,58)
jj jj 
и 
^^ ^^
(˜− se(˜ )˛19, 6, ˜+ se(˜ )˛1,96).
jj jj 
В Приложении 6Б обсуждается построение доверительных интервалов для нелинейных относительно коэффициентов выражений. Оказывается, что асимптотический подход позволяет решать и такую задачу. Для этого применяется так называемый дельта-метод. 
Замечание 2 . Аналогичным образом можно тестировать гипотезу H0: ˜=c, где c — это некоторая константа. В этом случае процедура
j
тестирования остается такой же с одним исключением: расчетное зна
^
˜− c
j
чение тестовой статистики будет иметь вид и, следовательно,
^ 
se(˜ )
j 
P-значение рассчитывается по формуле 
˝ ˆ
P-значение =°2 &#22;−
ˆ ˙ 
^
&#21;−c
j 
^ 
se(&#21;)
j 
ˇ &#23;
.
&#23; ˘ 
Замечание 3 . Не забудьте, что, так как в рамках нашей новой модели мы отказались от предположения о гомоскедастичности, стандартные ошибки для осуществления этого теста должны быть получены на основе формул стандартных ошибок, состоятельных в условиях гетероскедастичности. К счастью, все современные эконометрические пакеты умеют легко рассчитывать их автоматически. 
В случае тестирования гипотез по поводу выполнения сразу нескольких линейных ограничений также можно использовать все стандартные варианты F-теста, которые подробно рассмотрены в § 3.5. 
Единственное отличие состоит в том, что теперь, если верна нулевая гипотеза данного теста, то расчетное значение тестовой статистики имеет не распределение Фишера с qи ( − )
nk степенями свободы Fqnk(, − ), а распределение Фишера с qи &#8; степеней свободы Fq(, &#8;), так как n˜°. Поэтому для получения критических значений следу
˜(
ет использовать таблицу распределения Фишера Fq, °) или таблицу распределения Хи-квадрат, так как случайная величина с распределением &#15;2()q в qраз больше случайной величины с распределением Fq( ,.
˜)
Ограничение такого подхода к тестированию совместных ограничений состоит в том, что стандартный F-тест также требует гомоскедастичности случайных ошибок. Поэтому, чтобы получить корректные в условиях гетероскедастичности результаты тестирования гипотезы, используется специальное обобщение F-теста. В качестве такого обобщения можно применять, например, тест Вальда. 
Идея теста Вальда похожа на идею использования состоятельных в условиях гетероскедастичности стандартных ошибок: расчетное значение тестовой статистики корректируется с учетом возможной гетероскедастичности. Поэтому вас не должно удивлять, если при использовании робастных стандартных ошибок ваш эконометрический пакет для проверки значимости уравнения или для сравнения «короткой» и «длинной» регрессий начинает использовать тест Вальда вместо F-теста (что приводит к соответствующей корректировке значений тестовых статистик). Интерпретировать его результаты можно аналогичным образом. 
Более полное описание процедуры теста Вальда требует знакомства с матричной формой записи для множественной регрессии (§ 3.3) и обобщенной линейной моделью множественной регрессии (§ 5.5). Если вы разобрались и с тем, и с другим, то можно читать дальше. 
Пусть тестируемая гипотеза, как и в параграфе 3.6, имеет вид: 
H˜=r, 
где ° — вектор коэффициентов модели; H— матрица размером qна k; r— вектор-столбец длиной q; в свою очередь, q— количество тестируемых ограничений, т.е. количество уравнений в системе ограничений; k— число коэффициентов в модели. 
Расчетное значение тестовой статистики теста Вальда для тестирования гипотезы H˜=rимеет вид: 
^ −−1 −1^
(H ˜− r)( ( ˛ X ) H ˛)(H ˜− r),
˛ HX ˝ 1 
где — ковариационная матрица вектора случайных ошибок. 
Если верна тестируемая гипотеза, то эта величина имеет распределение Хи-квадрат с q степенями свободы. 
Таким образом, в случае если расчетное значение тестовой статистики больше критического значения из таблиц распределения Хи-квадрат при заданном уровне значимости, то гипотеза о выполнении ограничения H˜=r должна быть отвергнута. 
На практике ковариационная матрица  обычно не известна. По
^ 
этому в формуле тестовой статистики ее заменяют оценкой . В частности, если выполнены предпосылки линейной модели со стохасти
^ 
ческими регрессорами о независимости отдельных наблюдений, то будет диагональной матрицей, где на главной диагонали стоят оценки дисперсий случайных ошибок, полученные по процедуре из гл. 5 (см. § 5.3, случай 2). 
Пример 6.5. Тестирование гипотез 
в условиях асимптотического подхода 
Руководство крупной торговой сети планирует выяснить, помогает ли тренинг по продажам увеличить эффективность работы менеджеров по продажам. 
Для решения этой задачи были собраны следующие данные о двух тысячах менеджеров: 
sales — объем продаж данного менеджера (в тысячах рублей за период); 
training — фиктивная переменная, равная единице, если в самом начале данного периода менеджер прошел тренинг по продажам (работники, которые направлялись на курсы, выбирались из общей совокупности работников компании при помощи специальной лотереи); 
female — фиктивная переменная, равная единице для менеджеровженщин и нулю для мужчин; 
experience — опыт работы менеджера в годах; 
capital — фиктивная переменная, равная единице, если менеджер работает в столичном отделении компании, и равная нулю в противном случае; 
IQ — все менеджеры при приеме на работу в данную компанию проходят IQ-тест, эта переменная характеризует результаты менеджера. 
а . Оценка регрессии переменной sales на переменные training, female, experience, capital и IQ дала следующие результаты: 
Модель 1: МНК, использованы наблюдения 1-2000 Зависимая переменная: sales Робастные оценки стандартных ошибок (с поправкой на гетероскеда
стичность), вариант HC1  
Коэффициент  Ст. ошибка  
const trainingfemaleexperiencecapitalIQ −24,373118,86780,3927565,300553,295741,72884  6,707331,817621,758490,5695461,609320,0647299  

Сумма кв. остатков 2574369 F (5, 1994) 180,6451 
Используя асимптотический подход: 
а . Вычислите P-значение для коэффициента при переменной female. Проверьте значимость указанной переменной. Интерпретируйте полученный результат. 
б . Постройте 95%-й доверительный интервал для коэффициента при переменной training. Интерпретируйте полученный результат. 
в . Проверьте незначимость уравнения в целом, используя уровень значимости 1%. 
Решение. 
а . P-значение равно: 
˛ 
˙
2˜&#22;˙−
˙
˝ 
^
&#21;
j 
^
se(&#21;j ) 
ˆ ˘
˘=˜2 &#22;˛˙−0 392756, ˆ˘ 2 (,223348 =˜, =0 8232.
=˜&#22;−02 ) 204116 ,˘˝ 1 75849, ˇ
ˇ 
Так как P-значение больше одной сотой, пяти сотых и десяти сотых, то соответствующий коэффициент не является значимым ни на 1%-м, ни на 5%-м, ни на 10%-м уровнях значимости. Следовательно, пол менеджера не влияет на объем его продаж. 
Примечание: значение функции стандартного нормального распределения в нужной точке ˜(,−0 223348) можно вычислить, например, в MS Excel, используя команду =НОРМ.СТ.РАСП(−0,2235;1). 
б . Асимптотический доверительный интервал имеет вид: 
^^ ^^
( − ()˛ ,, ˜+ se(˜ )˛ ,)˜ se ˜ 196 196
jj jj 
(, − , ° ,, , + , ° ,)18 8678 1 81762 196 18 8678 1 81762 196 
(,, ,)1531 2243 
Так как этот 95%-й доверительный интервал не содержит ноль, можно заключить, что посещение тренинга значимо влияет на объем продаж менеджера (при 5%-м уровне значимости). Причем с вероятностью 95% увеличение объема продаж в результате этого посещения лежит в пределах от 15,31 тыс. руб. до 22,43 тыс. руб. за период. 
в . Расчетное значение тестовой статистики дано по условию и составляет 180,6451. Критическое значение может быть взято из таблиц 
˜ ,
распределения Фишера: Fq(, ) F001 5 °=,.
°= (, )302 
Или можно получить тот же самый результат, воспользовавшись распределением Хи-квадрат. Критическое значение из таблицы распределения Хи-квадрат для 5 степеней свободы и уровня значимости 1% составляет 15,086. Его следует разделить на q= 5, что приведет к получению той же самой величины 3,02. 
Поскольку расчетное значение больше критического, гипотеза о незначимости уравнения в целом отвергается. Уравнение в целом значимо (при 1%-м уровне). 
Задания для самостоятельного решения 
Задание 1 . Рассматривается модель: 
y=+˛−15 x 3 ˛x2 +˙.
i iii 
Случайные ошибки имеют нулевое условное математическое ожидание при заданном xi: E(˜ | x) = 0. Также известно, что Exi = 2, Ex2 = 8.
ii i 
Вычислите: 
а . Eyi. 
б . Eyx
(| = 4). 
ii в . Eyx
(| ). 
ii 
Задание 2 . Рассматривается модель: 
y=˝+˝ ˛ x+˙ .
i 12 ii 
а . Пусть для рассматриваемой модели выполнены все предпосылки линейной модели со стохастическим регрессором из § 6.2. Вычислите Ey(9 − y8). 
б . Допустим теперь для рассматриваемой модели используются все предпосылки классической линейной модели парной регрессии с детерминированным регрессором из § 2.3. Вычислите Ey(9 − y8). 
в . Пусть для рассматриваемой модели снова выполнены все предпосылки линейной модели со стохастическим регрессором из § 6.2. Вычислите Ey( − yx|, x). 
9 889 
Задание 3 . Исследователь анализирует влияние опыта работы на доход индивида при помощи следующей модели: 
ln earnings =˝+˝ ˛exp +˝ ˛exp2 +˝ ˛ female +˙ ,
i 12 i 3 i 4 ii 
где earningsi — доходы i-го индивида, в долларах в час; 
expi — опыт работы i-го индивида, в годах; 
femalei — бинарная переменная, равная единице, если i-й индивид женщина, и равная нулю, если мужчина. На основе оценки уравнения по 500 наблюдениям он получил следующие результаты: 
 2
2 263 0 0023exp − 0 3218
ln earnings = , + 0 0818, exp − ,, female ;
i iii
( , ) (00297, ) (00010) ( ,
0 226 , 0 0521) 
R2 = 0 103, , SEE = 0, 565. 
(В скобках под оценками коэффициентов указаны робастные стандартные ошибки.) 
Используя асимптотический подход: 
а . Вычислите P-значение (P-value) для теста на незначимость переменной female. Вы отвергаете нулевую гипотезу при уровне значимости 5%? А при уровне значимости 1%? 
б . Вычислите P-значение (P-value) для проверки гипотезы о том, что коэффициент при переменной female равен (−02, ). Вы отвергаете нулевую гипотезу при уровне значимости 5%? А при уровне значимости 1%? 
в . Постройте 99%-й доверительный интервал для коэффициента при переменной female. 
Задание 4 . В условиях предыдущего задания обратите внимание, что по мере увеличения опыта работы доход индивида сначала растет, а затем снижается. 
а . Вычислите оценку опыта работы, при котором доход индивида максимален. 
^^ −
б . Пусть также известно, что cov(,˜˜ ) =− ˝310 5. На 5%-м уровне
23 
значимости проверьте гипотезу о том, что доход индивида максимален при опыте работы, равном 20 годам. Задание 5 . Рассмотрим модель парной регрессии на фиктивную переменную: y =+ ˙. В вашем распоряжении есть данные о пе
˛˝x +
i ii 
, .
ременных xyИзвестно, что случайная ошибка ˝i может принимать только два значения: +1 или –1. Более того, известно совместное распределение рассматриваемых переменных: 
• 
вероятность того, что xi = 0 и ˜i =−1 , равна 1/8; 

• 
вероятность того, что xi = 0 и ˜i =1 , равна 3/8; 

• 
вероятность того, что xi =1 и ˜i =−1 , равна 3/8; 

• 
вероятность того, что xi =1 и ˜i =1 , равна 1/8. а . Выполняется ли в данном случае предпосылка E()i 0


˜=? А предпосылка E ˜i xi )
(| = 0? 
б . Вычислите предел по вероятности для МНК-оценки параметра °. Интерпретируйте полученный результат. 
в . Предложите какую-нибудь состоятельную оценку параметра °. 
Задание 6 . Рассмотрим линейную регрессионную модель: 
y =˝+˝ ˛ x + u .
i 12 ii 
Пусть выполнены все предпосылки линейной модели со стохастическим регрессором (которые мы сформулировали в этой главе) за одним исключением: объясняющая переменная положительно коррелирована со случайной ошибкой. 
^ 
а . Будет ли в этом случае МНК-оценка ° 2 состоятельной? Формально обоснуйте свой ответ. б . Пусть исследователь решает возникшую проблему следующим образом: он располагает данными о некоторой переменной z, такой, что cov(zu,) ,но cov( , ) ˆ 0. Вместо МНК-оценки он использует
= 0 zx
ii ii 
альтернативную оценку для коэффициента ° 2: 
n
˙ (z − z )˝(y − y)
 = i=1 ii .
˜2 
n 
(z − z )˝(x − x )
˙i=1 ii 
Будет ли эта оценка состоятельной? Формально обоснуйте свой ответ. 
Примечание: на самом деле оценки такого класса используются в эконометрических моделях достаточно часто. Мы более подробно поговорим про них в гл. 8. 
Задание 7 . Рассмотрим регрессионную модель: 
y =˝ ˛ x +˝ ˛ w +˙ .
i 1 i 2 ii 
Известно, что безусловные математические ожидания регрессоров xi , wi равны нулю, и xi распределены независимо от ( wi , ˝i ). 
Для представленной модели выполнены все предпосылки линейной модели со стохастическими регрессорами (которые мы сформулировали в этой главе) за одним исключением: wi положительно коррелирована с ˝i. 
^ 
а . Будет ли МНК-оценка ° 1 состоятельной? ^ 
б . Будет ли МНК-оценка ° 2 состоятельной? Задание 8 . Рассматривается модель парной регрессии без константы y=°˝x+˙, для которой:
i ii 
• случайные ошибки имеют нулевое условное математическое ожидание при заданном xE(˜ | x) = 0;
i: ii 
ii =… } независимы и одинаково распределены; • наблюдения {(,xy), i 1, , n 
• Ex()4 <°, Ey()4 <°.
ii 
Выведите асимптотическое распределение МНК-оценки коэффициента °. 



ПРИЛОЖЕНИЕ 6А 
СОСТОЯТЕЛЬНАЯ В УСЛОВИЯХ ГЕТЕРОСКЕДАСТИЧНОСТИ СТАНДАРТНАЯ ОШИБКА ОЦЕНКИ КОЭФФИЦИЕНТА: ДОКАЗАТЕЛЬСТВО СОСТОЯТЕЛЬНОСТИ 
В § 6.4 мы доказали, что асимптотическая дисперсия оценки коэффициента в модели парной регрессии равна: 
var((x −µ˛))
^ i xi
var(˜) = .
2
2 nˆ(var(xi )) 
Поскольку в рамках нашей модели мы допускаем наличие гетероскедастичности, оценка этой дисперсии должна быть состоятельной в условиях гетероскедастичности (робастной к гетероскедастичности). 
Такая оценка может быть вычислена по формуле 
1 n (x − x )22e
 ^1 n − 2 ˝i=1 ii 
var()˜2 = . 
n  2
var()x 
^ 
Если извлечем корень из оценки дисперсии ° 2, то получим состоятельную в условиях гетероскедастичности стандартную ошибку оценки коэффициента: 
1 n (x − x)22e 
^ 
 ^
1 n − 2 ˝i=1 ii
se()˜= var(˜ ) = . 
n  2
2 2 var()x 
Именно эта стандартная ошибка уже встречалась вам в § 5.2 про гетероскедастичность. Теперь мы знаем достаточно, для того чтобы доказать ее состоятельность. 
^° 2
Для этого мы докажем, что отношение оценки дисперсии var
() 
к 
^ 
единице: 
1 n( − )22
x xe
1 n−2 ˝i=1 ii n  2
var()xp
ˇ˘1.
ˇ 
var((x−µˆ))
i xi n°(var(x))2 
i 
° 
Перепишем указанную дробь следующим образом: 
( − )22
x xe
11 ˝ni i
n−2 i=1 
2 n )22 
n  2 ˇvar(x) &#22; 1 ˝ (x−xe 
var()x n ini=1 ii 
=° ° .

var((x− )) 2 ˘ var ( − )ˆ )
µˆ n−&#23; ()x&#21;&#20; var( x−µ
ixi ixi n°(var(xi))2 
Первый множитель представляет собой неслучайную величину, которая сходится к 1. Второй множитель сходится по вероятности к 1, так как выборочная дисперсия регрессора сходится к теоретической (см. § 6.2). Осталось доказать, что третий множитель тоже сходится к 1. Рассмотрим его подробнее: 
1 n 1 n
22 22
x−xe (x−xe
() )
n ° i=1 i in ° i=1 ii 
= . 
var((x−µ˙)) Ex−µ)22˙)
((
ixi ixi 
Чтобы доказать, что эта дробь сходится по вероятности к единице, достаточно доказать, что 
n
1 p
22 22
x− xe) − Ex( −µ ) ˇ ) ˝ 0.
(( ˝˙
° i i ixi
n
i=1 
Сделаем это в два шага: 
n
1 p
22 22
) ˇ˝Ex− ) ˇ ).
Шаг 1. Докажем, что (x−µ ˝˙ (( µ
° ixi ixi
n
i=1 
истинной теоретической дисперсии var( ) сходится по вероятности к
2 
nn
11 p
22 22
Шаг 2. Докажем, что (x− x) e − (x−µ ) ˇ ˝˝˙0. 
° ii ° i xi
nn
i=1 i=1 
Краткое описание каждого из двух указанных шагов приводится ниже. 
Шаг 1 . Сделаем дополнительную предпосылку: 
88
Ex , E()<˝
()<˝ ˙ .
ii 
Докажем, что v= (x−µ )22˝ удовлетворяют предпосылкам закона
i ixi больших чисел. Для этого нужно доказать, что var(vi) <°: 
var(v) =E((x−µ )22&#22;)2 =E((x−µ )44&#22; ) ˙ 
E(x−µ )8 ˘E&#22;8 <ˇ.
i ixi ixi ix i 
Здесь предпоследнее неравенство следует из неравенства Коши − Буняковского, а последнее — из сформулированной нами дополнительной предпосылки. 
Следовательно, случайная величина vi имеет конечный второй начальный момент распределения, который в данном случае равен дисперсии. Значит, она имеет конечный первый момент распределения, то есть математическое ожидание. Тогда все требования закона больших чисел выполнены. В соответствии с ним получаем, что: 
n
1 p)22ˇ ˝˙E((x−µ )22).
(x−µ˝ ˇ
° ixi ixi
n
i=1 
Шаг 2 . В рамках второго шага представим анализируемое выражение следующим образом: 
nn n
11 1
22 22 2222
(x− x) e − (x−µ ) ˙= ((x− x) e − (x−µ ) ˙ ) =
° ii ° i xi ˛ i i ixi
nn n
i=1 i=1 i=1 
n
1 ˝ 2 ^^2 22
= ((x−x)( +x+−− x) −(x−µ) ˆ).
˙˙ ˆ˙˙
i 12 ii 12 i ixi
n
i=1 
Далее достаточно раскрыть скобки, привести подобные и представить это выражение в виде суммы слагаемых, каждое из которых по теореме Слуцкого сходится к нулю. Для доказательства сходимости к нулю каждого из слагаемых достаточно будет снова применить теорему Слуцкого и неравенство Коши − Буняковского. 

ПРИЛОЖЕНИЕ 6Б 
ДЕЛЬТА-МЕТОД 
До сих пор мы умели строить доверительные интервалы для отдельных параметров и их линейных комбинаций, например для ° 1 или суммы ˜+ 5˜ .
12 
Иногда нужно построить доверительный интервал для нелинейного по параметрам выражения. Например, в полиномиальной модели 
y=˛ +˛ x+˛ x2 +˝ нам может быть интересен доверительный ин
i 12 i 3 ii 
°˘˙ тервал для вершины параболы, т.е. для ˝− 2 ˇ . 
˛ 2˘3 ˆ 
Асимптотическая теория позволяет решить эту задачу при помощи так называемого дельта-метода1. Опишем его. 
Пусть у нас есть некоторая состоятельная и асимптотически нормальная оценка параметра: 

n(^ −˝d˝˙°,
˜˜) 
где &#22; N0var( )).&#22;
~(, 
^ 
Или, иными словами, величина ° имеет асимптотически нормальное распределение с математическим ожиданием ° и дисперсией 
var( )&#22; 
. 
n 
^
°
Какое распределение имеет функция от этой оценки g()?
Чтобы ответить на этот вопрос, вспомним разложение функции в ряд Тейлора в окрестности точки x0: 
fx() = fx + ()(xx) + ( − ), x˝ x.
() fx˙− ox x
000 00 
Применим это разложение к функции от нашей оценки параметра: 
1 В русскоязычной литературе он также иногда называется методом построения доверительного интервала со стабилизацией дисперсии. 

^ ^^ 
g() =g() +g()( ) o˜˜); 
˜ ˜ ˙˜˜˜ (
−+ − 
^ ^^ 
g() −g() =g()( ) o˜˜);
˜ ˜ ˙˜˜˜ (
−+ − 

^ 
^
^ 
ng(() −g( ))˜=g() n˜˜) no˜˜).
˜ ˆ˜ ( −+ ˙( − 
Так как 
^ −˝d˝°,
(˜˜) ˙ 
где ˜ ~(, °2), то
N0 
ng(()˜−g˜ ˝˙g()

^ ()) d˝ ˆ˜°. 
По свойству дисперсии: 
var(g˜˝˙) = g˜˝ 2 °
() (()) var()˙. 
Следовательно: 

(( )^ ˜ d˝ 0 ()
ng˜− g( )) ˝˙N(, gˆ˜ 2 ˇ var( )° ). 
^ 
Поэтому случайная величина g()° будет иметь асимптотически нормальное распределение с математическим ожиданием g()° и дисперсией g˜()˛ 2 ° var( )˝ /.n 
На практике величина var( )&#22; неизвестна, но для целей построения асимптотического доверительного интервала можно заменить ее оценкой. Чтобы понять, как работает дельта-метод, рассмотрим модель парной регрессии y=˛ +˛ x+˝ , для которой выполнены все предпо
i 12 ii 
сылки линейной модели со стохастическим регрессором из § 6.2. Построим доверительный интервал для функции от оценки коэффициента 
^ 
при переменной g().
° 2 
В § 6.4 мы доказали, что 

ˇ var((x−µ˛)) &#22;
^ d ixi
n( − ) ˙ˆN 0
˜˜ ˙&#23;, &#20;.22 ˘ (var xi 
&#23; ())2 &#21;&#20; 
Следовательно, в обозначениях данного приложения: 
var((x−µ˛))
i xi
var( )˜= . var()i )2
( x 
^ 
Таким образом, случайная величина g() будет иметь асимптоти
° 2 чески нормальное распределение с математическим ожиданием g() и
° 2 var((x −µˆ))
i xi
дисперсией g ˜˝ ° . Отметим, что дробь в последнем
()2 2 (var()xi )2 °n 
произведении — это просто дисперсия МНК-оценки коэффициента при переменной, так как в конце § 6.4 мы доказали, что 
var((x −µ˛))
^ i xi
var()˜= .
2 
(var()x )2 ˆn
i 
^ 
Поэтому случайная величина g() будет иметь асимптотически
° 2 нормальное распределение с математическим ожиданием g() и ди
° 2
2^ 
сперсией g ˜() ° var(˛ ).
˛
22 
Заменим в последнем выражении неизвестные случайные величины 
^ 
их оценками и получим оценку дисперсии g(), которая будет равна:
° 2
^^ 
g ˜()˛22 ° var(˛2 ). Если извлечь из этой величины корень, то получим соответствующую стандартную ошибку: 
^^ 

^ ^
˜()2 ° var(˝ ) =
g ˝ 
g ˜()
˝ 
°se(˝ ).
22 2 2 
Таким образом, 95%-й асимптотический доверительный интервал для величины g() будет иметь вид:
° 2 
^ ^ 
^^ 
^ ^
((g ˜ ),−196 ˛ g ˙()
˜ 
˛˜ , g(˜ ),1 96 ˛
se() + 
g ˙()˜ 
˛˜
se())).
2 2 
22 
2 2 
Аналогичным образом могут быть построены доверительные интервалы и для коэффициентов в модели множественной регрессии. 
Пример 6.6. Применение дельта-метода для парной регрессии 
Оценка параметров модели при помощи МНК позволила получить следующие результаты: 
^ 
yi = 23, + 40, xi . (02,) ()
01, 
Постройте 95%-й асимптотический доверительный интервал для величины ()3.
° 2 
Решение . 
^ ^^^ ^^
((), ˛ g ˜˛ ˜ , g ˜ ), ˛ g ()˜˛ ())
g ˜−196 ˙()se() ( +1 96 ˙ se ˜
2 222 22 ^3 ^2^ ^3 ^2^

(( ) −1963 ()˜ ˛˜ ,(˜) +1963, ˛˛()
˜ , ˛˛ se() ˜˛se(˜2 ))
2 222 2 
3 23 2
(4 −, °° °,, 4 +, °° °,)196 34 01 196 34 01 
(546,, 734, ) 
*** Полученный нами результат может быть обобщен и на многомерный случай. 
Теорема о дельта-методе . 
˜˜
1) (^ −˝) d˝˙°(где &#22; — случайный вектор); 
2) gx() — вектор непрерывно дифференцируемых функций в окрестности точки °, 
то 
ng(()˜−g˜˝˙G()T

^ ()) d˝ ˜°, 
где Gx() —матрица частных производных функций из вектора ^ 
gx(). Число строк в этой матрице равно длине вектора °, а число столбцов — вектора gx(). 
 
В частности, если &#22; ~(N0,),
V то 

d 
^ T
(() ˜˛ 0 ˜ ( )).
ng˜− g( )) ˛˝N(, G() VG˜ 
Примечание: здесь значок Tозначает транспонирование. 

ПРИЛОЖЕНИЕ 6В 
ТАБЛИЦЫ СТАНДАРТНОГО НОРМАЛЬНОГО РАСПРЕДЕЛЕНИЯ И РАСПРЕДЕЛЕНИЯ ХИ-КВАДРАТ 
Критические значения t-статистик для больших выборок из стандартного нормального распределения 
Уровень значимости 
10% 5% 1% 
Двусторонний тест 1,64 1,96 2,58 

Критические значения для Хи-квадрат распределения для уровней значимости 5% и 1% 
k  1  2  3  4  5  6  7  8  9  10  11  12  
5%  3,84  5,99  7,81  9,49  11,07  12,59  14,07  15,51  16.92  18,31  19,68  21,03  
1%  6,63  9,21  11,34  13,28  15,09  16,81  18,48  20,09  21,67  23,21  24,72  26,22  



ГЛАВА 7 
ПРОБЛЕМЫ СПЕЦИФИКАЦИИ УРАВНЕНИЯ РЕГРЕССИИ 
В этой главе мы сконцентрируемся на том, как при помощи эконометрики получать корректные ответы на вопросы о причинно-следственных связях. Чтобы это сделать, нужно верно специфицировать вашу модель. Под верной спецификацией будем понимать такую, которая позволяет получить состоятельные оценки коэффициентов при интересующих вас переменных, а также состоятельные стандартные ошибки для тестирования гипотез. 
Сначала мы будем перечислять типичные ловушки, которые приводят к неверной спецификации, затем для каждой такой ловушки мы будем указывать возможные способы избежать ее и устранить проблему. 
В каких-то случаях мы будем опираться на уже знакомые вам концепции и понятия. В некоторых же ситуациях мы будем, наоборот, ссылаться на более продвинутые методы и модели, с которыми нам еще предстоит разобраться в следующих главах учебника (надеемся, это станет для вас дополнительной мотивацией все-таки дочитать его до конца). 
Напомним, что в предыдущей главе мы сформулировали два важных определения: 
• Эндогенный регрессор — это регрессор, который коррелирован со случайными ошибками модели: cov(xi , ˜°) 0.
i 
• Экзогенный регрессор — это регрессор, который не коррелирован со случайными ошибками модели: cov(xi ,)0
˜=.
i 
Кроме того, в той же главе мы выяснили, что для состоятельности оценки коэффициента при переменной необходимо, чтобы эта переменная была экзогенной (точнее, необходимо выполнение предпосылки 4 линейной регрессионной модели со стохастическими регрессорами из гл. 6). Если же регрессор эндогенный, то результаты вашего моделирования нельзя интерпретировать в терминах причинно-следственных связей. Нарушение предпосылки 4 об экзогенности регрессора — это самая частая проблема при проведении прикладных исследований на пространственных и панельных данных. Поэтому важно понимать, в каких случаях вам следует опасаться ее возникновения. Могут возникать следующие типичные ситуации: 
1. 
Эндогенность регрессора из-за пропуска существенной переменной. В качестве важного частного случая тут также следует указать проблему эндогенности из-за самоотбора. 

2. 
Эндогенность регрессора из-за выбора неверной функциональной формы связи. 

3. 
Эндогенность регрессора из-за двусторонней причинно-следственной связи. 

4. 
Эндогенность регрессора из-за ошибок измерения. 


В последующих четырех параграфах главы мы подробно обсудим каждый из этих пунктов. В пятом параграфе мы поговорим о других (помимо эндогенности) проблемах, которые могут делать выводы эконометрических исследований необоснованными. В каждом случае мы также укажем основные возможные пути преодоления перечисленных трудностей. 
7 .1 . Эндогенность из-за пропуска существенной переменной 
Пусть выполнены все предпосылки линейной модели со стохастическими регрессорами, и на зависимую переменную влияют два фактора: 
y=˙+˙ ˝ x+˙ ˝ w+ˆ , ˙˛ 0. (7.1)
i 12 i 3 ii 3 
Представим, что мы игнорируем второй фактор и оцениваем парную регрессию переменной y по переменной x: 
^^
^ 
y=+ x
˛˛ .
i 12 i 
В третьей главе мы показали, что в этом случае МНК-оценка будет, вообще говоря, смещена, что само по себе является достаточно серьезной проблемой. На самом деле, в большинстве ситуаций (кроме одного частного случая) она будет еще и несостоятельной. То есть возникшую проблему нельзя будет компенсировать использованием сколь угодно большого массива данных. Докажем это: 
˜ xy) cov( , ) cov(x, ˜+˜ ˆ x+˜ ˆ w+ˇ )
cov(, xy
^ pii i 12 i 3 ii
˜=˛ =
˛˝ = 
2 
° 
var()x var()xi var(xi) 
cov(xx) +˝ ˛cov(xw) +
˝˛ , , cov(x, ˙ )
2 ii 3 ii ii
== 
var(xi) 
, ) cov(xw)
cov(xw) cov(x, ˝ ,
iiii ii
=˛+˛ + =˛+˛ .
23 23
var x var() var(
() xx)
ii i 
Из этого соотношения ясно, что если, например, ˜3 > 0и cov(xw,) > 0, то МНК-оценка коэффициента ° 2 в парной регрессии
ii 
будет несостоятельна и завышена: cov(xw,)
^ p ii
˜ °˛˜ +˜ >˜
° .
223 2
var()i
x 
Отметим, что в этом случае интересующая нас переменная x действительно оказывается эндогенной (что, собственно, и приводит к проблеме). Действительно: при пропуске переменной w этот пропущенный фактор как бы остается внутри случайной ошибки. Иными словами, исходную модель можно переписать вот так: 
y=˝+˝ ˛ x+ u,
i 12 ii 
где u=˝ ˛ w+˙ . cov(xu = x, ˝˛ w+˙ )
Поэтому , )cov( = 
i 3 ii iii 3 ii =˝ cov(xw + x, ˙ ) =˝ cov(x, w) > x
, )cov( 0. То есть, хотя регрессор
3 ii ii 3 ii не коррелирован со случайной ошибкой исходной модели (), он кор
˝ 
релирован со случайной ошибкой оцениваемой парной регрессии ().
u 
Единственный случай, в котором регрессор остается экзогенным, а МНК-оценка остается состоятельной, — это ситуация некоррелированности интересующего нас регрессора и пропущенной переменной: 
cov(xw) = 0.
i, i Если это так, то: 
p 0
^
˜ °˛˜ +˜ =˜
° .
223 2
var(xi) 
Как можно решить проблему эндогенности регрессора из-за пропуска существенной переменной? Ответ на этот вопрос зависит от того, в какой из двух возможных ситуаций мы находимся: в простой или сложной. Рассмотрим их последовательно. 
Ситуация 1 (простая). Пропущенная переменная 
наблюдаема 
Это ситуация, в которой у вас есть данные о пропущенной переменной. Тогда, как вы, наверное, уже догадались, для решения проблемы нужно просто добавить пропущенную переменную в модель. В реальных исследованиях таких пропущенных переменных обычно не одна, а несколько (так как мир устроен сложно и на зависимую переменную обычно влияет сразу много факторов). Что ж, тогда нужно добавить их все. 
Переменные, которые вы добавляете в модель, чтобы устранить смещение оценки нужного вам коэффициента, называют контрольными. 
Сформулируем два определения: 
• 
Переменная интереса (variable of interest) — фактор, влияние которого на зависимую переменную нас интересует. 

• 
Контрольные переменные (control variables) — переменные, которые мы включаем в модель, для того чтобы избежать смещения коэффициента при интересующей нас переменной. 


Получение состоятельных оценок коэффициентов при контрольных переменных для исследователя зачастую не критично. И в целом получить состоятельные оценки коэффициентов при каждой переменной в модели множественной регрессии — это часто слишком амбициозная задача. Состоятельная оценка влияния переменной интереса — это уже успех. 
Обратите внимание на то, что с технической точки зрения (например, с точки зрения формул для вычисления МНК-оценок) нет разницы между контрольными переменными и переменными интереса. Разделение связано только с содержательными соображениями: интересующим вас исследовательским вопросом. 
Пусть, например, ваш вопрос таков: влияет ли образование на уровень доходов? В этом случае в регрессии: 
EARNINGS =˛ +˛ S +˛ EXP +˛ FEMALE +˝
i 12 i 3 i 4 ii 
переменная S, обозначающая число лет обучения респондента, будет переменной интереса. А переменные EXP и FEMALE, характеризующие опыт работы и пол респондента, соответственно будут контрольными. 
Однако если ваша статья посвящена исследованию дискриминации на рынке труда, то вы можете оценивать ту же самую модель, считая переменной интереса регрессор FEMALE, так как именно он обозначает интересную для вас характеристику работника. Контрольными переменными в этом случае будут факторы S и EXP. 
Так как включение дополнительных переменных в модель позволяет избежать несостоятельности коэффициентов, кажется, что разумно включать их в модель как можно больше. Просто на всякий случай. Приведет ли это к каким-то проблемам? Иными словами, к каким последствиям приводит включение в модель несущественного регрессора? Несущественным мы будем называть регрессор, который на самом деле не оказывает никакого влияния на зависимую переменную. 
Последствия включения в модель несущественной переменной: 
1 . Коэффициенты при прочих переменных остаются несмещенными и состоятельными. Действительно, если новый регрессор не влияет на зависимую переменную, то можно все равно считать, что он входит в модель, просто истинный коэффициент при нем равен нулю. 
2 . Из-за необходимости оценивать большее количество коэффициентов, а также из-за вероятной мультиколлинеарности увеличивается дисперсия оценок коэффициентов, т.е. снижается точность модели. 

Таким образом, включить в модель лишнюю переменную не так страшно, как пропустить нужную. Ведь в первом случае нет несостоятельности оценок, а во втором она возникает. Однако слишком много несущественных переменных включать в уравнение нецелесообразно, так как это негативно сказывается на точности ваших результатов. 
Поэтому хочется иметь набор правил, чтобы принимать решение, включать ли ту или иную переменную в уравнение. Ниже приведены некоторые соображения по этому поводу. 
Критерии для включения переменной в модель: 
1 . Роль переменной в уравнении опирается на прочные теоретические основания или хотя бы на здравый смысл. 
2 . Переменная статистически значима. 
3 . Оценки других коэффициентов сильно меняются при включении новой переменной в модель. То есть до этого они страдали от смещения из-за пропуска существенной переменной. Теперь вы эту существенную переменную добавили, и смещение пропало. 
4 . Скорректированный R-квадрат существенно увеличивается в результате включения переменной в модель. 

Ситуация 2 (сложная). Пропущенная переменная 

не наблюдаема 
Эта ситуация, в которой у вас отсутствуют данные о пропущенной переменной и достать их невозможно. В этом случае говорят, что пропущенная переменная ненаблюдаемая. 
Важным частным случаем является проблема самоотбора. Представим, что вы снова обратились к одному из наших любимых примеров − оценке влияния образования на уровень дохода. Вполне возможно, что индивиды принимают решение, получать ли им образование или нет, в зависимости от некоторого не наблюдаемого исследователем фактора, скажем, уровня таланта. Более талантливые индивиды после школы чаще принимают решение продолжить обучение в университете. Это и называется самоотбором. Тогда в терминах нашего уравнения (6.1) 
yi— это доход i-го индивида, xi— уровень его образования, а wi — ненаблюдаемый уровень таланта. Причем cov( i, i) > 0 так как талант
xw , ливые люди чаще решают получить высшее образование, и ˜3 > 0, так как талант в среднем способствует получению более высоких доходов. 
Ясно, что это как раз тот случай, когда 
cov(xw,)
^ p ii
˜ °˛˜ +˜ >˜
° ,
223 2
var()i
x 
и МНК-оценка будет завышать пользу от образования. 
Так как в этой ситуации мы не можем просто включить в уравнение нужную переменную, придется придумать что-то другое. К счастью, можно указать целых четыре пути решения проблемы эндогенности из-за пропуска ненаблюдаемой существенной переменной. 
Рассмотрим каждый из этих путей. 
Замещающие переменные . Замещающей переменной называется переменная, которая тесно коррелирована с ненаблюдаемой существенной переменной и при этом является наблюдаемой. 
В нашем примере с образованием такой переменной могли бы быть результаты IQ-теста. Ясно, что никакой тест не способен в полной мере описать природные способности человека, однако также ясно, что результаты хороших тестов будут коррелированы с этими способностями. 
Теперь представим, что вам важно измерить то, насколько удобно вести бизнес в данной стране. Удобство ведения бизнеса зависит от множества параметров, которые трудно измерить количественно, например характеристики законодательства, то, насколько это законодательство соблюдается, уровень коррупции и т.д. Поэтому напрямую переменную «удобство ведения бизнеса» включить в регрессионное уравнение не получится. Однако вместо нее вы можете использовать в качестве замещающей переменной один из многочисленных индексов, которые рассчитываются разными службами для оценки качества бизнес-среды, например индекс Ease of Doing Business Index (индекс легкости ведения бизнеса), который рассчитывается Мировым банком для сопоставления степени простоты ведения предпринимательской деятельности в разных странах. 
Включение замещающей переменной устраняет несостоятельность оценки коэффициента при регрессоре из-за пропуска существенного ненаблюдаемого фактора. 
Инструментальные переменные . В некоторых случаях у вас отсутствует переменная, тесно коррелированная с пропущенным ненаблюдаемым фактором, поэтому применить подход с замещающими переменными тоже невозможно. Зато вы можете отыскать данные о переменной, которая, наоборот, вообще не коррелирована с пропущенным ненаблюдаемым фактором и при этом коррелирована с вашей переменной интереса. 
В нашем примере в странах, где образование преимущественно платное, такой переменной мог бы быть, например, доход родителей индивида. Вряд ли богатство родителей гарантирует талант ребенка, однако оно дает ему гораздо больше возможностей для продолжения обучения. 
Оказывается, что такую переменную также можно применить для решения эндогенности. Как это сделать, мы подробно обсудим в гл. 8. 
Модели с фиксированными эффектами . Если вы располагаете данными за несколько периодов и пропущенный ненаблюдаемый фактор с течением времени меняется медленно (или вообще не меняется), то для получения состоятельных оценок коэффициентов подойдут модели, использующие панельные данные, в частности модели с фиксированными эффектами. Их применение подробно обсуждается в гл. 9. 
Контролируемый эксперимент . Представим, что в нашем примере был выпущен закон, в соответствии с которым в определенном регионе страны индивидам отныне запрещено самостоятельно решать, сколько лет они будут учиться. Теперь это определяется случайным образом, скажем, в ходе специальной лотереи. Законом строго предписывается, что каждому следует учиться ровно столько, сколько ему выпало в лотерее, и государству удается обеспечить его неукоснительное выполнение. 
Конечно, на практике трудно представить себе такую ситуацию, однако, используя свою силу воображения, вы сможете это сделать. Окажется, что в этом случае талант индивида больше никак не коррелирован с продолжительностью обучения (так как эта продолжительность определяется случайным образом, не зависящим от таланта): cov(xw,) = 0. Поэтому теперь МНК-оценка отдачи от образования
ii
снова станет состоятельной: 
p 0
^
˜ °˛˜ +˜ =˜
° .
223 2
var(xi ) 
Мы описали пример контролируемого эксперимента. Можно видеть, что такой подход также решает проблему эндогенности. В гл. 1 мы уже упоминали преимущества использования экспериментальных данных. Более детально мы обсудим этот вопрос в гл. 11, где будет освещен ряд соответствующих продвинутых методов1. 
В этом параграфе мы проанализировали широкий арсенал методов устранения эндогенности, вызванной пропуском существенной переменной. В следующих параграфах нас ждет аналогичное обсуждение для других источников эндогенности. 

7 .2 . Эндогенность из-за выбора неверной функциональной формы связи 
Неверная функциональная форма уравнения приводит к эндогенности регрессора. Действительно, представим, что в нашем примере про образование отдача от него является убывающей и описывается квадратичной функцией: 
y =ˆ+ˆ ˙ x +ˆ ˙ x2 +ˇ , ˆ> 0, ˆ< 0.
i 12 i 3 ii 23 
Рассмотрение линейной модели вместо нелинейной эквивалентно пропуску существенной переменной (в данном случае это переменная x2 ) и приводит к таким же последствиям2. 
1 Примеры контролируемых экспериментов в оценке эффективности образования не всегда являются утопией. Так, в 80-х годах XX в. в Далласе несколько тысяч школьников в ходе контролируемого эксперимента случайным образом распределялись по классам разного размера. Детали этой истории вы можете найти в гл. 11 данного учебника или в работе: Kreuger (1999) Experimental Estimates of Education Production Functions // The Quarterly Journal of Economics. 
2 Если истинная модель является не квадратичной, а какой-либо иной, например линейно-логарифмической, то это сохраняет вывод об эндогенности регрессора в неверно специфицированном уравнении. Формально в этом нетрудно убедиться, вспомнив, что логарифм можно аппроксимировать квадратичной функцией или полиномом более высокого порядка. 
Для решения указанной проблемы следует отыскать корректную функциональную форму связи. Соображения, которые позволяют это сделать, изложены в § 4.3 гл. 4. Поэтому здесь мы лишь кратко напомним, что для выявления верной функциональной формы могут быть полезны следующие шаги: 
1) осуществите графический анализ исходных данных и графический анализ остатков оцененного уравнения регрессии; 
2) опирайтесь на экономическую теорию или другие содержательные соображения по поводу природы анализируемых переменных (в конце концов эконометрику можно применять для ответов не только на экономические вопросы); 
3) используйте формальные статистические критерии. 

7 .3 . Эндогенность из-за двусторонней причинно-следственной связи 
Следующая важная ситуация, которая приводит к эндогенности — одновременная причинно-следственная связь (ее также называют двусторонней, или двунаправленной). 
Снова воспользуемся примером. Представим, что нас интересует, насколько эффективно работает полиция в некотором городе. Мы полагаем, что увеличение числа полицейских в определенном районе должно приводить к уменьшению числа преступлений в этом районе: 
y =˙+˙ ˝ x +ˆ , ˙< 0,
i 12 ii 2 
где yi — количество преступлений в i-м районе; xi — число полицейских в i-м районе. Если в какой-то район мы отправили много полицейских, то количество преступлений в нем должно сокращаться. Говоря совсем кратко, получается, что чем больше x, тем меньше y. Поэтому мы и ожидаем, что ˜2 < 0. Предположим, что городской департамент полиции планирует количественно оценить указанный эффект и нанял для этого нас. Для достижения указанной цели мы нуждаемся в состоя
тельной оценке коэффициента ° 2. 
Проблема, однако, состоит в том, что кроме влияния числа полицейских на число преступлений наверняка существует и обратная причинно-следственная связь. Скорее всего чем более криминогенным является данный район, тем больше туда будет направлено служителей правопорядка. В виде уравнения это влияние можно описать, например, так: 
x =˙+˙ ˝ y + u , ˙> 0.
i 12 ii 2 
Положительный коэффициент &#23;2 отражает гипотезу о том, что чем выше в районе преступность, тем больше туда будет отправлено полицейских. 
В нашем примере не только x влияет на y, но и y влияет на x. Поэтому мы имеем дело не с отдельным уравнением, а с системой уравнений: 
˙
ˇ y =&#22;+&#22; &#23; x +&#21; , &#22;< 0
i 12 ii 2
ˆ (7.2)
x =&#20;+&#20; &#23; y + u , &#20;> 0
˘ i 12 i
ˇ i 2 
Покажем, что, даже если случайные ошибки двух уравнений не связаны друг с другом: cov( , i )0
ui ˜=, регрессор в нашей модели все равно будет эндогенным. Для этого вычислим его ковариацию со случайной ошибкой в первом уравнении системы. Чтобы это сделать, надо провести следующее преобразование: выразить эндогенные переменные 
x è y через экзогенные ˝i è ui .
ii 
Подставим первое уравнение системы во второе: 
x =˝+˝ ˛(˙+˙ ˛ x +ˆ ) + u .
i 1 212 ii i 
Выразив xi , получим: 
˝ +˝˙ +˝ˆ+u
1 21 2 ii
x = .
i 
1−˝˙
22 
Аналогичную операцию можно проделать со второй переменной. В итоге получим новую систему: 
˝ ˘+˘&#23; +˘&#22;+u
1 21 2 ii
ˆx = 
i 
1−˘&#23;
ˆ
˙ 22 (7.3)
&#23; +˘&#23; +&#22;+&#23;u
ˆ 1 12 i 2 i
y = 
ˆ i 
1−˘&#23;
ˇ 22 
Система (7.2) называется системой в структурной форме. Система 
(7.3) называется системой в приведенной форме, так как в ней эндогенные переменные выражены через экзогенные. 
Такое представление дает возможность легко подсчитать ковариацию между xè ˝ . Для этого достаточно воспользоваться первым
ii 
уравнением системы (7.3): 
ˇ° +°˛ +°˜+u &#22; °&#19;cov(˜,˜)
1 21 2 ii 2 ii
cov(x, ˜)cov &#23; ,˜&#20;= =
= 
ii i
1 −°˛ 1−°˛
˘&#21;
22 22 
˙2 ˝var(ˆi) =>0.
1−˙ˇ
22 
Чтобы определить знак последней дроби, мы воспользовались первоначальными ограничениями на параметры: ˜> 0 è °< 0.
22 
Оказывается, что из-за того, что ситуация описывается не одним уравнением, а системой, регрессор x эндогенен: он коррелирован со случайной ошибкой. 
Как мы доказали ранее в гл. 6 (см. равенство (6.1) в § 6.3), МНКоценки коэффициентов сходятся по вероятности к величине: 
cov(x, °)
^ p ii
˜ ˛˝˜ +
˛ .
2 2 var()i
x 
В нашем случае это означает следующее: 
cov(x, °) &#22; 1 ˛ˆvar(°) &#19;
^ p ii 2 i
˜˝˙˜+ =˜+ ˆ &#17;>˜2.
˝
22 &#20; 2
() &#21; x 1−˛˜ &#18;
var x var()
ii 22 
Мы показали, что МНК-оценка будет несостоятельна и завышена. Так как ˜2 < 0, то в нашем примере при использовании обычного МНК мы часто будем получать оценку, сдвинутую к нулю. Иными словами, мы будем недооценивать эффективность полиции. Если эффект завы
^ 
шения силен, то мы получим оценку коэффициента ° 2 настолько близкую к нулю, что даже сочтем ее незначимой, т.е. сделаем ошибочный вывод о бесполезности полиции. В крайнем случае возможна даже ситу
^ 
ация ˜2 > 0, что может привести нас к решению о том, что полиция способствует увеличению, а вовсе не снижению количества преступлений. 
Этот пример показывает, что в ситуации двусторонней причинноследственной связи обычный МНК применять не следует, так как его использование приведет к несостоятельности интересующей нас оценки даже при использовании больших выборок. 
Проблема одновременной причинно-следственной связи и сопутствующие ей трудности при оценивании встречаются в исследованиях часто, причем гораздо чаще, чем хотелось бы прикладным эконометристам. Представим, например, традиционную проблему идентификации при оценке последствий макроэкономической политики: как изменение ключевой ставки процента1 влияет на уровень инфляции? При ответе на этот вопрос придется принимать во внимание, что, с одной стороны, увеличение ключевой ставки сдерживает рост инфляции (т.е. ключевая ставка влияет на инфляцию), однако, с другой стороны, увеличение инфляции может побудить центральный банк изменить свою политику (т.е. инфляция влияет на политику центрального банка и, следовательно, на ключевую ставку). Даже простой анализ конкурентного равновесия на рынке некоторого товара приведет нас к системе по меньшей мере из двух одновременных уравнений: кривой спроса и кривой предложения, что снова потребует анализа одновременной причинно-следственной связи. 
Обратите внимание, что в нашем примере про полицию в модели нет никаких пропущенных переменных, поэтому включение их в уравнение не может решить проблему. Придется использовать другие пути получения состоятельной оценки коэффициента в условиях двусторонней причинно-следственной связи: 
1) используйте инструментальные переменные; 
2) используйте методы, основанные на оценке систем одновременных уравнений (вместо оценки отдельных уравнений); 
3) осуществите контролируемый эксперимент. 
Применительно к пространственным и панельным данным в современных исследованиях более распространен первый подход. Мы обсудим его в гл. 8. Второй подход в настоящее время в основном используется для временных рядов2 и потому выходит за рамки нашего вводного учебника. 
Наконец, использование экспериментов подробно обсуждается в гл. 11. По аналогии с предыдущими примерами вы вполне можете догадаться, как может быть устроен эксперимент в данном случае. Департаменту полиции следует определять количество полицейских в ряде районов случайным образом, т.е. независимо от наблюдаемого там уровня 
1 Напомним, что ключевая ставка — это ставка, по которой центральный банк предоставляет кредиты коммерческим банкам. Она играет решающую роль при установлении процентных ставок по банковским кредитам. 
2 См. модели структурных векторных авторегрессий (structural vector autoregression, SVAR) или векторной коррекции ошибок (vector error correction model, VECM). 
преступности. В этом случае обратная причинно-следственная связь в указанных районах пропадет, что позволит состоятельно оценить коэффициент ° 2 при помощи обычного МНК. 

7 .4 . Эндогенность из-за ошибок измерения 
*
Пусть переменные yiи xсвязаны точным соотношением:
i 
* 
y=˝+˝ ˛ x.
i 12 i 
Однако вместо точных значений регрессора мы наблюдаем измерен
*
ные с ошибкой значения: x= x * +˛ , cov(x, ˜=) 0.
iii ii 
Оценим методом наименьших квадратов уравнение: 
y=˝+˝ ˛ x+ u.
i 12 ii 
^ 
Покажем, что и в этом случае МНК-оценка ° 2 будет несостоятельной. 
Так как y=˙+˙ ˝(x−ˆ ) =˙+˙ ˝ x−˙ ˝ˆ , то
i 12 ii 12 i 2 i 
u=−˝˙˛ ;
i 2 i 
* 
, ) cov(x+°, −˜ )
p cov(xu ˙° 
^ ii ii 2 i
˜˛˝˜+ + =
˛ =˜
22 2
var() var(xi
xi ) 
*
cov(x,˙+ ˙ ,˙ ) var(
)cov( ˙ )
iiii i
=˝−˝ =˝−˝ = 
22 22
var(xi) var()i
x 
*
var(ˆi) var(xi) =˙−˙ = ˝˙ .
22* *2
var ˆ+ var()x var()ˆ+ x
() var()
ii ii 
*
var(xi)
Величина <1, поэтому независимо от знака ° 2 эта
* 
var()i var()i
˜+ x 
оценка несостоятельна и смещена к нулю. 
Можно привести много примеров ситуаций, когда в эконометрическом исследовании приходится мириться с ошибками измерения. Скажем, если вашим регрессором является уровень безработицы или валовой внутренний продукт, вы неизбежно столкнетесь с этой проблемой, так как статистические службы не могут измерить указанные показатели идеально точно. 
Исследования, опирающиеся на индивидуальные данные, также иногда связаны с ошибками измерений. Типичная ситуация — использование данных, основанных на опросах. Если регрессором в вашей модели является возраст индивида, информация о котором собрана в ходе опроса (например, в процессе переписи населения), то скорее всего в измерениях будут содержаться неточности: демографам хорошо известно, что многие индивиды склонны при ответах на вопросы о возрасте округлять его до чисел, кратных пяти или десяти годам. Похожий эффект возникает и в случае ответов на вопросы о доходе. 
Конечно, в условиях ошибок измерений всегда можно посоветовать исследователю найти данные поточнее. Это хороший совет. Однако, к сожалению, на практике последовать ему удается далеко не всегда, поэтому приходится использовать альтернативный путь. 
Как мы выясним в гл. 8, проблема ошибок измерения также может быть решена при помощи инструментальных переменных. 
Иногда, однако, эту проблему просто игнорируют. Мотивация тут такая: если вам интересна не количественная оценка силы влияния переменной x на переменную y, а просто сам факт наличия или отсутствия этого влияния, то, получив статистически значимый коэффициент при регрессоре, вы можете не предпринимать дальнейших корректировок. Действительно, мы точно знаем, что ошибки измерения сдвигают оценку коэффициента к нулю. Поэтому, если коэффициент оказался значимым даже в условиях ошибок измерения, то после их устранения он тем более должен быть значим. 
7 .5 . Другие (помимо эндогенности) потенциальные угрозы обоснованности выводов эконометрического исследования 
Хотя эндогенность является наиболее существенным препятствием для получения надежных выводов при помощи эконометрики, есть и другие аспекты, о которых не следует забывать в процессе моделирования. В этом разделе мы прокомментируем основные из них: 
• 
мультиколлинеарность; 

• 
нарушение предпосылок о гомоскедастичности или о независимости случайных ошибок; 

• 
неоднородность выборки; 

• 
угрозы внешней обоснованности выводов. 



Мультиколлинеарность 
Мультиколлинеарность не является первоочередной проблемой, так как ее наличие в модели не приводит к смещению оценок коэффициентов. Поэтому если вы не наблюдаете серьезных негативных последствий мультиколлинеарности, то и бороться с ней не нужно. Напомним (см. детали в § 3.1), что под серьезными проблемами в этом контексте мы понимаем сильные проявления следующих традиционных симптомов мультиколлинеарности: 
—
 Неустойчивость результатов . Небольшое изменение исходных данных приводит к существенному изменению оценок коэффициентов. 

— 
Незначимость большинства переменных. Каждая переменная в отдельности является незначимой, а уравнение в целом − значимым и характеризуется высоким R2. 

—
 Неправдоподобность результатов . Оценки коэффициентов имеют неправильные с точки зрения экономической теории знаки или неоправданно большие значения. 


Однако даже если вы столкнулись с этими признаками, то прежде чем бороться с мультиколлинеарностью, подумайте, не обусловлены ли указанные странности эндогенностью регрессоров? Например, неправдоподобные знаки коэффициентов могут быть вызваны смещением из-за пропуска существенной переменной, а незначимость переменной интереса может объясняться ошибками измерения. В такой ситуации нужно устранять не мультиколлинеарность, а эти, гораздо более критичные, проблемы. 

Гетероскедастичность случайных ошибок 
или коррелированность случайных ошибок, относящихся 

к разным наблюдениям 
В условиях гетероскедастичности МНК-оценки коэффициентов остаются несмещенными и состоятельными (см. детали в гл. 5). Поэтому, как и мультиколлинеарность, эта проблема является менее критичной, чем проблема эндогенности. 
Основная рекомендация в связи с возможной гетероскедастичностью — не забывайте использовать состоятельные в условиях гетероскедастичности (робастные) стандартные ошибки. Иначе результаты тестирования гипотез и построенные вами доверительные интервалы будут некорректными (даже при том, что сами коэффициенты модели будут оценены состоятельно). 
В некоторых моделях случайные ошибки, относящиеся к разным наблюдениям, могут быть коррелированы друг с другом. Одним из примеров такой ситуации является автокорреляция, рассмотренная в конце § 5.5 гл. 5. Другой типичный пример — модели на панельных данных. Он будет проанализирован в гл. 9. Там будет показано, что в этом случае для решения проблемы также достаточно использовать специальный тип робастных стандартных ошибок. 

Неоднородность выборки 
Неоднородностью выборки будем называть ситуацию, когда часть наблюдений существенным образом отличается от основного массива данных. Подобные резко отличающиеся наблюдения называют выбросами. Как правило, следует исключать выбросы из выборки. 
Представим, например, что вы исследуете влияние неравенства на экономический рост, используя межстрановые данные. Все страны в вашей выборке являются развитыми европейскими экономиками за единственным исключением: одна страна оказалась развивающейся экономикой из Южной Америки, например, это Венесуэла. Не имея ничего против Венесуэлы, отметим, что, по всей видимости, ее институты, уровень экономического развития и многие другие характеристики довольно сильно отличаются от аналогичных характеристик типичной развитой европейской страны. Поэтому наверняка и модель экономического роста для такой страны будет другой. Чтобы в полной мере учесть это отличие, пришлось бы добавить неоправданно много контрольных переменных. Поэтому лучше просто исключить Венесуэлу из выборки. 
Другая похожая ситуация — исследования на региональных данных по России. В таких работах из выборки часто исключают, например, Москву, так как она резко отличается от других регионов сразу по ряду характеристик: плотность и численность населения, размер валового регионального продукта, средняя заработная плата и т.д. 
Примеры неоднородности данных легко привести и на микроуровне. Представим исследователя, анализирующего влияние физических характеристик баскетболиста на его доходы в профессиональном спорте. Если массив данных, на который опирается исследователь, состоит из информации о двух сотнях спортсменов, играющих в российских баскетбольных турнирах, и о его любимом Майкле Джордане1, то информацию о последнем, увы, придется из выборки исключить. 
1 Майкл Джордан — шестикратный чемпион национальной баскетбольной ассоциации, который по версии ряда источников является величайшим баскетболистом всех времен и народов. В контексте нашего примера стоит также отметить, что Forbes называет Майкла Джордана самым высокооплачиваемым спортсменом в мире за всю историю профессионального спорта. 
Формально наличие существенных выбросов нарушает предпосылку 2 линейной модели со стохастическими регрессорами, что может приводить к проблемам с состоятельностью и асимптотической нормальностью оценок. Однако обычно целесообразность исключения нетипичных наблюдений понятна и просто из соображений здравого смысла. Вряд ли статистика великого Майкла Джордана, игравшего в НБА в прошлом веке, может дать какую-то полезную информацию о заработках типичного российского баскетболиста в наши дни, скорее она непоправимо исказит результаты. 
Обычно потенциальная неоднородность данных может быть обнаружена на этапе их первичного анализа, в частности анализа гистограмм распределения данных и диаграмм рассеяния. Кроме того, для выявления отдельных неоднородных наблюдений или целых подвыборок полезно хорошо разобраться в содержательной стороне исследуемого вопроса. 

Угрозы внешней обоснованности выводов 
Приведенный выше пример про баскетболистов может быть полезен для обсуждения еще одного важного вопроса: как корректно определить границы, в рамках которых можно обобщать выводы эконометрического исследования. 
В соответствии с определением, данным в работе Стока и Ватсона [Stock, Watson, 2010], будем называть выводы эконометрического моделирования по поводу причинно-следственных связей внутренне обоснованными, если они применимы к проанализированной в исследовании генеральной совокупности. 
Соблюдение рекомендаций данной главы позволяет гарантировать внутреннюю обоснованность за счет обеспечения состоятельности оценок коэффициентов и корректного определения их стандартных ошибок. При этом, однако, важно четко определять рамки анализируемой генеральной совокупности. Скажем, если (как в примере выше) исследование осуществлено на основе информации о двух сотнях российских баскетболистов, то анализируемой генеральной совокупностью можно считать всех (именно) российских (именно) баскетболистов. Это значит, что полученные выводы не следует распространять на всех баскетболистов мира или на представителей других видов спорта. 
Более того, если в процессе пристального рассмотрения данных окажется, что все баскетболисты в выборке были мужчинами в возрасте от 20 до 25 лет, то границы анализируемой генеральной совокупности должны быть сужены до этой категории спортсменов и не могут быть распространены на игроков старше 40 или женщин-баскетболисток, даже если они из России. 
Аналогично на основе исследования по данным развитых европейских экономик можно делать выводы относительно развитых стран из Европы, но не по поводу, например, африканских стран. Во втором случае они будут необоснованными из-за игнорирования важных институциональных различий1. 
В некоторых случаях эконометрист может претендовать на то, что выводы его исследования являются не только внутренне, но и внешне обоснованными. Выводы эконометрического исследования называются внешне обоснованными, если их можно перенести с исследованной генеральной совокупности и заданных условий на другие генеральные совокупности и условия, например, если вы используете данные обследования студентов Новосибирского государственного университета, чтобы формулировать те или иные суждения по поводу склонности к списыванию у студентов Санкт-Петербургского государственного университета. 
Для обеспечения внешней обоснованности необходимо дополнительно к требованиям внутренней обоснованности гарантировать выполнение еще двух условий: 
• 
Отсутствие различий в генеральных совокупностях . В нашем примере это означает, что студенты НГУ и СПбГУ должны быть похожи друг на друга по своим основным характеристикам. 

• 
Отсутствие различий в условиях . Даже если студенты НГУ и СПбГУ полностью идентичны, они могут находиться в разных институциональных условиях. Это может делать выводы, полученные на основе анализа одной группы студентов, неприменимыми по отношению к другой группе. Например, если речь идет о склонности к списыванию, то выводы могут быть искажены различием уровней строгости наказаний за нарушения академической этики, принятых в разных университетах. 


Учитывая очевидность этой рекомендации, кажется удивительным, насколько часто она игнорируется не только начинающими эконометристами, но и вполне респектабельными людьми, дающими рекомендации по выбору мер экономической политики. Примеры провалов реформ, которые проводились в развивающихся странах на основе моделей, разработанных для развитых экономик, приводятся в остроумной книге Уильяма Истерли (Истерли В. В поисках роста: Приключения и злоключения экономистов в тропиках / Пер. с англ. М.: Институт комплексных стратегических исследований, 2006). 
Пример 7.1. Стоимость колготок 
в московских оптовых торговых фирмах 
Массив данных о стоимости продукции двух фирм − производителей колготок осенью 1997 г. вы можете найти в файле Tights.xlsx. Советуем проделать все вычисления, описанные в решении этого примера, чтобы лучше разобраться в деталях. 
Переменные: 
PRICE — цена колготок в рублях 1997 г.; 
DEN — плотность колготок, %; 
POLYAMID — доля содержания полиамида, %; 
LYKRA — доля содержания лайкры, %; 
COTTON — доля содержания хлопка, %; 
WOOL — доля содержания шерсти, %; 
°0, åñëè˙ïðîèçâîäèòåëü˙êîëãîòîêôèðìà Levante,
FIRM =˛
1, åñëè˙˙ïðîèçâîäèòåëü˙êîëãîòîê– ôèðìà GoldenLady.
˝ 
Вас интересует ответ на следующий исследовательский вопрос: если рассматривать продукцию с одинаковыми характеристиками, будет ли различаться цена для двух фирм? Если да, то какая фирма устанавливает более высокие цены? 
а . На основании анализа средних значений по группам скажите, различаются ли цены на колготки у разных производителей? Каковы недостатки такого подхода? 
Решение. 
Ограничив выборку условием FIRM = 1, получаем подвыборку колготок, произведенных фирмой Golden Lady. Среднее значение цены для этой подвыборки составляет 15 206 руб. 
Ограничив выборку условием FIRM = 0, получаем подвыборку колготок, произведенных фирмой Levante. Среднее значение цены для этой подвыборки составляет 16 382 руб. 
Получается, что колготки Levante дороже в среднем примерно на 1000 руб. Недостаток такого подхода состоит в том, что он мало говорит о готовности потребителей доплачивать именно за товар данной фирмы-производителя. Возможно, дело не в бренде, а, например, в составе колготок. Иными словами, простое сравнение средних не позволяет учесть прочие важные факторы. 
б . Постройте уравнение зависимости цены колготок от их плотности, состава и производителя. Не забудьте использовать состоятельные в условиях гетероскедастичности стандартные ошибки. 
Решение . 
Модель 1: МНК, использованы наблюдения 1-74 Зависимая переменная: Price 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const DENpolyamidlykracottonwool −4644,35176,448103,653391,328156,537476,064 59396,139,6128597,609544,700584,2051150,73 −0,078194,4540,17340,71840,26790,4137  0,9379<0,00010,86280,47500,78960,6804  ***  
Сумма кв. остатковR-квадратF (5, 68)  2,16e+090,49068113,10230  Ст. ошибка моделиИспр. R-квадрат Р-значение (F)  5641,8410,4532316,17e-09  

в . Можно ли считать, что уравнения, описывающие цены колготок для двух рассматриваемых фирм, отличаются друг от друга? Проведите тест Чоу. 
Решение . 
Для осуществления теста Чоу нужно оценить новую модель, добавив в нее соответствующую переменную сдвига и все необходимые переменные наклона, как это показано в таблице ниже: 
Расширенная регрессия для теста Чоу МНК, использованы наблюдения 1-74 Зависимая переменная: Price Пропущены из-за совершенной коллинеарности: fi_wool 
Коэффициент Ст. ошибка t-статистика P-значение const −152808 118428 −1,290 0,2017DEN 221,721 51,9178 4,271 6,70e-05 *** polyamide 1554,64 1178,86 1,319 0,1920lykra 1922,61 1212,67 1,585 0,1179 cotton 1595,87 1173,40 1,360 0,1787wool 3333,75 2346,56 1,421 0,1603firm −296013 168911 −1,752 0,0846 * firm*DEN −96,1882 81,2445 −1,184 0,2409firm*polyamide 2992,42 1679,25 1,782 0,0796 * firm*lykra 3114,42 1798,28 1,732 0,0882 * firm*cotton 3011,39 1698,10 1,773 0,0810 * 
Среднее зав. перемен 15841,89 Ст. откл. зав. перемен 7629,898 Сумма кв. остатков 1,98e+09 Ст. ошибка модели 5612,979R-квадрат 0,532946 Испр. R-квадрат 0,458810F(10, 63) 7,188806 Р-значение (F) 1,93e-07Лог. правдоподобие −737,8770 Крит. Акаике 1497,754Крит. Шварца 1523,099 Крит. Хеннана-Куинна 1507,864 
Тест Чоу для структурных изменений в точке firm 
F(5, 63) = 1,14022; P-значение 0,349 Примечание: используется F-статистика, состоятельная в условиях гетероскедастичности 
Из таблицы видно, что P-значение для теста Чоу составляет 0,349, что больше 0,05. Таким образом, даже при использовании 5%-го уровня значимости мы не отвергаем гипотезу об отсутствии структурного сдвига между моделями для цены колготок двух разных производителей. 
Есть некоторый соблазн остановить на этом процесс нашего исследования. Казалось бы, мы получили ответ на сформулированный в начале задания исследовательский вопрос: бренд не имеет значения. Однако, прежде чем это сделать, следует более обстоятельно проанализировать качество полученной модели. 
г . Как можно объяснить большое количество незначимых переменных в уравнении из пункта (б)? Может быть, существует мультиколлинеарность? Чему равно значение коэффициентов VIF для модели из предыдущего пункта? 
Как правило, колготки делают только из хлопка, шерсти, лайкры и полиамида (поэтому обычно сумма долей этих 4 элементов должна составлять 100%). Для проверки данного предположения создадим новую переменную, представляющую собой остаток: 
REST = 100 – COTTON – LYKRA – POLYAMID – WOOL. 
Для каких наблюдений эта переменная не равна нулю? Исключите их из выборки. Оцените регрессию заново, исключив из нее переменную POLYAMID, чтобы устранить мультиколлинеарность. 
Решение . 
Из результатов оценивания модели в пункте (б) мы видим, что все переменные, кроме переменной DEN, незначимы. Полученный результат можно объяснить мультиколлинеарностью. Действительно, в большинстве случаев колготки состоят из четырех материалов, учтенных в модели: COTTON, LYKRA, POLYAMID и WOOL. Следовательно, обычно сумма долей четырех этих составляющих будет близка к 100%, т.е. между указанными переменными существует почти строгая линейная связь. 
Для проверки нашего предположения вычислим значения коэффициентов VIF: 
DEN 1,746polyamid 251,545lykra 89,774 cotton 93,498wool 57,581 
Очевидно, что для перечисленных выше четырех переменных коэффициенты VIF существенно больше 10, а это свидетельствует о сильной мультиколлинеарности. 
Для проверки нашего предположения о том, что практически всегда колготки на 100% состоят из хлопка, лайкры, полиамида и шерсти, создадим новую переменную, представляющую из себя остаток: 
REST = 100 – COTTON – LYKRA – POLYAMID – WOOL. 
Проанализировав значения этой переменной в выборке, выясняем, что лишь для двух наблюдений переменная REST ˆ 0. Исключим из выборки эти нетипичные наблюдения. 
Далее, рассмотрев значения переменной POLYAMID, мы увидим, что для всех наблюдений его значение велико и близко к 100%. Исключив его из регрессии, мы будем воспринимать его как материал «по умолчанию». Это позволит в значительной мере решить проблему мультиколлинеарности. Оценим на новой выборке регрессию с переменными COTTON, DEN, LYKRA и WOOL. 
Модель 2: МНК, использованы наблюдения 1-72 Зависимая переменная: Price Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const DEN lykra cotton wool  4850,27175,399367,03258,2704−249,251  1800,0544,439692,458061,7878554,391  2,6953,9473,9700,9431−0,4496  0,00890,00020,00020,34900,6545  *** *** ***  
Среднее зав. переменСумма кв. остатковR-квадратF (4, 67)Лог. правдоподобиеКрит. Шварца  15561,112,10e+090,44578925,40284−720,96881463,321  Ст. откл. зав. перемен Ст. ошибка модели Испр. R-квадратР-значение (F)Крит. Акаике Крит. Хеннана-Куинна  7307,1945599,8970,4127027,92e-131451,9381456,469  

Вычислив коэффициенты VIF для новой модели, видим, что мультиколлинеарность действительно устранена (так как все коэффициенты заметно меньше 10): 
DEN 1,496lykra 3,109 cotton 1,430wool 3,147 
д . Можно ли что-то еще сделать для получения более однородных данных? Посмотрим на данные подробнее. 
Во-первых, обратимся к переменной WOOL: по шерсти только два наблюдения не равны 0. Скорее всего это другой вид колготок, который описывается другой моделью, поэтому исключим их. 
Во-вторых, проанализируем дополнительно данные по переменной COTTON. Только три наблюдения имеют очень высокие значения. Скорее всего это совершенно другой вид колготок. Исключим из выборки все наблюдения, для которых содержание хлопка составляет 40% или выше. 
Снова оцените модель из предыдущего пункта, используя новую ограниченную выборку, т.е. оцените регрессию переменной PRICE на константу и переменные DEN, LYKRA, COTTON (переменную WOOL больше не имеет смысла включать в уравнение, так как теперь она для всех наблюдений равна нулю). 
Как устранение мультиколлинеарности и переход к более однородным данным сказались на значимости оценок коэффициентов в данном примере? 
Решение . 
Исключение переменных по указанным в данном пункте критериям приводит к выборке из 67 наблюдений. Оценим параметры регрессионной модели по этим данным. 
Модель 3: МНК, использованы наблюдения 1-67 Зависимая переменная: Price Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const DENlykra 5128,89160,371256,3242085,87 1596,2243,617673,8774529,272  3,2133,6773,4703,941  0,00210,00050,00090,0002  *** *** *** ***  
Сумма кв. остатковR-квадратF (3, 63)  1,66e+090,47264317,17920  Ст. ошибка моделиИспр. R-квадратР-значение (F)  5134,6730,4475312,91e-08  

Отметим, что устранение мультиколлинеарности и использование однородной выборки приводит к получению статистически значимых коэффициентов при всех переменных в модели. 
е . Вернемся к интересующему нас вопросу о важности фирмы-производителя. Для модели из предыдущего пункта проведите тест Чоу, чтобы получить ответ на этот вопрос. Используйте 5%-й уровень значимости. 
Если выяснилось, что структурный сдвиг между моделями ценообразования разных фирм существует, то оцените модель из пункта (д) заново, добавив в нее переменную FIRM, т.е. оцените регрессию переменной PRICE на константу и переменные DEN, LYKRA, COTTON, FIRM. Интерпретируйте полученный результат. 
Решение . 
Результаты теста Чоу для модели из пункта (д) представлены ниже. Обратите внимание, что соответствующее P-значение равно 0,014, т.е. меньше 0,05. Следовательно, при уровне значимости 5% мы можем заключить, что структурный сдвиг существует и добавление в модель переменной, характеризующей фирму производителя, скорее всего является оправданным. 
Расширенная регрессия для теста Чоу МНК, использованы наблюдения 1-67 Зависимая переменная: Price Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const  3084,33  1738,94  1,774  0,0813  *  
DEN  203,996  71,8443  2,839  0,0062  ***  
lykra  228,206  114,550  1,992  0,0510  *  
cotton  2244,67  693,342  3,237  0,0020  ***  
firm  1950,90  2892,84  0,6744  0,5027  
firm*DEN  −80,0647  81,1609  −0,9865  0,3279  
firm*lykra  243,035  153,016  1,588  0,1176  
firm*cotton  −27,6460  1129,56  −0,02448  0,9806  

Среднее зав. перемен 14856,72 Ст. откл. зав. перемен 6908,103 Сумма кв. остатков 1,50e+09 Ст. ошибка модели 5046,583 R-квадрат 0,522927 Испр. R-квадрат 0,466325 F(7, 59) 12,99036 Р-значение (F) 5,58e-10 Лог. правдоподобие −662,0824 Крит. Акаике 1340,165 Крит. Шварца 1357,802 Крит. Хеннана-Куинна 1347,144 
Тест Чоу для структурных изменений в точке firm
 Хи-квадрат(4) = 13,7517 P-значение 0,0081 
F-статистика: F(4, 59) = 3,43792 P-значение 0,014 
Ниже представлены результаты оценивания с включением новой переменной. Легко видеть, что коэффициент при переменной FIRM статистически значим при 5%-м уровне и составляет около двух с половиной тысяч. Следовательно, при прочих равных условиях (т.е. при одинаковой плотности и сходном составе) колготки фирмы Golden Lady стоят на 2,5 тыс. руб. больше, чем колготки фирмы Levante1. 
1 Точнее, стоили в 1997 г. 
Модель 4: МНК, использованы наблюдения 1-67 Зависимая переменная: Price Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение 
const 2728,33 1396,87 1,953 0,0553 * DEN 166,223 43,0672 3,860 0,0003 *** lykra 329,380 75,4975 4,363 <0,0001 *** cotton 2203,03 543,331 4,055 0,0001 *** firm 2566,69 1266,24 2,027 0,0470 ** 
Сумма кв. остатков 1,57e+09 Ст. ошибка модели 5036,107R-квадрат 0,500748 Испр. R-квадрат 0,468538F (4, 62) 23,97258 Р-значение (F) 5,16e-12 
ж . Измените функциональную форму модели на логарифмическилинейную, т.е. оцените регрессию логарифма переменной PRICE на константу и переменные DEN, LYKRA, COTTON, FIRM. Интерпретируйте полученный результат. 
Решение . 
Результаты оценивания логарифмически линейной модели представлены ниже: 
Модель 5: МНК, использованы наблюдения 1-67 Зависимая переменная: l_Price Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 8,44591 0,123112 68,60 <0,0001 *** DEN 0,0115825 0,00241486 4,796 <0,0001 *** lykra 0,0352771 0,00608287 5,799 <0,0001 *** cotton 0,148974 0,0284931 5,228 <0,0001 *** firm 0,286642 0,0766869 3,738 0,0004 *** 
Сумма кв. остатков 6,106496 Ст. ошибка модели 0,313834R-квадрат 0,608580 Испр. R-квадрат 0,583327F (4, 62) 29,38280 Р-значение (F) 1,03e-13 
Очевидно, что и в данном случае переменная, характеризующая фирму-производителя, статистически значима. Интерпретировать коэффициент при этой переменной можно так: при прочих равных условиях (т.е. при одинаковой плотности и сходном составе) колготки фир
e029, 
−°мы Golden Lady стоят на ( 1) 100% =33% больше, чем колготки фирмы Levante. 
з . Осуществите тесты Рамсея для моделей из пунктов (е) и (ж). Используйте 5%-й уровень значимости. В соответствии с результатами тестов сделайте вывод, какая функциональная форма связи в данном случае является более оправданной: линейная или логарифмически линейная? 
Решение . 
Для модели из пункта (е) P-значение теста Рамсея составляет 0,46 (т.е. больше 0,05), а для модели из пункта (ж) оно равно 0,015 (т.е. меньше 0,05). 
Следовательно, в первом случае гипотеза о корректности спецификации не отвергается, а во втором отвергается. Можно заключить, что более оправдано использование линейной спецификации модели. Впрочем, это не очень важно, так как выводы по поводу знака и значимости коэффициента при интересующей нас переменной совпадают. 
и . На основе анализа всех полученных результатов дайте ответ на исследовательский вопрос, сформулированный в самом начале этого задания. 
Решение . 
Мы получили устойчивый к изменению спецификации модели вывод о том, что при одинаковой плотности и сходном составе колготки фирмы Golden Lady стоят дороже колготок ее конкурента. 
Примечание: обратите внимание, что в процессе решения задания для получения корректного ответа на интересующий нас вопрос пришлось проделать долгий путь. На этом пути мы использовали комбинацию нескольких идей по улучшению качества модели, описанных в данной главе: получение однородной выборки за счет устранения выбросов; преодоление негативных последствий сильной мультиколлинеарности; сопоставление различных функциональных форм уравнения регрессии. 

7 .6 . Чек-лист эконометриста 
Подводя итоги главы, сформулируем следующий краткий список вопросов, на который вам следует отвечать каждый раз, когда вы хотите решить, заслуживает ли ваша эконометрическая модель доверия: 
1. 
Нет ли в модели пропущенных существенных переменных? 

2. 
Верна ли выбранная функциональная форма? 

3. 
Нет ли в модели эндогенности в результате двусторонней причинно-следственной связи? 

4. 
Не искажены ли выводы из-за сильных ошибок измерения регрессора? 

5. 
Не забыли ли вы использовать состоятельные в данных условиях стандартные ошибки? 

6. 
Если переменная интереса оказалась незначимой, не вызвана ли эта незначимость сильной мультиколлинеарностью? 

7. 
Верно ли определены границы генеральной совокупности, на которую вы переносите выводы своей модели? 


Постоянное размышление над этими вопросами не гарантирует получения «идеальной модели» во всех случаях (увы, не существует набора простых рецептов, который бы его гарантировал), однако во многих случаях защитит вас от заведомо некорректных результатов и выводов. 
Задания для самостоятельного решения 
Задание 1 . В статье Р. Ениколопова, М. Петровой и Е. Журавской1 анализируется влияние телевидения на решения избирателей голосовать за ту или иную партию. В рамках моделирования на индивидуальных данных в качестве объясняющей переменной авторы используют бинарную переменную, которая равна единице, если респондент в год перед выборами смотрел телеканал НТВ, и равна нулю в противном случае. Данные по этой переменной были получены путем выборочного опроса избирателей. Зависимая переменная равна единице, если респондент голосовал за определенную партию (например, за «Единство»), и равна нулю в противном случае. Авторы включают в модель сет контрольных переменных, которые отражают индивидуальные характеристики избирателя. 
Поясните, с какими источниками эндогенности регрессора авторы скорее всего должны были столкнуться в своей статье. 
Задание 2 . В статье Д. Асемоглу, С. Джонсона и Дж. Робинсона2 авторы анализируют воздействие качества экономических институтов (если точнее, речь идет о защите прав собственности) на экономическое развитие. В качестве объясняющей переменной авторы используют индекс, характеризующий защиту прав собственности в данной стране (индекс рассчитывается на основе ряда переменных и нормирован таким образом, что большее значение индекса означает более высокий уровень защиты прав собственности). Зависимая переменная — ВВП на душу населения в данной стране (в долларах). 
Поясните, с какими источниками эндогенности регрессора авторы скорее всего должны были столкнуться в своей статье. 
1 Enikolopov R., Petrova M., Zhuravskaya E. 2011. Media and Political Persuasion: Evidence from Russia // American Economic Review. Vol. 111(7). Pp. 3253−85. 
2 Acemoglu D., Johnson S., Robinson J. A. 2001. The Colonial Origins of Comparative Development: An Empirical Investigation, American Economic Review. Vol. 91(5). 
Задание 3 . В некоторой отрасли промышленности фирмы определяют запасы готовой продукции в зависимости от ожидаемых годовых объемов продаж: 
e
y =˝+˝ ˛ x,
i 12 i 
где yi — запасы готовой продукции i-й фирмы в 2012 г.; 
xe — ожидаемый i-й фирмой годовой объем продаж в 2012 г.
i 
Фактический объем продаж i-й фирмы в 2012 г. (xi) отличается от ожидаемого на случайную величину ui: 
e
x = x + u; Eu() = 0; var(u) =°2 = const.
iiii iu 
ee
При этом распределение ui независимо от x : cov(xu,) = 0.
i ii 
Информация об ожиданиях фирм недоступна исследователю. Конечно, он мог бы провести опрос, но у него нет уверенности в том, что фирмы предоставят ему честные ответы о своих ожиданиях. Зато в распоряжении исследователя есть данные о фактических объемах продаж фирм. 
Используя обычный МНК, исследователь оценивает параметры следующей модели: 
y =˝+˝ ˛ x +˙ .
i 12 ii 
а . Покажите, что ˜ =−° 2 ˙u.
ii 

ÌÍÊ 
б . Вычислите предел по вероятности для МНК-оценки ° 2 . Интерпретируйте результат. 
*
Задание 4 . Пусть переменные y и xi связаны точным соотношени
i
*
ем y =˝+˝ ˛ x. Однако вместо верных значений зависимой перемен
i 12 i ной мы наблюдаем измеренные с ошибкой значения: y = y * + u, где
iii ui — независимые одинаково распределенные случайные величины с ну
левым математическим ожиданием и дисперсией ˘2 . Эти ошибки не кор
u релированы с xi. Мы оцениваем методом наименьших квадратов уравне
ние y =˝+˝ ˛ x +˙ . Удовлетворяют ли в данной ситуации случайные
i 12 ii ошибки i предпосылкам классической линейной модели со стохастическими регрессорами? Вычислите предел по вероятности для МНК-оценки коэффициента ° 2 и интерпретируйте полученный результат. Задание 5 . Страна Кейнсиания является закрытой экономикой без непосредственного государственного вмешательства, поэтому основное макроэкономическое тождество в ней имеет следующий вид: 
Y = C + I ,
t tt 
где Y — ВВП в месяце t; C – совокупное потребление в месяце t; I — 
tt t 
инвестиции в месяце t. Потребление зависит от дохода следующим образом: 
C =C +mpcY˛+˝,
ta tt 
где ˝ — случайные шоки потребления, которые представляют со
t 
бой независимые одинаково распределенные случайные величины с нулевым математическим ожиданием и постоянной дисперсией. Случайные шоки потребления не коррелированы с инвестициями. Структурных сдвигов в Кейнсиании не происходит, поэтому автономное потребление и предельная склонность к потреблению неизменны. 
Эконометрист Джон Инконсистент решил получить оценку предельной склонности к потреблению. Используя обычный МНК, он оценивает регрессию потребления на доход. Объясните, почему результату, который он получит, нельзя доверять? 
Формально обоснуйте свой ответ, вычислив соответствующий предел по вероятности. 
Задание 6 . Исходный файл с данными: DTP. 
В вашем распоряжении имеются следующие данные по 144 странам за 2008 г.1: 
DTP — количество ДТП на 100 тыс. человек; 
CARS — количество автомобилей в расчете на 1000 человек; 
LENTH — «густота» автомобильных дорог, представляет собой отношение протяженности дорог к площади страны (в расчете на 1000 км); 
ALC − годовое потребление алкоголя (в литрах спиртного на человека в год); 
DEV — фиктивная переменная, принимающая значение 1 для развитых стран и 0 для развивающихся. 
Исследовательский вопрос, на который вам нужно ответить: влияет ли потребление алкоголя на уровень дорожно-транспортных происшествий? 
Осуществите необходимый эконометрический анализ. Опишите процесс своего поиска в виде краткого отчета со всеми необходимыми таблицами, графиками, результатами оценки уравнений, нужными тестами и развернутой экономической интерпретацией. 
1 Данные взяты с сайта Всемирного банка: http://data.worldbank.org/ 
Задание 7 . Исходный файл с данными: Cobb-Douglas. В файле имеются следующие данные о 100 фирмах некоторой отрасли экономики России: 
Q — выпуск фирмы; 
K — количество используемого фирмой капитала; 
L — трудозатраты фирмы. 
Предполагается, что технология производства в данной отрасли описывается производственной функцией Кобба — Дугласа. 
Исследовательский вопрос, на который вам необходимо ответить: чему равна эластичность выпуска по капиталу в рассматриваемой отрасли? 
а . Специфицируйте модель подходящим образом и ответьте на этот вопрос. 
б . Насколько широк 99%-й доверительный интервал для оцененной эластичности? Не обусловлена ли такая низкая точность оценивания проблемой мультиколлинеарности? Обоснуйте свой ответ соответствующими расчетами. 
в . Проверьте гипотезу о том, что технология производства в данной отрасли характеризуется постоянной отдачей от масштаба. 
г . Покажите, как можно использовать полученный в предыдущем пункте вывод, для того чтобы от производственной функции двух переменных перейти к функции одной переменной. Подсказка: перейдите к модели, где производительность труда зависит от капиталовооруженности1. 
Оцените параметры нового уравнения. Чему теперь равна оценка эластичности выпуска по капиталу? Каков ее 99%-й доверительный интервал? Помогло ли устранение мультиколлинеарности повысить точность оценивания? 
Задание 8 . Исследователь анализирует влияние посещения лекций по математическому анализу на успеваемость по этому курсу. Исследователю доступны следующие данные о 400 студентах: 
points — балл студента за итоговый экзамен по математическому анализу; 
ege — результат ЕГЭ по математике, который данный студент получил, будучи школьником. Эти данные доступны по каждому из студентов, так как для поступления на данный факультет необходимо предоставить результаты ЕГЭ, причем абитуриент не может претендовать на поступление, если получил за ЕГЭ менее 60 баллов; 
1 Если вы знакомы с курсом макроэкономики, то там вы наверняка не раз проделывали такой трюк при изучении модели экономического роста Солоу. 
lect — количество лекций по математическому анализу, посещенных данным студентом в течение семестра (всего в семестре было 16 лекций). 
Исследователь анализирует следующую спецификацию модели: 
points =˝+˝ ˛lect +˝˛ ˛lectege +˙ .
i 12 i 3 i ii 
а . Поясните, почему может быть целесообразно учитывать в модели результаты ЕГЭ? Какой из источников эндогенности может помочь устранить данная переменная? 
б . Оценив параметры модели, исследователь получил следующие результаты: 
 2
points =1222021, − , ˝lect + 019˝˝ , R = 081.
, lectege ,
i iii
(104, ) (002) ( ,
, 005) 
В своем отчете исследователь сделал следующее заключение: «Так как коэффициент при переменной lect является отрицательным и статистически значимым, то посещение лекций негативно сказывается на результатах экзамена». 
Ясно, что такой вывод мог быть получен, например, в результате смещения из-за пропуска существенных переменных. Однако представим, что спецификация уравнения является корректной. Будет ли утверждение исследователя верно хотя бы в этом случае? Обоснуйте свой ответ. 


ГЛАВА 8 
ИНСТРУМЕНТАЛЬНЫЕ ПЕРЕМЕННЫЕ 
Инструментальные переменные (инструменты) — это мощное средство для решения проблемы эндогенности. Как мы уже упоминали в прошлой главе, они могут быть полезны в следующих случаях: 
• 
смещение оценки коэффициента из-за пропуска ненаблюдаемой существенной переменной (т.е. в ситуации, когда это смещение не может быть устранено за счет включения в модель контрольных переменных); 

• 
ошибки измерения регрессора; 

• 
эндогенность из-за двусторонней причинно-следственной связи. 


Как видите, спектр ситуаций, в которых инструментальные переменные полезны, весьма широк. Поэтому целесообразно разобраться с новым для нас специальным методом оценивания, опирающимся на их использование, — двухшаговым методом наименьших квадратов (twostage least squares). Для его обозначения мы будем использовать аббревиатуру 2МНК (а по-английски — 2SLS, или TSLS). 
В § 1 данной главы мы сформулируем все определения и поясним все ключевые идеи 2МНК для самого простого случая − парной регрессии. В § 2 мы обобщим наш анализ на случай множественной регрессии. В § 3 (техническом) с использованием матричной алгебры будут выведены формулы 2МНК-оценок коэффициентов. Параграф 4 содержит обсуждение статистических тестов, которые помогают определить, насколько хороши ваши инструменты и насколько уместно их использование в том или ином случае. Наконец, в § 5 (особенно важном с прикладной точки зрения) мы сконцентрируемся на вопросе о том, откуда можно взять подходящие для вашего исследования инструментальные переменные и приведем несколько примеров реальных исследований, использующих этот подход. 
8 .1 . Двухшаговый МНК: парная регрессия 
Рассмотрим модель парной регрессии y =˝+˝ ˛ x +˙ , в которой
i 12 ii x — эндогенный регрессор: cov( , ) 0. Иными словами, нарушена
˜°
xi i 
предпосылка 4 линейной модели с одним регрессором из гл. 6. Будем предполагать, что все остальные предпосылки этой модели выполняются. 
Как мы выяснили в двух предыдущих главах, если предпосылка об экзогенности регрессора нарушена, то МНК-оценка коэффициента ° 2 несостоятельна. Следовательно, обычный МНК использовать нецелесообразно, поэтому нам нужно предложить другой метод. 
Представим, что в нашем распоряжении кроме информации о переменных x и y есть еще данные о третьей переменной z, которая удовлетворяет двум свойствам: 
zx );
• релевантность (relevance): cov( i , i ˆ 0 
˜=0.
• экзогенность (exogeneity): cov(zi ,)
i 
Первое свойство говорит о том, что эта переменная коррелирована с нашим эндогенным регрессором. Второе свойство требует, чтобы эта переменная не была коррелирована со случайной ошибкой модели (т.е. в отличие от регрессора x являлась экзогенной). 
Переменная z называется инструментальной переменной или инструментом (instrumental variable, instrument). Если инструмент удовлетворяет обоим указанным свойствам (экзогенности и релевантности), то его называют валидным. 
Графически отношения между переменными x, y и z представлены на рис. 8.0. 

Рис. 8.0. Взаимосвязи между переменными x, y и z Примечание: не зачеркнутые стрелки означают наличие корреляции, зачеркнутая стрелка означает ее отсутствие. 
Наличие валидного инструмента позволяет получить состоятельную оценку коэффициента ° 2 , используя двухшаговый МНК. Из названия легко догадаться, что реализация этого метода состоит из двух шагов. На каждом из них применяется обычный МНК. 
Первый шаг 
Оцениваем регрессию переменной x по переменной z: 
^^ 
x ^ =+z
˛˛.
i 12 i ^
Получаем прогнозные значения xi. 
Второй шаг 
Оцениваем регрессию переменной yпо этим предсказанным значениям x ^: 
^^
^^ 
yi=+˛˛2 xi.
1 
Чтобы отличать оценку коэффициента, полученную таким способом, от обычной МНК-оценки, мы иногда будем использовать в обо
^ TSLS
значении дополнительный индекс: ° .
2 ^TSLS
Прежде чем формально доказывать, что оценка ° является со
2 
стоятельной, поясним кратко, почему так получается. Все дело в том, 
^
что переменная x, в отличие от исходной переменной x, является экзогенной. Мы можем быть в этом уверены потому, что она линейно выражается через инструмент, а инструмент, в свою очередь, экзогенен по своему свойству. 
Покажем, что 2МНК-оценка коэффициента при регрессоре задается формулой 
1 
˛( y− y)(z− z) 
ii cov(,yz)
^TSLS n
˜= = .
2 
1 cov(xz,)
˛(xi− x)(zi− z)
n 
Для этого отметим, что в силу стандартных формул для парной регрессии МНК-оценка коэффициента при переменной в регрессии первого 
˜
cov(, )
^^ ^^
шага x =+ имеет вид: ˜= xz
˛˛z , а МНК-оценка в регрессии
i 12 i 2 
° 
var()z ˜ ^ 
cov(,xy)
^ ^ ^TSLS
^ =+ ^ =
второго шага y ˛˛x равна ˜ . Следовательно,
i 12 i 2 
° 
^ 
var()x 
˜ ^ ˜ ^^ ^ ˜ 
cov , ° ()
cov(,xy)(°°+ zy) ˙cov zy,
^TSLS 12 2
˜== == 
2 
°° ^^ ^ ° 
^2
var x + °˙var
() var(°°z) () ()z
12 2 
˜˜˜
cov(,zy) cov(,zy) cov(,zy)
== = . 
^ °˜ ˜
˛2 ° var()z cov(,xz) ° cov(,xz)
° var()z
° 
var()z 
Теперь можно доказать состоятельность этой оценки: 
1 
˛( − )(
y yz−z)
ii cov(yz,)
^TSLS n pii
˙ˆ =
˜2 = 1 ˙ cov(xz,)
˛( i− )( i− ) ii
x xz z 
n 
cov(˝+˝ ˛ x+˙ , z) ˝ cov(xz, )cov(
+˙ , z)
12 i ii 2 ii ii
== = 
cov(xz) cov(x,)
, xz
ii ii 
˝ cov(xz,) + 0
2 ii
= {(z,) = } ==cov ˛ 0 ˝ .
ii 2
cov(xz,)
ii 
Здесь мы также использовали свойство релевантности инструмента (т.е. свойство cov(zx,) ˆ 0), чтобы гарантировать, что знаменатель
ii cov(yz,)
ii
дроби не равен нулю. 
cov xz)
(,ii 
В случае использования двухшагового МНК дисперсии оценок коэффициентов будут отличаться от случая обычного МНК, следовательно, и стандартные ошибки оценок коэффициентов нужно рассчитывать несколько иначе. Например, для случая гомоскедастичности корректная формула стандартной ошибки коэффициента при регрессоре имеет вид: 
n 2 ^ 
S21 2 ˛i=1ei 
se()˜= ˙ , S= .
2 
˛(x− x)2  2 n− 2
i corr (xz,) 
Подчеркнем, что здесь остатки рассчитываются по формуле 
^^ ^^ 
e=y ˛˛ а не по формуле =y ˛˛^2
−− x, e −− x(так как иначе S
ii 12 i ii 12 i 
окажется несостоятельной оценкой дисперсии случайной ошибки). 
Если вы сравните эту формулу стандартной ошибки с привычной формулой из гл. 2, то увидите, что отличие состоит в появлении множи
1
теля . Этот множитель демонстрирует важность релевантно
 (
corr 2 xz,) 
сти инструмента. Ведь если инструмент почти не релевантен, то корреляция между ним и регрессором окажется близкой к нулю. Тогда этот множитель будет велик, и, следовательно, стандартная ошибка оценки коэффициента тоже будет велика, что приведет к низкой точности оценивания, например к очень широким доверительным интервалам. 
Чтобы эконометрический пакет рассчитывал стандартные ошибки коэффициентов корректно, следует использовать встроенную процедуру двухшагового МНК (в этом случае можно добавить и корректировку стандартных ошибок на случай гетероскедастичности), а не самостоя
^ 
тельно регрессировать y по x при помощи обычного МНК. 
За исключением альтернативных стандартных ошибок, процедуры тестирования гипотез и построения доверительных интервалов для коэффициентов модели полностью аналогичны процедурам, описанным в гл. 6. 
Пример 8.1. Оценка эластичности спроса по цене 
На рынке сигарет в некоторой стране функция спроса в i-м регионе имеет вид: 
lnQ =˝+˝ ˛ ln P +˙ .
i 12 ii 
Функция предложения описывается соотношением: 
lnQ =˝+˝ ˛ ln P +˝ ˛ lnT + u ,
i 12 i 3 ii 
где Qi — количество сигарет в i-м регионе; Pi — цена сигарет в i-м регионе; Ti — налог с продаж в i-м регионе; ˝i — независимые и одинаково распределенные случайные величины, характеризующие шоки спроса (не коррелированы с налогами); ui — независимые и одинаково распределенные случайные величины, характеризующие шоки предложения. 
а . Объясните, почему МНК-оценка эластичности спроса по цене в рассматриваемой модели будет несостоятельной. Для этого вычислите 
^OLS
предел по вероятности для МНК-оценки ° 2 . Определите, если это возможно, будет ли МНК давать завышенную или заниженную оценку эластичности спроса? 
б . Предложите процедуру состоятельного оценивания эластичности спроса по цене. Формально обоснуйте свой ответ, вычислив соответствующий предел по вероятности. 
Решение . 
а . Выразим эндогенную переменную ln Pi через экзогенную lnTi : 
˜ +˜ ln P +°=˛+˛ ˆ ln P +˛ ˆ lnT + u ;
12 ii 12 i 3 ii 
−− ˝lnT ˇ
˙ˆ ˆ +−u
113 iii
ln P = ;
i 
−
ˆ˙
22 
˜u &#22;ˇ°−−˛ ˛&#19;lnT+−
113 iii
cov P˜) =cov 
(ln, ,˜= 
ii &#23; i&#20;
˛−°
˘&#21;
22 
1 
=˛cov(ˆ−˙ −˙ ˛ lnT+ˇ − u,ˇ ) = 
113 i i ii 
˙ −ˆ
22 
1 
=˛cov( −˙˛lnT+−ˇu,ˇ) = 
3 i i ii 
−
˙ˆ
22 
1 
= (−˙ ˝cov(ln,ˇ ) +˘2 − cov(uˇ ) =
T ,)
3 ii ˇ ii
˙ −ˆ
22 
ˆ&#22;
˘cov(lnT,° ) = 0,íàëîãèˇíåˇêîððåëèðîâàíûˇñˇøîêàìèˇñïðîñà˘˛2 
ii ° 
=ˇ &#21;= . 
covv(u,° ) = 0 ˝ −˙
˘˘
&#23; ii &#20; 22 
Таким образом, цена является эндогенной переменной в уравнении спроса, поскольку она коррелирована со случайными ошибками в этом уравнении. Подобную ситуацию легко объяснить интуитивно, если представить стандартный график с пересечением кривых спроса и предложения: положительный шок спроса (˜>0) сдвигает кривую спроса вправо, в результате чего растет равновесная цена. 
Поэтому оценка обычного МНК будет несостоятельной: 
˜˜
(ln,ln ) cov(ln,P°)
cov PQ 
^OLS p
˜ = =˜+ ˙˙ˆ
°°
2 var(ln P) 2 var(ln P) 
2
&#23;
˘ cov(ln P,˘) &#22; −ˇ
p ii 22
˜°˜ˇ+ =ˇ+ ˆˇ .
2 222
var(ln P) &#23;
i ln P 
Поскольку по закону спроса ˜2 < 0, а в силу закона предложения 2
˜
˝ ° −˛
22
˜2 > 0, то (˜2 −° 2) > 0. Следовательно, ˜2 > 0, и оценка завышена 
ln P (так как ˜2 < 0, то МНК-оценка скорее всего будет ближе к нулю, чем истинное значение коэффициента). 
б . Состоятельную оценку эластичности спроса по цене можно получить, если воспользоваться процедурой двухшагового МНК. Инструмент валиден, если он, во-первых, экзогенен и, во-вторых, релевантен. 
В рассматриваемом случае переменная lnTi экзогенна: по условию налоги не коррелированы со случайными величинами ˝i , характеризующими шоки спроса: cov(ln ,˜=) 0.
Tii 
К тому же налоги коррелированы с ценой: если они повышаются, то в результате сдвига кривой предложения увеличивается и равновесная цена, поэтому cov(lnTi ,ln Pi ) ˆ 0. 
Следовательно, инструмент lnTi валиден. 
На первом шаге оцениваем регрессию ln Pi по lnTi и получаем прогнозные значения lnPi . На втором шаге оцениваем регрессию lnQi по 
ln Pi , где уже отсутствует проблема эндогенности. 

8 .2 . Двухшаговый МНК: множественная регрессия 
Чтобы разобраться, как этот метод устроен для множественной регрессии, договоримся сначала об обозначениях. 
Оцениваемое уравнение таково: 
()1 ()p ()1 ()r
y =˙ +˙˝x +…+˙ x +˙ w +…+˙ w +ˆ ,
i 01 i pip+1 i pr+ ii 
()1 ()p
где xi …xi — эндогенные регрессоры, для состоятельной оценки коэффициентов при которых требуются инструменты; 
()1 ()r
wi …wi — экзогенные регрессоры, т.е. регрессоры, которые не коррелированы со случайной ошибкой модели; 
()1 ()m
z …z — инструментальные переменные.
ii 
В зависимости от соотношения значений параметров p и m возможны следующие ситуации: 
• если mp,= т.е. число эндогенных переменных совпадает с чи
слом инструментов, то уравнение называется однозначно иден
тифицируемым (exactly identified); 
>
• если mp, т.е. инструментов больше, чем эндогенных перемен
ных, то уравнение называется сверхидентифицируемым (overidentified); 
<
• если mp, т.е. инструментов меньше, чем эндогенных регрессо
ров, то уравнение неидентифицируемо (underidentified). 
Как мы покажем ниже, в последнем случае применение двухшагового МНК невозможно. Если же mp, то этот метод применим, и его
&#7; 
реализация устроена так: 
Первый шаг . Оцениваем p регрессий первого шага, в каждой из ко
()1 ()p
торых слева стоит один из эндогенных регрессоров (xi …xi ), а спра()1 ()
m
ва — константа, все инструментальные переменные (zi …zi ) и все ()1 ()r
экзогенные переменные (wi …wi ). Оценив эти вспомогательные уравнения, получаем для каждой эндогенной переменной предсказан
^()1 ()p^ 
…
ные значения xi ,, xi . 
Второй шаг . Оцениваем параметры той модели, которая нас интересовала изначально. Только теперь в правой части вместо эндогенных 
()1 ()p
регрессоров x …x ставим их предсказанные значения из регрес
ii
()1 ()p^^
сий первого шага x ,,… x . То есть оцениваем следующее уравнение
ii 
второго шага: 
()1 ^()p ()1 ()r^
y=˙ +˙˝x +…+˙ x +˙ w +…+˙ w +ˆ .
i 01 ip+ i pri 
pi 1 + i 
Очевидно, что процедура двухшагового МНК для множественной регрессии в целом аналогична случаю парной регрессии, который мы рассмотрели в предыдущем параграфе. Из описания этой процедуры понятно, почему невозможно идентифицировать уравнение, если инструментов меньше, чем эндогенных регрессоров. Действительно, представим, например, что p= 2, а m= 1, т.е. нам нужно оценить коэффициенты при двух эндогенных переменных и в нашем распоряжении есть всего один инструмент. 
В этом случае в ходе оценивания регрессий первого шага мы получим предсказанные значения этих эндогенных регрессоров, выражен
^()1 ^ ^()1 ()2 ^ ^()1
^
ные через один и тот же инструмент: x =˛ +˛ z и x =˛ +˛ z .
i 01 ii 01 i 
^()1 ^()2
Проблема состоит в том, что раз x и x линейно выражаются через
ii 
одну и ту же переменную, то они линейно выражаются и друг через друга. Иными словами, они являются линейно зависимыми. Поэтому, подставив их в регрессию второго шага, мы столкнемся с ситуацией чистой мультиколлинеарности, что, как мы знаем, сделает вычисление оценок коэффициентов невозможным. 
В прикладных исследованиях чаще всего встречается ситуация, в которой исследователь концентрируется на получении состоятельной оценки коэффициента при единственном эндогенном регрессоре, т.е. в ситуации, когда p= 1. В этом случае 2МНК устроен следующим образом: Регрессия первого шага . Оцениваем единственную регрессию xiна все 
()1 ()m ()1 ()r;
инструменты z … z и на все экзогенные переменные w …w
ii ii получаем предсказанные значения x ^ i: 
^ ^()1 ^ m () ^ r
()^1 ()^ 
x=˝ +˝ z +…+˝ z +˝ w +…+˝ w .
i 01 i mim+1 i mr+ i 
^ ()1 ()r
Регрессия второго шага . Регрессируем yiна x˜è˜˜w … w :
ii i 
^^ ^()1 ^()r
^^ 
y=˙ +˙˝x+˙ w +…+˙ w .
i 01 i 2 i 1+ri 
Иногда возможна ситуация, в которой исследователь не уверен в эк
()1 ()r
зогенности факторов wi … wi , однако хочет оставить их в уравнении второго шага в качестве контрольных переменных, чтобы избежать смещения из-за пропуска существенных переменных. В этом случае указанные переменные можно не включать в регрессию первого шага, но включать в регрессию второго шага. 
Требования к инструментам в случае множественной регрессии аналогичны случаю парной регрессии: 
• Экзогенность . Инструменты не должны быть коррелированы со случайными ошибками модели: 
()1 ()m
cov(z ,˜) 0, , cov(z ,˜) =0.
=…
ii ii 
• Релевантность . Инструменты должны быть коррелированы с эндогенными регрессорами. Технически это означает, что в регрессии второго шага не должно возникать чистой мультиколлинеарности не только для конечной выборки, но и при 
n˜°. 
Если инструменты удовлетворяют обоим требованиям, то они называются валидными. В этом случае применение двухшагового МНК будет приводить к получению состоятельных оценок коэффициентов. 
Важно подчеркнуть, что асимптотические свойства 2МНК-оценок в целом хороши, но не для конечных выборок. В частности, 2МНК-оценки могут быть смещены. Кроме того, они, вообще говоря, не являются эффективными. С прикладной точки зрения это означает, что двухшаговый МНК лучше применять только на больших выборках, для которых корректно использование асимптотического подхода. 

8 .3 . Векторно-матричная форма записи 
Выведем в общем виде формулы 2МНК-оценки вектора коэффициентов для случая множественной регрессии. 
В случае использования матричной формы записи можно переписать исходное уравнение модели 
()1 ()p ()1 ()r
y=˙ +˙˝x +…+˙ x +˙ w +…+˙ w +ˆ
i 01 i pip+1 i pr+ ii 
следующим образом: 
yX +,
=˛˝ 
где X— матрица регрессоров, которая имеет (1 + p+ r) столбцов: один 
столбец из единиц для константы, p столбцов для эндогенных регрес()1 ()p ()1 ()r
соров x …x и rстолбцов для экзогенных переменных w …w .
ii ii 
Число строк в этой матрице как обычно равно числу наблюдений n. 
Дополнительно нам потребуется матрица Z— n на (1 + m+ r) матрица, включающая константу, инструменты и экзогенные регрессоры — все переменные для регрессии первого шага. 
На первом шаге двухшагового МНК мы оцениваем регрессию Xпо Z. Это можно записать так: 
X^ =°Z^. 
^
По формуле для МНК-оценки из § 3.3 ˜= (ZZ˛ )−1 ZX˛ , следовательно: 
^ −1
X= ZZZ( ° ) ZX° . 
На втором шаге двухшагового МНК мы оцениваем регрессию y
^:
по X ^ ^^ TSLS
yX .
=° 
^TSLS ^^ ^
По формуле для МНК-оценки из § 3.3 ˜= (XX˛ )−1 Xy˛ , следовательно: 
^TSLS ^^ ^
˜= (XX˛ )−1 Xy˛= 
−1 −1 −1 −1
= (( ( ° ) °° ( ° ) ZX)) (( ° ) ° )°
ZZZ ZX)(ZZZ ° ZZZ ZXy= 
−1 −1 −1 −1
=( °( °) °( °) °) (( °) °°=
XZZZ ZZZZ ZX ZZZ )
ZXy 
−1 −1 −1
= ( ° ( ° ) ZX)(( ° ) ° )°
XZ ZZ ° ZZZ ZXy= 
− 1 −
= ( ° ( ° ) ° ) ° ( ° ) °
XZ ZZ 1 ZX − XZ ZZ 1 Zy. 
Таким образом, окончательно имеем следующую формулу для 2МНК-оценки: 
^TSLS −1 −1 −1
˜= ( ˛ ( ˛ ) ˛ ) ˛ ( ˛ ) ˛ .
XZZZ ZX XZZZ Zy 
Отметим, что для корректности приведенных выкладок необходимо, 
^^
чтобы матрица XX&#17; была невырожденной (чтобы существовала обрат^^
ная к ней матрица (XX˜ )−1). Именно для этого требуется выполнение свойства релевантности инструментов, которое мы сформулировали в конце предыдущего параграфа. 
Если число инструментов в точности совпадает с числом эндогенных регрессоров (m= p), то матрицы Xи Zимеют одинаковую размерность. В этом случае выражение для оценки °^ TSLS можно упростить: 
^TSLS −1 −1 −1
( XZ ZZ) Zy˛=
˜= (XZ ZZ˛˛ ) ZX˛ ) ˛ ( ˛ 
−1 −1 −1
= (ZX° )(ZZ° )(XZ° ) ° ( ° ) Zy=
XZ ZZ ° 
−1 −1
= (ZX° )(ZZ° )(ZZ° ) Zy°= 
−
= (ZX° )1 Zy° . 
Этот частный случай двухшагового МНК иногда называют методом инструментальных переменных (instrumental variables). Таким образом, оценка по методу инструментальных переменных имеет вид: 
^IV
˜= (ZX˛ )−1 Zy˛ . 

8 .4 . Тесты для моделей, оцененных двухшаговым МНК 
2МНК-оценки коэффициентов являются состоятельными, только если используемые инструменты релевантны и экзогенны. Поэтому полезно уметь тестировать выполнение этих условий. 
Начнем с релевантности. Рассмотрим случай, когда в модели есть единственная эндогенная переменная: 
()1 ()r
y =˝ +˝ x +˝ w +…+˝ w +˙ .
i 01 i 2 i 1+ri i 
Тогда для проверки релевантности сначала следует оценить параметры регрессии первого шага: 
^ ^ ^()1 ^()m ^ ()1 ^ ()r
x=˝ +˝ z +…+˝ z +˝ w +…+˝ w .
i 01 i mim+1 i mr+ i 
Затем, опираясь на тест для сравнения «короткой» и «длинной» регрессий, необходимо вычислить расчетное значение тестовой F-статистики для проверки гипотезы 
H: ˜ =…=˜ =0.
01 m 
Если эта гипотеза отвергается, то это значит, что инструменты вносят существенный вклад в объяснение изменений эндогенной переменной. Это говорит в пользу их релевантности. Обычно на практике используется следующее правило: если расчетное значение тестовой F-статистики для проверки данной гипотезы больше 10, то инструменты признаются релевантными. (И в целом чем F-статистика больше, тем лучше.) 
Эта рекомендация опирается на тот факт, что при выполнении указанного условия максимально возможное смещение 2МНК-оценки будет не слишком велико — в пределах 10% от истинного значения параметра. Поскольку доказательство данного факта весьма сложно технически, оно выходит за рамки нашего учебника. Однако заинтересованному (и не боящемуся трудностей) читателю мы советуем обратиться за подробностями к статье Стока и Його [Stock, Yogo, 2005]. 
Если же F-статистика меньше 10, то инструмент называется слабым. Это означает, что он почти не коррелирован с регрессором, т.е. объясняет малую долю дисперсии эндогенной переменной. 
Если используемые вами инструменты слабые, то: 
• 
точность 2МНК-оценок очень низка; 

• 
результаты тестов на значимость могут быть некорректны, так как распределение оценки коэффициента не является нормальным даже асимптотически. 


Поэтому, если результаты теста указывают, что вы имеете дело со слабыми инструментами, следует: 
• 
или найти альтернативный набор инструментов, которые будут сильными (к сожалению, иногда сделать это довольно трудно); 

• 
или, если у вас уже есть большое количество инструментов, попробовать отказаться от некоторых из них. Исключение наименее значимых инструментов может способствовать увеличению соответствующей F-статистики в регрессии первого шага (разумеется, при этом по-прежнему должно выполняться условие идентифицируемости mp).


&#7; 
Пример 8.2. Оценка эластичности спроса 
по цене (продолжение) 
Исследователь анализирует спрос на сигареты в 48 американских штатах. Он изучает зависимость величины спроса (Q) от цены (P), используя в качестве инструмента для цены ставку налога, взимаемого с производителей в соответствующем штате (T). Ниже представлены результаты применения двухшагового МНК: 
регрессия первого шага: 
 2
lnP = , + , lnTi , R = 047;
463003 ˛ ,
i 
003, ) (0 005 
( ,) 
регрессия второго шага (в скобках указаны робастные к гетероскедастичности стандартные ошибки для 2МНК): 
lnQi = , − , lnP
972108 ˛ .
i 
153, ) (032 
( ,) 
а . Является ли инструмент рассматриваемой модели слабым? 
б . Постройте 95%-й доверительный интервал для эластичности спроса по цене. Можно ли на основе полученного интервала утверждать, что цена значимо влияет на потребление сигарет? Можно ли на основе полученного интервала утверждать, что спрос на сигареты является эластичным? 
Решение . 
а . Чтобы проверить, является ли инструмент слабым, в данном случае необходимо вычислить расчетное значение соответствующей F-статистики для проверки гипотезы H0: ˜=0 в уравнении:
2 
ln P =˝+˝ ˛ lnT + u ;
i 12 ii 
Rn − 2 047 48 −
2 ,2
Fðàñ÷ = ˛=˛ = 408,.
1− R − 053, −
221 21 
Поскольку Fðàñ÷ >10, можно заключить, что инструмент релевантен (т.е. не является слабым). 
б . Теперь построим 95%-й доверительный интервал: 
^ ^^ ^
196 se() 196 ˛˜ )
(˜− , ˛˜ , ˜+ , se() 
2 22 2 (− , − , ° ,, − , + , ° ,)
108196 032 108 196032 
(,, − , ).−171 045 
Поскольку доверительный интервал не содержит ноль, можно утверждать, что цена значимо влияет на величину спроса. 
Однако на основе полученного доверительного интервала нельзя утверждать, что спрос на сигареты является эластичным, так как в доверительный интервал входят как значения больше минус единицы, так и меньше нее. 
*** 
Перейдем теперь к тестированию экзогенности инструмента. Для этого можно применить тест Саргана (Sargan test, или overidentifying restrictions test), также иногда его называют J-тестом. 
Тест доступен только в том случае, если число инструментов превышает число эндогенных регрессоров: m > p. 
Нулевая гипотеза теста состоит в том, что все инструменты экзогенны, альтернативная гипотеза — в том, что хотя бы один из инструментов эндогенен. 
Для осуществления теста следует оценить параметры вспомогательной модели регрессии следующего вида: 
()1 ()m ()1 ()r
e =˝ +˝ z +…+ ˝ z +˝ w +…+˝ w +v ,
i 01 i mim+1 i mr+ ii 
где ei — остатки, полученные в ходе оценивания регрессии второго шага двухшагового МНК. 
Далее следует вычислить расчетное значение тестовой статистики по следующей формуле: 
J =°mF,
statistic 
где F — расчетное значение F-статистики для проверки гипотезы ˜ =…=˜ =0 в этом вспомогательном уравнении.
1 m 
Если верна нулевая гипотеза, то имеет распределение
Jstatistic ˜2(mp). Поэтому для принятия решения следует сравнивать расчет
− 
ное значение статистики с критическим значением из таблиц распределения Хи-квадрат с (m – p) степенями свободы. Как обычно, нулевая гипотеза не отвергается при заданном уровне значимости, если расчетное значение меньше критического. Это означает, что все инструменты экзогенны. 
Если же нулевая гипотеза отклоняется, то нужно сделать вывод о том, что по крайней мере некоторые из инструментов эндогенны, а значит, 2МНК-оценки несостоятельны. Подчеркнем, что в этой ситуации вовсе не следует отказываться абсолютно от всех используемых инструментов, ведь тест говорит о том, что эндогенны лишь какие-то из них (но не обязательно все сразу). Поэтому в такой ситуации разумно будет отказаться только от части инструментов, провести повторную оценку уравнения и повторное осуществление теста. К сожалению, тест не указывает, с каким конкретно из инструментов возникла проблема, так что тут придется принимать решение самостоятельно. 
Еще раз подчеркнем, что проведение теста Саргана возможно лишь при m > p. Если же m = p, то тестировать экзогенность инструментов в принципе невозможно. Это означает, что при обосновании валидности используемых инструментальных переменных придется опираться на содержательные соображения. Следовательно, если вы используете 2МНК, то содержательное понимание моделируемого процесса особенно важно. Некоторые полезные примеры для такого случая приведены в следующем параграфе. 
Еще один тест, который мы обсудим в этом разделе, — это тест Хаусмана. Он помогает принять решение о том, нужно ли в принципе использование 2МНК в вашей модели или можно ограничиться обычным МНК. Идея теста состоит в следующем: МНК-оценки будут состоятельны только в том случае, если регрессоры экзогенны, а 2МНК-оценки будут состоятельны независимо от того, эндогенен регрессор или экзогенен. Следовательно, если МНК- и 2МНК-оценки параметров отличаются не слишком сильно, то это аргумент в пользу применимости обычного МНК. Если же МНК- и 2МНК-оценки совсем не похожи друг на друга, то значит, МНК дает несостоятельные результаты и пользоваться им не следует. Поэтому расчетное значение тестовой статистики опирается на сравнение векторов оценок, полученных при помощи обычного МНК и двухшагового. 
Представление формулы тестовой статистики требует использования матричной записи (§ 3.3 и § 8.3): 
^2ÌÍÊ ^ÌÍÊ ^^2ÌÍÊ ^^ÌÍÊ −1^2ÌÍÊ ^ÌÍÊ 
(˜ −˜ )˛(V (˜ ) −V (˜ )) (˜ −˜ ), 
^^°ÌÍÊ 
где V ( ) — оценка ковариационной матрицы вектора МНК-оценок; ^^°2ÌÍÊ
V ( ) — оценка ковариационной матрицы вектора 2МНК-оценок. 
Нулевая гипотеза теста Хаусмана состоит в том, что МНК-оценки коэффициентов модели состоятельны. Если она верна, то указанная тестовая статистика имеет распределение &#15;2(), где k — суммарное число
k 
переменных в регрессии второго шага. 
Если нулевая гипотеза не отвергается, следует использовать для оценки коэффициентов обычный МНК, так как он будет давать состоятельные результаты (и к тому же более точные, чем 2МНК). В случае отвержения нулевой гипотезы придется заключить, что МНКоценки несостоятельны, и остановить свой выбор на 2МНК. 
У теста Хаусмана есть ограничение: его применение корректно, только когда используемые инструменты валидны. Если вывод о том, что можно ограничиться обычным МНК, получен на основе использования теста Хаусмана с сомнительным набором инструментальных переменных, то и сам вывод будет оставаться спорным. Иными словами, для корректного проведения теста Хаусмана все равно придется искать набор годных инструментов. И это дает нам дополнительную мотивацию, чтобы перейти к следующему параграфу. 

8 .5 . Где взять подходящие инструменты? 
2МНК является панацеей для многих проблем с эндогенностью при условии, что у вас есть валидные инструменты. При этом, однако, остается вопрос о том, где их взять. 
К сожалению, единого готового алгоритма, позволяющего автоматически получать инструментальные переменные для заданной модели, не существует. Поэтому использование двухшагового МНК требует не только владения эконометрической техникой, но и хорошего понимания исследуемой проблемы. 
Именно опираясь на это понимание, следует выбирать потенциальных кандидатов в инструменты — переменные, не коррелированные со случайными ошибками модели и при этом коррелированные с регрессором. От того, насколько убедительно вы объясните читателю, почему предлагаемый вами инструмент должен быть валиден, зависит, будет ли ваша работа вызывать доверие или нет. 
Чтобы продемонстрировать, какой способ размышлений об инструментах может помочь найти их, мы приведем в этом параграфе три истории. Каждая из них опирается на реальные исследования, собравшие большое количество цитирований. Я советую вам не ограничиваться чтением учебника, но и посмотреть сами эти статьи. 
История 1. Влияет ли образование на доход? 
В главе 7 (§ 7.1) мы уже обсудили, что в регрессии дохода индивида на его уровень образования (количество лет обучения) регрессор будет эндогенным из-за пропуска ненаблюдаемой существенной переменной — уровня таланта и мотивации индивида. Действительно, более талантливые люди в среднем чаще продолжают обучение в университете, чем менее талантливые. В результате положительная корреляция между числом лет обучения индивида и его доходом может быть обусловлена не пользой от окончания вуза, а тем, что более талантливые люди одновременно и больше учились, и больше зарабатывают теперь. 
Для устранения этой эндогенности нам нужно подобрать инструмент, который будет коррелирован с числом лет обучения (релевантен), но при этом не коррелирован с уровнем таланта (экзогенен). 
В работе Д. Карда1 в качестве такого инструмента используется расстояние от места жительства индивида до ближайшего колледжа. Речь идет о том месте, где жил индивид в момент принятия решения о продолжении обучения после школы. На первый взгляд эта переменная выглядит довольно экзотичной, однако в действительности она отвечает всем требованиям: 
• 
переменная релевантна, хотя расстояние до ближайшего учебного заведения вряд ли является главным фактором принятия решения о продолжении обучения, однако если от дома до колледжа совсем близко, это несколько увеличивает шансы на то, что индивид примет решение продолжить обучение. Поэтому в данных наблюдается положительная корреляция между близостью к колледжу и числом лет обучения; 

• 
переменная экзогенна, поскольку тот факт, что ваш дом расположен рядом с колледжем, сам по себе не делает вас более талантливым, а значит, близость к колледжу не должна быть коррелирована с уровнем таланта индивида. 


Расчеты, проделанные Д. Кардом, выявляют устойчивое значимое позитивное влияние образования на уровень дохода. Вы сможете воспроизвести их, разобрав одно из заданий для самостоятельного решения в конце главы. 
Альтернативными инструментами, используемыми в моделях отдачи от образования, являются продолжительность обучения отца и продолжительность обучения матери индивида. Логика здесь такая: наличие у родителей ученой степени само по себе не делает их детей более талантливыми (экзогенность), однако увеличивает вероятность того, что ребенок под их влиянием сам захочет получить хорошее образование (релевантность). 
1 Card D. (1995). «Using geographic variation in college proximity to estimate the return to schooling», in: Louis N. Christofides, E. Kenneth Grant and Robert Swidinsky, eds., Aspects of labour market behaviour: essays in honour of John Vanderkamp. University of Toronto Press, Toronto, Canada, pp. 201−222. 

История 2. Влияет ли телевидение на результаты выборов? 
В работе Р. Ениколопова, М. Петровой и Е. Журавской1, которую мы упоминали в заданиях для самостоятельной работы (см. гл. 7), анализируется эффект воздействия телевидения на результаты выборов в российскую Думу в 1999 г. 
В ходе предвыборной кампании партия «Единство» пользовалась поддержкой федеральных телеканалов ОРТ и РТР. В свою очередь, партия ОВР («Отечество — вся Россия») была поддержана телекомпанией НТВ. При этом телеканалы ОРТ и РТР были доступны на всей территории России, а сигнал НТВ покрывал только ее часть. 
Результаты выборов сильно различались в зависимости от того, смотрели ли избиратели в данном регионе НТВ или нет. Это приводит к гипотезе о том, что телеканал НТВ, предлагая зрителям альтернативную точку зрения, повлиял на их предпочтения. Именно эту гипотезу и тестируют авторы. 
Таким образом, в этой работе регрессор (x) — бинарная переменная, которая фиксирует, смотрел ли данный индивид НТВ. Объясняемая переменная (y) — решение индивида голосовать или не голосовать за ту или иную партию. 
Сложность получения состоятельной оценки воздействия переменной x на переменную y состоит в том, что регрессор эндогенен: 
• 
Данные о регрессоре получены на основе опроса, а значит, могут быть подвержены сильной ошибке измерения. 

• 
Возможна обратная причинно-следственная связь (y &#6; x): не телезритель полюбил партию ОВР потому, что НТВ ее похвалил, а наоборот, телезритель, который уже давно любит партию ОВР, с большей вероятностью решит смотреть НТВ, где про его любимую партию говорят хорошее (и аналогично сторонник «Единства» вряд ли захочет смотреть НТВ). 


Для устранения эндогенности авторам нужен инструмент, который коррелирован с решением смотреть НТВ (x), но который не коррелирован с политическими предпочтениями (y). 
Этим требованиям соответствует переменная доступность телеканала НТВ в данном регионе. Значение этой переменной определяется силой сигнала передатчиков НТВ: 
• 
Доступность НТВ релевантна − там, где телевизоры плохо ловят данный телеканал, его вряд ли будут смотреть. 

• 
Доступность НТВ экзогенна, так как она определяется не политическими предпочтениями зрителей, а техническими возможностями − передатчики сигнала унаследованы НТВ от советского образовательного телеканала и устанавливались явно не из соображений соответствия современным политическим пристрастиям. 


Enikolopov R., Petrova M., Zhuravskaya E. (2011). Media and Political Persuasion: Evidence from Russia // American Economic Review. Vol. 111(7). Pp. 3253−85. 
Авторы выявили значимое и довольно заметное влияние НТВ на результаты выборов. В соответствии с предсказанием модели, партии, поддержанные НТВ и получившие в сумме 25% голосов избирателей, при полном отсутствии НТВ набрали бы всего 9% голосов. Партия «Единство» без критики НТВ получила бы, по оценкам авторов, примерно в полтора раза больше голосов по сравнению с тем, что она имела в действительности. 
Важно отметить, что при оценке параметров модели обычным МНК без использования инструментальных переменных значимость соответствующих эффектов на индивидуальных данных исчезает. Иными словами, инструменты играют решающую роль в получении корректных выводов в рассматриваемой работе. 
История 3. Влияет ли защита прав собственности 

на экономический рост? 
На момент написания этих строк статья Д. Акемоглу, С. Джонсона и Дж. А. Робинсона1 имеет около двух тысяч цитирований и занимает 8-е место в списке самых цитируемых статей из топ-5 научных экономических журналов в мире (речь идет о работах, опубликованных с 1990 г. по настоящее время)2. 
Авторы исследования проверяют гипотезу о том, что качество институтов имеет значение для обеспечения высоких темпов экономического роста. Точнее, о том, что страны, в которых права собственности защищены хорошо, имеют преимущество в накоплении капитала, что в конечном счете обеспечивает более высокий долгосрочный ВВП на душу населения по сравнению со странами, которые не уделяют внимания защите прав собственности. 
Вы можете реплицировать (повторить) расчеты авторов, используя файл Acemoglu, который доступен среди прочих наборов данных 
1 Acemoglu D., Johnson S., Robinson J. A. The Colonial Origins of Comparative Development: An Empirical Investigation // American Economic Review. 2001. Vol. 91(5). 
2 Интересно отметить, что первое место в этом рейтинге занимает эконометрическая работа [Arellano, Bond, 1991], посвященная оценке динамических моделей на панельных данных. 
для этого учебника. Там содержится информация о следующих переменных: 
• 
countryn — название страны; 

• 
shortnam — краткий код страны; 

• 
prot — мера защиты прав собственности в данной стране (мера устроена так, что более высокие значения соответствуют более хорошей защите прав собственности). Это переменная интереса в анализируемой работе; 

• 
lgdp — логарифм ВВП на душу населения в 1995 г. Это зависимая переменная; 

• 
logmort — логарифм уровня смертности колонистов (см. детали далее); 

• 
latitude — широта, на которой расположена столица данной страны (измерена как расстояние от экватора и нормирована таким образом, чтобы изменяться в пределах от нуля до единицы); 

• 
euro — доля населения европейского происхождения в данной стране по состоянию на 1975 г. 


Если оценить параметры модели парной регрессии подушевого ВВП на защиту прав собственности, мы обнаружим положительную корреляцию между этими переменными (табл. 8.1, рис. 8.1). 
Таблица 8.1 
Зависимость логарифма подушевого ВВП (lgdp) от переменной качества институтов (prot) . Обычный МНК 
Зависимая переменная: lgdp Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 4,66038 0,320131 14,56 <0,0001 *** prot 0,522107 0,0499225 10,46 <0,0001 *** 
Среднее зав. перемен 8,062237 Ст. откл. зав. перемен 1,043359Сумма кв. остатков 31,53971 Ст. ошибка модели 0,713236R-квадрат 0,540115 Испр. R-квадрат 0,532697F (1, 62) 109,3770 Р-значение (F) 2,57e-15Лог. правдоподобие −68,16772 Крит. Акаике 140,3354Крит. Шварца 144,6532 Крит. Хеннана-Куинна 142,0364 
Полученные результаты не стоит интерпретировать как причинноследственную связь по трем причинам: 
• Регрессор может быть эндогенен из-за пропущенных существенных переменных. На подушевой ВВП могут влиять другие факторы помимо качества институтов. 
lgdp ˜° prot (˛ ˝˜˙ˆ˜ˇ˜˘ ˝˜ &#23;&#22;&#21;)
 10,5
 10
 9,5 
9
 8,5 
lgdp 
8
 7,5 
7
 6,5 
6 
prot 
Рис. 8.1. Зависимость логарифма подушевого ВВП (lgdp) от переменной качества институтов (prot) 
• 
Регрессор может быть эндогенен из-за двусторонней причинно-следственной связи. Возможно, дело не в том, что страны с лучшими институтами становятся богаче, а, наоборот, в том, что богатые страны могут позволить себе более хорошие институты. 

• 
Наконец, регрессор наверняка эндогенен из-за ошибок его измерения. Действительно, вряд ли используемый индекс (равно как и любой другой) может идеально охарактеризовать такое сложное понятие, как защита прав собственности. 


Если первая проблема может быть решена при помощи включения в модель контрольных переменных, то для преодоления двух других трудностей требуется инструмент. 
При выборе инструмента авторы останавливаются на смертности поселенцев во время колонизации данной страны. Разумеется, такой подход требует ограничить выборку только странами, которые являются бывшими колониями, что авторы и делают. Этот инструмент отрицательно коррелирован с качеством институтов: в колониях, где смертность завоевателей была высока из-за скверных условий жизни (например, климата и специфических заболеваний), они не были заинтересованы в создании институтов, направленных на защиту прав собственности, так как их интересовало только извлечение ресурсов из подконтрольных территорий, а жить там сами они не собирались. Это дает надежду на релевантность инструмента. Далее мы проверим рассматриваемое предположение на данных. 

Также ясно, что этот инструмент экзогенен, потому что никакие шоки, связанные с текущим экономическим ростом, явно не влияют на смертность колонистов несколько веков назад. 
В соответствии с логикой авторов статьи, увеличение смертности поселенцев должно негативно влиять на качество институтов, а снижение качества институтов, в свою очередь, должно сдерживать рост экономики. Следовательно, если предположения авторов верны, то между смертностью поселенцев в прошлом и ВВП сегодня должна быть отрицательная корреляция. Именно такой характер связи мы и наблюдаем в уравнении в табл. 8.2 (коэффициент при переменной logmort значимый и отрицательный) и на рис. 8.2 (который соответствует рис. 1 в статье). Уравнение, в котором зависимая переменная регрессируется непосредственно на инструмент (а не на эндогенный регрессор), называется уравнением приведенной формы. 
Таблица 8.2 
Приведенная форма модели: зависимость логарифма подушевого ВВП (lgdp) от логарифма смертности колонистов (logmort) . Обычный МНК 
Приведенная форма: МНК, использованы наблюдения 1-64 Зависимая переменная: lgdp Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 10,7076 0,383628 27,91 <0,0001 *** logmort −0,569798 0,0730481 −7,800 <0,0001 *** 
Среднее зав. перемен 8,062237 Ст. откл. зав. перемен 1,043359 Сумма кв. остатков 36,86476 Ст. ошибка модели 0,771099 R-квадрат 0,462470 Испр. R-квадрат 0,453800 F (1, 62) 60,84495 Р-значение (F) 8,79e-11 Лог. правдоподобие −73,16000 Крит. Акаике 150,3200 Крит. Шварца 154,6378 Крит. Хеннана-Куинна 152,0210 
lgdp ˜° logmort (˛ ˝˜˙ˆ˜ˇ˜˘ ˝˜ &#23;&#22;&#21;)
 10,5
 10
 9,5 
9
 8,5 
lgdp 
8
 7,5 
7
 6,5 
6 
logmort 
Рис. 8.2. Приведенная форма модели: зависимость логарифма подушевого ВВП (lgdp) от логарифма смертности колонистов (logmort). Обычный МНК 
Высказанные соображения приводят нас к использованию двухшагового МНК: на первом шаге следует оценить регрессию переменной prot на инструмент logmort. На втором шаге следует оценить регрессию зависимой переменной lgdp на предсказанные значения переменной интереса, полученные в результате оценки регрессии первого шага. 
Результаты оценки регрессии первого шага представлены в табл. 
8.3 и изображены графически на рис. 8.3. Как видно из таблицы и рисунка, смертность колонистов отрицательно коррелирует с качеством институтов, что соответствует рассуждениям авторов. F-статистика для теста на незначимость инструмента (в данном случае она же является F-статистикой для теста на незначимость уравнения) равна 23,8, что больше 10. Таким образом, можно заключить, что инструмент является релевантным. 

Таблица 8.3 
Регрессия первого шага двухшагового МНК: зависимость качества институтов (prot) от логарифма смертности колонистов (logmort) . Обычный МНК 
firat stage: МНК, использованы наблюдения 1-64 Зависимая переменная: prot 
Коэффициент Ст. ошибка t-статистика P-значение const 9,40017 0,611645 15,37 <0,0001 *** logmort −0,621318 0,127315 −4,880 <0,0001 *** 
Среднее зав. перемен 6,515625 Ст. откл. зав. перемен 1,468647 Сумма кв. остатков 98,17445 Ст. ошибка модели 1,258356 R-квадрат 0,277525 Испр. R-квадрат 0,265872 F (1, 62) 23,81609 Р-значение (F) 7,76e-06 Лог. правдоподобие −104,5037 Крит. Акаике 213,0074 Крит. Шварца 217,3251 Крит. Хеннана-Куинна 214,7083 

prot ˜° logmort (˛ ˝˜˙ˆ˜ˇ˜˘ ˝˜ &#23;&#22;&#21;)
 10 
9 
8 
7 
6 
5 
4 
3 
logmort 
Рис. 8.3. Регрессия первого шага двухшагового МНК: зависимость качества институтов (prot) от логарифма смертности колонистов (logmort). 
Обычный МНК 
Результаты оценивания регрессии второго шага представлены в табл. 
8.4. Эффект воздействия качества институтов на реальный ВВП оказывается позитивным, значимым и довольно сильным. Стоит отметить, что его оценка увеличилась почти в два раза по сравнению с оценкой обычного МНК: с 0,52 до 0,92. Тест Хаусмана указывает на несостоятельность оценок обычного МНК и, следовательно, целесообразность использования двухшагового МНК. 
Обратите внимание: в данном случае (в отличие от предыдущего пункта, с регрессией первого шага) использовались робастные стандартные ошибки. Это привело к некоторому изменению значения F-статистики, проверяющей релевантность инструмента. Однако эта F-статистика тоже больше 10, так что вывод о релевантности инструмента сохраняется вне зависимости от отсутствия или наличия поправки на гетероскедастичность. 
Важно отметить, что 2МНК-оценка оказалась значительно больше по абсолютной величине, чем МНК-оценка. Это означает, что скорее всего преобладающей причиной эндогенности регрессора были ошибки измерения. Мы знаем, что в условиях ошибок измерения регрессора МНК смещает оценки коэффициента при этом регрессоре к нулю. 2МНК устранил эту проблему, и в результате оценка коэффициента оказалась больше. 
Таблица 8.4 
Зависимость логарифма подушевого ВВП (lgdp) от переменной качества институтов (prot) . Двухшаговый МНК 
Зависимая переменная: lgdp Независимые переменные: prot Инструменты: const logmort Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 2,08689 1,12724 1,851 0,0689 * prot 0,917080 0,169112 5,423 1,02е-06 *** 
Среднее зав. перемен 8,062237 Ст. откл. зав. перемен 1,043359Сумма кв. остатков 52,73844 Ст. ошибка модели 0,922291R-квадрат 0,540115 Испр. R-квадрат 0,532697F(1, 62) 29,40812 Р-значение (F) 1,02e-06Лог. правдоподобие −306,4709 Крит. Акаике 616,9418Крит. Шварца 621,2595 Крит. Хеннана-Куинна 618,6427 
Тест Хаусмана (Hausman) 
Нулевая гипотеза: МНК оценки состоятельны
 Асимптотическая тестовая статистика: Хи-квадрат(1) = 22,3 
P-значение = 2,36278e-006 Тест на слабые инструменты -
F-статистика для 1-го шага (1, 62) = 16,7
 Значение < 10 может указывать на слабые инструменты 
Авторы статьи предполагают, что климатические условия могут влиять на экономическое развитие, поэтому важно учесть этот фактор в модели. Переменная latitude как раз является замещающей переменной для климата. В табл. 8.5 представлены результаты оценивания 2МНКрегрессии с учетом этой контрольной переменной. Обратите внимание, что ее включение в модель не сказывается на выводах по поводу влияния качества институтов на экономическое развитие: коэффициент при переменной prot остается значимым и положительным, а также не слишком сильно меняется по абсолютной величине. 
Таблица 8.5 
Зависимость логарифма подушевого ВВП (lgdp) от переменной качества институтов (prot) в случае добавления контрольной переменной . Двухшаговый МНК 
Зависимая переменная: lgdp Независимые переменные: prot Инструменты: const logmort latitude Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 1,93582 1,37215 1,411 0,1634 prot 0,953286 0,228158 4,178 9,52e-05 *** latitude −0,468469 1,18788 −0,3944 0,6947 
Среднее зав. перемен 8,062237 Ст. откл. зав. перемен 1,043359Сумма кв. остатков 56,55973 Ст. ошибка модели 0,962917R-квадрат 0,527875 Испр. R-квадрат 0,512395F(2, 61) 14,89629 Р-значение (F) 5,40e-06Лог. правдоподобие −304,7061 Крит. Акаике 615,4122Крит. Шварца 621,8889 Крит. Хеннана-Куинна 617,9637 
Тест Хаусмана (Hausman) 
Нулевая гипотеза: МНК оценки состоятельны
 Асимптотическая тестовая статистика: Хи-квадрат(1) = 17,3 
P-значение = 3,11377e-005 
Тест на слабые инструменты -
F-статистика для 1-го шага (1, 61) = 10,0
 Значение < 10 может указывать на слабые инструменты 
2МНК-оценки позволяют заключить, что улучшение защиты прав собственности позитивно влияет на экономическое развитие. 
В одном из заданий для самостоятельного решения вы сможете провести дополнительные расчеты, чтобы проверить устойчивость полученных авторами статьи результатов. 
В заключение отметим, что хорошим подспорьем в поиске валидных инструментов может быть формальная теоретическая модель, описывающая взаимосвязь между анализируемыми переменными. Продемонстрируем это на следующем примере. 
Пример 8.3. Система одновременных уравнений 
Рассмотрим простую модель закрытой экономики, заданную следующей системой одновременных уравнений в структурной форме: 
C =˛ +˛ Y +˝ ;
t 12 tt 
I =˛ +˛ Y + u ;
t 12 tt 
Y = C + I +G ,
t ttt 
где Y — ВВП в году t; C — совокупное потребление; I — совокупные ин
tt t 
вестиции; Gt — государственные закупки; 
E() 0 var(˜ ) = () =0 var(u ) =°2; var(Y ) =°2;
˜=; °˜ 2; Eu ;
t t t tutY 
cov(˜ ,G ) ; cov(uG ) =; cov(u ,)0 ; ˜2; ˜ +° < 1.
= 0 ,0 ˜=; > 0 > 0
tt tttt ˜2 22 
Рассмотрите три способа оценки параметров функции потребления: 
а . Обычный МНК. 
б . Двухшаговый МНК, где в качестве инструмента для ВВП используются инвестиции. 
в . Двухшаговый МНК, где в качестве инструмента для ВВП используются госзакупки. 
Для каждого варианта вычислите предел по вероятности для оценки параметра ° 2 (выразите этот предел через &#23;2, ° 2, ˜° 2, 2, 2). Для
˘˘ 
uY 
каждого варианта укажите, будет ли оценка параметра ° 2 состоятельной или несостоятельной (для каждой несостоятельной оценки укажите, будет ли она завышена или занижена). 
Решение . а . Выразим Yi через экзогенные переменные: 
˝˙G ˆu
++ ++ 
11 iii
Y = .
i 
1−−
˝˙
22 
Отсюда получаем, что 
2
˘ ++ ++G ˜u
°˛ &#21;˝
11 iii ˜
cov(Y,˜)cov=&#22; , ˜&#19;= .
ii i
1 °˛ 1 °˛
−− −−
&#23;&#20;
22 22 
Здесь мы использовали нулевые ковариации, которые даны в условии. 
2
˜ Отметим, что по условию ˜2 +° 2 < 1, поэтому ˝> 0. Следо
1−° −˛
вательно: 2 2 
˜ cov(CY, ) cov(Y,°)˜=ˆˇ =˜
^ cov CYP ii
(, ) ii
ˆ += 
2 ° 2
Y var()Y vaar()Y
var() ii 
ˇ21
&#23;
=ˆ+ ˝>ˆ .
21−˘−ˆ ˇ22 
22 Y 
Таким образом, МНК-оценка несостоятельна и завышена. 
б . Перейдем теперь к 2МНК-оценке с инвестициями в качестве инструмента. Сразу обратим внимание на то, что в силу второго уравнения исходной системы инвестиции являются эндогенной переменной, а значит, вряд ли их использование в данном случае позволит получить состоятельную оценку коэффициента. Действительно: 
2
˛ cov(I,˜ )cov(° +° Yu+ ,˜ ) =° cov(Y,˜ ) =° ˜ ;
= 
ii 12 i ii 2 ii 2 
1−° −˝
22 
2
˙
22 u
cov(IY)cov(= ˝+˝Yu,Y) =˝˙ +cov(
, + u,Y) =˝˙ + ;
ii 12 i ii 2 Y ii 2 Y 
1−˝ −ˆ2
2 
 cov(CI, ) cov(I,)
^ cov(,CI) Pii iˆi
˜=˛˝ =˜
˛ += 
2 YI YI cov(
 cov(,) 2 YI,)
cov(,) ii ii 
2
ˇ
˘
ˆ
2 
1−ˆ −˙
22
=˙+ >˙.
2 22
ˇ
2 u
ˆˇ +
2 
Y 1−ˆ −˙
22 
в . Из условия задания и анализа исходной системы можно видеть, что госзакупки в нашем случае экзогенны, а значит, есть надежда на то, что они будут валидным инструментом: 
 CG cov(CG, ) cov(G ,° )
^ cov(, ) P ii ii
˜=˝˙ =˜
˝ +=˜2.
2  cov(,) 2 ,)
YG cov(YG
cov(YG,) ii ii 
Последнее равенство верно в силу того, что, во-первых, по условию cov(˜i ,G ) = 0, а во-вторых, cov(YG,) ˆ 0, потому что, как мы показали
i ii 
в самом начале решения, Yi зависит от Gi. 
2МНК-оценка, для которой государственные закупки используются в качестве инструмента, состоятельна. 
Задания для самостоятельного решения 
Задание 1 . Оценивание отдачи от образования. 
Файл с исходными данными: Education. Имеются следующие данные о примерно 3 тыс. граждан США за 1976 г.: ed76 — количество лет обучения; age76 — возраст, лет; exp76 — опыт работы, лет; wage76 — зарплата, центов в час; lwage76 — логарифм зарплаты; black — фиктивная переменная, которая равна 1, если рассматривае
мый индивид афроамериканец; smsa76 — фиктивная переменная, которая равна 1, если индивид жил в крупном городе с пригородами (метрополии); nearc4 — фиктивная переменная, которая равна 1, если индивид проживал рядом с колледжем; south76 — фиктивная переменная, которая равна 1, если индивид 
жил на юге; 
momed — число лет образования матери; 
daded — число лет образования отца. 
Исследовательский вопрос, на который мы попытаемся ответить в этом задании: влияет ли образование на доходы индивидов в США? 
а . Используя обычный МНК, оцените зависимость логарифма зарплаты от количества лет обучения, опыта, опыта в квадрате и фиктивных переменных black, smsa76 и south76. Не забудьте применить состоятельные в условиях гетероскедастичности стандартные ошибки. 
б . Какова отдача от образования в представленной модели: на сколько процентов при прочих равных условиях увеличивается зарплата при увеличении числа лет обучения на один год? 
Как справедливо замечает в своем исследовании Кард [Card, 1995], число лет обучения может быть коррелировано со случайными ошибками модели. Возможное объяснение следующее: существует ненаблюдаемая характеристика индивида (скажем, его уровень способностей). Так как переменная способности ненаблюдаема, то она учитывается только в случайных ошибках. Однако если более способные индивиды склонны много учиться, то окажется, что переменная ed76 и переменная способности коррелированы. А следовательно, переменная ed76 коррелирована со случайными ошибками (возникает проблема эндогенности). Это приведет к смещению оценки коэффициента при ed76. Для решения этой возможной проблемы воспользуемся методом инструментальных переменных. 
в . Обсудите причины, по которым переменную nearc4 можно использовать в качестве инструмента для переменной ed76. Какой недостаток есть у этой переменной как у инструмента? 
Используя nearc4 в качестве инструментальной переменной для продолжительности обучения и считая все контрольные переменные экзогенными, оцените уравнение для логарифма заработной платы. 
Интерпретируйте результаты: как изменилась отдача от образования? Осталось ли влияние образования значимым? 
г . Интерпретируйте результаты теста на слабые инструменты и результаты теста Хаусмана для модели из предыдущего пункта. 
д . Заново оцените модель из пункта (в), добавив в качестве инструментов для образования переменные momed и daded. Объясните, почему они могут являться подходящими инструментами. В оцененной модели интерпретируйте результаты теста на слабые инструменты, теста Хаусмана и теста Саргана. Почему в этом пункте возможно проведение теста Саргана, а в пункте (в) — нет? 
е . Представьте результаты моделирования в виде сводной таблицы. Приведите там, помимо оценок коэффициентов, стандартных ошибок и R-квадрата, результаты проведенных вами тестов. Сопоставив результаты оценки разных моделей, дайте ответ на исследовательский вопрос, сформулированный в самом начале задания. 
Задание 2 . На рынке сигарет в некоторой стране функция спроса в i-м регионе имеет вид: 
lnQ =˝ +˝˛ ln P +˝ ˛ ln Income +˙ .
i 01 i 2 ii 
Функция предложения описывается соотношением: 
lnQ =˝+˝ ˛ ln P +˝ ˛ ln rtaxso +˝ ˛ ln rtax + u ,
i 12 i 3 i 4 ii 
где Qi— количество сигарет в i-м регионе; Pi — цена сигарет в i-м регионе; Ti — налог с продаж в i-м регионе; 
lnIncomei — логарифм дохода на душу населения в i-м регионе, экзогенная переменная; 
lnrtaxsoi — логарифм налога с продаж, общего для всех товаров в i-м регионе; 
lnrtaxi — логарифм акциза на продажу сигарет в i-м регионе; 
˝i — независимые и одинаково распределенные случайные величины, характеризующие шоки спроса (не коррелированы с налогами); 
ui — независимые и одинаково распределенные случайные величины, характеризующие шоки предложения. 
а . Запишите уравнение, которое следует оценить исследователю в качестве первого шага двухшагового МНК в рассматриваемой модели. Считайте, что исследователь использует два инструмента. 
б . F-статистику для тестирования какой гипотезы следует вычислить исследователю, чтобы выяснить, являются ли инструменты слабыми? Запишите в явном виде формулу для этой F-статистики, расшифровав все обозначения. Пусть эта F-статистика оказалась равна 900. Интерпретируйте полученный результат. 
в . При оценивании регрессии второго шага исследователь получил следующую модель (в скобках указаны робастные к гетероскедастичности стандартные ошибки для 2МНК): 
840120 046˝ lnIncome .
lnQi = , − , ˝ lnPi + , i(,)(,) (,)
120 020 031 
Какие из переменных являются значимыми? Дайте содержательную интерпретацию полученных результатов (не забудьте, что следует интерпретировать только коэффициенты при значимых переменных). 
Задание 3 . В этом задании вам предлагается осуществить эксперимент, иллюстрирующий преимущества 2МНК по сравнению с обычным МНК в некоторых ситуациях. 
а . Используя функцию генерации случайных чисел в Excel, создайте по 2000 наблюдений для трех независимых одинаково (нормально) распределенных случайных величин: 
˜i ~ N 01, ;
() 
u ~ N ()
i 01, ; 
v ~ N ()
i 01, . 
б . Вычислите по 2000 значений переменных x, y, z, используя следующие расчетные формулы: 
x =˛ + u ;
iii 
z = v + u ;
iii 
y =+, x
204 ˛+˝.
i ii 
в . Будем считать, что мы не наблюдаем случайные величины ˝, u, v, а располагаем только данными о переменных x, y, z. 
Оцените регрессию y по x (y ˝˙x ˆ), используя обычный
=+˛+ 
i ii 
МНК. Проверьте гипотезу ˜=04,. 
г . Можно ли доверять полученным МНК-оценкам? Почему? 
д . Оцените регрессию y на x (y ˝˙x ˆ), используя 2МНК
=+˛+ 
i ii 
^OLS
(z — инструмент для x). Сопоставьте ° , °^ TSLS и истинное значение коэффициента. Интерпретируйте результаты. 
е . Осуществите тест Хаусмана для сравнения регрессий, полученных в пунктах (б) и (д). Интерпретируйте результаты. 
Задание 4 . Исследователя интересует ответ на вопрос: как переменная X влияет на переменную Y? Исследователь предполагает, что переменная X является эндогенной. Он располагает данными о переменной X, экзогенной переменной W, а также о нескольких переменных, которые могут использоваться как инструменты для переменной X. 
1 Z()2 Z()34
Обозначим эти потенциальные инструменты Z(),, и Z(). Исследователь оценил пять моделей, используя двухшаговый МНК и различные комбинации инструментов. Результаты оценивания представлены в таблице. Какая из них позволяет наиболее адекватно ответить на вопрос исследователя? Аргументируйте свой выбор. 
Почему в левой нижней ячейке таблицы стоит прочерк? 
Dependent variable: Y  Number of observations: 964  
Regressor  (1)  (2)  (3) (4) (5)  
X  7,1 (0,8)  7,0 (1,2)  3,4 3,2 9,9 (0,1) (0,2) (2,1)  
W  4,2 (0,9)  4,0 (2,3)  3,3 4,1 2,9 (0,8) (1,3) (2,1)  
Intercept  1,4 (0,2)  1,5 (0,2)  1,3 1,2 1,8 (0,3) (0,3) (0,4)  

Instrumental variable (s)  Z(1)  Z(1), Z(2)  Z(2), Z(3) Z(1), Z(3) Z(1), Z(4)  
First-stage F-statistic  2.1  34,2  96,7 46,8 3,2  
P-value for overidentifying restrictions J-test  —  0,127  0,001 0,009 0,181  

Задание 5 . Исследователя интересует ответ на следующий вопрос: есть ли причинно-следственная связь между переменными X и Y? Исследователь оценил три модели, используя переменную W как контрольную, предполагая, что она экзогенна. 
Результаты оценки модели представлены в таблице ниже. 
а . Заполните пропуски в таблице, используя следующую информацию: при оценке регрессии переменной X по переменной W и константе R-квадрат оказался равен 0,1. При добавлении в эту регрессию переменной Z1 R-квадрат увеличился до 0,5. А при добавлении в модель еще и переменной Z2 R-квадрат составил 0,6. 
б . Интерпретируйте результаты тестов Хаусмана, Саргана, а также теста на слабые инструменты. Поясните, почему результаты теста Саргана приведены только для третьей модели, но не приведены для второй. На основе полученных результатов сделайте выбор в пользу одной из трех оцененных моделей. 
в . Используя модель, выбранную на предыдущем этапе, осуществите необходимый тест при уровне значимости 5% и дайте ответ на вопрос исследователя, сформулированный в самом начале этой задачи. 
Модель 1  Модель 2  Модель 3  
Метод оценивания  МНК  2МНК  2МНК  
Регрессор  Зависимая переменная: Y  
X  2,1 (0,2)  1,4 (0,9)  1,8 (0,8)  
W  77,9 (15,3)  74,2 (19,5)  81,3 (10,4)  
Константа  0,1 (0,8)  0,9 (1,3)  0,7 (0,6)  
Количество наблюдений  250  250  250  
Список инструментов для переменной X  —  Z1  Z1, Z2  
F-статистика для теста на слабые инструменты  —  
P-значение для теста Хаусмана  —  0,002  0,001  
P-значение для теста Саргана  —  —  0,007  

Задание 6 . Рассмотрим простую модель закрытой экономики со следующими предпосылками: 
C =˛ +˛ GDP +˝ ; (1)
t 12 tt 
GDPC + I , (2)
=+G
t ttt 
где GDPt (Gross Domestic Product) — ВВП в году t; Ct — совокупное потребление; It — совокупные инвестиции; Gt — государственные закупки; ˝t — случайные шоки потребления. Государственные закупки и инвестиции являются экзогенными переменными. 
а . Вычислив соответствующий предел по вероятности, покажите, что МНК-оценка предельной склонности к потреблению в рассматриваемой модели несостоятельна. 
б . Исследователь предлагает оценить уравнение (1) при помощи двухшагового МНК, используя переменную Z = I + G в качестве ин
tt t 
струмента для ВВП. Будет ли такая оценка состоятельной? 
в . Второй исследователь предлагает оценить уравнение (1) при помощи двухшагового МНК, используя две отдельные инструментальные переменные: It и Gt. Будет ли такая оценка состоятельной? Будут ли различаться оценки, полученные в пунктах (б) и (в)? 
Задание 7 . Исследователь анализирует влияние телевидения на результаты выборов. Он располагает данными о популярности телеканала X-ТВ в каждом регионе (переменная Xi — количество людей, которые смотрят этот телеканал в i-м регионе), а также о количестве голосов, полученных в этом регионе партией «Народное процветание», которую канал Х-ТВ активно поддерживал во время предвыборной кампании 1999 г. (переменная Yi). 
Исследователь предполагает наличие двусторонней причинноследственной связи: с одной стороны, там, где телеканал более популярен, за «Народное процветание» будет отдано больше голосов (благодаря действию поддержки X-ТВ). С другой стороны, телеканал более популярен именно там, где много сторонников «Народного процветания», так как они знают, что телеканал часто хвалит их любимую партию, и охотно смотрят его. Помимо прочего, на переменную Xi влияет переменная Zi, которая равна единице, если канал X-ТВ транслировался в i-м регионе в 1980 г. (задолго до образования партии «Народное процветание») и равна нулю в противном случае. 
Представьте описанную ситуацию в виде системы одновременных эконометрических уравнений в структурной форме. Преобразуйте ее в систему в приведенной форме. 
Объясните, почему МНК-оценки коэффициентов в регрессии Y на X будут несостоятельными (приведите формальное обоснование и содержательное объяснение). Предложите процедуру оценивания, которая позволит исследователю получить состоятельную оценку интересующего его коэффициента. Обоснуйте свой ответ. 
Задание 8 . Вы располагаете следующими данными о конкурентном рынке товара А (см. файл Supply): 
Qi — потребление товара А на душу населения в i-м городе (килограммов в год); 
PAi — средняя цена товара А в i-м городе (рублей за 1 кг); 
Ti — средняя ставка акциза, уплачиваемая продавцами товара А (рублей за 1 кг), в i-м городе; 
Ii — доход на душу населения в i-м городе (тысяч рублей в месяц); 
PBi — цена товара B, который является товаром-заменителем для товара А, в i-м городе (рублей за 1 кг); 
PCi — цена товара С, который используется в качестве сырья для изготовления товара А, в i-м городе (рублей за 1 кг). 
Вам необходимо выяснить, чему равна эластичность предложения товара А по его цене? 
Выберите подходящую эмпирическую стратегию, осуществите необходимые преобразования данных и эконометрические, чтобы ответить на этот исследовательский вопрос. 



ГЛАВА 9 
ПАНЕЛЬНЫЕ ДАННЫЕ 
Если в выборке содержатся данные о нескольких объектах, каждый из которых наблюдается в течение нескольких моментов времени, например ежегодные данные о доходе и потреблении в 50 регионах некоторой страны за период с 1992 по 2011 г., то такие данные называют панельными (panel data, или longitudinal data). 
В отличие от пространственных данных, на которых мы концентрировались в предыдущих главах, теперь для обозначения наблюдений нам будет удобно использовать не один, а два индекса: 
x
it, 
где i = 1, 2, …, n — номер объекта (например, региона); 
t = 1, 2, …, T — номер момента времени (например, номер года). 
Есть несколько причин для использования панельных данных в прикладных исследованиях. 
1 . Большое количество наблюдений . Представьте, что вы проводите исследование, опираясь на информацию по странам мира. Если вы используете пространственные данные, то в вашем распоряжении, по всей видимости, будет менее 200 наблюдений. Ведь даже если вы включите в выборку все независимые государства − члены ООН, то их окажется меньше 200. А если оставить только те из них, по которым доступна достаточно полная статистическая информация, список окажется еще короче. Применив же панельные данные, вы будете иметь возможность использовать гораздо больше точек. Например, получив информацию о 100 странах за 10 лет, вы сможете строить регрессии по 100 · 10 = 1000 наблюдений. 
Количество доступных наблюдений зависит от того, имеете вы дело со сбалансированной или несбалансированной панелью. Панель называется сбалансированной, если существует наблюдение для каждого объекта и для каждого момента времени. В этом случае общее число наблюдений равно n · T. Когда в данных есть пропуски, панель называется несбалансированной. В этом случае общее число наблюдений меньше, чем n · T, однако все равно может оставаться достаточно большим. Если возникновение пропусков является экзогенным, то для несбалансированных панелей можно использовать те же методы оценивания, что и для сбалансированных. 
2 . Возможность отслеживать динамику для множества объектов . Использование панельных данных позволяет анализировать распределение тех или иных эффектов во времени, например постепенное изменение потребления сигарет в некоторой стране после принятия антитабачных законов в ряде ее регионов. 
3 . Дополнительный способ устранения эндогенности . Пожалуй, самым главным мотивом для использования панельных данных является возможность получить состоятельные оценки коэффициентов при интересующих нас переменных в условиях, когда на пространственной выборке это невозможно. Такой шанс появляется за счет учета неоднородности моделируемых объектов. 

Чтобы понять, как указанная неоднородность может затруднять оценивание, рассмотрим пример. Представим, что нас интересует ответ на такой вопрос: влияет ли закон, разрешающий гражданам носить с собой личное огнестрельное оружие, на уровень преступности? Ответ на него, действительно, вовсе не очевиден. Сторонники закона утверждают, что его введение позволяет снизить преступность, так как гражданские лица получат шанс защититься от злоумышленников. Их оппоненты возражают, что в результате введения такого закона преступность, наоборот, вырастет из-за избыточного количества огнестрельного оружия на руках у населения и его спонтанного использования. 
Пусть мы располагаем панельными данными о регионах некоторой страны, и уровень преступности в них описывается следующим уравнением: 
y =˛x +µ +˙ , (9.1)
it it iit 
где yit — уровень преступности в регионе i в год t; 
xit — бинарная переменная, которая равна единице, если в регионе i в год t введен закон, разрешающий гражданам носить личное огнестрельное оружие, и равная нулю в противном случае; 
˝it — это, как обычно, случайные ошибки модели; 
µi — ненаблюдаемая переменная, характеризующая специфические особенности каждого из регионов, например культурные или институциональные особенности, которые трудно поддаются измерению. Так как все регионы разные, почти нет шансов полностью учесть их специфику в наблюдаемых контрольных переменных. Поэтому такой фактор в модели наверняка останется. Обратите внимание, что у этой переменной нет индекса t, а есть только индекс i. 
Так мы подчеркиваем, что указанные особенности не меняются во времени (или меняются очень медленно, поэтому в рамках исследования могут считаться постоянными). Присутствие переменной µi порождает следующую дилемму: 
• 
с одной стороны, мы не можем включить ее в модель непосредственно, так как она не является наблюдаемой; 

• 
с другой стороны, если она коррелирована с интересующей нас переменной xit, то отказ от ее включения приведет к несостоятельности оценки коэффициента ° из-за пропуска существенной переменной (см. гл. 7). 


Таким образом, неоднородность объектов часто становится причиной эндогенности регрессоров. К счастью, панельные данные дают возможность применить простой и хорошо работающий способ решения этой проблемы — использование моделей с фиксированными эффектами. 
Именно этот класс моделей рассматривается в § 9.1–9.4. Затем в § 9.5–9.6 обсуждается альтернативный подход к оцениванию — модель со случайными эффектами. В конце главы, в § 9.7 обобщена информация о спецификационных тестах, которые помогут выбрать наиболее подходящий в каждом случае метод работы с панельными данными. 
9 .1 . Модель с фиксированными эффектами 
В рамках этого подхода индивидуальные особенности каждого объекта µi рассматриваются в качестве неизвестных исследователю (и ненаблюдаемых) параметров — так называемых фиксированных эффектов. 
Предпосылки модели с фиксированными эффектами (случай парной регрессии): 
1. Модель линейна по параметрам: 
y =˝x +µ +ˆ , i = , … nt = ,, … T
12,,, 12 ,.
it it iit 
2. Наблюдения {(, x … x , ˛ , ˛ , …˛ ), i =12 ,, =12 ,
x ,, ,,, … nt ,, … T }
i1 i2 iT i1 i2 iT 
независимы и одинаково распределены. 
3. x и ˝it имеют ненулевые конечные четвертые моменты распределе
it 
4 ˜4
ния Ex()it <°, E() <˛.
it
4. Случайные ошибки имеют нулевое условное математическое ожидание: E(˜ | x , x , …, x , µ ) = 0.
it i1 i2 iT i 
Очевидно, что эти предположения очень похожи на предпосылки линейной регрессионной модели со стохастическим регрессором из гл. 6 с учетом добавления в уравнение ненаблюдаемых фиксированных эффектов и расширения формулировки на несколько периодов времени. 
Отметим две важные детали, которые делают модель с фиксированными эффектами максимально близкой к реальности: 
• 
Вторая предпосылка требует, чтобы значения регрессоров, относящиеся к разным объектам, были независимы друг от друга. Однако важно подчеркнуть, что она допускает наличие зависимости между значениями регрессоров, относящимися к одному объекту, но разным моментам времени: например, она допускает, что xi3 может быть коррелирован с xi2, а тот, в свою очередь, может быть коррелирован с xi1. Иными словами, будущие значения регрессора для данного объекта могут зависеть от его прошлых значений. Это реалистичное предположение. Например, потребление табака в данном регионе сегодня наверняка связано с его потреблением в прошлом. Аналогично инфляция в России сегодня скорее всего влияет на будущую российскую инфляцию. 

• 
Четвертая предпосылка требует, чтобы регрессор был экзогенен в том смысле, что он не должен быть связан со случайной ошибкой модели. Однако она допускает наличие корреляции между значением регрессора xit и фиксированным эффектом µi . Это тоже реалистичная предпосылка. В рамках нашего примера про ношение оружия ясно, что культурные особенности данного региона (которые как раз и характеризуются его фиксированным эффектом) могут влиять на решение по поводу закона о ношении оружия в этом регионе (т.е. на значение xit). 


Модель может быть сформулирована и для случая множественной регрессии. Тогда придется добавить предпосылку, требующую отсутствия чистой мультиколлинеарности. В остальном все предположения аналогичны случаю парной регрессии, только запись становится гораздо более громоздкой. 
Предпосылки модели с фиксированными эффектами (случай множественной регрессии): 
1 . Модель линейна по параметрам: 
()1 ()2 ()k
y =˝ x +˝ x +…+˝ x +µ +ˆ ,
it 1 it 2 it kit iit 
i = 12 … nt =12 … T
,,,, ,, ,. 
()1 ()1 ()1 ()2 ()2 ()2 ()k ()k
2 . Наблюдения {(x , x , …, x , x , x , …, x , …, x ,, …,
i1 i2 iT i1 i2 iT i1 xi2 ()k 
, ° , ° , …, ° ), i =12,, …,,nt = 12,, …,}T независимы и
xiT i1 i2 iT
одинаково распределены. 
()1 ()2 ()k
3 . x , x , …, x и ˝it имеют ненулевые конечные четвертые мо
itit it 
менты. 
4 . Случайные ошибки имеют нулевое условное матожидание: 
()1 ()1 ()1 ()2 ()2 ()2 (()k ()k ()k
E(˜ | x , x , …, x , x , x , …, x , …, x , x , …, x , µ ) = 0.
it i1 i2 iT i1 i2 iT i1 i2 iT i 
5 . С вероятностью 1 в модели отсутствует чистая мультиколлинеарность. 
Рассмотрим три подхода, которые позволяют получить состоятельные оценки коэффициентов при регрессорах в модели с фиксированными эффектами: модель с фиктивными переменными, внутригрупповое преобразование и модель в первых разностях. 

9 .2 . Модель с фиктивными переменными 
Естественным подходом к решению проблемы ненаблюдаемых фиксированных эффектов является добавление фиктивных переменных, характеризующих эти эффекты. Например, если в вашем распоряжении есть данные по регионам России, можно добавить в уравнение фиктивную переменную для каждого из регионов1. 
Зададим эти фиктивные переменные следующим образом: 
()2
di — фиктивная переменная, которая равна единице, если наблюдение относится ко второму объекту (i = 2), и равна нулю в противном случае; 
()3
di — фиктивная переменная, которая равна единице, если наблюдение относится к третьему объекту (i = 3), и равна нулю в противном случае; 
… 
n
di () — фиктивная переменная, которая равна единице, если наблюдение относится к объекту номер n (i = n), и равна нулю в противном случае. 
1 Точнее, для всех регионов, кроме одного, чтобы избежать ловушки фиктивных переменных, которая описана в гл. 4. 
Покажем, как эти фиктивные переменные могут быть применены для оценки коэффициентов в уравнении (9.1): 
y =˛x +µ +˙ . (9.1)
it it iit 
Для этого перепишем уравнение (9.1) следующим образом: 
()2 ()3 ()n
y =˙x +µ +(µ −µ )d +(µ −µ )d +…+(µ −µ )d +ˇ . (9.2)
it it 1 21 i 31 in 1 i it 
Легко проверить, что уравнение (9.2) эквивалентно уравнению (9.1). Действительно, если записать его для первого объекта (i = 1), то все фиктивные переменные окажутся равными нулю, и мы получим: 
y =˛x +µ +˙ .
1t 1t 11t 
Если же записать его, например, для второго объекта (i = 2), то ока
()2 ()3 ()4 ()n
жется, что =1, d =d =…=d =0. Следовательно, уравне
diii i 
ние (9.2) примет вид: 
y =˝x +µ + (µ −µ ) +ˆ ,
2t 2t 1 212t 
y =˛x +µ +˙ .
2t 2t 22t 
Аналогично можно записать уравнение для всех остальных объектов. Таким образом, чтобы учесть фиксированные эффекты, достаточно добавить в модель константу и (n – 1) фиктивных переменных1. Эти фиктивные переменные мы всегда можем задать, т.е. они наблюдаемы. Следовательно, проблема смещения из-за пропуска ненаблюдаемой существенной переменной (описанная в самом начале этой главы) решается, и обычный МНК снова будет давать состоятельные оценки коэффициентов при интересующих нас переменных. 
Если переписать уравнение (9.2), используя более привычные обо
значения, то можно представить его следующим образом2: 
()2 ()3 ()n
y =˝ +˝ x +˝ d +˝ d +…+˝ d +˙ . (9.3)
it 01 it 2 i 3 i ni it 
Это так называемая модель с фиктивными переменными (least squares dummy variables model, LSDV-модель). 
1 Еще раз подчеркнем, что если добавить к константе не (n – 1), а n фиктивных переменных, то возникнет чистая мультиколлинеарность. 
2 Здесь мы обозначили ˜ =µ1, ˜i = (µ −µ ), i = 23 …,.
,, n
0 i 1 
R-квадрат в этой модели обычно называют LSDV-R2. Обычно на практике он оказывается сравнительно высоким за счет того, что большое количество фиктивных переменных объясняет значительную долю дисперсии зависимой переменной. 
В рамках данного подхода легко осуществить тест, который ответит на вопрос, нужно ли учитывать фиксированные эффекты в уравнении, иными словами, позволит сравнить модель с фиксированными эффектами и обычную регрессию, не учитывающую специфические особенности отдельных объектов (последняя называется регрессией пула, pooled regression). Для этого достаточно тестировать гипотезу: 
H : ˜ =˜ =…=˜ =0.
02 3 n 
Альтернативная гипотеза состоит в том, что хотя бы один из коэффициентов отличается от нуля. 
Проверку можно осуществить при помощи стандартного теста на сравнение «короткой» и «длинной» регрессий. Если эта гипотеза отвергается, то следует использовать модель с фиксированными эффектами. В противном случае можно заключить, что все объекты в выборке одинаковые, и ограничиться использованием pooled regression. 
Описанный способ оценивания демонстрирует преимущество панельных данных по сравнению с пространственными данными. Действительно, на пространственных данных оценить уравнение (9.3) при помощи МНК было бы невозможно, так как в этом случае в вашем распоряжении было бы всего n наблюдений, а в уравнении (9.3) (n + 1) неизвестных параметров. 
Есть у этого подхода и существенное ограничение. Модель с фиктивными переменными не позволяет идентифицировать коэффициенты при переменных, которые не меняются во времени. При попытке добавить такие переменные в модель в ней возникнет чистая мультиколлинеарность из-за того, что они окажутся линейно зависимы с множеством фиктивных переменных для отдельных объектов. Например, оценивая при помощи модели с фиксированными эффектами уравнение для заработной платы работника, вы сможете включить в него возраст, но не сможете включить бинарную переменную, характеризующую расу работника. Ведь раса работника в отличие от его возраста со временем не меняется и де-факто уже учтена в его фиксированном эффекте. 
Двунаправленная модель с фиксированными эффектами 
Модель (9.1) может быть обобщена следующим образом: 
y =˛x +µ+˙ +ˆ ,
it it itit 
где &#5;t — фиксированные эффекты различных периодов времени. Такие переменные могут быть полезны, если вы хотите учесть общие для всех объектов структурные изменения, которые происходят с течением времени. Скажем, если ваша выборка представляет собой данные по регионам России за 20 лет, то фиксированные эффекты объектов µi будут учитывать специфические особенности каждого из регионов, а временные эффекты &#5; — особенности различных лет, например влияние на
t 
зависимую переменную экономических подъемов и спадов, характерных для экономики страны в целом. 
Модель, которая учитывает оба типа эффектов, называется двунаправленной моделью (модель, учитывающая только один тип, соответственно однонаправленной). Оценить ее параметры можно, добавив в уравнение (9.3) еще (T – 1) фиктивных переменных: 
()2 ()n ()2 ()T
y =˝ +˝ x +˝ d +…+˝ d +˙ td +…+˙ td +ˆ ,
it 01 it 2 i ni 2 t Tt it 
()2
где td — бинарная переменная, которая равна единице, если наблюдение
t
относится ко второму периоду времени, и равна нулю в противном случае; 
()3
td — бинарная переменная, которая равна единице, если наблю
t 
дение относится к третьему периоду времени, и равна нулю в противном случае; 
… 
()
td T — бинарная переменная, которая равна единице, если наблюде
t 
ние относится к периоду времени T, и равна нулю в противном случае. 
Пример 9.1. Отдача от посещения лекций 
Три сотни студентов изучали курс математического анализа, который длился два семестра. В файле Attendance доступны следующие данные о каждом из них: 
perfomanceit — результат по курсу i-го студента в семестре t; 
t = 1 соответствует первому семестру, t = 2 соответствует второму семестру. Результат семестра измерен в баллах по шкале от 0 до 100; 
attendanceit — количество лекций, посещенных i-м студентом в семестре t. 
Результат студента по курсу описывается моделью: 
performance =°˝attendance +µ+ˆ+ˇ,
it it itit 
где µi — переменная, которая характеризует индивидуальные особенности i-го студента, например уровень его мотивации и школьной математической подготовки. 
Переменная &#5;t , в свою очередь, характеризует особенности семестра t. Например, если ˜ >˜ , это будет свидетельствовать о том, что
21 
результаты студентов во втором семестре в среднем выше, чем в первом (при равной мотивации и равном количестве посещенных лекций), т.е. о том, что второй семестр проще первого. 
Исследовательский вопрос, на который мы попытаемся ответить, таков: влияет ли посещение лекций на результат студента в семестре или же этот результат полностью определяется индивидуальными особенностями студента? 
В терминах модели вопрос можно переформулировать так: отличается ли от нуля коэффициент при переменной attendance? 
Для ответа на этот вопрос оценим параметры трех уравнений. 
Уравнение 1 . Объединенная регрессия (регрессия пула, pooled regression): 
 ^^
performance =˝ +˝˛attendanceit
it 01 . 
Уравнение 2 . Модель с фиксированными эффектами для студентов. Так как в нашем распоряжении есть данные о 300 студентах, необходимо добавить в уравнение 299 фиктивных переменных: 
 ^ ^ ^ ()2 ^ (300)
performance =˙ +˙˛attendance +˙ d +…+˙ d .
it 01 it 2 i 300 i 
Уравнение 3 . Двунаправленная модель с фиксированными эффектами. Так как нам доступны данные за два периода, следует добавить в уравнение еще одну фиктивную переменную для второго периода времени: 
 ^ ^ ^ ()2 ^ (300) ^ ()
performanceit =˙0 +˙1˛attendanceit +˙2 di +…+˙300 di +ˆ2 tdt 2. 
Результаты представлены в табл. 9.1. Первый столбец соответствует уравнению 1, второй — уравнению 2, третий — уравнению 3. 
Если взглянуть на первый столбец, можно обнаружить, что коэффициент при переменной attendance значим на 1%-м уровне и отрицателен: он равен –0,989. Таким образом, из этого уравнения, казалось бы, можно заключить, что посещение каждой лекции в среднем снижает результат по курсу математического анализа на один балл. 
Чтобы проверить, не вызван ли этот неожиданный вывод смещением оценки коэффициента из-за пропуска существенной переменной, посмотрим на второй столбец, где представлены результаты оценки модели с фиксированными эффектами. Прежде всего отметим, что гипотеза о равенстве нулю коэффициентов при всех фиктивных переменных фиксированных эффектов уверенно отвергается при любом разумном уровне значимости (см. значение F-статистики и соответствующее P-значение внизу второго столбца). Следовательно, мы должны сделать вывод о том, что предпочтительна модель с фиксированными эффектами для отдельных студентов. Иными словами, индивидуальные особенности каждого студента играют важную роль в определении его результатов по курсу. 
Таблица 9.1 
Три спецификации моделей для результатов семестра 
(1)  (2)  (3)  
Константа  62,639***  34,163***  34,219***  
(2,420)  (0,509)  (0,528)  
attendance  −0,989***  1,119***  1,116***  
(0,219)  (0,051)  (0,051)  
d_2  −3,669***  −3,666***  
(0,051)  (0,051)  
d_3  11,491***  11,492***  
(0,025)  (0,026)  
…  …  …  …  
d_299  26,809***  26,808***  
(0,025)  (0,026)  
d_300  10,937***  10,932***  
(0,102)  (0,102)  
td_2  −0,062  
(0,185)  

Число наблюдений 600 600 600 
R2  0,046  0,993  0,993  
F-статистика для проверки  138,5  137,8  
незначимости индивидуальных эффектов  —  (0,000)  (0,000)  
F-статистика для проверки незначимости  
временных эффектов  —  —  0,2 (0,639)  

Примечание: в скобках под оценками коэффициентов указаны робастные стандартные ошибки. В скобках рядом с F-статистиками указаны P-значения для проверки соответствующей гипотезы. *** обозначает значимость на 1%-м уровне. 
Коэффициент при переменной attendance во втором столбце снова значим на 1%-м уровне, но теперь оказался положительным: он равен 1,119. То есть посещение каждой лекции в среднем увеличивает результат студента по курсу примерно на 1,1 балла. Скажем, посещение 10 лекций добавит к результату семестра примерно 11 баллов. Учитывая, что суммарное количество баллов за семестр может принимать значения от 0 до 100, можно видеть, что лекции не играют решающей роли в оценке. Тем не менее их вклад на самом деле является положительным, а не отрицательным (как мы могли бы ошибочно заключить, если бы ограничились моделью без фиксированных эффектов из первого столбца). Этот пример демонстрирует, как важно учитывать неоднородность моделируемых объектов для получения корректной оценки. 
Кстати, отметим, что радикальное увеличение коэффициента R-квадрат в модели с фиксированными эффектами по сравнению с первой моделью говорит в пользу того, что индивидуальные особенности студентов играют решающую роль в их результате по курсу. 
В третьем столбце рассматривается двусторонняя модель, т.е. модель с добавлением еще и фиктивной переменной для временного периода. Если бы у нас было больше временных периодов, то и таких бинарных переменных было бы больше одной. Формальный тест не отвергает гипотезу о равенстве нулю коэффициента при бинарной переменной времени. То есть данные не противоречат тому, что сложность двух семестров курса была примерно одинаковой и, следовательно, номер семестра не влияет на результаты студентов. Поэтому в данном случае можно сделать выбор в пользу модели из второго столбца (впрочем, коэффициент при интересующей нас переменной примерно одинаков для второго и третьего столбцов). 

9 .3 . Внутригрупповое преобразование 
Оценка параметров модели с фиктивными переменными в случае большого числа объектов в выборке является довольно затратной в вычислительном смысле. Представьте, например, что уравнение (9.3) оценивается по данным о тысяче объектов. В этом случае в матрице регрессоров X будет 1001 столбец. Поэтому матрица XX&#17; имеет размер 1001 на 1001. Следовательно, для вычисления вектора МНК-оценок ˜^ = (XX˛ )−1 Xy˛ потребуется вычислить матрицу, обратную к матрице 1001 на 1001. Если для современных компьютеров это не такая уж и сложная задача, то всего несколько десятилетий назад она была почти не решаема. 
Чтобы преодолеть эту трудность, было разработано так называемое внутригрупповое преобразование данных. Оценка, полученная на основе этого преобразования, называется внутригрупповой оценкой (within estimator). Она позволяет получить в точности ту же самую оценку коэффициента при регрессоре, что и LSDV-модель, но с меньшими вычислительными сложностями. Упрощение достигается за счет того, что в результате этого преобразования удается обойтись без вычисления величины отдельных фиксированных эффектов. 
Придуманный ради экономии вычислительных мощностей способ оказался удобным, поэтому в прикладных исследованиях под оценкой модели с фиксированными эффектами по умолчанию понимают именно эту оценку. 
Чтобы понять, как она устроена, снова вернемся к исходному уравнению (9.1): 
y =˛x +µ +˙ . (9.1)
it it iit 
Запишем его отдельно для каждого периода времени: 
y =˛x +µ +˙ ;
i1 i1 ii1 y =˛x +µ +˙ ;
i2 i2 ii2 y =˛x +µ +˙ ;
i3 i3 ii3 
… 
y =˛x +µ +˙ .
iT iT iiT 
Сложим все эти уравнения друг с другом: 
TT T y =˙ x +T ˝µ+ ˇ . 
° it ° it i ° it 
t =1 t =1 t =1 
Разделим результат на T: 
y =˛x +µ +˙ . (9.4)
i iii 
Здесь мы воспользовались следующими обозначениями в средних по времени: 
T TT 
yx ˛
° t =1 it ° t =1 it ° t =1 it 
y = ; x = ; ˛= .
iii
T TT 
Осталось вычесть из уравнения (9.1) уравнение (9.4): 
y − y =˝x −˝x +µ−µ+ˆ −ˆ ,
iti it iiiiti 
(y − y ) =˝(x − x ) + (˙ −˙ ). (9.5)
iti it i iti 
Обозначим отклонения от средних по времени следующим образом: 
y = y − y ; x = x − x ; ˛ =˛ −˛ .
it it iit it iit iti 
В этом случае равенство (9.5) примет вид: 
y =˛x+ ˝ .
it itit 
Мы снова устранили ненаблюдаемые фиксированные эффекты из модели. Теперь для оценки параметра ° нам достаточно вычислить МНК-оценку в обычной парной регрессии без константы (см. задание 8 к гл. 2): 
nT 

xy
 ˛˛i=1 t =1 it it
˜= . 
nT 
()2 
i it
˛˛=1 t =1 x 
Если для исходного уравнения (9.1) выполнены все предпосылки модели с фиксированными эффектами, то для переменных преобразованного уравнения (9.5) будут выполнены предпосылки регрессионной модели со стохастическим регрессором из гл. 6. Отсюда ясно, что МНКоценка коэффициента в таком уравнении будет состоятельной и асимптотически нормальной. Для наглядности докажем состоятельность этой оценки непосредственно. 
Теорема о состоятельности within-оценки 
Если выполнены предпосылки 1−5 модели с фиксированными эффектами, то °будет состоятельной оценкой параметра ° при n ˜°. 
Доказательство . 
В силу предпосылки о конечных четвертых моментах распределения существуют конечные пределы по вероятности для следующих выражений (детальное обоснование этого факта может быть проведено аналогично доказательству состоятельности обычных МНК-оценок в гл. 6): 
nT T
1 p
x ˇ ˛˝Ex <ˆ
 ˛ˇ ;
°° it it ° it it
n 
i==
11tt =1 
nT T
1 p
x 2 ˛˝E ()x 2 <ˆ.
() ˛
°° it ° it
n 
i==
11tt =1 
Опираясь на этот факт, можно вычислить предел по вероятности для within-оценки: 
nT nT
1  1 ( x +˝)
xy x ˜
˛˛ it it ˛˛ it it it
 ni=1 t =1 ni=1 t =1
˜== = 
1 nT nT
()x 2 ()2
x

˛˛ it 1 ˛˛ it
ni=1 t =1 ni=1 t =1 
1 nT 21 nT
˝ ()x + x˙
˛˛ it ˛˛ it it
ni=1 t =1 ni=1 t =1 p
= ˆˇ
ˆ
1 nT 
(x)2 
n ˛˛ it
i=1 t =1 
TT T
()2  ˇ
ˆEx +Ex ˇ Ex 
p ˙t =1 it ˙t =1 it it ˙t =1 ittit
˜° =+=ˆ.
˜ˆ
TT
Ex E ()x 2
()2 
˙t =1 it ˙t =1 it 
В последнем равенстве мы воспользовались тем, что в силу экзоген
T 
ности регрессора Ex°˛= 0.
it it t =1 
*** 
Полученная модель называется внутригрупповой регрессионной моделью (within-group regression), так как объясняет вариацию зависимой переменной вокруг среднего значения для группы наблюдений, относящихся к разным моментам времени, но к одному объекту. Внутригрупповое преобразование для множественной регрессии осуществляется аналогичным образом. 
Коэффициент R-квадрат, подсчитанный для такой модели, называется within-R2. Он не совпадает с LSDV-R2 и не может быть сопоставлен с ним, так как рассчитывается на основе общей суммы квадратов остатков для преобразованной переменной (а не для исходной). Поэтому, приводя коэффициент детерминации для вашей модели, не забывайте уточнять, о каком именно R2 идет речь. 
В отличие от R2 оценки коэффициентов при переменных, полученные в ходе применения внутригруппового преобразования, в точности совпадают с оценками LSDV-модели. В этом смысле два указанных подхода эквивалентны. 
В случае выполнения предпосылок 1−5 модели с фиксированными эффектами within-оценка асимптотически нормальна, что позволяет тестировать гипотезы относительно соответствующих коэффициентов и строить доверительные интервалы для них. Но при вычислении стандартных ошибок для модели с фиксированными эффектами следует принимать во внимание не только возможную гетероскедастичность, но и то, что случайные ошибки, относящиеся к одному объекту (но к разным моментам времени), могут быть коррелированы между собой. Оценка стандартных ошибок, состоятельная в условиях такой кластеризации, была предложена Ареллано, поэтому соответствующие стандартные ошибки называются стандартными ошибками в форме Ареллано (Arellano standard errors) или состоятельными в условиях кластеризации стандартными ошибками (cluster-robust standard errors). 
Пример 9.2. Отдача от посещения лекций (продолжение) 
Вернемся к нашему примеру с оценкой пользы от посещения лекций (см. пример 9.1). Оценим теперь коэффициент при переменной attendance при помощи внутригруппового преобразования. Ниже представлена стандартная выдача эконометрического пакета для этого случая. 
Модель 1: Фиксированные эффекты, использовано наблюдений - 600 Включено 300 пространственных объектов Длина временного ряда = 2 Зависимая переменная: performance Робастные стандартные ошибки 
Коэффициент Ст. ошибка t-статистика P-значение const 40,1209 0,384245 104,4 2,61e-237 *** attendance 1,11873 0,0359668 31,10 9,90e-096 *** 
Сумма кв. остатков 759,9752 Ст. ошибка модели 1,594278 LSDV R2 0,993163 within-R2 0,786506 
Обратите внимание, что интересующий нас коэффициент оказался равен 1,12. Он совпадает с коэффициентом при переменной attendance, который мы получили при помощи МНК с фиктивными переменными. Чтобы убедиться в этом, посмотрите на второй столбец в табл. 9.1 в примере 9.1. Таким образом, мы убедились на примере, что два этих метода оценивания приводят к одинаковому итогу. Стандартные ошибки для коэффициентов несколько различаются. Это связано с тем, что в последнем случае использованы стандартные ошибки в форме Ареллано (Arellano standard errors), которые учитывают панельную структуру данных. 
В таблице, приведенной выше, также показаны два варианта коэффициентов R2: LSDV-R2 и within-R2. Первый из них — это тот же самый R2, что и во втором уравнении из табл. 9.1. Он, как это обычно и бывает, больше, чем within-R2. 
9 .4 . Модель в первых разностях 
Представим для начала, что в нашем распоряжении есть данные только за два периода времени t= 1,2. В этом случае модель (9.1) можно записать для каждого из них: 
y =˛x +µ +˙ ;
i1 i1 ii1 
y =˛x +µ +˙ .
i2 i2 ii2 
Вычтем из второго уравнения первое: 
y − y =˝(x − x) + (˙ −˙ ).
i2 i1 i2 i1 i2 i1 
Обозначим ˜y= yy ˜x= x xu=˛ −˛ С учетом этих
ii2 − i1, ii2 − i1, ii2 i1. 
обозначений наше новое уравнение примет вид: 
˜y= ˝˜x+ u.
i ii 
Обратите внимание, что в результате трюка с переходом к первым разностям мы снова устранили фиксированные эффекты из модели. В этом и есть основная идея модели в первых разностях. 
Следовательно, в новой модели состоятельную оценку коэффициента при переменной можно получить при помощи МНК. Ее формула будет соответствовать обычной МНК-оценке в парной регрессии без константы: 
n
˝xy
˜^ =˛i=1 i˝ i .
FD 
(˝x)
˛in =1 i 2 
Для преобразованной модели в первых разностях оказываются выполненными все предпосылки модели со стохастическими регрессорами из гл. 6, что гарантирует состоятельность и асимптотическую 
^
нормальность оценки ° FD. Проверим путем непосредственных вычислений, что эта оценка действительно является состоятельной: 
n 1 n
ˆxy
ˆxy ˙ iˆ i EEx yˆ
^ ˙i=1 iˆ in i=1 p ˆ ii
˜== ˛˝= 
n 1 n )2
FD 22 ˛ (ˆ
˙ (ˆx)(ˆx) Exi
i=1 i ˙i=1 i
n 
Ex( ˝ (˛ 2 Ex
˛ ˝˛x+u) Ex) +˛ u Ex˛ u
iii iii ii
= = ˝=˝ Ex(˛ )2 Ex˛ )2 =+ Ex˛ ). 
( (2 
i ii 
В последнем переходе мы используем тот факт, что Exiiu = 0 в силу
˜ 
предпосылки об экзогенности регрессора. 
В рамках этого подхода тоже невозможно оценить коэффициент при переменной, которая не меняется во времени. Действительно, представьте, что для наблюдений выполнено равенство: x = x . Тогда для
i2 i1 
всех наблюдений ˜xi = 0. Следовательно, в этом случае n (˜xi )2 = 0
˛i=1 
˝xyи вычислить ˜^ =˛in =1 i ˝ i просто не получится.
FD n 
(˝x )2
˛i=1 i 
Поэтому для работоспособности модели с первыми разностями требуется, чтобы хотя бы для некоторых наблюдений значение регрессора менялось во времени. В нашем примере с законом о ношении оружия это означает, что хотя бы для некоторых регионов в первом периоде закон должен отсутствовать, а во втором периоде он должен быть принят в них же. 
Разумеется, вовсе не обязательно ограничиваться моделью с единственной объясняющей переменной и всего с двумя периодами. Рассмотренный нами подход может быть обобщен и на случай множественной регрессии, и на произвольное число временных периодов. Для этого рассмотрим модель множественной регрессии с фиксированными эффектами: 
k y = ˆ˝ x +µ +˘ ; i =12 … nt =12 … T
,,,; ,,,.
it ˙ j it ()j iit j =1 
Вычтем из уравнения для периода t уравнение для периода (t – 1): 
k ˜yit = ˆˇ j ˙˜ it ()j + uit ; i =12 … ; t = 23,,T ,
x ,, , n , … j =1 
где ˜y = y − y −1; ˜x = x − x −1; =˛ −˛ 1.
it it it it it ituit itit − 
В преобразованной модели снова устранены ненаблюдаемые фиксированные эффекты, что решает проблему, описанную в самом начале данной главы. Следовательно, параметры в преобразованной модели можно состоятельно оценить при помощи МНК. 
Если в вашем распоряжении имеются данные только за два временных периода (T = 2), то оценка модели в первых разностях численно равна within-оценке. В случае большего числа периодов эти оценки могут не совпадать. 

9 .5 . Модель со случайными эффектами 
Альтернативным подходом к моделированию на панельных данных является модель со случайными эффектами. 
Предпосылки модели со случайными эффектами: 
1 . Модель линейна по параметрам: 
()1 ()2 ()k
y =˝ x +˝ x +…+˝ x +µ +ˆ ;
it 1 it 2 it kit iit 
i =12 … nt =12 … T
,,,; ,,,. 
()1 ()1 ()1 ()2 ()2 ()2 ()k ()k
2 . Наблюдения {(x , x , …, x , x , x , …, x , …, x ,,
i1 i2 iT i1 i2 iT i1 xi2 ()k 
,, ° , ° , …° ), i =12 … nt =12 … T независимы
… , ,,,; ,,,}
xiT i1 i2 iT
и одинаково распределены. 
()1 ()2 ()k
3 . x , x , …, x и ˝it имеют ненулевые конечные четвертые момен
itit it
ты. 
4 . Случайные ошибки имеют нулевое условное матожидание: 
()1 ()1 ()1 ()2 ()2 ()2 (()k ()k ()k
E(˜ | x , x , …, x , x , x , …, x , …, x , x , …, x , µ ) = 0.
it i1 i2 iT i1 i2 iT i1 i2 iT i 
5 . С вероятностью единица в модели отсутствует чистая мультиколлинеарность. 
()1 ()1 ()1 ()2 ()2 ()k ()k )
E(µ | x , x , …, x , x , …, x , …, x , …, x = E(µ ) = 0.
ii1 i2 iT i1 iT i1 iT i 
Сравнив данный набор условий с предпосылками модели с фиксированными эффектами, очевидно, что эта модель отличается всего одним дополнительным пунктом № 6 (остальные предпосылки в точности совпадают). Из него следует, что регрессоры не должны быть коррелированы с ненаблюдаемыми эффектами µi . 
Таким образом, называя величины µi случайными эффектами, в прикладных исследованиях предполагают их некоррелированность с регрессорами. 
Обозначим =µ +˝ . В этом случае исходное уравнение можно
vit iit 
переписать следующим образом: 
()1 ()2 ()k
y =˝ x +˝ x +…+˝ x +v .
it 1 it 2 it kit it 
В этом уравнении регрессоры экзогенны, так как они не коррелированы ни с одной из компонент vit. 
Так как регрессоры в модели со случайными эффектами экзогенны, параметры этой модели могут быть состоятельно оценены обычным МНК. Однако, как правило, на практике для этого используется не обычный МНК, а доступный обобщенный МНК. Дело в том, что МНКоценки в этой модели будут хоть и состоятельными, но не эффективными. Поэтому применение доступного обобщенного МНК позволяет получить более точные результаты. 
Читателя, заинтересованного в технических деталях получения оценки доступного ОМНК, мы приглашаем обратиться к § 9.6. Здесь же мы отметим несколько важных с прикладной точки зрения соображений о модели со случайными эффектами. 
• 
Преимуществом модели со случайными эффектами является возможность идентификации коэффициентов при переменных, которые не меняются во времени. Как вы помните, для модели с фиксированными эффектами это было невозможно. 

• 
Недостатком же являются более жесткие предпосылки: требование некоррелированности регрессоров и случайных эффектов. Выполнение этой предпосылки можно тестировать (см. § 9.7). 

• 
Так как параметры модели оцениваются не обычным МНК, а доступным ОМНК, то R2 для этой модели не определен. 


Пример 9.3. Отдача от посещения лекций (продолжение) 
Вернемся к нашему примеру с оценкой пользы от посещения лекций (см. примеры 9.1 и 9.2). Оценим теперь интересующий нас параметр при помощи модели со случайными эффектами. 
Модель 1: Случайные эффекты (GLS), использовано наблюдений - 600 Включено 300 пространственных объектов Длина временного ряда = 2 Зависимая переменная: performance 
Коэффициент Ст. ошибка zP-значение const 40,5705 0,871857 46,53 0,0000 *** attendance 1,07664 0,0371079 29,01 4,40e-185 *** 
Как и в случае использования модели с фиксированными эффектами, мы можем сделать вывод, что посещение лекций полезно для овладения курсом. В соответствии с полученной оценкой посещение одной дополнительной лекции увеличивает результат по курсу примерно на 1,08 балла. 
Добавим фиктивную переменную временного периода для учета возможных временных эффектов. Результаты для соответствующей спецификации представлены ниже. Очевидно, что соответствующая переменная не является статистически значимой. К тому же ее добавление не оказывает существенного влияния на оценку коэффициента при интересующей нас переменной attendance. Поэтому в нашем случае нет необходимости в учете временных эффектов. 
Модель 2: Случайные эффекты (GLS), использовано наблюдений - 600 Включено 300 пространственных объектов Длина временного ряда = 2 Зависимая переменная: performance 
Коэффициент Ст. ошибка zP-значение const 40,6545 0,882711 46,06 0,0000 *** attendance 1,07293 0,0376277 28,51 7,75e-179 *** dt_2 −0,0886003 0,146151 −0,6062 0,5444 

9 .6 . Доступный ОМНК для оценивания модели со случайными эффектами 
Чтобы понять, как устроена ковариационная матрица вектора случайных ошибок в модели со случайными эффектами, вычислим ее элементы. Для этого определим дисперсии ˝it и случайных эффектов следующим образом: var(˜ ) =°2 ˜ , var(µ ) =°2 . Элементами кова
it i µ
риационной матрицы являются коэффициенты ковариации: 
cov(vv,) ij, = ,,,; t, p =12; 12 … n ,, …,.T
it jp 
С учетом наших обозначений: 
cov(vv )cov(µ +˝ , µ +˝ ) =
, = 
itjp iit j jp 
=cov(µµ+ µ˝) +cov(˝µ, +
, )cov( , )cov(˝˝,) = 
i j ijp it j itjp 
=cov(µµ, + ˝˝ .
)cov( , )
i j itjp 
Здесь в последнем переходе мы использовали предпосылку 2 модели со случайными эффектами, в силу которой случайные ошибки ˝it не коррелированы с µi . 
Если i = j и t = p, то 
222
cov(vv )cov( , ) +cov(˝˝) =˙+˙=˙.
, = µµ ,
itjp ii itit µ˝ v 
Поэтому на главной диагонали ковариационной матрицы вектора 
222
случайных ошибок стоят суммы ˜ =˜ +˜ . 
v µ˛Если i = j и tp, то
ˆ 
cov(vv )cov( , ) +cov(˝˝) =˙2 +0 =˙2.
, = µµ ,
itjp ii itip µµ 
Если же i ˆ j, то cov(v , v )cov( , ) +cov(˝˝) =+=0.
= µµ , 00
itjp ij itjp 
Таким образом, ковариационная матрица вектора случайных ошибок представляет собой блочную матрицу размером n на n блоков: 
00 
00 
где 0 обозначает нулевую квадратную матрицу размером T на T, а &#4; — квадратную матрицу размером t на t, на главной диагонали которой стоят числа ˜2 +˜2, а вне главной диагонали — числа ˜2: 
µ˛ µ 
ˇ 222 2 &#22;ˇ 22 2 &#22;
˝+˝˝ ˝ ˝˝˝ 
µˆµ µ v µµ
&#23; 
&#20;&#23;
&#20; 
222 2 222
&#23;˝ ˝+˝ ˝ &#20;&#23;˝˝ ˝&#20; 
µµˆ µµ v µ
&#23; &#20;&#23;&#20;
˜= 
= 
.
&#23; &#20;&#23;&#20; 
2 2 2222
&#23;˝ ˝ 
˝+˝&#20;&#23;˝˝ 
˝2 &#20; 
µ µ µˆµµ v
˘ &#21;˘&#21; 
Представим, например, что в выборке имеются данные про три объекта (n = 3), и про каждый из них доступна информация за два периода времени T = 2. В этом случае 
˝ 22 2 ˇ
&#22;+&#22; &#22; 
µ&#20; µ
˜=ˆ &#23;.
2 22
ˆ &#22; &#22;+&#22;&#23;
˙ µ µ&#20;˘ 
И, следовательно, ковариационная матрица вектора случайных ошибок будет иметь вид: 
+ 
2 
0 000 
+ 
0 000 
+ 
2 
00 
˜= 
. 
&#22;
˝ &#20;&#20;&#20;&#20;&#20;&#20;&#20;&#20;&#20;&#20;&#21; 
2 
ˆ
˝
2
˝
2
˝ 
µ
µ µ 
˝
2 
ˆ
˝
2 
µ 
˝
00 00
2 
ˆ
˝
+
2
˝
2
˝
00 
ˇ
°
˝ 

0
ˆˆˆ 
=˜ 
&#23;˘ 
°

ˆ˙ 
µ 
2 
ˆ
˝
2
˝
ˇ 
µ
&#23;&#23;&#23;&#23;&#23;&#23;&#23;&#23;&#23; 
+ +
00 0 
00 00 
2 
ˆ
˝
2
˝
2 
2 
µ 
˝
2 
ˆ
˝
2 
µ
µ 
˝
&#23;˘ 
µ 
˝
0 
µµ 
С учетом этого результата процедура реализации доступного ОМНК для оценки параметров модели со случайными эффектами устроена так: 
2
^2 ^2^ ^2
1. Находим оценки ˜ =˜°+˜µ . и ˜µ . Зная их, вычисляем оценку
v 
^
ковариационной матрицы вектора случайных ошибок . 
2. Находим оценку вектора коэффициентов модели со случайными эффектами при помощи доступного ОМНК (см. § 5.5): 
˝
ˇ
RE 
&#21; 
^ 1 
^ ^ ^^
X
&#21; 
^ 
Поясним детали первого пункта описанной процедуры. Оценка ко
˜˜ ˜ 
вариационной матрицы может быть вычислена по формуле: 
˜ 
ˆ ˆ ˆ ˆ ˆ˙ 
&#23; &#23; &#23; &#23; &#23;˘ 
RE 
−1 −1
RE 
2 
−1
X
T T
( 
)
X
=
=
y. 
… 
RE 
k 
˝
ˇ
22
&#22;µ 
2
&#22;&#22; &#22; 
&#22; 
&#22;&#22; &#22; 
° ° 
° 
^^ 
^ ^^^ 
˜
^^ 
^ ^^ ^
Чтобы определить ^ , нужно получить состоятельные оценки ˘2 и
v
2
^
˜µ . Это можно сделать по следующим формулам: 
nT ˜^2 v = 1 ˝˝eit 2; (9.6)
nT − k 
i==t
11 
nT −1 T 
21^
˜µ= ee , (9.7)
ˇˇˇit is
T −1
nT ˝−ki 11 st 1
==t =+ 
2 
где eit — остатки, полученные в ходе оценки параметров модели со случайными эффектами при помощи обычного МНК (pooled regression). 
^ 
^° 
0 
˝
ˇ
00
µ
v
ˆ ˆ ˆ ˆ ˆ ˆˆˆˆ 
&#23; &#23; &#23; &#23; &#23; &#23;&#23;&#23;&#23; 

ˆ ˆ ˆ ˆˆˆˆˆ˙ 
&#23; &#23; &#23; &#23;&#23;&#23;&#23;&#23;˘ 

0 
2 
2 
2 
µ
µ
v 
, ãäå
=
= 
. 


2 
2 
2
00 

˙
˘
µ 
^&#22;µ

v 

9 .7 . Спецификационные тесты 
Мы обсудили три подхода к оцениванию на панельных данных: регрессия пула, модель с фиксированными эффектами и модель со случайными эффектами. Следовательно, в каждом конкретном случае важно уметь выбирать наилучший подход. Для этого достаточно научиться попарно сравнивать между собой три доступных варианта. 
Мы уже умеем выбирать между регрессией пула и моделью с фиксированными эффектами. Для этого используется специальная версия теста на сравнение «короткой» и «длинной» регрессий, которую мы рассмотрели в § 9.2. 
Теперь нам нужно научиться делать выбор между моделями со случайными эффектами и с фиксированными эффектами, а также между моделью со случайными эффектами и регрессией пула. 
Для первого из указанных выборов используется тест Хаусмана, уже знакомый нам по теме «Инструментальные переменные». Он позволяет проверить выполнение предположения 6 модели со случайными эффектами (так как именно это предположение отличает ее от модели с фиксированными эффектами). В рамках теста сравниваются оценки модели с фиксированными эффектами, полученные при помощи внутригруппового преобразования, и оценки модели со случайными эффектами, полученные при помощи доступного ОМНК. Нулевая гипотеза теста Хаусмана в данном случае состоит в том, что оценки доступного ОМНК являются состоятельными. Альтернативная гипотеза заключается в том, что они несостоятельны. 
Тестовая статистика теста Хаусмана имеет вид: 
^^^^ ^^ −1^ ^
(˜ −˜ )((V ˜ ) −V (˜ )) (˜ −˜ ),
˛
FERE FE RE FERE 
^
где ° — вектор оценок коэффициентов для модели с фиксирован
FE 
^^
ными эффектами; V (° ) — оценка ковариационной матрицы этого
FE 
вектора. Аналогичные величины с индексом RE соответствуют модели со случайными эффектами. Если нулевая гипотеза верна, то данная статистика имеет распределение Хи-квадрат с k степенями свободы. 
Если нулевая гипотеза отвергается, то следует заключить, что оценки доступного ОМНК несостоятельны, и сделать выбор в пользу модели с фиксированными эффектами. В противном случае предпочтительной является модель со случайными эффектами. 
Тест Бреуша — Пагана позволяет сделать выбор между моделью со случайными эффектами и обычной регрессией пула, которая не учитывает никаких индивидуальных эффектов. Нулевая гипотеза этого теста состоит в том, что дисперсия случайных эффектов ˜2 равна нулю (т.е. в
µ
том, что все объекты однородны). Если это так, то в применении доступного ОМНК нет необходимости и можно ограничиться обычным МНК без учета случайных эффектов. Тестовая статистика для этого теста имеет вид: 
2
° 2 ˙
n °T ˙˝ e ˇˇ
˝&#23;&#23;
nT i=1˛t =1 it ˆ
˝ˇ
−1,
2(T −1) ˝ n °T 2 ˙ˇ 
˝ ˇˇ
˝&#23;&#23;
i=1˛t =1eit ˆ
˛ˆ 
где eit — остатки регрессии, оцененной обычным МНК. Если верна нулевая гипотеза, то эта статистика имеет распределение Хи-квадрат с одной степенью свободы. Отвержение нулевой гипотезы говорит в пользу модели со случайными эффектами, не отвержение — в пользу обычной регрессии пула. 
Посмотрим, как работают эти тесты в нашем примере про результаты по курсу математического анализа. 
Пример 9.4. Отдача от посещения лекций (окончание) 
В таблице 9.2 представлены итоги оценивания отдачи от посещения лекции тремя способами: при помощи обычного МНК (регрессия пула), при помощи внутригруппового преобразования (модель с фиксированными эффектами) и при помощи доступного ОМНК (модель со случайными эффектами). Мы получили эти результаты в ходе решения примеров 9.1−9.3 в предыдущих параграфах. 
Таблица 9.2 
Сводные результаты оценивания отдачи от посещения лекций 
Метод оценивания  МНК  Фиксированные эффекты  Случайные эффекты  
Коэффициент при  –0,989***  1,119***  1,073***  
переменной attendance (0,219) (0,036) (0,037)  

Примечание: в скобках под оценками коэффициентов указаны стандартные ошибки. В первом случае использованы состоятельные в условиях гетероскедастичности стандартные ошибки, во втором случае — стандартные ошибки в форме Ареллано. Символ «***» − значимость на 1%-м уровне. 
Из таблицы видно, что оценки отдачи от посещения при использовании разных подходов могут заметно отличаться друг от друга. Следовательно, важно осуществить спецификационные тесты для выбора подходящей модели. 
МНК против фиксированных эффектов 
Расчетное значение F-статистики для проверки гипотезы об отсутствии фиксированных эффектов равно 138,5, что значительно больше критического значения F (299, 299) при 1%-м уровне значимости. Поэтому и соответствующее P-значение меньше 0,01. Следовательно, нулевая гипотеза отвергается при уровне значимости 1%, и мы делаем выбор в пользу модели с фиксированными эффектами. 

МНК против случайных эффектов 
Расчетное значение статистики Хи-квадрат (1) составляет 191,1, что заметно больше критического значения из таблиц распределения Хи-квадрат для одной степени свободы и уровня значимости 1%. Соответственно и P-значение для проверки гипотезы о том, что дисперсия случайных эффектов равна нулю, заметно меньше, чем 0,01. Таким образом, мы отвергаем нулевую гипотезу и делаем выбор в пользу модели со случайными эффектами. 

Случайные эффекты против фиксированных эффектов 
Расчетное значение тестовой статистики для проверки гипотезы о состоятельности ОМНК-оценок равно 136,8. Это тоже больше критического значения из таблиц распределения Хи-квадрат для одной степени свободы (в этом тесте число степеней свободы равно количеству регрессоров в модели, в нашем случае это как раз единица) и уровня значимости 1%. Соответственно и P-значение для данной гипотезы меньше 0,01. Мы должны заключить, что оценки модели со случайными эффектами несостоятельны, и сделать выбор в пользу модели с фиксированными эффектами. 
Подводя итоги всех тестов, мы можем утверждать, что наилучшим выбором является модель с фиксированными эффектами. Таким образом, посещение лекций положительно влияет на сумму баллов по курсу математического анализа. 
*** 
В заключение отметим, что, если результаты спецификационных тестов противоречивы, следует отдавать предпочтение модели с фиксированными эффектами. Это объясняется тем, что ее предпосылки являются наиболее слабыми. Следовательно, она будет давать состоятельные результаты в большем числе случаев, чем альтернативные модели. 
Задания для самостоятельного решения 
Задание 1 . В распоряжении исследователя имеются данные о совокупном потреблении и располагаемом доходе в пяти регионах Вестероса за два года. 
Первый год  
Регион  Потребление  Располагаемый доход  
Винтерфелл  4  10  
Риверран  7  10  
Королевская гавань  12  20  
Дорн  13  20  
Хайгарден  26  40  

Второй год  
Регион  Потребление  Располагаемый доход  
Винтерфелл  4  10  
Риверран  3  10  
Королевская гавань  6  10  
Дорн  13  20  
Хайгарден  14  20  

Эконометрист Э. Старк предполагает, что зависимость совокупного потребления в регионе от располагаемого дохода описывается следующим уравнением: 
y =˝ +˝˛ x +µ +ˆ ,
it 01 it iit 
где yit — потребление в i-м регионе в году t;
 — располагаемый доход в i-м регионе в году t;
xit 
µi — ненаблюдаемая переменная, характеризующая специфические особенности i-го региона. 
а . Используя модель с фиксированными эффектами (осуществив внутригрупповое преобразование), найдите оценку коэффициента ° 1. 
б . Теперь найдите оценку коэффициента ° 1, используя модель в первых разностях. 
в . Эконометрист С. Баратеон предполагает, что автономное потребление меняется со временем, поэтому зависимость потребления от располагаемого дохода описывается следующим уравнением: 
y =˝ +˝˛ x +˝ ˛t +µ +ˆ .
it 01 it 2 i it 
Используя модель в первых разностях, найдите оценки коэффициентов ° 1 и ° 2. 
Задание 2 . В условиях предыдущего задания эконометрист Т. Ланнистер не соглашается с Э. Старком и утверждает, что между регионами Вестероса нет существенных различий, поэтому зависимость потребления от располагаемого дохода имеет вид: 
y =˝ +˝˛ x +˙ .
it 01 it it 
Чтобы проверить свое предположение об отсутствии индивидуальных эффектов, Т. Ланнистер оценил модели 1 и 2 (результаты представлены в таблицах ниже). 
Осуществив необходимый тест, сделайте выбор между подходом Т. Ланнистера (регрессия пула) и подходом Э. Старка (модель с фиксированными эффектами). 
Модель 1: МНК, использовано наблюдений - 10 Включено 5 пространственных объектов Длина временного ряда = 2 Зависимая переменная: y 
Коэффициент Ст. ошибка t-статистика P-значение const –2,09877 0,945432 -2,2199 0,05719 * x 0,723457 0,0491507 14,7192 <0,00001 *** 
Среднее зав. перемен 10,20000 Ст. откл. зав. перемен 6,988880Сумма кв. остатков 15,65432 Ст. ошибка модели 1,398853R2 0,964390 Испр. R2 0,959938 
Модель 2: Объединенный (pooled) МНК, использовано наблюдений - 10 Включено 5 пространственных объектов Длина временного ряда = 2 Зависимая переменная: y 
Коэффициент Ст. ошибка t-статистика P-значение const –2,0 1,34164 –1,4907 0,21030 x 0,6 0,0894427 6,7082 0,00257 *** du_2 1,0 1,41421 0,7071 0,51852du_3 2,0 1,48324 1,3484 0,24882du_4 3,0 1,67332 1,7928 0,14746du_5 4,0 2,28035 1,7541 0,15427 
Среднее зав. перемен 10,20000 Ст. откл. зав. перемен 6,988880 Сумма кв. остатков 8,000000 Ст. ошибка модели 1,414214 R2 0,981802 Испр. R2 0,959054 
du_2 — фиктивная переменная, равная единице для наблюдений, относящихся к региону Риверран; 
du_3 — фиктивная переменная, равная единице для наблюдений, относящихся к региону Королевская гавань; 
du_4 — фиктивная переменная, равная единице для наблюдений, относящихся к региону Дорн; 
du_5 — фиктивная переменная, равная единице для наблюдений, относящихся к региону Хайгарден. 
Задание 3 . Исследователь анализирует влияние закона, разрешающего гражданским лицам хранить огнестрельное оружие, на уровень преступности. Он располагает панельными данными о 40 регионах некоторой страны за 20 лет. D — переменная, которая равна единице, если в данном регионе в данный год действует закон, разрешающий хранение огнестрельного оружия, и равная нулю в противном случае. X и W — некоторые контрольные переменные. Y — количество преступлений в регионе (тысяч в год). 
Исследователь оценил 4 уравнения: уравнения 1−2 — при помощи модели с фиксированными эффектами; уравнения 3−4 — при помощи модели со случайными эффектами. 
Результаты представлены в таблице ниже. 
Результаты оценки моделей . Зависимая переменная — lnY 
Модель  Модель 1  Модель 2  Модель 3  Модель 4  
Метод оценивания  FE  FE  RE  RE  

D  –0,50 (0,04)  –0,50 (0,05)  –0,60 (0,01)  –0,40 (0,02)  
X  0,32 (0,02)  0,21 (0,02)  0,05 (0,04)  0,04 (0,04)  
W  –0,05 (0,01)  –0,06 (0,01)  –0,09 (0,02)  –0,10 (0,02)  
Индивидуальные эффекты  Да  Да  Да  Да  
Фиктивные переменные времени  Нет  Да  Нет  Да  
Число наблюдений  800  800  800  800  
R2  0,657  0,780  —  —  
P-значение теста Хаусмана  —  —  0,002  0,004  
P-значение теста на равенство нулю коэффициентов при фиктивных переменных времени  —  0,001  —  0,008  

Примечание: здесь и во всех последующих таблицах в скобках под оценками коэффициентов указаны робастные стандартные ошибки. 
а . Выберите наилучшую модель из предложенного списка. Обоснуйте свой выбор. 
б . Для выбранной модели проверьте статистическую значимость коэффициента при переменной D и, если он оказался значимым, дайте его содержательную интерпретацию. 
Задание 4 . Дискриминация 
В файле discrimination содержатся следующие данные о 500 работниках некоторой отрасли: id — номер работника; female — бинарная переменная, равная единице для женщин и нулю для мужчин; exp — опыт работника (лет); educ — образование работника (число лет обучения), заработная плата в долларах в день. Данные по каждому работнику доступны за два года (номер года отражает переменная year). 
Вам необходимо ответить на вопрос: присутствует ли в рассматриваемой отрасли дискриминация по гендерному признаку? Иными словами, верно ли, что мужчины и женщины с одинаковыми характеристиками получают разную заработную плату? 
а . Оцените параметры следующей модели: 
ln wage =˛ +˛ exp +˛ educ +˛ exp female +˛ female +˝ .
it 01 it 2 it 3 it it 4 it it 
Значимы ли переменные female и exp × female? Поясните, как пол работника влияет на его заработную плату? 
б . Оцените параметры модели с фиксированными эффектами для индивидов: 
ln wage =˛ exp +˛ educ +˛ exp female +µ +˙
it 1 it 2 it 3 it it iit . 
Почему в эту спецификацию не включена отдельно переменная female (включено только произведение exp × female)? 
Оправдано ли включение в уравнение фиксированных эффектов? Для ответа на вопрос проведите соответствующий тест. 
Поясните, как пол работника влияет на его заработную плату в соответствии с результатами оценивания этой модели? 
в . Оцените параметры двунаправленной модели с фиксированными эффектами: 
ln wage =˛ exp +˛ educ +˛ exp female +µ +˙ +ˆ .
it 1 it 2 it 3 it ititit 
Оправдано ли включение в уравнение индивидуальных эффектов для работников? А фиксированных эффектов времени? Для получения ответа осуществите необходимые тесты. 
Поясните, как пол работника влияет на его заработную плату в соответствии с результатами оценивания этой модели? 
г . Используя модель со случайными эффектами, оцените параметры следующего уравнения: 
ln wage =˛ +˛ exp +˛ educ +˛ exp female +µ +˙ +ˆ .
it 01 it 2 it 3 it ititit 
Осуществите тесты Хаусмана и Бреуша — Пагана для сравнения этой модели с альтернативными вариантами моделей на панельных данных. Интерпретируйте их результаты. 
Поясните, как пол работника влияет на его заработную плату в соответствии с результатами оценивания этой модели? 
Задание 5 . Государственный долг и экономический рост1 
Среди макроэкономистов хорошо известна работа К. М. Рейнхарта и К. С. Рогоффа2, где на основе корреляции между темпами роста ВВП и уровнем долга был найден «пороговый уровень долга» 90% ВВП, при превышении которого темпы роста ВВП начинают значительно падать. Примечательно, что сами авторы сделали оговорку, что полученный результат является приближенным и неодинаков для разных групп стран. Несмотря на это, значение 90% ВВП получило широкое распространение. Во многих эмпирических исследованиях тестируется и находит подтверждение нелинейная зависимость темпов роста ВВП от долга. 
Однако в апреле 2013 г. Т. Херндон, М. Эш, Р. Поллин нашли ошибку в расчетах Рейнхарта и Рогоффа и опровергли основной результат их исследования3. На основании тех же самых данных делается вывод о том, что влияние государственного долга на темпы роста реального ВВП отрицательное и одинаково для любых значений долга (монотонная зависимость). Таким образом, был поставлен под сомнение один из аргументов в пользу необходимости «политики затягивания поясов», которое содержится в исследовании Рейнхарта и Рогоффа. Но эта статья не отменяет результатов многочисленных исследований, нашедших нелинейную зависимость для разных групп стран. 
В этом задании вам предлагается проверить наличие перевернутой U-образной (квадратичной) зависимости темпов роста ВВП от уровня государственного долга для 18 стран ОЭСР за 1980−2009 гг. 
Данные содержатся в файле debtOECD (описание данных см. также на листе Info): 
• 
Country — порядковый номер страны; 

• 
Year — год; 

• 
realGDP — реальный ВВП на душу населения, в постоянных ценах, в долларах США; 

• 
Growth — темп прироста реального ВВП на душу населения, %; 

• 
Pop — численность населения, тыс. человек; 

• 
Ngs — валовые национальные сбережения, % ВВП; 

• 
School — среднее число лет обучения среди населения старше 15 лет; 

• 
Openness — степень открытости экономики (экспорт + импорт к ВВП), % ВВП; 


1 Автор задачи — Ольга Сучкова. 
2 Reinhart C. M., Rogoff K. S. Growth in a time of debt // NBER, Working Paper № 15639, 2010. 
3 Herdon T., Ash M., Pollin R. Does High Public Debt Consistently Stifle Economic Growth? A Critique of Reinhart and Rogoff // University of Massachusetts Amherst, Political Economy Research Institute, Working Paper series, № 322, 2013. 
• 
Infl — уровень инфляции (ИПЦ), %; 

• 
Total_dep — демографическая нагрузка детьми и пожилыми, %; 

• 
Bankcrisis — фиктивная переменная, равная единице, если в данной стране в этот год произошел банковский кризис, и равная нулю в противном случае; 

• 
Debtgov — валовой государственный долг, % ВВП. 


а . Оцените регрессию переменной Growth на Ngs, логарифм реального ВВП на душу населения, темп прироста населения, Openness, School, Total_dep, Infl, Bankcrisis, Debtgov и квадрат долга, используя три подхода: 
1) обычный МНК (pooled regression); 
2) модель с фиксированными эффектами; 
3) модель со случайными эффектами. 
При этом, чтобы избежать потенциальной проблемы эндогенности, вместо самих регрессоров возьмите их первые лаги (т.е. их значения для предыдущего периода). 
Представьте результаты в виде единой таблицы. Укажите коэффициенты и (в скобках под ними) их стандартные ошибки. Отметьте звездочками значимые переменные. 
б . Выберите среди оцененных моделей наилучшую. Приведите результаты всех тестов, которые вы использовали для этого. Поясните, как именно на основе результатов тестов осуществляется выбор. 
в . На основе полученных по выбранной модели оценок рассчитайте «пороговое значение» уровня государственного долга (как вершину параболы). С помощью теста на линейные ограничения на 5%-м уровне значимости проверьте гипотезу о том, что «порог» равен 0,9 (90% ВВП). 
Задание 6 . Рассматривается модель на панельных данных: 
y =˝x +µ + u ; i = ,, … n; t = ,, … T .
12, 12,
it it iit 
Докажите, что в случае наличия данных за два периода (T = 2) внутригрупповая оценка (within estimator) параметра ° совпадает с оценкой модели в первых разностях. 
Задание 7 . Рассматривается модель на панельных данных: 
y =˝x +µ + u ; i = 12 … ; t = ,,,3
, , ,100 12
it it iit 
где uit — независимые одинаково нормально распределенные величины с нулевым математическим ожиданием и дисперсией, равной ˘2; 
µi — индивидуальный фиксированный эффект i-го объекта (ненаблюдаемая переменная). 
Оценку параметра &#19; исследователь получает с помощью внутригруппового преобразования исходных данных и применения к преобразованным данным обычного метода наименьших квадратов (внутригрупповое оценивание, within estimation). 
а . Считая xit детерминированными величинами, вычислите дисперсию полученной оценки параметра &#19; (выразите ее явным образом через ˘2 и xit, i = ,, …, 100, t = ,,). 
12 123 
б . Опираясь на результаты предыдущего пункта, объясните, в каком из двух описанных ниже случаев точность оценивания параметра &#19; будет выше: 
1. 
Значение регрессора x для каждого объекта слабо меняется от года к году, однако внутри каждого года сильно отличается от объекта к объекту. 

2. 
Значение регрессора x для каждого объекта сильно меняется от года к году, однако внутри каждого года слабо отличается от объекта к объекту. 


Задание 8 . Рассматривается модель на панельных данных: 
y =˙y +µ +ˇ ; i =12, …, n; t = ,3
, 12,,
it it −1 i it 
где — независимые одинаково нормально распределенные вели
˝it
чины с нулевым математическим ожиданием; µi — индивидуальный фиксированный эффект i-го объекта (ненаблюдаемая переменная). Подобная модель называется динамической, так как в ней в правой части уравнения содержится зависимая переменная. 
а . Оценку параметра &#19; исследователь получает с помощью модели в первых разностях. Объясните, почему в данном случае эта оценка будет несостоятельной. 
б . Предложите способ получения состоятельной оценки параметра &#19;. 




ГЛАВА 10 
МОДЕЛИ БИНАРНОГО ВЫБОРА 
Модели бинарного выбора полезны, если вы хотите оценить вероятность наступления некоторого события и определить, от чего эта вероятность зависит, или если вы хотите выяснить, какие факторы и каким образом влияют на решения, принимаемые индивидом. Например: 
•	 
Какова вероятность наступления рецессии в экономике в следующем году? Какие факторы влияют на эту вероятность? 

•	 
Почему одни выпускники школы принимают решение о поступлении в вуз, а другие — нет? Какие факторы влияют на это решение? 

•	 
Вернет ли этот заемщик долг или нет? 


10 .1 . Линейная модель вероятности 
На первый взгляд, если мы столкнулись с одним из вопросов, сформулированных в начале параграфа, мы можем легко обойтись тем инструментарием, который нам уже знаком: взять в качестве зависимой переменной бинарную переменную. В примере с заемщиками мы могли бы собрать данные про n индивидов, взявших кредит в банке, и в качестве зависимой переменной выбрать бинарную переменную, равную единице для тех, кто вернул долг, и нулю для тех, кто не вернул. 
В такой модели мы можем считать, что вероятность наступления события (например, возвращения кредита) линейно зависит от некоторого фактора x (например, от заработной платы индивида). Тогда такую модель называют линейной моделью вероятности и записывают следующим образом: 
p = P(y =1) =˛ +˛ x ,
ii 12 i 
где Yi — переменная, которая равна единице, если событие наступило, и нулю в противном случае; xi — фактор, влияющий на вероятность наступления данного события; pi = P(yi =1) — вероятность того, что событие наступит. 
Рассмотрим данную модель на примере влияния времени, затраченного на подготовку к зачету, на вероятность его успешной сдачи. Пусть yi — переменная, которая равна единице, если i-й студент сдал зачет, и нулю в противном случае; xi — время, затраченное на подготовку i-м студентом (в часах); pi = P( yi =1) — вероятность того, что зачет будет сдан успешно. 
Представим, что мы собрали данные о двух тысячах студентов, оценили параметры уравнения при помощи обычного МНК и получили следующие результаты (табл. 10.1). 
Таблица 10.1 
Результаты оценки вероятности сдачи зачета при помощи линейной модели вероятности 
Зависимая переменная:  y  
Коэффициент  Ст. ошибка  t-статистика  
Константа  –0,30  0,05  −6,00  
x  0,10  0,02  5,00  

В соответствии с результатами оценивания из табл. 10.1 можно записать уравнение для предсказанной вероятности сдачи зачета: 
^ 
p =−03, +01, xi . 
Это уравнение следует интерпретировать так: если x увеличивается на единицу, то вероятность наступления события увеличивается на 0,1. То есть один дополнительный час подготовки увеличивает вероятность сдать зачет на 0,1 (на 10 процентных пунктов). Скажем, если студент потратил на подготовку 9 ч, то вероятность сдать зачет будет равна: 
^ 
p =− , + , ˝= ,.
03 01906 
На практике линейная модель вероятности используется сравнительно редко, так как обладает недостатками. Главный из них — сложности с интерпретацией результатов. В такой модели предсказанные значения вероятности могут быть отрицательными или превышать единицу, что заведомо не соответствует действительности. В нашем приме
^^
ре если x = 2, то p =−01, <0, а если x = 20, то p =17, >1. 
Кроме того, нереалистичным часто выглядит и предположение о том, что вероятность успеха зависит от объясняющей переменной линейно. Вряд ли увеличение времени подготовки с 20 до 30 ч должно приводить к такому же изменению вероятности сдачи зачета, как и увеличение с 1000 до 1010 ч. 
0,5  


Чтобы преодолеть эту проблему, в прикладных исследованиях вместо линейной модели вероятности обычно используют одну из двух альтернатив: логит-модель или пробит-модель. Мы рассмотрим их в последующих параграфах этой главы. 

10 .2 . Логит-модель: введение 
В рамках логит-анализа для описания вероятности наступления события используется логистическая функция: 
1
Fz() = .
i −
zi
1 + e 
График этой функции представлен на рис. 10.1. Она всегда принимает значения в пределах от нуля до единицы, что позволяет преодолеть основной недостаток линейной модели вероятности, упомянутый в предыдущем параграфе. 
1 
0 –6–4–20 2 4 6 
Рис. 10.1. График логистической функции 
Если мы анализируем случай парной взаимосвязи (т.е. случай, когда вероятность наступления события зависит от единственного фактора x), то логит-модель может быть записана так: 
1
( i ==()i
Py 1) Fz = ,
−zi
1+e где z =˛ +˛ x ;
i 12 i 
1
Py( ==).
1
i −( +xi )
˝˝
1+e 12 
Для оценивания такой модели применить обычный МНК не получится, так как параметры входят в уравнение нелинейно. Кроме того, невозможно свести модель к линейной по параметрам подобно тому, как мы делали это в гл. 4 при помощи перехода к логарифмам. Поэтому для оценки логит-модели используется метод максимального правдоподобия (ММП). 
С деталями процедуры оценивания можно познакомиться в § 10.3. Здесь мы доверим эту работу эконометрическому пакету, а сами сосредоточимся на том, как можно интерпретировать результаты логит-модели. Для этого вернемся к нашему примеру про вероятность успешной сдачи зачета в зависимости от времени, затраченного на подготовку (табл. 10.2). 
Таблица 10.2 
Результаты оценки вероятности сдачи зачета при помощи логит-модели 
Зависимая переменная:  y  
Коэффициент  Ст. ошибка  z  
const  −9,00  0,50  −18,00  
x  0,50  0,04  10,00  

В соответствии с табл. 10.2 оцененная вероятность сдачи зачета имеет следующий вид: 
1
^
Py( ==).
1
i ( 905, xi
+ −−+ )
1 e 
Как можно интерпретировать подобные результаты? 
Во-первых, можно оценить вероятность наступления интересующего нас события в тех или иных условиях. Например, если студент затратил на подготовку 15 ч, то какова вероятность сдать зачет? Для ответа на вопрос достаточно подставить в формулу xi = 15 и вычислить вероятность. В нашем случае она равна 0,18. То есть для студента, который готовился 15 ч, вероятность сдать зачет составляет 18%. 
Во-вторых, можно интерпретировать результаты в терминах изменения зависимой переменной в результате изменения регрессора. Для этого следует найти так называемый предельный эффект изменения регрессора, т.е. вычислить, на сколько меняется вероятность наступления события при небольшом изменении переменной x. Для этого подсчитаем производную вероятности по x: 
−( +x
ˇˇ)
dP(yi =1) e 12 
= ˙ˇ. 
dx 22 
−( +x
ˇˇ)
(1 +e 12 ) 
В нашем примере для студента, который готовился к зачету 15 ч, оценка предельного эффекта составит: 
(, ˙ i =˙ , = , 
dP^(y =1) e−−+90515) 
05 007. 
−−+(, ˙
90515)
dx (1+e )2 
Таким образом, дополнительный час подготовки для нашего студента увеличит вероятность сдачи зачета примерно на 7 процентных пунктов. 
Геометрически предельный эффект (как и любая производная) характеризует наклон функции. Так как у логистической функции разный наклон в разных точках (см. рис. 10.1), то и предельный эффект для разных значений регрессора будет различаться. Скажем, для студента, который затратил на подготовку не 15 ч, а 100 ч, предельный эффект будет гораздо меньше: 
^
dP( y =1) −−+( 905, ˙100)ie ˙05,, 0
==0 0000000000000000008.
2
dx (1+e−−+, ˙ ) )
( 905 100 
В нашем примере это, по всей видимости, означает, что студент, который готовится 100 ч, и так знает все, что нужно, и имеет вероятность сдачи зачета, близкую к 100%. Поэтому от еще одного дополнительного часа подготовки толку практически не будет. 
С прикладной точки зрения непостоянство предельного эффекта порождает некоторую сложность: не очень понятно, в какой именно точке его считать. На практике для этого обычно используется один из двух вариантов: 
1) предельный эффект для среднего по выборке. В нашем примере он работает следующим образом: вычисляем среднее по выборке время подготовки к зачету x, а затем считаем предельный эффект в точке x; 
2) средний предельный эффект: вычисляем предельный эффект для каждого студента, затем считаем среднее значение из nпредельных эффектов. 
Говоря про интерпретацию результатов логит-модели, следует отдельно упомянуть интерпретацию коэффициентов при фиктивных переменных. Представим, например, что в нашей истории про вероятность сдачи зачета регрессором теперь является бинарная переменная. Пусть, например, x — переменная, которая равна единице для тех студентов, которые в прошлом в школе учились в математическом классе (и равна нулю для всех остальных). Представим для определенности, что, оценив логит-модель, мы получили вот такие результаты: 
1
^
Py( ==).
1
i + −−(,20+20, ˝x)
1 e 
Использовать здесь для интерпретации подход с вычислением предельного эффекта — это не слишком удачная идея, так как предельный эффект (как и любая производная) показывает изменение функции при бесконечно малом изменении аргумента. Однако в случае бинарной переменной аргумент не может меняться на бесконечно малую величину: он равен либо нулю, либо единице. Вместо этого удобно вычислить изменение вероятности наступления события в результате изменения регрессора с 0 до 1. 
В нашем примере с бинарной переменной математического класса можно подсчитать вероятность сдать зачет для студента не из математического класса (т.е. для студента, для которого х равен 0). Для этого надо про
1сто в формулу вероятности подставить х, равный 0 (получится 2 ).
1 + e А потом можно подсчитать вероятность наступления этого события для студента из математического класса (т.е. для студента, для которого х равен 1). Для этого надо подставить 1 в выражение для вероятности (по
1лучится 0 ). Потом следует просто сравнить эти две вероятности:
1 + e 
11
^^ 
px( =−1) px( =0) =−=038
,.
02
1 +e 1+e 
Это будет значить, что для выпускников из математической школы по сравнению с выпускниками других школ вероятность получить зачет на 0,38 больше (т.е. на 38 процентных пунктов больше). 

10 .3 . Логит-модель: оценивание и тестирование гипотез 
Вероятность наступления события в логит-модели описывается функцией: 
1
( ==()
Py 1) Fz = .
ii (˝˝x)
−+
1 +e 12 i 
Следовательно, вероятность ненаступления события имеет вид: 
1
Py( =) =−Py( =11) =−Fz() =−
01 1.
i ii +−(1+2xi
˝˝ )
1 e 
С учетом этих соображений можем записать функцию правдоподобия: 
(, 1 =) =
Ly …, y) = P( y=˛) P(y 0
1 n ˝ i ˝ i yi =1 yi =0 
1 ˙ 1 ˘ 
=˛ 1−=
&#21;−( +x) &#21;ˇ −( +&#22;
&#20;&#20; &#20;&#20;x) 
y=11 +e 12 iy=0 ˆ 1 +e 12 i &#23; 
ii 
y 1−y
ii
˛ 1 ˆ˛ 1 ˆ 
=&#22;1− .
&#21; i ˙˝1+e−(1+2xi) ˘ˇ ˙˝ 1 +e−(1+2 i ˘ˇ
&#20;&#20; &#20;&#20;x) 
Логарифмируя это выражение, получаем логарифм функции правдоподобия: 
nn
1 ˘ 1 &#21; 
ln Ly(, …, y) = y˙ln + ( −y)˙ln 1 − .
1 n ˆi −(ˇˇ+x) ˆ1 i &#22;−(ˇˇ+ ) &#19; 
i=11+e 12 ii=1 &#23; 1 +e 12xi &#20; 
Далее для получения оценок параметров достаточно вычислить производные по ° 1 и ° 2 и приравнять их к нулю. Решение соответствующей системы относительно неизвестных значений параметров и приво
^^
дит к получению необходимых оценок ° 1 и ° 2. 
Так как данная система является нелинейной, у нее может не быть аналитического решения, поэтому не получится (подобно случаю применения МНК) записать формулы оценок коэффициентов в общем виде. Эконометрические пакеты осуществляют решение системы не аналитически, а численными методами. Функция правдоподобия будет выпуклой вверх, поэтому в найденной точке будет достигаться ее максимум. 
В силу общих свойств метода максимального правдоподобия, если спецификация модели верна, то полученные ММП-оценки параметров будут состоятельными и асимптотически нормальными. Последнее свойство позволяет тестировать гипотезы по поводу отдельных коэффициентов в логит-модели стандартным образом: вычисляя отношение оценки коэффициента к его стандартной ошибке и используя тот факт, что это отношение имеет стандартное нормальное распределение (пример 10.1). 
Тестировать гипотезы по поводу выполнения нескольких ограничений (например, для сравнения «короткой» и «длинной» регрессий) можно при помощи теста отношения правдоподобия (likelihood ratio test). Для этого следует оценить параметры модели без ограничений и модели с ограничением и вычислить следующее расчетное значение тестовой статистики: 
LR =−2(ln LR −ln LUR ), 
где lnLUR — логарифм максимального значения эмпирической функции правдоподобия в регрессии без ограничений; 
lnLR — логарифм максимального значения эмпирической функции правдоподобия в регрессии с ограничениями. 
Если верна нулевая гипотеза, то эта статистика имеет асимптотическое распределение &#15;2(), где q — число ограничений.
q 
В этом и предыдущем параграфах мы рассматривали случай анализа парной взаимосвязи. В действительности на вероятность наступления того или иного события могут влиять сразу много факторов. 
В этом случае логит-модель оценивается и интерпретируется аналогичным образом с той лишь разницей, что теперь zi зависит не от единственной переменной, а от произвольного их количества: 
11
( i ==()i
PY 1) Fz == ,
−z −(ˆˆ+˙x ()2 +…+ˆ˙x ()k )
1 +ei 1 +e 12 i ki 
()2 ()k
z =˙+˙ ˝x +…+˙ ˝x .
i 12 i ki 
Так как параметры логит-модели оцениваются не методом наименьших квадратов, то стандартный коэффициент R2 в данном случае неприменим. Зато можно использовать для анализа степени соответствия модели данным некоторые специфические именно для моделей бинарного выбора характеристики: 
1. Доля правильно предсказанных исходов. При этом в стандартном случае, если предсказанная вероятность наступления события 
^ 
не меньше 0,5 ((Pyi =°) 05 
1 , ), то предсказанным исходом считается наступление события. Если же соответствующая вероятность меньше половины, то предсказанным исходом считается ненаступление события. Естественно, более предпочтительной является модель, которая лучше предсказывает исходы. 
2. 
Коэффициент корреляции между исходами и предсказанными вероятностями. 

3. 
Коэффициент псевдо-R2, называемый также R-квадрат МакФаддена. Он определяется следующим образом: 


ln()
L
1,
pseudo-R2 =−
ln()0
L 
где ln(L) — логарифм функции правдоподобия в модели, для которой мы вычисляем pseudo-R2; Ln(L0) — логарифм функции правдоподобия в модели, содержащей только константу. 
Подобно обычному коэффициенту R2, этот коэффициент лежит в пределах от нуля до единицы (и равен нулю для модели, включающей только константу). Чем лучше модель соответствует данным, тем ближе к единице он окажется. 
Пример 10.1. Вероятность приема на работу 
Сто кандидатов проходили собеседование о приеме на работу в круп
ную компанию. Известны следующие данные о кандидатах: x — стаж работы кандидата (в годах); gender — бинарная переменная, равная единице для кандидатов
мужчин и равная нулю для кандидатов-женщин; black — бинарная переменная, равная единице для кандидатовафроамериканцев и нулю для всех остальных кандидатов; y — бинарная переменная, равная единице для тех кандидатов, которые были приняты на работу. Результаты оценивания трех моделей на основе доступных данных представлены в табл. 10.3 и 10.4. а . Заполните пропуски в табл. 10.3, вычислив значение коэффициента R-квадрат МакФаддена для всех моделей. б . Для модели 3 проверьте значимость уравнения в целом, используя тест отношения правдоподобия. в . Сравните модель 2 и модель 3, используя тест отношения правдоподобия. г . Для модели 2 интерпретируйте полученный результат, вычислив предельный эффект стажа работы для среднего по выборке работника. 
д . Для модели 2 интерпретируйте полученный результат, вычислив средний предельный эффект стажа работы. 
Таблица 10.3 
Модели вероятности принятия кандидата на работу 
Зависимая переменная: y Метод оценивания: логит-модель  
Модель 1  Модель 2  Модель 3  
X  —  0,49 (0,03)  0,49 (0,15)  
Gender  —  —  0,15 (0,43)  
Black  —  —  –0,32 (0,43)  
Constant  –0,32 (0,20)  −1,02 (0,15)  −0,90 (0,42)  
Логарифм функции правдоподобия  –68,0  −62,0  −61,0  
R-квадрат МакФаддена  

Таблица 10.4 
Стаж работы и результаты отбора кандидатов 
Стаж работника  Количество кандидатов с таким стажем работы  Количество принятых на работу  
0 лет  40  10  
1 год  25  10  
2 года  10  5  
3 года  10  6  
4 года  10  7  
5 лет  5  4  

Решение . а . Для каждой из моделей вычислим pseudo-R2: 
ln()0
L Модель 1: pseudo-R2 =− =.
10
ln()0
L 
62
1 009 
Модель 2: pseudo-R2 =− =,.
68 61
1 =,.
Модель 3: pseudo-R2 =− 010 
68 
б . Для тестирования значимости уравнения в целом нам нужно проверить гипотезу о том, что коэффициенты при всех трех переменных (стаж, пол и раса кандидата) равны нулю. Для этого нам нужно определить значение логарифма функции правдоподобия в модели, в которой нет всех трех этих переменных, т.е. в модели, в которую включена только константа: 
LR =−2(ln LR −ln LUR ) =−− +61 =
2(68 ) 14. 
Критическое значение тестовой статистики Хи-квадрат(3) при уровне значимости 5% равно 7,81. Расчетное значение больше критического, следовательно, гипотеза о равенстве нулю коэффициентов при всех переменных отклоняется. Делаем вывод о том, что уравнение в целом значимо. 
в . LR =−2(ln LR −ln LUR ) =−−62 +61 =
2( )2. 
Критическое значение тестовой статистики Хи-квадрат(2) при уровне значимости 5% равно 5,99. Расчетное значение меньше критического, следовательно, гипотеза о равенстве нулю коэффициентов при добавленных переменных не отвергается. Делаем вывод о том, что добавление переменных не оправдано. Модель 2 является предпочтительной. 
г . Для начала отметим, что коэффициент при анализируемой переменной статистически значим при уровне значимости 5% (0,49/0,03>1,96). Средний по выборке стаж работника составляет: 
°+ °+°+°+°+° 
400251 102103 10455 
x ==14,.
100 
Предельный эффект в этой точке равен: 
^^
−(˙+˙ x) −−(,10204+,9˛,)
dp^ e 12 e 914 
^ 
= ˛˙= ˛ , = ,.
049012 
dx ^^ 2
−(˙+˙ x) (, +, ˛,) 
−−10204914 2 
12
(1+e ) 2 (1+e ) 
Таким образом, для среднего по выборке кандидата один дополнительный год опыта работы увеличивает вероятность оказаться нанятым на работу примерно на 12 процентных пунктов. 
д . Вычисляем предельный эффект для каждого стажа работы, который есть в выборке: 
^^ 
−−102049 )
^ −(˛+˛ x) (, +,90˜
dp e 12 e
^ 
2
^ 
x = 0; dx =(1+e−(˛1+˛^2x))2 ˜˛ =(1+e−−(, +, ˜ )˜0490095, = ,; 
1020490) 2 
^^
−(˛˛+ x) (, + 91˜)
^ −−10204, 9
dp e 12 e
^ 
x= 1; = ˜˛= ˜0490114, ;
^^ 2
˛˛ (,1020491 2 , = 
dx (1+e−(1+ 2x)) 2 (1+e−− +, ˜)) 
^
dp
x= 2; = 0 122, ;
dx 
^
dp
x= 3; = 0 117, ;
dx 
^
dp
x= 4; = 0 099, ;
dx 
^
dp
x= 5; = 0 076, . 
dx 
Вычисляем средний предельный эффект: 
40 ˜0 095 + 25˜0 114 +˜ , +10 ˜0 117 +˜ , + 50 076 
, , 10 0122 , 10 0099 ˜ , = 0,110.
100 
Таким образом, средний предельный эффект стажа работы составляет примерно 10 процентных пунктов. 

10 .4 . Пробит-модель 
Альтернативным способом оценки параметров модели бинарного выбора является пробит-модель. 
Ее отличие от логит-модели состоит в том, что вместо логистической функции для описания вероятности наступления события используется функция стандартного нормального распределения. 
()2 ()k
(1 ()
PY ==) ˙ z =˙ ˆ( +ˆ ˝x +…+ˆ ˝x );
ii 12 i ki 
z =˙+˙ ˝x()2 +…+˙ ˝x()k ,
i 12 i ki 
z
где &#3;()i — функция стандартного нормального распределения. 
Оценивание, тестирование гипотез и интерпретация результатов в рамках пробит-анализа проводятся полностью аналогично случаю логит-анализа с поправкой на использование функции стандартного нормального распределения вместо логистической функции. В частности, предельный эффект изменения переменной x(j) может быть вычислен так: 
˜PY( =1)
i ()2 ()k
= ˛ +˘ˆx +…+˘ ˆx )ˆ˘ =
ˇ˘(
()j 12 i kij
˜x 
()2 ()k
&#23;&#23;+ °x +…+&#23; °x
( 2 k )2 
1 ii
1 − 
= 
e 2 °&#23; ,
j
2˘ где ˛˜()° — производная от функции стандартного нормального распределения, т.е. функция плотности вероятности стандартного нормального распределения. Аналогично тому, что мы обсуждали в § 10.2, на практике этот предельный эффект часто вычисляют в точке средних значений регрессоров. При значениях аргумента, не слишком далеких от нуля, логистическая функция и функция стандартного нормального распределения ведут себя сходным образом, поэтому предельные эффекты, оцененные с использованием логит- и пробит-моделей, оказываются примерно одинаковыми. Это делает выбор между двумя указанными подходами непринципиальным. В случае если результаты их применения все-таки отличаются, можно выбирать модель, характеризующуюся более высоким значением функции правдоподобия и лучшими значениями характеристик качества подгонки модели, которые мы обсудили в § 10.3. 
Пример 10.2. Вероятность сдачи зачета 
На основе пробит-модели бинарного выбора исследователь анализирует вероятность сдать зачет по некоторому курсу. Исследователь собрал данные о 250 студентах, сдававших зачет: 
Pass — бинарная переменная, равная единице, если студент сдал зачет; Lectures — количество посещенных студентом лекций по курсу; Male — фиктивная переменная, равная единице для мужчин и нулю 
для женщин. В таблице ниже представлены результаты оценивания модели. 
Dependent Variable: Pass  
Probit  
0,20  
Lectures  (0,03)  
– 0,50  
Male  (0,02)  
– 0,05  
Lectures×Male  (0,02)  
– 1,00  
Constant  (0,12)  

a . Какие коэффициенты в модели являются значимыми? 
б . Иван и Дарья посетили по 10 лекций, но пропустили зачет и будут сдавать его позже. Используя оцененную модель, вычислите вероятность сдать зачет для каждого из них. 
в . Вычислите предельный эффект посещения лекций для Дарьи. 
Решение . 
а . Для всех коэффициентов отношение оценки коэффициента к стандартной ошибке по модулю больше, чем 1,96. Поэтому все коэффициенты статистически значимо отличаются от нуля при уровне значимости 5%. 
б . Для Ивана: z = 0,2·10 − 0,5·1 − 0,05·10 – 1 = 0; Ф(z) = Ф(0) = 0,5. Вероятность сдать зачет равна 50% (здесь Ф(z) — функция стандартного нормального распределения). 
Для Дарьи: z = 0,2·10 − 0,5·0 − 0,05·0 – 1 = 1; Ф(z) = Ф(1) = 0,84. Вероятность сдать зачет равна 84%. 
22
z 1
1 − 1 − 
в . 
e 2 ˛02, = 
e ˛02 = , ˛ , = , . Одна дополнитель
2 , 024020048 
2˜ 2˜ ная лекция увеличит вероятность получения зачета примерно на 5 процентных пунктов. 
Задания для самостоятельного решения 
Задание 1 . Исследователю доступны данные о 200 посетителях кинотеатра: x — доход посетителя (долларов в месяц), среднее по выборке значение этой переменной составляет 500 долл.; gender — бинарная переменная, равная единице для мужчин и рав
ная нулю для женщин; age — возраст посетителя (в годах); y — бинарная переменная, равная единице для тех посетителей, которые 
купили перед сеансом порцию попкорна, и равная нулю для всех остальных. 
Зависимая переменная: y. Метод оценивания: логит-модель  
Модель 1  Модель 2  Модель 3  
x  —  0,10 (0,01)  0,09 (0,01)  
gender  —  —  0,15 (0,43)  
age  —  —  0,32 (0,43)  
constant  –0,32 (0,20)  −52,0 (0,15)  −46,0 (0,42)  
Логарифм функции правдоподобия  –59,0  −51,0  −50,0  
R-квадрат МакФаддена  

а . Заполните пропуски в таблице, вычислив значение коэффициента R-квадрат МакФаддена для всех моделей. 
б . Сравните модели 2 и 3, используя тест отношения правдоподобия. 
в . Для модели 2 поясните, как изменение дохода влияет на вероятность покупки, вычислив соответствующий предельный эффект для среднего по выборке посетителя (не забудьте проверить, значимо ли это влияние). 
Задание 2 . Исследователя интересует, как вероятность сдать зачет зависит от времени, затраченного на подготовку. Пусть yi — бинарная переменная, которая равна единице, если i-й студент сдал зачет, и равна нулю в противном случае, а xi — количество часов, затраченное на подготовку к зачету i-м студентом. Исследователь располагает данными о 100 студентах: 
1, 
˛˝˙ 
0, 
ïðèi
= 
…
1,2,, 
50; 
y
i 
= 
ïðèi
= 
…
5152,,
, 
100; 
50 50 100 100 x =1000; x2 = 25 000; x = 2000; 2 = 85 000. 
° i ° i ° i ° xi i=1 i=1 i=51 i=51 
а . Сначала исследователь использует линейную модель вероятности, т.е. оценивает регрессию переменной y на переменную x и константу. Вычислите МНК-оценки коэффициентов модели. Вычислите R2. Как меняется вероятность сдать зачет в результате увеличения времени подготовки на один час? 
б . Теперь исследователь, используя те же самые данные, оценил параметры логит-модели. Результаты оценивания представлены в таблице ниже. Как в соответствии с новой моделью меняется вероятность сдать зачет в результате увеличения времени подготовки на один час? (Для ответа на вопрос вычислите соответствующий предельный эффект для индивида со средним по выборке временем подготовки.) 
Модель 1: Логит, использованы наблюдения 1-100 Зависимая переменная: y Стандартные ошибки рассчитаны на основе Гессиана 
Коэффициент Ст. ошибка const –35,1 2,67 x 1,17 0,09 
Задание 3 . В распоряжении банка имеются данные о некотором количестве заемщиков, которым прежде был выдан потребительский кредит на приобретение смартфона (см. файл с данными defolt). 
Про каждого заемщика известен уровень его заработной платы в тысячах рублей в месяц (переменная salary), состоит ли он в браке (переменная married, равная единице для тех, кто состоит в браке, и равная нулю для всех остальных), а также есть ли у него недвижимость в собственности (переменная home — бинарная переменная, которая равна единице в случае наличия недвижимости). Наконец, про каждого из заемщиков известно, вернул ли он долг или нет: за это отвечает переменная defolt, которая равна нулю в первом случае и единице во втором. 
а . Постройте логит-модель вероятности невозврата долга в зависимости от переменных salary, married и home. Какие из указанных переменных являются значимыми при 5%-м уровне? 
б . Оцените модель из пункта (а) заново, исключив незначимые переменные. Используя соответствующие предельные эффекты, интерпретируйте коэффициенты при значимых переменных. 
в . Предположим, банк планирует в дальнейшем выдавать потребительские кредиты только тем заемщикам, для которых вероятность невозврата долга составляет менее 10%. Опираясь на вашу модель, определите, следует ли в этом случае выдать кредит индивиду, у которого нет собственной недвижимости, а заработная плата составляет 57 тыс. руб. в месяц? 
Задание 4 . Выполните предыдущее задание заново, используя теперь вместо логит-модели пробит-модель. Сопоставьте качество прогноза двух этих моделей. 
Задание 5 . Рассмотрим модель бинарного выбора: 
Py( ==1) F (˛+˛x ), 
i 12 i 
где x и y — бинарные переменные. Имеются данные о 50 наблюдениях. 
y = 0  y = 1  
x = 0  10  16  
x = 1  18  6  

Найдите оценки параметров ° 1 и ° 2, используя логит-модель и сформулировав соответствующую оптимизационную задачу. 
Задание 6 . Вопросы этого задания основаны на следующем эксперименте: 600 водителей, выбранных случайным образом, попросили пройти специальный тест на вождение автомобилем. Для каждого водителя были собраны следующие данные: Pass — фиктивная переменная, равная единице, если водитель сдал тест; Male — фиктивная переменная, равная единице, если водитель мужчина, и равная 0, если водитель женщина; Experience — опыт вождения автомобилем (в годах). В таблице ниже представлены результаты двух пробит-моделей, оцененных на основе имеющихся данных. 
Зависимая переменная: pass. Метод оценивания: пробит-модель  
(1)  (2)  
Experience  0,06 (0,01)  0,08 (0,03)  
Male  —  –0,17 (0,02)  
Male × Experience  —  –0,04 (0,01)  
Constant  0,70 (0,12)  0,80 (0,20)  

а . Иван — водитель с 5-летним стажем вождения. На основе каждой из двух моделей оцените вероятность сдачи теста для Ивана. 
б . На основе второй модели вычислите предельный эффект увеличения опыта вождения для Ивана. 
в . Зависит ли от пола то, как опыт влияет на успешность сдачи? Обоснуйте свой ответ. 


ГЛАВА 11 
ОЦЕНКА ЭФФЕКТА ВОЗДЕЙСТВИЯ 
Часто эконометристу требуется оценить последствия реализации некоторой политики (осуществить policy evaluation), например выяснить: 
• 
Как изменится занятость в результате введения закона о минимальной заработной плате? 

• 
Как скажется на уровне инфляции переход к политике инфляционного таргетирования? 

• 
Увеличится ли объем продаж товара благодаря реализации его рекламной кампании? 

• 
Будет ли уменьшение размера класса способствовать увеличению успеваемости школьников? 

• 
Станут ли работники лучше работать, если пройдут курсы повышения квалификации? 


Во всех примерах мы сталкиваемся с необходимостью определения эффекта воздействия (treatment effect) некоторой политики на зависимую переменную. Неважно, идет ли речь о монетарной политике, рекламной политике или о каком-либо другом вмешательстве, последствия которого нам интересны. 
Если в подобной ситуации есть возможность осуществить контролируемый эксперимент, то получение ответа на любой из указанных вопросов с эконометрической точки зрения становится достаточно простой задачей (мы упоминали это в § 1.3), поэтому эконометристы любят использовать эксперименты. Мы обсудим соответствующую методологию вместе со всеми необходимыми определениями в § 11.1. 
Подчеркнем, что в § 11.1 вы встретите не новые эконометрические методы, а скорее новый способ думать о выявлении причинно-следственных связей. 
Так как проведение экспериментов может быть довольно дорогим (а иногда и невозможным) занятием, то на практике для оценки эффектов воздействия часто приходится довольствоваться историческими данными. Для этого разработан ряд специальных методов, которые мы обсудим в § 11.2−11.4. Их общей чертой является попытка преобразовать исторические данные таким образом, чтобы максимально приблизить их к условиям идеального контролируемого эксперимента. 
11 .1 . Оценка эффекта воздействия в идеальном эксперименте 
Начнем с того, что договоримся о терминах. В качестве примера при обсуждении терминологии мы будем использовать гипотетическое исследование, в котором анализируется эффективность лечения. Представим, что мы рассматриваем несколько сотен индивидов, часть из которых подверглась госпитализации и лечению, а часть — нет. И нас интересует причинно-следственная связь между госпитализацией индивида и его уровнем здоровья (будем считать, что мы умеем измерять уровень здоровья численно). 
В общем случае группа объектов, которая подверглась воздействию, называется испытуемой группой (treatment group), а группа, которая ему не подвергалась, — контрольной группой (control group). 
В нашем примере испытуемая группа — это те, кто был госпитализирован, а контрольная — это все остальные. 
Для обозначения принадлежности объекта к той или иной группе будем использовать бинарную переменную Di: 
Di = 1, если i-й объект вошел в группу, подвергшуюся воздействию (treatment group). В нашем примере Di = 1, если i-й индивид был госпитализирован. Уровень здоровья i-го индивида в этом случае будем обозначать Yi(1); 
Di = 0,если i-й объект вошел в контрольную группу (control group), например если индивид не был госпитализирован. Уровень здоровья i-го индивида в этом случае будем обозначать Yi(0). 
Тогда изменение здоровья индивида в результате госпитализации можно определить так: 
Yi(1) – Yi(0). 
Эта величина называется эффектом воздействия (treatment effect, или causal effect) для i-го индивида. В нашем примере treatment effect для некоторого индивида — это величина, на которую изменится уровень его здоровья, если его подвергнуть лечению, по сравнению со случаем, если его не лечить. 
Обратите внимание, что эффект воздействия зависит от индекса i, т.е. может быть разным для различных индивидов. Если это так, то эффект воздействия называется гетерогенным. Подобная гетерогенность эффекта — достаточно естественная предпосылка во многих ситуациях. Например, для болеющего человека уровень здоровья сильно зависит от того, подвергнется он лечению или нет, а для человека с крепким здоровьем госпитализация не будет существенно влиять на самочувствие. 
Если усреднить эффект воздействия по всем индивидам из генеральной совокупности, то мы получим так называемый средний эффект воздействия (average treatment effect, ATE). Приведем примеры ATE: 
• 
На сколько в среднем увеличивается здоровье индивидов в результате их госпитализации? 

• 
На сколько в среднем увеличится успеваемость школьников, если обучать их в маленьком классе вместо класса нормальной величины? 

• 
На сколько в среднем изменится занятость в ресторанах быстрого питания в результате принятия закона о минимальной заработной плате? 


Чтобы подсчитать эффект воздействия, нужно вычислить разность Yi(1) – Yi(0). На практике это невозможно, так как ни для одного объекта мы не наблюдаем одновременно Yi(1) и Yi(0). Мы наблюдаем либо одно, либо другое. Действительно, данный конкретный индивид либо госпитализирован, либо нет. Если индивид госпитализирован, то мы наблюдаем Yi(1). При этом мы не знаем достоверно, что было бы, если бы индивида не лечили, т.е. мы не наблюдаем Yi(0). Два эти значения называются потенциальными исходами (potential outcomes). 
Уровень здоровья, который мы фактически наблюдаем, — это и есть доступное нам в данных значение зависимой переменной для конкретного индивида (в англоязычной литературе его называют observed outcome): 
° 
˝Y ()1 ,˜åñëè D =1;
Y =˛ ii 
iY ()0,˜åñëè D = 0.
˝
˙ ii 
Иногда удобно записывать Yi следующим образом: 
DY 1 ( )). 
Y =Y ()0 +˝(() −Y 0
ii iii 
Путем непосредственной подстановки нашей бинарной переменной легко убедиться, что обе записи эквивалентны. 
Так как мы не можем непосредственно вычислить эффект воздействия для отдельного объекта Yi(1) – Yi(0), то мы не можем вычислить и его математическое ожидание E(Yi(1) – Yi(0)), т.е. ATE. Мы не сможем его вычислить, даже если представить, что нам доступны данные по абсолютно всем объектам из генеральной совокупности. 
Вместо этого мы можем попытаться оценить этот эффект, используя наблюдаемые данные. 
В нашем примере можно попробовать оценить эффект от лечения, сопоставив ожидаемые уровни здоровья тех, кто был госпитализирован, с ожидаемым уровнем здоровья всех остальных. Для этого нужно вычислить такую величину: 
EY(| D =−(| =),
1) EYD 0
ii ii 
где EY(|i Di =1) — ожидаемое значение зависимой переменной для объектов, которые подверглись воздействию; EY(|i Di = 0) — ожидаемое значение зависимой переменной для объектов, которые не подвергались воздействию. 
Чтобы выяснить, как эта разница математических ожиданий соотносится с интересующей нас величиной ATE, осуществим такие преобразования: 
=−EYD (1 =−(0 )
EY(| D 1) (| =0) =EY ()| D 1) EY ()| D =0 = 
iiii iiii 
= EY( ()1 | D =1) − EY( ()0| D =1) + EY( ()0| D =1) − EY( ()0| D = 0) = 
iiii ii ii 
(1 0 =+(0 1(()
=EY () −Y ()| D 1) EY ()| D =) −EY 0| D =0).
iii ii ii
˜˛˛˛˛˛˛˛˛˛°˛˛˛˛˛˛˛˛˛˝ ˜˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛°˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˛˝ 
ATET selectionbias 
Последнее выражение состоит из двух слагаемых: 
• EY( ()1 −Y ()0 | D =1) — это средний эффект воздействия для ин
iii 
дивидов, которые подверглись воздействию (average treatment effect on the treated, ATET); 
• EY( ()0| D =−) EY( ()0| D =0) —1 это выражение называют сме
ii ii 
щением из-за самоотбора (selection bias). Первое слагаемое здесь — ожидаемый уровень здоровья госпитализированных людей (D = 1), если бы они не отправились лечиться (Yi(0)). Второе слагаемое — ожидаемый уровень здоровья людей, которые не пошли лечиться. 
Таким образом, исходная разность математических ожиданий может быть записана так: 
=−EYD 0 +selectionbias.
EY(| D 1) (| =) =ATET
ii ii 
Если в нашем примере про больницы предположить, что люди сами решают, идти им лечиться или нет, то естественно ожидать отрицательного смещения из-за самоотбора, потому что лечиться в этом случае отправятся люди с низким уровнем здоровья (т.е. люди с низкими значениями Yi(0)). Следовательно, разность математических ожиданий не будет равна интересующему нас эффекту воздействия. 
Если же предположить, что индивиды случайным образом распределяются между испытуемой и контрольной группой в ходе контролируемого эксперимента, то наш вывод поменяется. Действительно, в условиях случайного распределения по группам (random assignment) попадание объекта в ту или иную группу не будет зависеть от его характеристик. В терминах математических ожиданий это будет означать, что: 
EY( ()0| D ==) ( ()| D =0
1 EY 0) =EY( ()0). 
iiii i 
В такой ситуации смещение из-за самоотбора отсутствует: 
selectionbiasE Y ()| D = ) − EY( ()| D = 0 = 0.
= (01 0)
ii ii 
Следовательно, разность условных математических ожиданий равна интересующему нас среднему эффекту воздействия: 
(| =−EYD 0
EY D 1) (| =) =ATET .
ii ii 
Поскольку в соответствии с законом больших чисел математические ожидания могут быть состоятельно оценены средними, то состоятельная оценка среднего эффекта воздействия может быть вычислена следующим образом: 
YY = ATET
1 − 0  , 
где Y1 — среднее по выборке значение зависимой переменной для объектов, попавших в испытуемую группу (в нашем примере это средний уровень здоровья для индивидов, подвергшихся госпитализации); 
Y0 — среднее по выборке значение зависимой переменной для объектов, попавших в контрольную группу. 
Еще раз подчеркнем, что состоятельная оценка эффекта воздействия возможна только в условиях, когда смещение из-за самоотбора отсутствует. Контролируемый эксперимент — это ситуация, когда объекты независимо от своих характеристик случайным образом разделяются на две группы (испытуемую и контрольную). Следовательно, контролируемый эксперимент гарантирует отсутствие смещения из-за самоотбора. Это и обеспечивает фундаментальное теоретическое основание для использования экспериментальных данных с целью выявления причинно-следственных связей. 
Оценка эффекта воздействия может быть получена и при помощи обычной парной регрессии. Для этого нужно оценить параметры модели: 
^^^
Y =+˛D .
˝˝
i 12 i 
Вспомнив формулы для обычного МНК, можно доказать (см. соответствующее задание в конце главы), что в этом случае МНК-оценка коэффициента при переменной будет в точности равна оценке интересующего нас среднего эффекта воздействия: 
^
˜= − .
YY (11.1)
210 
Если эксперимент построен корректно, то в обычной парной регрессии объясняющая переменная является экзогенной. Это возможно благодаря случайному распределению объектов по группам (благодаря random assignment). Поэтому обычная парная регрессия дает несмещенную и состоятельную оценку среднего эффекта воздействия. Следовательно, в регрессии не обязательно использовать контрольные переменные. 
Тем не менее есть две причины, по которым их использование всетаки может быть полезно: 
1. 
Увеличение точности оценивания: включение контрольных переменных позволяет лучше описать зависимую переменную, снизить стандартную ошибку регрессии и получить более точные оценки коэффициентов. 

2. 
Проверка качества рандомизации: если эксперимент построен правильно и бинарная переменная D действительно экзогенна, то оценки коэффициента при этой переменной в парной и в множественной регрессии не должны сильно отличаться (так как обе оценки являются состоятельными). 


Пример 11.1. Эксперимент STAR 
В качестве примера использования экспериментальных данных в эконометрике рассмотрим проект STAR (Student / Teacher Achievement Ratio), который был реализован в США в 1980-х гг. Его авторы поставили перед собой цель выяснить, помогает ли обучение в меньших группах достигать больших академических успехов. 
Этот вопрос важен не только с точки зрения образования, но и с экономической точки зрения, так как, чтобы учить школьников в маленьких классах, необходимо больше учителей и, значит, для их оплаты необходимо больше бюджетных денег. Следовательно, нужно собирать больше налогов или отвлекать ресурсы от чего-то другого. Поэтому важно понять, есть ли какая-то существенная польза от уменьшения численности стандартного школьного класса. 
Для того чтобы это выяснить, исследователям пришлось потратить 4 года и порядка 12 млн долл. (и это в ценах 1980-х гг.) для проведения эксперимента. В нем было задействовано несколько тысяч американских школьников. Когда они поступали в начальную школу, их случайным образом распределяли по классам разного типа: некоторые классы имели стандартный размер (22−25 человек), а некоторые — уменьшенный (13−17 человек). 
С деталями исследования вы можете познакомиться в статье Крюгера [Krueger, 1999]. Здесь мы сконцентрируемся на результатах расчетов для второклассников. Они представлены в табл. 11.1. 
Зависимая переменная — результаты стандартизированного письменного теста, который проводился в конце каждого из четырех лет обучения (Stanford Achievement Test). То есть в конце каждого года обучения школьники во всех школах писали единый тест, что обеспечивало сравнимость их академических успехов. 
Переменная интереса — это бинарная переменная, которая равна единице для школьников, попавших в испытуемую группу (treatment group), т.е. для школьников, обучавшихся в маленьком классе (в табл. 11.1 она обозначена как «Маленький класс»). 
В таблице 11.1 вы также можете увидеть прочие переменные, которые были включены в те или иные спецификации модели: 
• 
Класс с дополнительной помощью — бинарная переменная, которая равна единице для школьников, обучавшихся в классе, где были доступны дополнительные консультации сверх обычных занятий. В ходе эксперимента такие классы тоже определялись случайным образом. 

• 
Белая/ азиатская раса — бинарная переменная, равная единице для школьников, относящихся к одной из указанных рас. 

• 
Женщина — бинарная переменная, равная единице для девочек и нулю для мальчиков. 

• 
Право на бесплатный обед — бинарная переменная, равная единице для школьников, которые имели право на бесплатные обеды. Эта переменная является замещающей переменной для дохода семьи, так как такое право получали школьники из малоимущих семей. 

• 
Белый учитель — бинарная переменная, равная единице для школьников, которых обучал учитель указанной расы. 

• 
Учитель-мужчина — это, как нетрудно догадаться, снова бинарная переменная, которая равна единице для школьников, которых обучал учитель-мужчина. 

• 
Опыт учителя и степень магистра — это переменные, характеризующие стаж учителя (в годах) и наличие у него степени магистра. 

• 
Кроме того, в некоторые спецификации включались бинарные переменные принадлежности к определенной школе (в исследовании приняли участие школьники из нескольких десятков школ). 


Судя по результатам оценивания, случайное распределение школьников по классам было осуществлено корректно: попадание в тот или иной класс не коррелировано с прочими контрольными переменными. Такой вывод можно сделать в силу того, что изменения набора контрольных переменных не оказывают существенного влияния на коэффициент при переменной интереса. Во всех спецификациях этот коэффициент приблизительно равен 6. 
Можно видеть, что эффект воздействия от попадания в маленький класс устойчив к выбору спецификации: он статистически значим на 1%-м уровне во всех моделях. Таким образом, можно заключить, что обучение в маленьком классе увеличивает результаты школьника на итоговом тесте примерно на 6 баллов. 
Таблица 11.1 
Моделирование воздействия размера класса на результаты итогового теста 
Объясняющая переменная  (1)  (2)  (3)  (4)  
Маленький класс  5,93 (1,97)  6,33 (1,29)  5,83 (1,23)  5,79 (1,28)  
Класс с дополнительной помощью  1,97 (2,05)  1,88 (1,10)  1,64 (1,07)  1,58 (1,06)  
Белая/ азиатская раса  —  —  6,35 (1,20)  6,36 (1,19)  
Женщина  —  —  3,48 (0,60)  3,45 (0,60)  
Право на бесплатный обед  —  —  −13,61 (0,72)  −13,61 (0,72)  
Белый учитель  —  —  —  0,39 (1,75)  
Учитель-мужчина  —  —  —  1,32 (3,96)  
Опыт учителя  —  —  —  0,10 (0,06)  

Окончание таблицы 11.1 
Объясняющая переменная  (1)  (2)  (3)  (4)  
Степень магистра  —  —  —  −1,06 (1,06)  
Фиксированные эффекты школ  Нет  Да  Да  Да  
R2  0,01  0,22  0,28  0,28  

Примечания. В таблице приведены результаты МНК-оценки модели для второклассников. Зависимая переменная — балл школьника за стандартизированный тест. Во всех моделях, кроме перечисленных переменных, включена константа, которая не приводится для экономии места. В скобках под оценками коэффициентов указаны робастные стандартные ошибки. Число наблюдений равно 5950. 
Источник: [Krueger, 1999]. 

11 .2 . Оценка эффекта воздействия методом разности разностей 
Описание метода разности разностей удобно сразу осуществить на примере конкретного исследования. Для этого мы воспользуемся работой Карда и Крюгера [Card, Kreuger, 1994]. 
В 1992 г. в штате Нью-Джерси, США, минимальный размер оплаты труда был увеличен с 4,25 до 5,05 долл. Экономическая теория подсказывает, что подобное решение должно сказаться на занятости работников с низкой квалификацией (ведь именно их труд часто оплачивается по минимальной ставке). Эту гипотезу решили проверить Кард и Крюгер в своей работе. Они собрали данные о занятости работников в ресторанах быстрого питания. Таким образом, отдельный объект в их выборке — это один ресторан быстрого питания, а зависимая переменная — число работников, занятых в этом ресторане полный рабочий день. 
Таким образом, средний эффект воздействия (average treatment effect), который интересует авторов работы, — это среднее изменение занятости в ресторане быстрого питания в Нью-Джерси в результате принятия нового закона о минимальной заработной плате. 
Как можно было бы подсчитать это изменение? 
Первый, довольно наивный, подход — взять данные по Нью-Джерси до и после изменения минимальной заработной платы и сравнить их между собой. Этот подход плох, потому что занятость с течением времени может изменяться не только в результате изменения заработной платы, но и по каким-то другим причинам. Есть множество глобальных факторов, которые влияют на всю Америку в целом и могли сказаться на занятости. Сравнивая такие средние значения до и после, мы не можем понять, влияет ли на происходящее минимальная зарплата или дело в каких-то других факторах. Например, в США могла начаться рецессия, которая способствовала бы снижению занятости во всех штатах независимо от экономической политики на рынке труда. Или в ресторанном бизнесе могла быть внедрена новая продвинутая технология, которая позволила снизить спрос на труд низкоквалифицированных работников в этой отрасли. 
Второй подход состоит в том, чтобы сравнить занятость в среднем ресторане в Нью-Джерси (т.е. в испытуемой группе) со средней занятостью в каком-нибудь другом штате, где минимальная зарплата не изменилась (т.е. в контрольной группе), например в Пенсильвании, в которой в тот же самый период времени минимальная заработная плата осталась на прежнем уровне. Понятно, что такой подход тоже не совершенен. В отличие от совсем «честного» эксперимента, когда мы случайным образом делим рестораны на две группы, здесь эксперимент не совсем чистый, потому что все рестораны первой группы находятся в одном штате, а рестораны второй группы — в другом. И эти штаты, вполне возможно, хотя они и похожи, отличаются не только минимальной зарплатой, но какими-то еще характеристиками. И поэтому снова невозможно выяснить, объясняются ли различия в занятости в этих двух штатах именно различием в минимальной заработной плате или чем-то еще. 
Вместо каждого из двух указанных подходов можно применить альтернативный метод, который объединяет их преимущества и помогает избежать недостатков. Чтобы понять, как он работает, перечислим основные факторы, которые могут влиять на занятость в типичном ресторане: 
• 
специфические особенности штата, в котором расположен ресторан (эффект штата); 

• 
особенности различных периодов времени, скажем, изменение экономической конъюнктуры (временной эффект); 

• 
эффект изменения минимальной заработной платы (тот самый 


эффект, который мы пытаемся оценить). Формально мы можем записать это так: 
Y =˝+µ+˛ˆD +ˇ,
ist s t ist ist 
где индекс i − номер ресторана; индекс s − штат (Нью-Джерси или Пенсильвания); индекс t — момент времени (период до изменения заработной платы в Нью-Джерси или период после него); 
— число работников, занятых в данном ресторане;
Yist 
переменная D равна единице в ресторанах, которые находились в Нью-Джерси в тот период, когда там поменялась заработная плата, и равна нулю во всех остальных случаях; 
&#23; — эффект штата. Он имеет два значения:  если на
s &#23;control , 
блюдение относится к контрольной группе, т.е. к Пенсильвании; &#23; , если наблюдение относится к испытуемой группе, т.е.
treatment
к Нью-Джерси; µ — временной эффект. Он равен µbefore до изменения заработной
tплаты и µafter после изменения;
 —
 эффект воздействия увеличения заработной платы на занятость. Это тот самый эффект, который требуется оценить; 

—
 случайные ошибки модели.


˝ist
Определим ожидаемое количество занятых в ресторане Нью-Джерси до изменения заработной платы: 
EY(|streatment, = ) =µ += tbefore ˝ .
ist before treatment 
Определим ожидаемое количество занятых в ресторане Нью-Джерси после изменения: 
EY(|streatment, = ) =µ+˝ +˙
= tafter .
ist after treatment 
Вычитая из второго математического ожидания первое, получим ожидаемое изменение занятости в Нью-Джерси: 
˜ =µ −µ +ˆ.
treatment after before 
Теперь определим ожидаемое количество занятых в ресторане Пенсильвании до изменения заработной платы: 
EY(|scontrol, = ) =µ +
= tbefore ˝ .
ist before control 
Определим ожидаемое количество занятых в ресторане Пенсильвании после изменения: 
EY(|scontrol, = ) =µ +
= tafter ˝ .
ist after control 
Аналогично прошлому случаю, вычитая из второго математического ожидания первое, получим ожидаемое изменение занятости в Пенсильвании: 
=µ −µ .
˜control after before 
Осталось вычесть из первой разности (&#16; ) вторую разность
treatment 
( ), т.е. найти ту самую разность разностей, которая дала назва
&#16;control 
ние анализируемому методу: 
˜ −˜ =˝.
treatment control 
Таким образом, мы показали, что интересующий нас эффект воздействия может быть представлен как разность разностей условных математических ожиданий: 
˜=˝ −˝= 
treatment control 
= [( | = , tafter) − (| = , =
EY streatment = EY streatment tbefore)]−
ist ist 
− EY | = , tafter) − (|scontrol, =
[( scontrol = EY = tbefore)].
ist ist 
В силу закона больших чисел состоятельной оценкой каждого из этих математических ожиданий является соответствующее среднее значение. Следовательно, состоятельная оценка эффекта воздействия в данном случае может быть рассчитана так: 
^
˜= [Y −Y ]−[Y −Y ], (11.2)
treatmentafter, treatmentbefore, control, after coontrol, before
 — средний уровень зависимой переменной в контроль
где Ycontrolbefore
,
ной группе до осуществления воздействия (в нашем случае — это средний уровень занятости в ресторанах Пенсильвании до изменения минимальной заработной платы в Нью-Джерси);
 — средний уровень зависимой переменной в контроль-
Ycontrolafter
,
ной группе после осуществления воздействия (в нашем случае — это средний уровень занятости в ресторанах Пенсильвании после изменения минимальной заработной платы в Нью-Джерси);
 — средний уровень зависимой переменной в испытуе-
Ytreatmentbefore
,
мой группе до осуществления воздействия (в нашем случае — это средний уровень занятости в ресторанах Нью-Джерси до изменения минимальной заработной платы);
 — средний уровень зависимой переменной в испыту-
Ytreatmentafter
,
емой группе после осуществления воздействия (в нашем случае — это средний уровень занятости в ресторанах Нью-Джерси после изменения минимальной заработной платы). 
Таблица 11.2 
Оценка воздействия увеличения минимальной заработной платы на занятость методом разности разностей 
Пенсильвания Нью-Джерси Переменная (1) (2) (3) = (2) – (1) 
1. 
Среднее число занятых в одном 23,33 20,44 −2,89 ресторане до изменения мини-(1,35) (0,51) (1,44) мальной зарплаты 

2. 
Среднее число занятых в одном 21,17 21,03 −0,14 ресторане после изменения (0,94) (0,52) (1,07) минимальной зарплаты 


3. Изменение среднего числа −2,16 0,59 2,76 занятых (1,25) (0,54) (1,36) 
Примечание: в скобках под средними значениями указаны соответствующие стандартные ошибки. 
Источник: [Card, Kreuger, 1994]. 
Результаты расчетов эффекта воздействия на реальных данных приведены в табл. 11.2. В соответствии с ней эффект воздействия равен: 
^
˜= [Y −Y ]−[Y −Y ] = 
, treatmentbefore, control after coontrol before,
treatmentafter , 
= [,21 03 − ,]−[,21 17 − 23 33 = 276 
2044 ,] ,. 
На первый взгляд может показаться, что правильный ответ равен 2,75, а в табл. 11.2 и в наших выкладках выписано число 2,76. Это расхождение возникает из-за округлений при промежуточных вычислениях (см. статью Карда и Крюгера). 
Можно заключить, что повышение минимальной заработной платы привело к увеличению равновесного уровня занятости в ресторанах быстрого питания Нью-Джерси в среднем на 2,76 человека. Этот результат противоречит выводам стандартных теоретических моделей из микроэкономики (или экономики труда), поэтому вызвал широкое обсуждение в литературе. Вы можете посмотреть статью Карда и Крюгера, а также цитирующие ее более поздние работы, в которых предпринимаются попытки уточнить и объяснить полученные в ней оценки. 
Нас же этот пример интересует в качестве иллюстрации применения метода разности разностей. Кроме того, описанная здесь история является примером квазиэксперимента, т.е. ситуации, когда распределение объектов на контрольную и испытуемую группу осуществляется не в ходе контролируемого эксперимента, а в силу некоторых внешних обстоятельств, которые при этом позволяют все-таки получить корректную оценку эффекта воздействия. 
Геометрическая интерпретация применения метода разности разностей представлена на рис. 11.1. Пунктирная линия на нем показывает, как менялась бы занятость в Нью-Джерси, если бы этот штат не подвергся воздействию. Подход разности разностей предполагает, что в этом случае динамика занятости была бы аналогична контрольной группе (что в нашем примере означает снижение числа работников). 
уровень занятости 
тренд занятости в штате, 
на который оказано воздействие тренд занятости в контрольном штате 
˜ 
˛ эффект 
° воздействия ˛
˝ 
гипотетический тренд занятости в штате, на который оказано воздействие, для случая, если бы воздействия не случилось 

время до после 
Рис. 11.1. Геометрическая иллюстрация метода разности разностей 
Метод разности разностей непосредственно связан с оценкой моделей при помощи регрессий. В частности, если вы располагаете панельными данными об объектах из испытуемой и контрольной групп за два периода (до и после проведения политики), оценка метода разности разностей может быть получена в результате применения следующей модели: 
Y =˝ +˝˛ x +˝ ˛ z +˙˛ x ˛ z +ˆ , (11.3)
it 01 i 2 t it it 
где xi — бинарная переменная, которая равна единице, если i-й ресторан расположен в Нью-Джерси (т.е. относится к испытуемой группе); 
zt — бинарная переменная, которая равна единице для всех наблюдений, относящихся ко второму периоду (периоду после повышения минимальной зарплаты). 
В этом случае, применив МНК, получим следующее уравнение: 
^^^^ ^
Y =˝ +˝˛ x +˝ ˛ z + ˙˛ x ˛ z .
it 01 i 2 t it 
Можно доказать (см. задание в конце главы), что: 
^
˜=;0 , Ycontrolbefore  
^˜=Y −Y ;1 ,treatmentbefore ,control before  
^˜=Y −Y ;2 ,controlafter ,controlbefore  
^˜= [Ytreatm −Yentafter treatmen ] [− Ytbefore control after  −Y coontrol  ].before 

,, ,, 
Таким образом, коэффициент при произведении xi · zt равен той самой оценке эффекта воздействия, которую мы вывели выше. 
Эквивалентный способ оценивания состоит в применении МНК к следующей парной регрессии: 
˜Y = +˝+xu
˙ˆ , (11.4)
i 2 ii 
где xi — по-прежнему бинарная переменная, которая равна единице, если i-й объект относится к испытуемой группе; ˜Y =Y 1 −Y 0.
ii i
Если применить к этой модели МНК, то оценка коэффициента при регрессоре снова будет задаваться формулой (11.2). 
Для состоятельности этой оценки требуется, чтобы в уравнении 
(11.3) выполнялись все предпосылки модели со стохастическим регрессором (см. гл. 6). В частности, требуется экзогенность объясняющей переменной. Если регрессор оказывается эндогенным из-за пропуска других существенных факторов, влияющих на &#16;Y , то эта проблема может быть, как обычно, решена включением в уравнение (11.3) контрольных переменных. 
Иными словами, метод разности разностей может быть дополнен при помощи учета контрольных переменных, что делает его взаимосвязь с прочими моделями на панельных данных еще более тесной. 
В то же время у метода разности разностей есть важное преимущество по сравнению с ними. Дело в том, что иногда вместо панельных данных вам доступны лишь так называемые повторяющиеся пространственные данные. Это означает, что для разных периодов имеются данные по различным объектам. Скажем, в нашем примере про рестораны быстрого питания это означало бы, что до изменения заработной платы исследователи опросили бы одни рестораны, а после изменения — другие. Тогда непосредственно оценить уравнение (11.3) было бы невозможно, так как нельзя было бы рассчитать разности ˜Y =Y 1 −Y (потому что
ii i0 
по каждому отдельному объекту доступны данные только для одного из двух периодов). Однако интересующий нас эффект воздействия все еще мог бы быть рассчитан при помощи метода разности разностей по формуле (11.2). 
Метод разности разностей широко используется в современных прикладных исследованиях для анализа последствий применения тех или иных мер экономической политики. 

11 .3 . Локальный средний эффект воздействия (LATE) 
В некоторых случаях разделение на группу, подвергшуюся воздействию, и контрольную группу может быть эндогенным. Например, если индивиды сами решают, подвергаться ли им воздействию, то при попытке оценить величину среднего эффекта воздействия мы столкнемся со смещением из-за самоотбора. 
Такая ситуация особенно вероятна, если эффект воздействия является гетерогенным, т.е. существенно отличается для разных индивидов. В этих условиях корректно оценить ATE затруднительно, зато возможно состоятельно оценить так называемый локальный средний эффект воздействия (local average treatment effect, LATE). 
Чтобы пояснить идею работы этого метода, мы будем использовать статью Ангрист [Angrist, 1990], которая посвящена попытке оценить воздействие службы в армии на будущие доходы. 
Простое сравнение средних доходов людей, которые служили и не служили в армии, показывает, что доходы ветеранов устойчиво ниже. Однако эти оценки не вызывают доверия, так как они могут быть смещены из-за эндогенности решения о прохождении службы (возможно, дело в том, что в армию идут менее способные к гражданской работе люди). Подход, который использует Ангрист, позволяет преодолеть эту проблему. 
Ангрист обращается к данным о ветеранах войны во Вьетнаме. В те времена в США использовался призыв на военную службу. Приоритетность призыва зависела от так называемого случайного порядкового номера (Random Sequence Number, RSN). Этот номер присваивался каждому мужчине в результате розыгрыша лотереи. Номер изменялся от 1 до 365, так как был привязан к дате рождения. Министерство обороны каждый год определяло некоторый потолок (пороговое значение) случайного порядкового номера. После этого на службу призывались все мужчины с RSN ниже этого порогового значения. 
Говоря коротко, на службу призывались мужчины, которым выпало пойти в армию в результате некоторой лотереи (в статье этих победителей называют draft-eligible). 
Важно отметить, что статус победителя лотереи вовсе не равен статусу ветерана войны (это две разные переменные): 
• 
с одной стороны, вовсе не все ветераны войны были победителями лотереи, ведь кто-то записывался на службу добровольно; 

• 
с другой стороны, не все победители лотереи стали ветеранами, так как кто-то из победителей избежал службы в силу, например, медицинских ограничений. 


Такая ситуация называется двусторонним несоблюдением (two-sided noncompliance). 
Тем не менее статус победителя лотереи и статус ветерана положительно коррелированы друг с другом: победители лотереи в среднем оказывались в армии с большей вероятностью, чем остальные мужчины. В то же время статус победителя лотереи не коррелирован с прочими характеристиками индивида, которые могут влиять на его доход (так как присваивался случайным образом). Все это указывает на то, что статус победителя лотереи можно было бы использовать в качестве инструмента для переменной, характеризующей ветеранский статус. Мы, однако, не будем сразу пользоваться уже знакомой методологией двухшагового МНК, а начнем с альтернативного взгляда на описанную ситуацию. 
Будем использовать следующие обозначения: 
Yi — значение зависимой переменной (potential outcome). В нашем примере это доход i-го индивида; 
Di — это снова переменная воздействия, которая в отличие от первого параграфа является эндогенной. В нашем примере это бинарная переменная, равная единице, если i-й индивид служил в армии. 
Переменная воздействия зависит от некоторого бинарного инструмента Zi — так называемого внешнего предписания (treatment assignment). В нашем примере это бинарная переменная, равная единице, если i-й индивид выиграл в лотерее: 
° D ()1 ,˜åñëè Z =1;D = D () = ˛˝ ii
Z
i ii 
D ()0,˜˜åñëè Z = 0.
˙
˝ ii 
В общем случае переменная Yi может зависеть и от переменной воздействия, и от предписания: 
°Y (00,,) ˜åñëè D = 0, Z = 0;
i ii
˝
Y ()01,,˜åñëè D = 0, Z =1;
˝ i ii
Y =Y (DZ,) =˛
i iii 
() Z = ;
Y 10,,˜åñëè D =1, 0
˝ i ii 11,,˜åñëè D = , 1.
˝ Y () 1 Z =1
˙ i ii 
Как обычно, для каждого отдельного индивида мы наблюдаем только одно из четырех возможных значений, так как один и тот же человек не мог одновременно служить и не служить или одновременно выиграть в лотерее и не выиграть. 
Сформулируем предпосылки, которые потребуются нам для оценки локального среднего эффекта воздействия (LATE). 
Предпосылка 1 о независимости (Independence) . 
zi не зависит от (Yi(Di(0), 0), Yi(Di(1), 1), Di(0), Di(1)). 
В нашем примере это означает, что результат лотереи не зависит от характеристик индивида. 
Предпосылка 2 об исключающем ограничении (Exclusion restriction) . 
Для любого i верно, что Yi(1, 0) = Yi(1, 1) и Yi(0, 0) = Yi(0, 1). 
Эта предпосылка означает, что инструмент Zi не оказывает непосредственного влияния на зависимую переменную. Он может влиять на нее только опосредованно: через изменение переменной Di. 
В нашем примере это означает, что выигрыш в лотерее сам по себе не влияет на доход1. Он влияет на вероятность попадания в армию. А уже служба в армии, в свою очередь, может влиять на доход. 
С учетом этой предпосылки зависимую переменную можно записать как функцию от единственного фактора Yi(Di): 
Y ()1 ˜Y 10, ) =Y 11 ;
( (),
ii i 
Y ()0 ˜Y (0, 0) =Y (01, ).
ii i 
Предпосылка 3 о первом шаге (First Stage) . 
Для любого i верно, что EDi() − Di 0) ° 0.
(1 () 
Это аналог предпосылки о релевантности инструмента, т.е. о том, что инструмент влияет на переменную воздействия. 
В нашем примере это означает, что выигрыш в лотерею увеличивает для индивида вероятность оказаться в армии. 
Предпосылка 4 о монотонности (Monotonicity) . 
Для любого i верно, что Di ()1 − Di ()0 ° 0. 
Заметим, что вместо Di ()1 − Di ()0 > 0 можно с таким же успехом писать Di ()1 − Di ()0 =1, так как здесь это эквивалентно. Сформулированная предпосылка означает, что разность Di ()1 − Di ()0 может принимать только два значения: 0 или 1. 
1 Напомним, что здесь речь идет не о лотерее с денежным выигрышем, а о лотерее, победители которой получали повестку от министерства обороны. 
Чтобы пояснить эту предпосылку, отметим, что с точки зрения реакции на предписание каждый индивид может быть отнесен к одному из четырех типов: 
1. Complier − если получил предписание, то идет в армию, а если не получил предписание, то не идет в армию. Для такого индивида верно, что Di ()1 −Di ()0 =10 1.
−= 
2. Always-taker − независимо от предписания идет в армию: 
Di ()1 −Di 0 11() =−=0. 
3. Never-taker − независимо от предписания не идет в армию: 
Di ()1 −Di 0 00() =−=0. 
4. Defier − если получил предписание, то не идет в армию, а если не получил предписание, то идет в армию. Для такого странного индивида верно, что Di ()1 −Di 0 =01
() −=−1. 
Ясно, что поведение последнего типа индивидов выглядит нереалистично. Предпосылка о монотонности как раз и предполагает, что таких индивидов не существует. 
Последняя предпосылка важна для того, чтобы понять, что такое локальный средний эффект воздействия (LATE), — это эффект воздействия для индивидов типа Complier (по-русски их можно назвать послушными индивидами, т.е. индивидами, которые строго следуют предписанию): 
LATE = EY( i ()1 −Yi ()0 
Di ()1 − Di ()0 >0). 
Для других групп индивидов оценить ATE невозможно. 
• 
Для индивидов типа Always-taker у нас нет ни одного наблюдения, показывающего, что с ними будет, если они не подвергнутся воздействию. 

• 
Для индивидов типа Never-taker у нас нет ни одного наблюдения, показывающего, что с ними будет, если они подвергнутся воздействию. 


Если эксперимент устроен так, что в группу, подвергшуюся воздействию, могут попасть только те, кто получил предписание (а те, кто его не получил, могут оказаться исключительно в контрольной группе), то такая ситуация называется односторонним несоблюдением (one-sided noncompliance). 
В нашем примере такая ситуация наблюдалась бы, если бы в США законодательно запретили поступать на военную службу тем, кто не выиграл в лотерее (даже в качестве добровольцев). 
В случае одностороннего несоблюдения четвертая предпосылка не потребуется нам для оценки эффекта воздействия. А в случае двустороннего несоблюдения, как мы убедимся далее, она необходима. 

Теорема о LATE Если выполнены предпосылки 1–4, то 
EY(| Z =−) EYZ( =0)
1|
ii ii 
=LATE. 
ED(| Z =−1) EDZ
(| =0)
ii ii 
Для доказательства теоремы рассмотрим сначала два слагаемых в числителе данной дроби: 
EY(|iZ ==â°ñèëó°ïðåäïîñûëêè°2}
i 1){ = (0(10 | ==
=EY() +Y() −Y())˝DZ 1){â°ñèëó°ïðåäïîñûëêè°1} = 
i  i  i  i  i  
= EY( ()0 + Y( ()1 −Y 0 )() ˝ D()1 ). i i i i  
Аналогично:  

EY(|iZ =0 = }
i ){â°ñèëó°ïðåäïîñûëêè°2 = 
= EY() + Y() −Y())˝ DZ = 0 =
(0(10| ){â°ñèëó°ïðåäïîñûëêè°1} = 
i ii ii = EY( ()0 +(Y()1 −Y()0)˝ D()0 ).
i iii 
Следовательно, числитель дроби в формуле для LATE можно записать так: 
EY Z =−1) EYZ|
(| ( =0) = 
ii ii EY( ()0 + (Y()1 −Y()0)˛ D()1 ) − EY( ()0 + (Y()1 −Y()0)˛ D()0) = 
i iii i iii = EY() −Y())(˛ D() −
((10 1 D()0 )).
ii ii 
Преобразуем далее полученное выражение. Для этого воспользуемся свойством математического ожидания: 
EY() −Y())(D() − D 0
((1 0 ° 1 ())) = 
ii ii =EY() −Y())|˛1 D() −D() =˛PD() −D 0
((1 0 1 01)(1 () =1) +
iiii ii +EY() −Y())˛0| D() −D() 0 PD() −D() =) =
((10 10 =˛)(1 00
iiii ii =EY() −Y())| D() −D() =˛PD() −D() =+
((1 0 1 01)( 1 01)0.
iiii ii 
Здесь мы опираемся на предпосылку 4, поэтому не включаем случай Di()1 − Di()0 =−1, ведь в силу этой предпосылки такой случай невозможен. Следовательно, дробь, записанная в формулировке теоремы, может 
быть преобразована так: 
EY(| Z =−) EYZ( =0)
1|
ii ii 
= 
ED(| Z =−1) EDZ
(| =0)
ii ii 
((10 10 =˛)( 1 D() =)
EY() −Y())| D() −D() 1 PD() − 01
iiii ii
== 
PD( i() −i 01)1 D() = 
= EY() −Y())| D() − D() =1 = LATE,
((10 1 0)
ii ii 
что и требовалось доказать. 
Предпосылка 3 необходима, чтобы знаменатель дроби не равнялся нулю. 
Если заменить математические ожидания их выборочными аналогами, то получим оценку LATE: 
YY
−
 10
LATE= ,
D− D
10 
где Y1 — среднее значение зависимой переменной для индивидов, которые получили предписание. В нашем примере это средний доход тех, кто выиграл в лотерею; 
Y — среднее значение зависимой переменной для индивидов, кото
0 
рые не получили предписание. В нашем примере это средний доход тех, кто проиграл в лотерею; 
D1 — доля тех, кто подвергся воздействию, среди тех, кто получил предписание. В нашем примере это доля победителей лотереи, которые пошли служить; 
D0 — доля тех, кто подвергся воздействию, среди тех, кто не получил предписание. В нашем примере это доля проигравших в лотерею, которые при этом все равно пошли служить. 
Мы показали, что: 
( =−(|0 0).
ED| Z 1) EDZ =) =PD( ()1 −D() =1
iiii ii 
Указанная вероятность — это доля послушных индивидов в генеральной совокупности. В свою очередь, величина D1 − D0 — это оценка разности матожиданий: 
ED(| Z =−1) EDZ
(| =0).
ii ii 
Следовательно, величина D1 − D0 является оценкой доли послушных индивидов в нашей выборке. 
Если игнорировать различие между переменной предписания и переменной воздействия, то можно просто оценить влияние предписания на изменение зависимой переменной вот таким образом: 
ITTEYZ(| = ) − EY | Z = 0).
= 1(
ii ii 
Эта величина называется эффектом предписания (intention-to-treat effect, ITT effect). 
Состоятельная оценка этой величины снова может быть вычислена 
 
=
путем замены матожиданий соответствующими средними: ITTY1 −Y0. 
В силу доказанной нами теоремы: 
EY(| Z =−(| =0) ITT
1) EYZ
ii ii
LATE == . 
ED | Z =−E(DZ| =) PD 1 − ()01
( 1) 0 (() Di =)
iiii i 
Так как знаменатель последней дроби лежит между нулем и единицей, то 
LATE &#7; ITT 
. Причем равенство достигается, только если выборка на 100% состоит из послушных индивидов. 
Мы не зря упоминали двухшаговый МНК в начале этого параграфа. Дело в том, что в случае, когда инструментальная переменная и эндогенный регрессор являются бинарными, 2МНК-оценка совпадает с оценкой LATE (доказательству этого факта посвящено одно из заданий в конце главы). 
Таким образом, идеология LATE полезна в том числе тем, что в условиях гетерогенного эффекта воздействия позволяет четко определить, что именно мы оцениваем, используя 2МНК: эффект воздействия политики для индивидов, которые следуют предписанию. 


11 .4 . Разрывный регрессионный дизайн 
В некоторых квазиэкспериментах вероятность того, что объект подвергнется воздействию, является разрывной функцией от наблюдаемой переменной (или группы переменных). В этом случае для оценки эффекта воздействия может быть применен разрывный регрессионный дизайн (regression discontinuity design, RDD). 
Он бывает двух видов: четкий (sharp) и нечеткий (fuzzy). Рассмотрим их последовательно. 
Четкий разрывный дизайн 
Представим, например, что вы хотите оценить влияние обучения индивида в магистратуре университета N на его будущий доход. Скажем, у вас есть результаты вступительных экзаменов в эту магистратуру в 2010 г. для всех абитуриентов, а также данные об их доходах в 2020 г. Доход является зависимой переменной. Для поступления в эту магистратуру нужно сдать вступительный экзамен. Пусть проходной балл в 2010 г. составил 150 баллов из 200 возможных. В этом случае, если абитуриент набрал 150 и более баллов, то он поступает в магистратуру (т.е. оказывается в испытуемой группе), если же он набрал 149 баллов, то не поступает (т.е. оказывается в контрольной группе). 
Такая организация данных возникает и в других случаях, когда назначение воздействия определяется какими-то формальными правилами. Например, в двухпартийной системе кандидат от партии побеждает на выборах, если набирает больше половины голосов, или финансовая помощь может назначаться индивиду, если его доход оказывается ниже некоторого порогового уровня. 
Для определенности мы продолжим концентрироваться на примере с поступлением в университет N. В этом случае испытуемая группа — это выпускники университета N, которые в свое время успешно в него поступили, набрав проходной балл. Контрольная группа — это те абитуриенты, которые в свое время не смогли поступить в университет N. 
Понятно, что простое сравнение средних уровней доходов в испытуемой и контрольной группе не даст нам состоятельной оценки эффекта от обучения в магистратуре. Ведь скорее всего результат вступительного испытания коррелирован со способностями индивида. Тем самым в университет поступили индивиды с более высоким уровнем способностей. А значит, их доход может оказаться выше не из-за того, что они учились в университете N, а из-за того, что они в целом более способные, чем индивиды из контрольной группы. 
Мы могли бы устранить это смещение, сравнивая средние уровни доходов для индивидов, которые набрали ровно 150 баллов (проходной балл), и для индивидов, которые набрали 149 баллов. Судя по результатам вступительного экзамена, уровни способностей таких индивидов очень близки. Можно считать, что разница в 1 балл из 200 определяется исключительно случайными факторами. А значит, сравнение средних уровней доходов в этом случае даст состоятельную оценку эффекта воздействия обучения в магистратуре университета N на будущий доход. 
Проблема последнего подхода состоит в том, что в вашей выборке может оказаться очень мало индивидов, имеющих 149 баллов и 150 баллов. Из-за этого оценка будет иметь низкую точность (высокую дисперсию). 
Разрывный дизайн позволяет преодолеть эту проблему. Чтобы показать, как он работает, воспользуемся следующими обозначениями: 
Di = 1, если i-й объект вошел в группу, подвергшуюся воздействию (treatment group). В нашем примере Di = 1, если i-й индивид учился в магистратуре университета N. Доход i-го индивида в этом случае будем обозначать Yi(1); 
Di = 0, если i-й объект вошел в контрольную группу (control group). В нашем примере Di = 0, если i-й индивид не учился в магистратуре университета N. Доход i-го индивида в этом случае будем обозначать Yi(0). 
Интересующий нас эффект воздействия — это изменение дохода индивида в результате обучения в магистратуре университета N: 
˜=Yi () −Yi 0
1 (). 
Естественно предположить, что ожидаемый доход индивида связан с его баллом за экзамен. Эта связь возникает за счет того, что балл за экзамен является прокси-переменной для способностей индивида. В этом случае доход индивида можно следующим образом записать как функцию от переменных xi и Di: 
Y =+x +˙D +ˆ;
˛˝
i iii 
˝ˆ˙ 
*
0,˜˜ïðè˜x
<
;
x
i
D
i 
= 
*
1,˜˜ïðè˜x
˛
ˆˇ
x 
,
i 
где x* — пороговый уровень, преодоление которого определяет попадание в испытуемую группу. В нашем примере — это проходной балл, равный 150. Переменную x в разрывном дизайне называют переменной отбора (selection variable1). 
Отличие от стандартного случая использования контрольной переменной, который мы обсуждали в предыдущих главах, здесь состоит в том, что переменная интереса D не просто коррелирована с другим регрессором x, а является неслучайной (детерминированной) функцией от него. Поэтому для состоятельности МНК-оценок достаточно потребовать экзогенности переменной отбора. Тогда переменная D автоматически тоже будет экзогенной. 
1 Иногда в литературе используются также термины running variable и forcing variable. 
В условиях этой предпосылки для индивида из контрольной группы условное математическое ожидание зависимой переменной равно: 
EY( ()| x ) =+x .
0 ˛˝
ii i 
А для индивида из испытуемой группы оно составляет: 
EY( ()|x ) =+x ˙.
1 ˛˝+
ii i 
Графически описанная ситуация проиллюстрирована на рис. 11.2. Коэффициент равен величине разрыва функции ожидаемого дохода в точке x*. 
Таким образом, чтобы выяснить эффект воздействия, достаточно 
^
оценить полученное уравнение регрессии. МНК-оценка  и будет состоятельной оценкой эффекта воздействия. 

Рис. 11.2. Пример модели с разрывным дизайном; линейный случай Влияние переменной отбора на зависимую переменную может быть нелинейным: Y =+f () +˝D (11.5)
˛ x +˙,
i iii 
˝ˆ˙ 
*
0,˜˜ïðè˜x
<
;
x
i
D
i 
=
(11.6)
*
1,˜˜ïðè˜x
˛
ˆˇ
x 
.
i 
В качестве функции f(xi) обычно используют полином, например, для квадратичной функции f(xi): 
2
Y =+ x +˝x +˙D
˛˝ +ˆ.
i 1 i 2 i ii 
Соответствующий пример изображен на рис. 11.3. 
При необходимости спецификация (11.5) может быть дополнена путем включения в уравнение контрольных переменных. 
Если эффект воздействия является гетерогенным, т.е. различным для разных индивидов, то разрывный дизайн корректно оценивает этот эффект не для любых индивидов, а только для тех, у кого значение переменной отбора близко к пороговому уровню. 

x 
Рис. 11.3. Пример модели с разрывным дизайном; нелинейный случай 

Нечеткий разрывный дизайн 
При нечетком разрывном дизайне вместо условия (11.6) выполняется следующая предпосылка: 
*
˝gx(),˜˜ïðè˜x < x ,
ˆ 0 ii **
PD =1x ˙ ãäå˜˜gx() ˘ (11.7)
( |) = gx().
ii *01
ˆ gx(),˜˜ïðè˜x ˛ x ,
ˇ 1 ii 
Таким образом, при нечетком разрывном дизайне преодоление порога влияет на вероятность попадания в испытуемую группу, однако не гарантирует это попадание. 
В нашем примере с поступлением такая ситуация могла бы возникнуть, если бы некоторые из абитуриентов, набравшие проходной балл, после этого по каким-то причинам не стали бы учиться в магистратуре университета N. И наоборот, какие-то из абитуриентов, не набравшие проходной балл, все-таки смогли бы пройти обучение (скажем, не на бюджетной основе, а на платной). 
В этом случае переменная D в уравнении Y =+f () +˝D
˛ x +˙
i iii
больше не является экзогенной, так как зависит не только от преодоления порога, но и от решения индивида. Следовательно, обычный МНК не позволит получить состоятельную оценку коэффициента  в уравнении (11.5). 
Поэтому в условиях нечеткого разрывного дизайна для оценки эффекта воздействия лучше применить 2МНК, используя в качестве инструмента переменную T: 
˝ˆ˙ ˆˇ
1, 
0, ˜ïðè xi
<
* 
x 
,
T
i 
= 
˜˜ïðè˜x
i
˛
* 
x 
. 
В силу того, что вероятность попадания в контрольную группу зависит от того, превышает ли переменная отбора порог или нет, такой инструмент будет релевантным. В то же время он является экзогенным, так как определяется исключительно экзогенной переменной отбора. 
Пример 11.2. Партия власти и результаты выборов 
В заключение этого параграфа рассмотрим пример применения метода разрывного регрессионного дизайна для модели бинарного выбора (таким образом, этот пример опирается не только на текущую главу, но и на гл. 10). 
Мы обратимся к статье Ли [Lee, 2008], автор которой задался вопросом, существует ли у партии власти дополнительное преимущество на выборах (Incumbency advantage)? 
Точнее говоря, Ли пытается выяснить, имеет ли преимущество кандидат на место в палате представителей США на текущих выборах, если его партия выиграла предыдущие выборы? 
В поиске ответа на этот вопрос есть очевидная трудность: вполне возможно, что лица, занимающие должность, хорошо соответствуют предпочтениям избирателей, имеют большую поддержку и выигрывают благодаря этому, а вовсе не благодаря «административному ресурсу». 
Чтобы отделить один эффект от другого, Ли при помощи идеологии четкого разрывного дизайна анализирует вероятность быть избранным как функцию от соотношения голосов за партии демократов и республиканцев на предыдущих выборах. 
Он использует тот факт, что победитель на выборах может быть определен следующим образом: 
D =1,˜åñëè˜x ° 0 ˜è˜˜D = 0, åñëè˜x < 0,
it, it, it, it, 
где xi,t — разность между долями голосов, отданных за демократов и за республиканцев (Democratic vote share margin of victory). Если эта разность больше нуля, значит, демократы получили на выборах больше голосов, чем республиканцы, и, следовательно, выиграли их1; 
Di,t — переменная, равная единице, если на выборах победил кандидат от демократов. Индекс i соответствует избирательному округу, а индекс t — номеру года. 
Ли оценивает параметры следующей логит-модели бинарного выбора: 
( == ˛˝ ), (11.8)
PD 1) F ( +x +˙D
it, +1 it, it, 
где PD( it =1) — вероятность победы демократической партии на вы
, +1
борах в периоде t + 1; F(·) — логистическая функция. (В некоторых спецификациях автор добавляет также контрольные переменные, которые могут влиять на вероятность победы, например опыт кандидата.) 
Результаты оценивания модели графически представлены на рис. 
11.4. По мере роста доли голосов, которую демократы получили на предыдущих выборах, увеличивается вероятность их победы на следующих выборах. Это увеличение логично и могло бы объясняться ростом популярности демократов на территории соответствующего избирательного округа, если бы не значительный разрыв в точке xi,t = 0 (соответствующей ровно половине голосов, отданных избирателями демократам). Мы видим, что, набрав немного менее 50% голосов на предыдущих выборах, демократы имеют шансы на победу лишь около 15% (см. левый график). Однако если число голосов на прошлых выборах оказывается хоть немного больше 50%, то вероятность победы демократов в текущей избирательной кампании резко растет сразу до 60%. 
Величина этого разрыва соответствует оценке коэффициента и характеризует эффект воздействия нахождения партии у власти в момент избирательной кампании на вероятность победить на выборах. Как можно видеть из рис. 11.4, партия власти получает примерно 45%-й «бонус» к вероятности победы. 
1 Разумеется, такую методологию можно применить только в том случае, когда на победу на выборах претендуют только две партии. В случае с США — это партии демократов и республиканцев. 
Все это позволяет автору статьи заключить, что партия власти получает существенное преимущество на выборах (независимо от текущих предпочтений избирателей). 

-0.25 -0.20 -0.15 -0.10 -0.05 0.00 0.05 0.10 0.15 0.20 0.25 Democratic Vote Share Margin of Victory, Election t 
Рис. 11.4. Зависимость вероятности победы демократов на выборах в период t+1 в зависимости от доли голосов, набранных в период t 
Примечание. Democratic vote share margin of victory, Election t — разность между долями голосов, отданных за демократов и за республиканцев на выборах в период t. Следовательно, положительные значения этой переменной соответствуют победе демократов, а отрицательные — победе республиканцев. 
Источник: [Lee, 2008]. 
Важным свидетельством корректности выводов автора являются результаты так называемого теста плацебо (placebo test). Такое название в литературе об эффектах воздействия носит не какая-то конкретная статистическая процедура, а общий подход к проверке надежности результатов, который устроен так: необходимо проанализировать спецификацию модели, которая похожа на вашу базовую спецификацию, но в которой точно не должно возникать значимого эффекта воздействия. Если его там действительно не возникает, это говорит в пользу корректности выводов базовой модели. 
В случае с работой Ли [Lee, 2008] подобный тест состоит в том, чтобы оценить параметры следующей модели: 
( ==˝ ˝ ).
PD 1) F ( +D +˝x (11.9)
i,t −1 01 i,t 2 it, 
В отличие от базовой модели (11.8) в левой части уравнения стоит вероятность победы не на следующих выборах, а на предыдущих (t – 1). 
Ясно, что затруднительно использовать нахождение у власти сегодня для того, чтобы выиграть выборы несколько лет назад. Следовательно, в этом случае коэффициент при переменной D должен быть статистиче
i,t
ски незначимым, и на соответствующем графике не должно возникать разрыва. Как видно на рис. 11.5, разрыва в графике вероятности победы на выборах действительно нет. Это означает, что модель Ли успешно проходит тест плацебо. 
Подчеркнем, что этот тест может применяться не только в рамках разрывного дизайна. Он может быть полезен при проверке корректности выводов модели, оцененной любым из методов. 

-0.25 -0.20 -0.15 -0.10 -0.05 0.00 0.05 0.10 0.15 0.20 0.25 Democratic Vote Share Margin of Victory, Election t 
Рис. 11.5. Результаты теста плацебо Источник: [Lee, 2008]. 
Задания для самостоятельного решения 
Задание 1 . Докажите равенство (11.1), выведя формулы МНК-оце
^ ^^
нок обоих коэффициентов в уравнении Y = +˛D где D — бинар
˝˝ ,
i 12 ii ная переменная. Задание 2 . Пусть в условиях предыдущей задачи &#23; — доля наблюдений, относящихся к испытуемой группе, а (1 −°) — это соответственно доля наблюдений, относящихся к контрольной группе. Считая, что дисперсия случайной ошибки одинакова для всех наблюдений и равна ˘2, вычислите условную дисперсию МНК-оценки коэффициента при ^2
DD … ,, n). Какой
переменной var(˜ |, ,, D ) (выразите ее через ˜°
212 n 
должна быть доля наблюдений, относящихся к испытуемой группе, в общем числе наблюдений, чтобы МНК-оценка была наиболее точной? 
Задание 3 . Докажите, что в модели (11.3) МНК-оценка коэффициента при произведении xi · zt равна: 
^
˜= [Y −Y ]−[Y −Y ].
, treatmentbefore, control after coontrol before,
treatmentafter , 
Задание 4 . Докажите, что в модели (11.4) МНК-оценка коэффициента при регрессоре равна: 
^
˜= [Y −Y ]−[Y −Y ].
, treatmentbefore, control after coontrol before,
treatmentafter , 
Задание 5 . В 2013 г. ни в одном из регионов королевства Вестерос не была установлена минимальная заработная плата. В 2014 г. в четырех регионах королевства (Винтерфелле, Хайгардене, Риверране и Пайке) был принят закон о минимальной заработной плате, в то время как в остальных регионах никаких ограничений по поводу уровня зарплаты по-прежнему не устанавливалось. 
Экономическая теория утверждает, что установление минимальной заработной платы может приводить к росту безработицы, однако исследователи отмечают, что средний уровень безработицы для регионов, применивших закон о минимальной зарплате, в 2014 г. по сравнению с 2013 г. сократился. Для простоты расчетов предположим, что численность экономически активного населения во всех рассматриваемых регионах одинакова. Динамика безработицы в регионах Вестероса приведена в таблице. 
Регион  Уровень безработицы, %  
2013  2014  
Винтерфелл  10  8  
Хайгарден  10  8  
Риверран  9  9  
Пайк  11  7  
Королевская гавань  11  7  
Дорн  12  7  
Орлиное гнездо  13  7  
Старомест  13  8  
Ланниспорт  11  9  

а . Действительно ли введение минимальной заработной платы является причиной для роста безработицы? Для ответа на этот вопрос оцените эффект от введения минимальной заработной платы, используя доступные данные и метод разности разностей. Интерпретируйте полученный результат. Дайте графическую иллюстрацию решения. 
б . Найдите МНК-оценки параметров уравнения регрессии: 
Y =˝ +˝˛ x +˝ ˛ z +˙˛ x ˛ z +ˆ ,
it 01 i 2 t it it 
где Yit — уровень безработицы в регионе i в году t; 
xi — бинарная переменная, которая равна единице для регионов, которые ввели минимальную зарплату; 
zt — бинарная переменная, которая равна единице для всех наблюдений, относящихся ко второму периоду (2014 г.). 
Сопоставьте полученные результаты с результатами пункта (а). 
в . Пусть известны также робастные стандартные ошибки оценок коэффициентов: 
^ ^^^
˜ 040 ˜ 0 53 se() °= 0 93.
se() = ,;se() = ,; ˜= 061,;se() ,
012 
Используя 5%-й уровень значимости, проверьте значимость коэффициентов при переменных и дайте содержательную интерпретацию полученных результатов. 
Задание 6 . Исследователь анализирует воздействие закона, запрещающего продажу алкоголя после 23.00, на потребление алкоголя. Исследователь обладает информацией о подушевом потреблении алкоголя в восьми регионах в 2014 и 2015 гг. В 2014 г. во всех регионах алкоголь продавался без ограничений. В 2015 г. в регионах A, B, C, D был введен указанный закон, а в остальных регионах он не применялся. Данные о потреблении алкоголя (литров на человека в год) приведены в таблице. 
Регион  A  B  C  D  E  F  G  H  
2014  6  6  8  4  4  3  3  2  
2015  6  8  9  5  6  5  5  4  

а . Исследователь использует для оценки интересующего его влияния модель с фиксированными эффектами: y =°˝x +˙+ˆ, где &#23;i — фик
it it iit 
сированный эффект i-го региона; xit — фиктивная переменная, равная единице, если в i-м регионе в году t действовал закон об ограничении продажи алкоголя, и равная нулю в противном случае; yit — потребление алкоголя на душу населения в i-м регионе в году t. Используя внутригрупповое преобразование, найдите оценку параметра ° и интерпретируйте полученный результат. 
б . Теперь оцените эффект воздействия закона об ограничении продаж алкоголя, используя метод разности разностей. Интерпретируйте полученный результат. Дайте графическую иллюстрацию решения (не забудьте указать на рисунке координаты всех ключевых точек, а также величину эффекта воздействия). 
в . Чем может быть вызвано подобное расхождение оценок? 
Задание 7 . В этом задании вам предлагается реплицировать некоторые выводы работы Шеридана и Болла [Sheridan, Ball, 2005] на более свежих данных. Рекомендуем вам прочитать ее, прежде чем переходить к расчетам. 
Исходный файл с данными: Inflation_Targeting.xlsx. Обратите внимание, что там есть два отдельных листа (для развитых стран и для развивающихся). 
а . Сопоставьте средние уровни инфляции в таргетирующих ее странах до и после инфляционного таргетирования. Можно ли на основе этого результата сделать вывод о воздействии инфляционного таргетирования на уровень инфляции? 
б . Теперь примените метод разности разностей, оценив параметры уравнения (1) из статьи Шеридана и Болла [Sheridan, Ball, 2005, pp. 249–276]. Осуществите оценку для трех выборок: 
• 
полная выборка стран; 

• 
развитые страны; 

• 
развивающиеся страны. 


Интерпретируйте результаты, объясните, что можно сказать о воздействии перехода к инфляционному таргетированию на уровень инфляции в долгосрочной перспективе, опираясь на полученные оценки параметров? 
Задание 8 . Докажите, что оценка эффекта воздействия при помощи LATE эквивалентна 2МНК-оценке в случае использования бинарной объясняющей переменной и бинарной инструментальной переменной. 
Задание 91 . В 1979−1980 гг. в одном из штатов США проводился следующий эксперимент: участки в поликлиниках были случайным образом разделены на две группы. Пациенты из первой группы заранее получили письмо с напоминанием прийти в поликлинику к участковому 
1 По мотивам статьи Hirano K., Imbens G. W., Rubin D. B., Zhou X. (2000). Assessing the Effect of an Influenza Vaccine in an Encouragement Design. Biostatistics. No. 1(1). Pp. 69−88. 
врачу и сделать прививку от гриппа, а из второй группы не получили такого письма. 
На основе представленных в таблице данных рассчитайте оценку локального среднего эффекта воздействия (LATE) прививки от гриппа на заболеваемость. 
Группа людей, получивших письмо-напоминание  Группа людей, не получивших письмо-напоминание  
Доля сделавших прививку  0,31  0,19  
Доля госпитализированных зимой 1979/80 г. с респираторными заболеваниями  0,08  0,09  

Задание 10 . Анализируется воздействие вакцинации против гриппа на заболеваемость этим вирусом. Для оценки эффекта была проведена следующая процедура: случайным образом была определена группа участковых врачей, которым отправили напоминание о важности вакцинации против гриппа и необходимости ее провести. Остальные врачи не получали напоминание. После этого часть врачей на своем участке провели вакцинацию, а часть — нет. 
В массиве Vaccination доступны следующие данные о пяти сотнях участков: 
Z — бинарная переменная, равная единице для участков, где врачи получили напоминание о важности вакцинации; 
Vaccination — бинарная переменная, равная единице на тех участках, где в результате была проведена вакцинация; 
Disease — количество случаев заболеваний гриппом в последующий год (на 100 человек). 
Используя массив данных Vaccination, оцените ITT-эффект от вакцинации, а также вычислите оценку соответствующего локального среднего эффекта воздействия (LATE). Тестируйте значимость этого эффекта и дайте содержательную интерпретацию полученного результата. 
Задание 11 . Рассмотрим модель 
y =°˝x +˙°w +ˆ,
i i iii 
где yi — производительность труда i-го работника; xi — стаж работы i-го работника, E(xi) > 0, 0 < var(xi) < ∞; wi — бинарная переменная, равная единице, если i-й работник посетил курсы повышения квалификации, и равная нулю в противном случае; &#23;i — изменение производительности труда i-го работника в результате посещения им курсов повышения квалификации (т.е. эффект воздействия курсов повышения квалификации). Обратите внимание, что этот эффект различен для разных работников (является гетерогенным); ошибки ˝i — независимые и одинаково распределенные случайные величины, E(|˜ x ° w )
,, = 0.
i iii
Исследователя интересует средний эффект воздействия курсов повышения квалификации: µ= E° i . В качестве этого эффекта он использует МНК-оценку коэффициента при переменной w в регрессии: 
^^
^ 
y =°x +°˙w .
˝
i ii 
Обратите внимание, что исследователь игнорирует гетерогенность, мотивируя это тем, что его интересует только средний эффект воздействия. 
а . Предположим, что в действительности эффект от посещения курсов повышения квалификации зависит от опыта работника: ˜=˝° ,
i xi
где ˜>0. Будет ли оценка, полученная исследователем, состоятельной? Если нет, то можете ли вы определить направление ее асимптотического смещения (т.е. указать, будет ли она завышенной или заниженной)? 
б . Ответьте на вопросы предыдущего пункта, если теперь известно, что xi и wi независимы. 



ЗАКЛЮЧЕНИЕ: ЧТО ДАЛЬШЕ? 
Надеюсь, вам было интересно. Если первое знакомство с эконометрическими методами оставило у вас желание погрузиться в дальнейшие детали, то вот несколько идей, куда можно двигаться после этой книги. 
Проблема эндогенности из-за двусторонней причинно-следственной связи в некоторых случаях может быть решена не только при помощи подхода, описанного в гл. 8, но и при помощи специальных методов оценивания систем одновременных уравнений, включая, например, структурные векторные авторегрессионные модели (SVAR). 
В качестве продолжения гл. 9 можно разобраться с динамическими моделями на панельных данных. Динамическими называются модели, где в правой части уравнения стоит прошлое значение зависимой переменной (см. задание 8 из гл. 9). Для таких моделей изученные нами методы работы с панельными данными не вполне применимы, поэтому придется освоить специальные процедуры, опирающиеся на обобщенный метод моментов (который, впрочем, полезен не только для работы с динамическими панелями, но и во многих других ситуациях). 
Естественным продолжением гл. 10 являются дискретные модели множественного выбора, т.е. модели, где исследуется выбор не из двух вариантов (как это было в гл. 10), а из большего их количества. Например, эти модели пригодятся, если вы хотите выяснить, какие факторы определяют, как абонент выбирает между тремя крупными сотовыми операторами. Другой важный класс моделей, опирающихся на метод максимального правдоподобия, — это модели с урезанными и цензурированными выборками (например, Тобит-модель или модель Хекмана). 
Глава 11 может быть дополнена анализом непараметрических методов оценивания эффектов воздействия, т.е. методов, которые не предполагают явной спецификации уравнения для зависимой переменной, например методы сопоставления и сопоставления по мере склонности (matching and propensity score matching) или методы, находящиеся на стыке машинного обучения и эконометрики причинно-следственных связей (скажем, causal trees). Хороший обзор таких методов содержится в работе С. Ати, Г. В. Имбенс [Athey, Imbens, 2017]. 
Наконец, отдельный большой раздел эконометрики — модели временных рядов (time series). Если вы хотите прогнозировать будущие значения каких-то переменных (например, инфляции или валютного курса) или выявлять динамические причинно-следственные связи (влияет ли увеличение рекламных расходов на объем продаж?), то вам пригодится именно он. 
Возможно, какие-то из указанных методов и моделей найдут свое место в будущих изданиях этой книги, а пока для знакомства с ними я рекомендую вам обратиться к замечательным учебникам, упомянутым в списке литературы в конце работы (см., напр., [Магнус, Катышев, Пересецкий, 2007; Носко, 2011; Айвазян, Фантаццини, 2014; Кэмерон, Триведи, 2015; Хайяши, 2017]). 

РЕШЕНИЯ К ЗАДАНИЯМ 
В этом разделе собраны решения к расчетным и теоретическим заданиям, которые предложены в конце каждой из глав учебника. Некоторые задания разобраны подробно, для некоторых предлагаются лишь краткие решения и ответы, однако в целом здесь рассмотрены все задачи каждой из глав. 
К ГЛАВЕ 1 
Задание 1 . «Вредное» лечение 
а . Скорее всего, такой результат получен из-за того, что в больницу обращались только люди с изначально более скверным здоровьем. Если бы они не пошли лечиться, то их здоровье в 2013 г. было бы еще хуже, чем в результате лечения. Однако даже с учетом этого лечения их показатели уступают показателям полностью здоровых людей, которые в больницу не обращались. В тексте главы такая проблема называлась проблемой смещения из-за самоотбора. 
б . Можно было бы случайным образом определять, кто будет госпитализирован, а кто — нет. При этом при проведении такого случайного распределения первоначальный уровень здоровья игнорировался бы (т.е. часть больных людей получили бы отказ в лечении, а часть здоровых были бы госпитализированы принудительно). Следовательно, проблема, описанная в пункте (а), была бы решена. 
Трудность проведения такого эксперимента состоит в том, что не лечить больных людей ради статистического эксперимента не вполне этично. 
Задание 2 . Горная болезнь 
Первый вариант привел бы к проблеме смещения из-за самоотбора: лекарство, скорее всего, стали бы принимать только восприимчивые к горной болезни альпинисты. 
Второй вариант связан с проблемой смещения из-за пропуска существенных факторов: вполне возможно, что организмы мужчин и женщин в силу физиологических особенностей по-разному реагируют на высоту и на новое лекарство. 
Третий вариант лишен обоих указанных выше недостатков, поэтому является предпочтительным. 
К ГЛАВЕ 2 
Задание 1 . Расчетный пример 
а . Организуем промежуточные вычисления в виде такой таблицы: 
Сумма Среднее 
y  x  x2  x · y  
16  12  144  192  
9  9  81  81  
7  6  36  42  
5  3  9  15  
3  0  0  0  
40  30  270  330  
8  6  54  66  

Теперь можно посчитать МНК-оценки: 
xy −˝xy 66 −˝68 18
^
˜= ===1;2 x2 −x 2 54 −62 18 
^^
˜ y ˜x 8162=.
=− ˝=−˝ 
12 ^
Таким образом, оцененная линия регрессии: y =+˛x .
21
ii 
б . Для вычисления суммы квадратов остатков удобно дополнить 
^
нашу таблицу еще несколькими столбцами. В этой таблице y вычисля
i
ется по формуле, которую мы нашли в пункте (а), а остатки регрессии вычисляются по определению: e = y − y ^.
iii 
y  x  x2  x · y  y ^  e  e2  
16  12  144  192  14  2  4  
9  9  81  81  11  -2  4  
7  6  36  42  8  -1  1  
5  3  9  15  5  0  0  
3  0  0  0  2  1  1  
40  30  270  330  40  0  10  
8  6  54  66  8  0  2  

Сумма 
Среднее 
Таким образом, сумма квадратов остатков равна 10. Напомним, что 
^
сумму предсказанных значений зависимой переменной yi и сумму остатков (без квадратов) вычислять для решения задания было вовсе не обязательно. Мы сделали это для проверки. Если все вычисления вер
^
ны, то в нашей регрессии сумма ˛ yi должна совпадать с суммой ˛ yi, а сумма остатков всегда должна быть равна нулю. В нашем случае так и вышло. 
Один из способов вычисления коэффициента детерминации R2 показан в примере 2.2 в гл. 2. Мы же воспользуемся тем фактом, что для парной регрессии коэффициент детерминации равен квадрату выборочного коэффициента корреляции между регрессором и объясняемой переменной. Доказательство этого факта представлено в решении задания 2 к данной главе: 
2
(xy−˛xy)
2 2( 182 
R =corr xy,) =(x −x )˛(y −y )= =09,. 
22 2218˛(84 −64) 
в . 
2
2 
52
S £e /( − ) 
10/3 
1
^ 
i
se() = = === 0 192, .
˜
2 
£(xi− x)2 nx( 2 − x2 ) 518ˆ 27 
Расчетное значение тестовой статистики равно: 
^
˜ 1
2 
= ,.
= 
5 196 
^
˜ 1
se()
2 27 
Критическое значение тестовой статистики при уровне значимости 5% и трех степенях свободы составляет 3,182. Расчетное значение больше критического. Следовательно, мы отвергаем нулевую гипотезу и делаем вывод о том, что коэффициент является статистически значимым. 
г . Построим интервал для коэффициента ° 2: 
^^ ^^
( − ˜˛t , ˜+ ˜˛t )
˜ se() se() 
22 n−22 2 n−2 
( − , ° ,, + , ° ,)10192 3182 10192 3182 
(,, ,)0 388 1 612 
Ответы: а . y ^ =+˛x. б . £e2 =10
21 , R2 = 0,9. в . Коэффициент стати
i ii
стически значим. г . (0,388, 1,612). 
Задание 2 . R-квадрат и корреляция 
var(

var(

^
˛
2 
x
var var()y 
 
2 
var 
2var 
 
^^^ 
) 
= 
) 
()x
1 
+˛˛
x
()y 
^
˛
2
R
2 
= 
= 
= 
= 
var()y

var()y

()y 
2
2
°
˙
˜
cov 
˜
cov 
°
°
˙
(,xy) (,xy) 
2
()x 
˜
corr var
˝ ˝˛ 
ˇ ˇˆ 
(,.)
˝˝˛ 
ˇˇˆ 
=
=
=
xy
° 
° 

°°
()x ()y ()x
˘
()yvar var var 
v
var 
Примечания: в процессе вычислений используются свойства выборочной дисперсии и выборочной ковариации, которые мы вспоминали в параграфе 2.1. 
Задание 3 . Преобразования переменных 
^^^
а . В этом случае мы вместо регрессии yi=+ xi˛˛ будем оценивать
12 ^ ^^
параметры новой модели: y=1 +2 z, где z= x+ c˛˛ . Отметим, что в
i iii этом случае zxc.
=+ 
Выясним, как соотносятся оценки коэффициентов в новой модели с оценками коэффициентов в старой модели: 
˜˜ ˜
cov(,zy)( + , ) cov xy
cov xcy (, ) 
^^
˜== = ==˝2;
2 
°° ° 
() var( + ) var()
var z xc x 
^ ^ ^^^^^
˜ yz˜ y (xc) °=yx° c°°
=−˙ =− +˙ −˙−˙ =−˙c°.
1 2 2 2212 
Чтобы выяснить, что произойдет с R2, воспользуемся формулой, которую мы доказали в предыдущей задаче: 
˜2 ˜2 ˜2(
2 cov (zy) cov (xcy xy
, +,) cov ,)
R == = .
°°° °°° 
var() () xc)
z°var y var( +°var()y var()x°var()y 
Таким образом, R2 для новой модели совпадает с R2 для исходной модели. 
^
Ответ: коэффициент наклона ° не изменится, а свободное слага
2 емое изменится на величину (−°c˛^ ). Коэффициент детерминации R2 
2 
не изменится. 
^^^
б . В этом случае мы вместо регрессии y=+ x˛˛ будем оценивать
i 12 i
^
^^
параметры новой модели: y=1 +2 z, где z=° . Отметим, что в
˛˛ xc
i iiiэтом случае zxc.
=° 
Выясним, как соотносятся оценки коэффициентов в новой модели с оценками коэффициентов в старой модели: 
˜˜ ˜ ^
(, ) cov( ˛ ,) c˛cov(, ˝2
cov zy xcy xy)
^
˜== = = ;
2 °° 2 c
var()z var(xc˛ ) c˛ va ° r()x ^
° 
^ ^ 2^^
˜=−˙˜=y (xc) =−˙°=°
yz − ˙˙ yx ;
12 21
c 
˜2 ˜2 ˜2 ˜2 
cov (zy) cov (xcy) c2 °cov (, ) cov (xy)
2, °, xy ,
R === = .
°°° ° 2 °° °° 
var()z°var()y var(xc°°) var()yc°var()x°var()y var()x°var(y) 
Таким образом, R2 для новой модели совпадает с R2 для исходной модели. 
^° 
1 не изменится, а коэффициент накло
Ответ: свободное слагаемое 
°
^ на изменится в cраз и станет равен 2 . Например, если раньше регрес
c 
сор измерялся в рублях, а теперь мы стали измерять его в копейках, то c= 100, и коэффициент наклона уменьшится в 100 раз. R2 не изменится. 
Задание 4 . y на x и наоборот 
1
Интуиция может подсказывать ответ . Однако на самом деле вер
2 
ный ответ другой. Чтобы его найти, запишем две модели в общем виде: 
˜
cov(,xy)
^^ ^^ 
y=+ x; ˛= ;˛˛
i 12 i 2 ° 
var()x 
˜
cov(,xy)
^^^ ^ 
xi =1 +2 yi; ˛2 = .
˛˛ 
° 
var()y 
Перемножим коэффициенты наклона в этих моделях: 
˜
2(, )
cov xy
^ ^
˜°˛ = .
22 
°° 
var()x˛var()y 
Выражение, которое стоит справа — это квадрат выборочного коэффициента корреляции между переменными xи y. Таким образом, это R2 для каждой из моделей. R2 в первой модели и R2 во второй модели 

совпадают, так как corr 

corr
(, ) 
(, )
yx:xy
= 
^^ 2
˜°˛ =R ;
22 
^
2 ˜˛ = 08,;
2 ^
˜= 04,.
2 ^
Ответ: ˜2 = 04,. 
Задание 5 . Опыт и производительность 
а . Результаты расчетов представлены в таблице: 
Модель 1: МНК, использованы наблюдения 1-2000 Зависимая переменная: sales 
Коэффициент Ст. ошибка t-статистика P-значение const 159,546 2,23334 71,44 <0,0001 *** experience 4,96958 0,677081 7,340 <0,0001 *** 
Сумма кв. остатков 3684939 Ст. ошибка модели 42,94548 R2 0,026255 Испр. R2 0,025767 F (1, 1998) 53,87134 Р-значение (F) 3,10e-13 
В виде уравнения полученный результат можно представить так: 
 2
sales =159 55 + 497˛experienceR .
,, , = 0,03
ii
223, ) (068 
( ,) 
Так как для обоих коэффициентов P-значение меньше одной сотой, можно заключить, что оба коэффициента значимы на 1%-м уровне. Впрочем, невысокий R2 говорит о том, что существуют другие важные для производительности факторы, которые наша модель пока не учитывает. 
Интерпретация результата: каждый дополнительный год опыта увеличивает продажи менеджера в среднем на 5 тыс. руб. за период. б . Результаты оценивания для удобства сопоставления представлены в виде сводной таблицы: 
Подвыборка Подвыборка Полная прошедших не проходивших выборка тренинг тренинг Константа 159,55*** 170,55*** 153,95***(2,23) (4,08) (2,56)experience 4,97*** 6,26*** 4,58***(0,68) (1,25) (0,77)Число наблюдений 2000 627 1373 Испр. R2 0,03 0,04 0,02 
Зависимая переменная — sales. В скобках указаны стандартные ошибки. *** обозначает значимость на 1%-м уровне. 
Для работников, проходивших тренинг, оценки обоих коэффициентов больше, чем для остальных. Тем самым при равном опыте работы производительность тех менеджеров, которые проходили тренинг, будет выше. Например, для работника с пятилетним опытом работы в случае, если он проходил тренинг, предсказанный объем продаж составит 170,55 + 6,26 · 5 = 201,85 тыс. руб. за период. А у его коллеги с таким же опытом, но без тренинга, он будет равен 153,95 + 4,58 · 5 = 176,85 тыс . руб. за период. Тем самым можно заключить, что курсы повышения квалификации позитивно влияют на продажи менеджеров. 
На практике, конечно, всегда следует тестировать статистическую значимость подобных различий. Мы научимся это делать в гл. 4. 
^
Задание 6 . Дисперсия ° 
1 
^ 
,Сначала покажем, что cov(˜°2) =0: 
ˇ˜ +˜ +…+˜ £(x −x )˜&#22;
^ 12 n ii
cov(˜° )cov , °+ &#20;
, =&#23; = 2 ˘ 2 £(xi −x ) &#21;
&#23; n 2 &#20; 
cov(ˆ +ˆ +…+ˆ ,(x −x)ˆ+(x −x )ˆ +…+(x −x )ˆ )
12 n 112 2 nn
== 
n ˙£(x −x)2 
i 
= {предпосылка №5} = 
cov(ˆ ,(x −x ˆ+ ˆ ,(x − x ˆ ) +…+cov(ˆ ,(x −x ˆ )
))cov( ) )
111 222 nn n
== n˙£(x −x )2 
i (x −x)˛cov(ˆˆ,) +…+(x −x )˛cov(ˆˆ,)
1 11 n nn
== 
n˛£(xi −x )2 
= {предпосылка №4} = 
2 22
(x − x)˛ˆ +…+(x − x )˛ˆ £(x − x )˛ˆ 0 ˛ˆ2
1 ni
= ===0.
2 2)2
n ˛£(x − x ) n˛£(x − x) n˛£(x − x
i ii 
Теперь перейдем к вычислению требуемой дисперсии: 
^^ ^
var(˜)var(= y ˜x) var( +
˜˜x °˜x)−˙ = +−˙ = 
1 2 122 ^ ^^ 
=var( −˛x = ˙+var(ˆ˛x) −2 ˛cov(˙, ˆ
˙ˆ )var() ˛x) = 
2 22 
2
˙ 
^2 ^ 
=+var(ˇ)˛x−2 ˛cov(ˆˇ)˛x=
,
22
n 
2 22
˙ ˙˙
^2 2
=+var(ˆ)˛x−˛˛x=+ ˛
20 x.
2
nn £(x−x)2 
i 
При последнем переходе мы воспользовались доказанным в § 2.4 ра
2
° 
^ 
венством var(˜2) = 2 . Полученный результат в принципе уже £(xi− x) 
является верным ответом, однако его можно несколько упростить: 
2 2 222
˜ ˜ ˜˜˝ x
2
+˝ x=+ = 
2
n £(x− x) n nx(2 − x2)
i 
22
(x− x2)˙2 ˙2 ˛ x ˙2 ˛ x2 
= +== 
22 22 22
˛( − x) ˛( − x) ˛( −
nx nx nxx) ˝2 ˛ x2 
= . £(xi− x)2 
Таким образом, получаем окончательный ответ: 
2
22 2 ˆ x
°˙ x ° 
var(˜^) = =˙ i .
22
1 £(x− x) nˆ(x− x)
ii 
Задание 7 . Ковариация между оценками коэффициентов 
^ 
Сначала покажем, что cov(y, ˜2) = 0: 
^ ^^
cov(y, ˜ )cov(˜ +˜ x+°, ˜ ) = cov(°, ˜ ) = 0.
= 
2 122 2 
Последнее равенство доказано в решении задания 6. Теперь перейдем к нужной нам ковариации: 
^^ ^^^ ^^
cov(˜˜,) =cov(y−˜x, ˜= y, ˜) −x˝cov(˜, ˜
)cov( ) = 
12 222 22 22
˝ x˛˝
=−0 x˛ =− . £(xi−x)2 £(xi−x)2 Здесь мы воспользовались доказанным в решении задания 6 равен
2
2 ˙ x ством var(˜^) =˝ i , а также доказанным в параграфе 2.4 ра
°
2
1 n ˙(x − x)
i 
2
° 
^ 
венством var(˜ ) = .
2
2 £(xi− x) 
Задание 8 . Регрессия без константы 
а . Запишем сумму квадратов остатков для оцениваемой модели: 
nn e2 =°(y −˙^ ˝ x)2. 
° i ii i=1 i=1 
&#19;
&#19;
^^ 
является параболой с ветвями, направленными вверх, поэтому точка экстремума, которую мы найдем, будет точкой минимума. Возьмем 
^: 
Эту сумму мы минимизируем по 
Относительно 
эта функция
. 
производную по
&#19; 
n 
^
−2˝x°(y −˙° x) = 0;
ii i i=1 
nn 
^ 
xy −˝ x2 = 0;
° ii ° i i=1 i=1 
n 
xy
˜^ =˛i=1 ii . x
˛in =1 i 2 
Это уже ответ, однако можно записать его более компактно. Если разделить числитель и знаменатель на число наблюдений n, получим 
xy
^ 
следующий результат: ˜= . 
2
x 
Чтобы проверить несмещенность оценки, вычислим ее математическое ожидание. Для этого заметим, что: 
nn n 
xy x(˜x +°) x° 
^ ˙i=1 ii ˙i=1 iii =+˙i=1 ii;
˜== ˜ 
nn n
22 2
xx
˙i=1 i ˙i=1 i ˙i=1xi 
˙ n ˘ nn 
x° xE&#21;() x&#21;0
° 
^ ˇ&#20;i=1 ii&#22;&#20;i=1 ii &#20;i=1 i
E() =E˜+˜ ˜=.
˜ =+ =+˜
ˇ n &#22; nn
2 22
ˇ x &#22; xx
ˆ&#20;i=1 i &#23;&#20;i=1 i &#20;i=1 i ^ 
Так как E()˜ =˜, то оценка является несмещенной. В ходе решения мы использовали следующие предпосылки классической линейной модели: 
• 
модель правильно специфицирована (мы использовали эту предпосылку, когда вместо yiподставляли ˜xi+° i); 

• 
xi— детерминированные (неслучайные) величины (мы использовали эту предпосылку, когда выносили «иксы» из-под знака математического ожидания); 


E()i 0.
˜= 
Обратите внимание, что нарушение любой из этих предпосылок сделало бы оценку, вообще говоря, смещенной. 
б . 
˘&#23; ˘&#23; = 
˙ˆ ˙ˆ 
° = 
= 
nn&#21;
° = 
=
&#21;
xx ˇ 1 ii&#22; 
^ i1 ii i1 ii
var( )var
= ˇ&#22;11 ˜ 
В силу предпосылки о том, что все случайные ошибки являются независимыми друг от друга, можно переписать дисперсию суммы в числителе последнего выражения, представив ее как сумму дисперсий: 
nn n
2 22
Vx( &#20;) xV&#21;&#20; x&#21;&#19;
° i=1 ii ° i=1 i ()i ° i=1 i 
= == 
2 22
˛ n ˆ˛ n ˆ˛ n ˆ
2 22
x xx
˙°˘ ˙°˘ ˙°˘
˝ i=1 iˇ˝ i=1 iˇ˝ i=1 iˇ 
˛ n ˆ
22
&#19;&#21; x
˙˘
˝° i=1 iˇ&#19;2 
== . 
˛ˆ
˛ n ˆ x2
22 ˙°n ˘
˙ x˘˝ i=1 iˇ
˝° i=1 iˇ 
n
˙
˙˘
˘
&#21;
° 
var 
x
i
ˇ ˇˇˆ 
&#22; &#22;&#22;&#23; 
ˇ ˇˇˆ 
&#22; &#22;&#22;&#23; 
˜
+
=
var
= 
2. 
n n
2 
2
&#21;
&#21;
n
x 
x 
2
&#21;
i 
i 
= 
x
1 i
i 
i 
i 
2
° 
^
Таким образом: V()˜= . Отметим, что в дополнение к
˝ n ˇ
2
x
˙ˆ&#22;i=1 i˘&#23; 
предпосылкам, перечисленным в пункте (а), здесь мы использовали 
также предпосылки о независимости случайных ошибок для разных наблюдений и о постоянстве дисперсии случайных ошибок. 
С ростом объема выборки знаменатель дроби растет (если только добавляемое значение xiне равно нулю), следовательно, дисперсия оценки уменьшается, т.е. точность оценки растет. 
в . Рассмотрим простой пример с двумя наблюдениями: x1 = 1, y1=0 и x1 = 0, y1 = 1. 
n 
xy
˝ ii 00+
^ i=1 ^^
В этом случае: ˜= == 0. Поэтому y = 0 и y = 0, а 
n 2 + 12 
x
˝i=1 i 10 2 ^2 ^2 
˝
˛e (y −y) +(y −y ) 01
+
2 i 11 22
R 1 =− 1 =−1.
=− 1 =−
2 22 05,
˛( yi−y) 05, +05, 
Такая ситуация возможна из-за того, что в модели нет константы, в то время как все хорошие свойства для коэффициента R2 доказаны нами для случая модели с константой. 
Задание 9 . Регрессия на константу 
а . Запишем сумму квадратов остатков для оцениваемой модели: 
nn ei 2 =°( yi−˝^)2. 
° 
i=1 i=1 ^^
Эту сумму мы минимизируем по &#19;. Относительно &#19; эта функция является параболой с ветвями, направленными вверх, поэтому точка экстремума, которую мы найдем, будет точкой минимума. Возьмем производную по &#19;^: 
n 
^
)
˛= 
−2 
i 1 
−
=
0.
(yi 
n 
y
^ ˛i=1 i
Отсюда получаем, что ˜= = y. 
n ˝ n ˇ˝ n ˇ n 
y (˜°) n ()
+ ˜+ E° 
^ ˆ&#21;i=1 i&#23; ˆ&#21;i=1 i &#23;&#21;i=1 in˜+0
E()˜=E =E = ==˜.
ˆ&#23;ˆ &#23;
nn nn
ˆ&#23;ˆ &#23;
˙˘˙ ˘ 
Таким образом, оценка является несмещенной. В ходе решения мы использовали следующие предпосылки классической линейной модели: 
• модель правильно специфицирована (мы использовали эту предпосылку, когда вместо yi подставляли ˜°);
+i E()˜=0.
i 
б . 
˙ n ˘˙ n ˘
˜°) °
( +
^ ˇ&#21;i=1 i &#22; ˇ&#21;i=1 i &#22;
var(˜)var==var ˜+ = 
ˇ &#22;ˇ&#22;
ˇ n &#22;ˇ n &#22;
ˆ &#23;ˆ&#23; 
°
˙ˆ&#23; 
=
ˇ
1 
2. 
n
°
˙
˘
&#23;
i 1 i 
n˘ 
n 
В силу предпосылки о том, что все случайные ошибки являются независимыми друг от друга, можно переписать дисперсию суммы в числителе последнего выражения, представив ее как сумму дисперсий: 
n 
var(˝ ) 22
° i=1 in˛˙ ˙ 
== .
22 
nnn 
2
° 
^ 
Таким образом: V ()˜= . Отметим, что в дополнение к предпосыл
n 
кам, перечисленным в пункте (а), здесь мы использовали также предпосылки о независимости случайных ошибок для разных наблюдений и о постоянстве дисперсии случайных ошибок. 
С ростом объема выборки знаменатель дроби растет, следовательно, дисперсия оценки уменьшается, т.е. точность оценки растет. 
в . В этой задаче для вычисления R2 удобно воспользоваться следую
 ^ 
var()y
щей формулой: R2 = . Отметим, что в нашей модели y ^ i принима

var()y ^ 
^
ет одинаковое значение для всех наблюдений: yi =°. Следовательно,  ^ 
var()y
var y ^, R2 =  = 0. 
() = 0 var()y 
Это довольно естественный результат: регрессией, в которой есть только константа, невозможно объяснить изменения зависимой переменной. 
˛˝
var 
i
i
˝ ˝˝˛ 
ˇ ˇˇˆ 
= 
n 
=
var
= 
Задание 10 . Нарушение предпосылки 3 
ˇ £(x − x )°&#22; £(x − x )µ
^ ii i
E ˜= E &#23;˜+ &#20;=˜+ = 
2 &#23; 22 &#20; 22
˘ £(xi − x ) &#21; £(xi − x ) 
£(xi − x )0 =˜2 +µ =˜+µ =˜ .
22 22
£(xi − x ) £(xi − x ) 
Таким образом, если вас интересует оценка коэффициента при переменной (так оно обычно и бывает), то при наличии в модели константы задумываться про предпосылку 3 необязательно, так как ее выполне
ние не критично для несмещенного оценивания коэффициента ° 2. 
К ГЛАВЕ 3 
Задание 1 . Расчетный пример 
По условию оцененное уравнение имеет вид: 
y ^ = 22, + 05, x+ 07, zR,2 = 02,,
i ii
(04, ) ()01, (05, ) 
где xi— количество недель, которое i-й сотрудник провел на курсах повышения квалификации; zi— стаж работы i-го сотрудника в фирме АВС (в годах); yi— производительность труда i-го сотрудника. 
Для удобства формулирования гипотез запишем модель так: 
y=˝+˝ ˛ x+˝ ˛ z+˙ .
i 12 i 3 ii 
а . Тестируемая гипотеза H: ˜=0. Расчетное значение тестовой
03 
статистики равно 0,7 / 0,5 = 1,4, что меньше критического значения, которое при данном уровне значимости составляет 2,58. Поэтому гипотеза о равенстве нулю коэффициента при переменной не отвергается. Следовательно, переменная незначима. 
б . Проверим значимость уравнения в целом. 
Тестируемая гипотеза H: ˜ =˜ = 0. Расчетное значение тестовой
02 3 
статистики составляет: 
2
R nk 02,
− 997
F= ˛ =˛= ,
124 625. 
1 − R2 k−1 08, 2 
Это больше критического значения, которое равно: 
F (k−1 − ) = (, ) = 46
,nk F 2997 ,.
001, 0 01
, 
Следовательно, тестируемая гипотеза отвергается. Уравнение в целом значимо. 
в . Новую модель в общем виде можно записать так: 
y=˝+˝ ˛ x+˝ ˛ z+˝ ˛ w+˝ ˛ p+˙ ,
i 12 i 3 i 4 i 5 ii 
где wи p— новые переменные, добавленные в модель. 
Тестируемая гипотеза H0: ˜ =˜ = 0. Расчетное значение тестовой
45
статистики составляет: 
R − R
22 nk 03, − , 1000
− 02 − 5
F = UR R ˛= ˛= ,.
71 07 ðàñ÷ 1− R2 q 103− ,2
UR 
Это заведомо больше критического значения, которое составляет: 
F (qnk) = 0 01(2 995 = ,.
, − F , )46
001 ,
, 
Следовательно, тестируемая гипотеза отвергается. Добавление переменных в модель оправдано. 
Задание 2 . Религия и потребление алкоголя 
180 
2
а . Общая сумма квадратов ˝ (ALCO − ALCO) = 300 + 200 = 500;
i=1 i 
300
R12 = = 06,.
500 
б . Значение общей суммы квадратов (TSS) в модели 2 при уменьшении числа регрессоров не изменилось, поскольку оно зависит лишь от ALCOi и ALCO, а не от набора используемых регрессоров. Значение суммы квадратов остатков увеличилось (при уменьшении количества регрессоров увеличились отклонения предсказанных значений от истинных, а значит, и сумма их квадратов). Следовательно, объясненная сумма квадратов уменьшилась на 100. 
200
Поэтому имеем: R22 = 500 = 04,. 
в . Чтобы выяснить, влияет ли религия на потребление алкоголя, сравним модели 1 и 2 с помощью теста на «короткую» и «длинную» регрессии. 
Запишем тестируемую гипотезу: 
: ˜ =˜ =˜ = 0.
H03 4 5 
Расчетное значение равно: 
22
R − R
UR Rnk 06, − , 180
− 04 − 5
F = ˛= ˛= ,.
29 17 1− R2 q 106− ,3
UR 
Критическое значение при уровне значимости 5% составляет F(3,175) = 2,605; 29,17 > 2,605. Вывод: гипотеза не принимается. Следовательно, религия влияет на потребление алкоголя, и лучше пользоваться моделью 1. 
Задание 3 . Смещена или нет? 
^ 
а . По определению оценка коэффициента ° является несмещен
2
^ 
ной, если E()˜2 =˜2. Проверим, выполняется ли это равенство в данном случае: 
˛ ˜ ()1 ˆ˛ ˜ ()1 (1) ()2 ˆ
cov(x , y) cov(x , ˜+˜ &#22; x +˜ &#22; x +&#21;)
^ 123
E() = E ˙ ˘= E ˙=
˜2 ˙ ° ()1 ˘ ° ()1 ˘ 
˝ var(x ) ˇ ˙˝ var(x ) ˘ˇ 
ˆ ˜ ()1 ˜ ()1 ()1 ˜ ()1 ()2 ˜ ()1 &#23;
cov(, x ) +˝ ˛cov(x , x ) +˝ ˛cov(x , x ) + cov(x
˝ ,˙))
12 3
= E ˘ &#21;= 
˘ ° ()1 &#21;
ˇ var(x ) &#22; 
° ˜(, ()1 &#19; &#22;&#20; ˜( ()1, ()2 ˜ 1 &#16;
˝ cov &#22; x ) = 0 ˆ˝ 3 cov xx ) cov(x(),&#21;)
=˛ 1 ˇ= E &#17;&#22;+ +&#14;= 
˜ ()1 ()1 ° ()1 &#17; 2 va ° r(x()1) v ° ar(x()1) &#14;
˝˙cov(x , x ) = var(x )˝˘&#18; &#15; 
˛˛−íåñëó÷àéíûå&#22;âåëè÷èíû ˘
˝ ,
ˆ 23 ˆ 
=˙ &#23;= 
()1 ()2
ˇˆx , x −äåòåðìèíèðîâàííûå&#22;ð &#22;ˆ
ðåãðåññîðû 
˜ ()1 ()2 ˜ ()1 ˜ ()1 ()2
˝˛cov(x , x ) E ( ,)) ˝˛cov(x , x ) =˝+ + =˝+ . 
3 (cov x ˙ 3 
° ()1 ° ()1 ° ()1
2 var(x ) var(x ) 2 var(x ) 
Замечания: 
Во-первых, в процессе решения мы использовали тот факт, что 
 ˘ 1 () &#21;
()1 1 ()1
E(cov(x ,)˜ ) = E &#23;&#22; ˛(xi − x )ˇ(˜i −˜)&#20;&#19; = 
n 
()1 ()1 ()1 ()1
=°xi −x ˆE() −°xi −x ˆE() =0
1 ( )ˇi 1 ( )ˇ , 
nn 
˜=
так как E()i 0 в силу выполнения предпосылок КЛМПР (и, следова
тельно, E()˜=0). 
Во-вторых, поскольку ° 2и ° 3 – это неслучайные величины, а x(1) и (x()1) ( ()1 ()2
x(2) – детерминированные регрессоры, то °°, и cov , x )
, var x
23 
можно свободно выносить за знак математического ожидания. 
˜( ()1 ()2)
˜˝cov x , x Итак, E ˜^ =˜ + 3. va˜r(x()1) ˆ0 è c
()2 2 Поскольку
° ()
var(x 1) 
()1 ()2 ^ 
cov x , x ), ˜° ° ( ˆ0 то E() ˜ . Следовательно, оценка смещена.
22 
Более того, можно сделать вывод о направлении смещения оценки. 
(x()1) ( ()1 ()2
var >0 всегда, а по условию ˜3 < 0 и cov x , x ) >0. Следовательно, вся «добавка» отрицательна, и оценка занижена. 
( ()1 ()2
б . Аналогично, если теперь cov x , x ) <0, а ˜3 < 0 по-прежнему, то вся «добавка» становится положительной, и оценка оказывается завышенной. 
( ()1 ()2
в . Если теперь cov x , x ) =0, то «добавка» обращается в ноль, и ^
оценка становится несмещенной: E() =˜2.
˜ Таким образом, ответ на
2 
последний вопрос задания: нет. 
Задание 4 . Рынок ноутбуков 
Удобно представить нашу модель таким образом: 
price =˝+˝ ˛diag +˝ ˛weight +˝ ˛time +˙ .
i 12 i 3 i 4 ii 
Тогда по аналогии с решением предыдущей задачи можно вычислить матожидание оценки в парной регрессии: 
˜˜
cov(diag,weight)(diag time
cov ,)
^
E ˜ =˜ +˜ +˜ .
2 23 ° 4 
° (
var(diag) var diag) 
(
Из условия задачи следует: ˜3 < 0, cov diag,weight) > 0, °> 0,
4 cov(diag, time) <0, поэтому 
˜˜
cov(diag, weight) cov(diag, time)
˜ +˜< 0.0
3 ° 4 ° 
var(diag) var(diag) 
^ 
Следовательно, E ˜2 <˜2. Оценка занижена. 
Задание 5 . Отдача от образования 
Проведем предварительный анализ данных. 
а . Получаем следующую таблицу: 
Описательная статистика, использованы наблюдения 1-540 
Переменная Среднее Медиана S.D. Min Max EXP 16,9 17,5 4,43 1,15 23,6S 13,7 13,0 2,44 7,00 20,0EARNINGS 19,6 16,0 14,4 2,13 120,FEMALE 0,500 0,500 0,500 0,000 1,00 
Проанализируем полученные результаты на примере переменной S. Из таблицы видно, что в среднем работники, вошедшие в выборку, учились 13,7 лет (речь идет об учебе, начиная со школы). Минимальное образование составляет 7 классов, максимальная продолжительность обучения — 20 лет. 
Среднее значение 0,5 для переменной FEMALE означает, что ровно половину выборки составляют женщины. 
В целом, прежде чем переходить к построению моделей регрессии, полезно просмотреть описательные статистики по переменным. Например, это поможет понять, не возникло ли каких-то грубых ошибок при вводе данных. 
б . Получаем следующий результат: 
Коэффициенты корреляции, наблюдения 1-540 5% критические значения (двухсторонние) = 0,0844 для n = 540 
EXP S EARNINGS FEMALE 1,0000 −0,2179 0,0743 −0,2194 EXP 1,0000 0,4153 −0,0205 S 1,0000 −0,2415 EARNINGS 1,0000 FEMALE 
Переменная EARNINGS положительно коррелирована с переменными EXP и S, т.е. люди, у которых больше опыт работы и выше образование, в среднем получают более высокую зарплату. Это вполне соответствует ожиданиям. Отметим, впрочем, что парные коэффициенты корреляции подходят только для предварительного анализа. Окончательные выводы о наличии причинно-следственной связи на их основе делать не стоит, так как они характеризуют парную связь без учета прочих факторов, а, как мы выяснили, такой подход может приводить к получению некорректных выводов. 
Переменная EARNINGS отрицательно коррелирована с переменной FEMALE. Это означает, что женщины в нашей выборке получают в среднем более низкую зарплату, чем мужчины. Делать окончательный вывод на основе только коэффициента корреляции не стоит. Возможно, мы столкнулись с ситуацией дискриминации на рынке труда, а возможно, дело не в дискриминации, а в том, что женщины в нашей выборке получают более низкую зарплату, так как у них в среднем меньше опыт работы по сравнению с мужчинами (действительно, переменные FEMALE и EXP коррелированы отрицательно). Требуется дополнительный анализ. 
Отрицательная корреляция между переменными EXP и S также вполне соответствует нашим ожиданиям: чем дольше индивид учится, тем меньше при прочих равных условиях у него остается времени на получение опыта работы. 
Прежде чем переходить к построению моделей регрессии, полезно просмотреть корреляционную матрицу для переменных. Это позволит сделать предварительные выводы о характере взаимосвязей между переменными. Также, как показано в гл. 4, это может быть полезно для выявления проблемы мультиколлинеарности. 
в . Получаем следующие графики: 

График разброса EARNINGS от S График разброса EARNINGS от EXP 
Как и в случае с парными коэффициентами корреляции, прослеживается положительная, хотя и не очень четкая, взаимосвязь между анализируемыми переменными. 
г . Теперь перейдем к рассмотрению модели парной регрессии. 
Получаем следующую таблицу: 
Модель 1: МНК, использованы наблюдения 1-540 Зависимая переменная: EARNINGS 
Коэффициент Ст. ошибка t-статистика P-значение const −13,9335 3,21985 −4,3274 0,00002 *** S 2,45532 0,231851 10,5901 <0,00001 *** 
Сумма кв. остатков 92688,67 Ст. ошибка модели 13,12569 R2 0,172498 Испр. R2 0,170960 F (1, 538) 112,1496 Р-значение (F) 6,22e-24 
В виде уравнения полученный результат можно представить так: 
 2
EARNINGS =−13 93 +246˝Si ; R = ,
, , 0 172.

i 
(322) (023
, ,) 
Из таблицы видно, что соответствующее P-значение меньше одной сотой. Следовательно, при 1%-м уровне образование значимо влияет на доход. В среднем каждый дополнительный год образования ассоциируется примерно с двумя с половиной долларами дополнительного дохода в час. 
Парная регрессия не позволяет учесть влияние прочих факторов. 
Стандартная ошибка регрессии равна 13,13, в то время как среднее значение заработной платы по выборке составляет примерно 20 долл. в час (это можно увидеть в описательных статистиках, которые мы получили в самом начале задания). Таким образом, можно сделать вывод о том, что точность нашей модели оставляет желать лучшего. Действительно: стандартная ошибка в 13 долл. (при том, что зарплата в среднем равна 20 долл.) — не слишком впечатляющий образец точности. 
Это означает, что есть и другие факторы, помимо уровня образования, которые существенно влияют на уровень заработка. 
Все перечисленные выше соображения вынуждают нас продолжить исследование. 
д . Перейдем к построению и оценке модели множественной регрессии. 
Добавив в поле регрессоров переменную EXP, получим следующую таблицу: 
Модель 2: МНК, использованы наблюдения 1-540 Зависимая переменная: EARNINGS 
Коэффициент Ст. ошибка t-статистика P-значение const −26,485 4,27251 −6,1989 <0,00001 *** S 2,67813 0,23365 11,4621 <0,00001 *** EXP 0,562433 0,128514 4,3764 0,00001 *** 
Сумма кв. остатков 89496,58 Ст. ошибка модели 12,90970R2 0,200996 Испр. R2 0,198021F (2, 537) 67,54352 Р-значение (F) 6,83e-27 
В виде уравнения результат можно записать так: 
 2
EARNINGS =− , +2 678 ˝S + , ˝EXP , R =0 201.
26485 , 0562 ,
i ii
0 129)(4273, ) (0234, ) ( , 
Проверим значимость уравнения в целом. Соответствующее P-значение (F) меньше 0,01, следовательно, уравнение в целом значимо при уровне значимости 1%. 
Теперь посмотрим, какие из факторов значимо влияют на заработок на 1%-м уровне. P-значение для каждой переменной меньше, чем 0,01. Следовательно, при 1%-м уровне все переменные значимы. (Три звездочки напротив каждого из коэффициентов также говорят о значимости на 1%-м уровне значимости.) 
И образование, и опыт работы значимо и положительно влияют на уровень заработка типичного работника, что соответствует соображениям здравого смысла. 
Содержательная интерпретация коэффициента при переменной EXP: при прочих равных условиях один дополнительный год стажа увеличивает зарплату работника в среднем на 56 центов. 
Содержательная интерпретация коэффициента при переменной S: при прочих равных условиях один дополнительный год образования увеличивает зарплату работника в среднем на 2,7 долл. 
Отметим, что к численным оценкам коэффициентов в этом уравнении следует относиться довольно осторожно, так как R2 по-прежнему не очень высокий, что говорит о низком качестве подгонки. Если вас интересует точная численная интерпретация для коэффициентов, то лучше опираться на модели с высокими значениями R2 и низкими стандартными ошибками у соответствующих коэффициентов. 
е . Получим следующий результат: 
Модель 3: МНК, использованы наблюдения 1-540 Зависимая переменная: EARNINGS 
Коэффициент Ст. ошибка t-статистика P-значение const −19,6919 4,36076 −4,5157 <0,00001 *** S 2,59114 0,22855 11,3373 <0,00001 *** EXP 0,405677 0,12882 3,1492 0,00173 *** FEMALE −5,90905 1,11397 −5,3045 <0,00001 *** 
Сумма кв. остатков 85032,75 Ст. ошибка модели 12,59536 R2 0,240848 Испр. R2 0,236599 F (3, 536) 56,68377 Р-значение (F) 7,74e-32 
То же самое в виде уравнения: 

EARNINGS =−19 692 +2 591 ˝S + , ˝EXP − ,
, , 0406 5909 ˝FEMALE ,
i ii i
(4 361, ) (0 229, ) (0129) 1114)
, (, 
R2 = 0,241. 
Переменная FEMALE — это так называемая бинарная или фиктивная (dummy) переменная. Такие переменные будут подробно рассмотрены в следующей главе. 
С содержательной точки зрения ее включение в модель оправдано, так как часто есть основания предполагать наличие на рынке труда дискриминации по гендерному признаку. С точки зрения теста на значимость, эта переменная является значимой (так как соответствующее Pзначение меньше 0,01), поэтому стоит включить ее в модель. 
Коэффициент при этой переменной равен (–5,9). Этот результат можно интерпретировать следующим образом: при прочих равных условиях (при равном стаже работы и равном уровне образования) женщины получают зарплату примерно на 6 долл. в час ниже, чем мужчины. 
ж . 
Метод оценки - МНК Зависимая переменная: EARNINGS 
(1) (2) (3)const −13,933*** −26,485*** −19,692***(3,220) (4,273) (4,361)S 2,455** 2,678** 2,591***(0,232) (0,234) (0,229)EXP 0,562*** 0,406***(0,129) (0,129)FEMALE −5,909***
(1,114) n 540 540 540 Испр. R2 0,171 0,198 0,237 
В скобках указаны стандартные ошибки. *** обозначает значимость на 1%-м уровне. 
з . Если записать оцениваемое в пункте (е) уравнение в стандартном виде: 
EARNINGS =˝+˝ ˛S +˝ ˛EXP +˝ ˛ FEMALE +˙ ,
i 12 i 3 i 4 ii 
то тестируемая гипотеза имеет вид H0: ˜ =˜ = 0.
34 
Расчетное значение таково: 
22
R − R
UR Rnk 0 2408, − , 540
− 0 1725 − 4
F = ˛= ˛= 241,.
1− R2 q 10 2408− ,2
UR 
Критическое значение при уровне значимости 1% F(2, 536) = 4, 605; 24,1 > 4,605. Вывод: нулевая гипотеза не принимается. «Длинная» регрессия значимо лучше, чем «короткая», т.е. переменные добавлять стоило. 
и . В этом пункте рассмотрим зависимость заработка от числа лет обучения и стажа работы отдельно для женщин и мужчин. 
Оценим сначала уравнение 
EARNINGS =˝+˝ ˛ S +˝ ˛EXP +˙
i 12 i 3 ii 
отдельно для мужчин. Для этого нам нужно оставить в выборке только те наблюдения, которые относятся к мужчинам. 
Модель 4: МНК, использованы наблюдения 1-270 Зависимая переменная: EARNINGS 
Коэффициент Ст. ошибка t-статистика P-значение const −31,5168 7,87079 −4,0043 0,00008 *** S 3,14078 0,369334 8,5039 <0,00001 *** EXP 0,645303 0,238204 2,7090 0,00718 *** 
Сумма кв. остатков 54433,12 Ст. ошибка модели 14,27828R2 0,214545 Испр. R2 0,208661F (2, 267) 36,46512 Р-значение (F) 9,97e-15 
Запись в стандартной форме: 
 2
EARNINGS =−31 517 +3 141 ˝S + , ˝EXP , R =0 215.
, , 0645 ,
i ii
0 238)(7871, ) (0369, ) ( , 
Аналогично оценим уравнение отдельно для женщин. Для этого нам нужно оставить в выборке только те наблюдения, которые относятся к женщинам. 
Получаем следующий результат: 
Модель 5: МНК, использованы наблюдения 271-540 (n = 270) Зависимая переменная: EARNINGS 
Коэффициент Ст. ошибка t-статистика P-значение const −17,2028 4,57972 −3,7563 0,00021 *** S 2,07722 0,280521 7,4049 <0,00001 *** EXP 0,317944 0,138836 2,2901 0,02280 ** 
Сумма кв. остатков 29704,77 Ст. ошибка модели 10,54769 R2 0,178877 Испр. R2 0,172726 F (2, 267) 29,08225 Р-значение (F) 3,75e-12 
Запись в стандартной форме: 
 2
EARNINGS =−17 203 +2 077 ˝S + , ˝EXP , R =0 179.
, , 0318 ,
i ii
(4 580, ) (0 281, ) (0 139)
, 
Иногда разделение выборки на отдельные однородные подвыборки может дать хорошие результаты. В данном случае существенного улучшения не наблюдается. 
Зато можно сравнить модели для мужчин и для женщин и заметить, что с ростом стажа (равно как и с ростом числа лет обучения) зарплата для мужчин растет в среднем чуть быстрее, чем для женщин (в гл. 4 мы обсудим специальный тест, который позволит проверять гипотезу о равенстве коэффициентов в двух таких моделях). Таким образом, полученный результат также подтверждает гипотезу о наличии дискриминации на рынке труда. 
Задание 6 . Расчетный пример 
^ 
а . ˜= (XX˛ )−1 Xy˛ ; 
1000 
XX 
˛ 
˜ 
˜ 
ˆ
00 
˙ ˙˙˝ 
˘ ˘˘ˇ 
0 3000 1000 
;
= 
0 1000 2000 
˝
ˇ
0 001, 0 0 
ˆ ˆˆ˙ 
&#23; &#23;&#23;˘ 
1
(
XX)− 
0 0004, − ,0 0 0002 
;
= 
˜ 
0 −0 0002, ,
0 0006 
Xy 
˛
ˆ
1000 1000
˙ ˙˙˝ 
˘ ˘˘ˇ 
;
= 
2000 
˛
ˆ
1 
˙ ˙˙˝ 
˘ ˘˘ˇ 
&#23;
&#23;
˜
^ 
1 Xy 
2
°e 
39880
2 i
б . S == = 40 .
nk 1000 −
− 3 
Оценка ковариационной матрицы вектора оценок коэффициентов: 
˝004,0 0 ˇ ^^ 12 ˆ&#23;
V() (XX)−&#21;S =ˆ 0 0 016 −, &#23;
˜= &#22; , 0008 . ˆ&#23;
˙ 0 −0 008, , ˘0 024 
Расчетное значение тестовой статистики: 
^
˜ 1
2 
=
= , > ,
6452 58.
^
se()˜ ,0 024
3 
(
XX)− 
0
=
= 
. 
1 
Коэффициент значим. в . H0: ˜+˜ = 2:
12 ^^ ^^
˝+˝ − 2 ˝+˝ − 2
12 12
== =
tðàñ÷ 
˜ ^^ ° ^^
se(˝1 +˝2) 
var(˝ +˝ )
12 
+−2
10 
== 
˜ ^ ˜ ^ ° ^^ 
var() +var()˙ +˝2 cov ˙˙)
˙ (,
12 12 −1 −1 

= 
==−42.
,. 
, −42, > 258, поэтому гипотеза отклоняется. 
0040 016, + , +20* 0 237
, 
Задание 7 . Множественная регрессия без константы 
а . 
˛05, 05, ˆ 
XX˜= ;
˝˙05, 1 ˇ˘ ˙+4 −2˘
1
(XX˜ )−= ;
ˆˇ−2 +2&#23;&#22; ˛100 ˆ 
Xy˜= ;
˝˙400ˇ˘ ˝−400ˇ
^
˜= (XX&#22; )−1 Xy&#22;= . 
˙ˆ 600 ˘&#23; 2°e 
996
2 i
б . S == = 2.
nk 500 −
− 2 
Оценка ковариационной матрицы вектора оценок коэффициентов: 
˙+8 −4˘
^^ 12
V()˜=(XX&#21;)−&#20;S = .
ˇ&#22;
ˆ−4 +4&#23; 
Расчетное значение тестовой статистики по модулю равно 
^
˜ 
−400 
= 

1414196.
= , > , Коэффициент значим.
^ 
se ˜
() 
8
1 
в . Вычислим необходимую стандартную ошибку: 
˜ ^^ 
° ^^ 
° ^ ° ^ ˛ ^^
( ˜˜ ˜˜ 2 cov(,
se ˜+˜) = var( + ) = var() +var() +˝ ˜˜= 
1212 12 12) 

Теперь построим доверительный интервал: 
^^  ^^ ^^  ^^
( +−( +)˝,, ˜˜ se( + )˝,)
˜˜ se ˜˜ 196 ++ ˜˜ 1 96
1212 1212 (600 −400 −°, , 600 −400 +°,
2196 2196) 
( ,, ,)196 08 203 92 
Задание 8 . Еще раз о сравнении «короткой» и «длинной» регрессий 
()1 ()3
В модели 2 сумма регрессоров (xi + xi ) рассматривается как новая переменная, т.е. число регрессоров в модели 2 меньше, чем в модели 1 на один. Или, иными словами, в модели 2 есть одно линейное ограничение. Воспользуемся тестом для сравнения «короткой» и «длинной» регрессий: 
22
RUR − RRnk 0 882, − , 26 112− 0 876 − 4
F = ˛= ˛= ,.
ðàñ÷ 2
1− Rq 10 882− ,1
UR 
Критическое значение при уровне значимости 5% составляет 
F (, − ) = 43.
1264 , 
1,12 < 4,3. Вывод: гипотеза о том, что ˜2 =˜4, не отклоняется. 
Задание 9 . F = t2 
n 2
1 ˝˙ ei
^ 
 ^ 
n − 2 i=1 
se()˜= var()
˜= ;
22 
£(x − x )2 
i 
^2
° 2 −&#23; x 2 −&#23;&#23;˜ 
2 &#21;2 ˙ ^2 (n 2) £(xi −) ^(n−2) n var()x 
t =˝ ˇ=&#21;2 =&#21;2;
˝ ^ ˇ n ˜
se()
˛&#21;2 ˆ e2 n&#23;var()e
&#22;i=1 i 
var var var
 
 
^^
2 
^ 
( 
)
nk
− 
−2
R 
+˙˙
x
()yn 
1 
2
= 
=
F = 
˛ 
˛ 
(n 2)
˛−= 
1 −R
2 
k 
−1 
−
21
var()e (e) 
var()x

2
^
˝ 
°( − 2).
= 
n
2 
var 
После этих преобразований видно, что F = t2. 
Задание 10 . Стандартная ошибка и скорректированный 
R-квадрат 
 nn22
ee 
22 k −12 ˝i=1 ik −1 ˝i=1 i
R =R − (1 R ) =− −
˛− 1 ˛= 
nk− n 2 nk− n 2
(y −y)( y −y) 
adj ˝i=1 i ˝i=1 i 
1 n −1
22 2
1) −))1 n 2 n 2 
=− ˛((nk− S +(k 1 S =− ˛S . 
( y −y)( y −y)
˙i=1 i ˙i=1 i 
Учитывая, что стандартная ошибка модели SEE = 
S 2 , получаем следующий результат: 
n −1
22
R 1 ˛SEE
=− .
adj 
n
˝( y −y)2 
i=1 i 
Отметим, что в правой части указанного выражения при добавлении 
n −1
в модель новых объясняющих переменных дробь остает
(y − y)
˛in =1 i 2 
ся без изменений (так как ее величина определяется только общим количеством наблюдений и значениями зависимой переменной). Следо
вательно, увеличение 2 всегда эквивалентно уменьшению
Radj 2
стандартной ошибки модели SEE. И равенство Radj для двух моделей, оцененных по одним и тем же наблюдениям и с одинаковой зависимой переменной (но с разным набором регрессоров), будет достигаться только в случае совпадения в этих моделях стандартных ошибок регрессии. Что и требовалось доказать. 
()e 
К ГЛАВЕ 4 
Задание 1 . Интерпретация коэффициентов 
Отметим сначала, что все переменные являются статистически значимыми, поэтому имеет смысл их интерпретировать. 
а . dy = 20 · dz; 
˜y ° 20 ˛˜z, 
поэтому верна формулировка: при увеличении переменной z на единицу переменная y увеличивается на 20 ед. 
dx
б . dy = 20 ° ; 
x ˜x
˜y ° 20 ˛ , 
x 
поэтому верна формулировка: при увеличении переменной x на 1% переменная y увеличивается на 20/100 = 0,2 ед. 
Задание 2 . Еще интерпретация 
Отметим сначала, что все переменные являются статистически значимыми, поэтому имеет смысл их интерпретировать. 
dxdy dx
а . dy = ,; = ,
(ln) 007 ° 007 ° ; 
xy x ˜y ˜x
° 007 ˛ ,
, 
yx 
поэтому верна формулировка: при увеличении переменной x на 1% переменная y увеличивается на 0,07%. 
dy
б . dy = , dz; = 007 °dz
(ln) 007 ° ,; 
y ˜y 
007 ˛˜z,
° , 
y 
поэтому верна формулировка: при увеличении переменной z на единицу переменная y увеличивается на 0,07 × 100 = 7%. 
в . На первый взгляд, этот пункт аналогичен предыдущему, и ответ должен быть таким: «Переменная y увеличивается на 0,9 × 100 = 90%». Однако из-за того, что в этом случае коэффициент при переменной довольно велик (существенно больше одной десятой), приближенная формула будет приводить к возникновению слишком большой погрешности. Поэтому следует осуществлять вычисления, используя точную формулу: 
^
ln y =−10 + , ˝ln x + , ˝z +09 ˝d ;
007 007 ,
0 000 ^
ln y 10 + , ˝ln x + , ˝z +09 ˝ d + ).
=− 007 007 ,(1
1 000 
Следовательно, 
^^
ln y1 − ln y0 = 09,; 
˜
^ 
y
1
˝ 
ln = 09,;
˛°ˆ˙ 
^ 
y
0 
^ 
y
1 09,
= e = ,;
246
^ 
y
0 
^^ 
y − y
10 
= ,.
146
^ 
y
0 
Таким образом, при прочих равных условиях при увеличении переменной d на единицу переменная y увеличивается на 146%. (Что заметно больше, чем на 90%.) 
Задание 3 . 
а . Поскольку предельная склонность к потреблению постоянна, а автономное потребление может меняться, сдвиг в функции при переходе от одного региона к другому происходит как раз за счет автономного потребления. 
Создадим некоторую фиктивную переменную Ai, которая описывается следующим образом: 
°1,åñëè i-éˆèíäèâèäˆèçˆðåãèîíà À;
A =˛
i 0 i ˆˆðåãèîíàˆÁ.
,åñëèˆ-éˆèíäèâèäˆèç
˝ 
Перепишем функцию потребления с использованием фиктивной переменной: 
c =˝+˝ ˛ A +˝ ˛income +˙ .
i 13 i 2 ii 
Видим, что для населения из региона А функция потребления в таком случае примет вид: 
c = (˝ +˝ ) +˝ ˛income +˙ ,
i 13 2 ii 
а для населения из региона Б: 
c =˝+˝ ˛income +˙ .
i 12 ii 
Следовательно, сдвиг в потреблении учтен. Таким образом, для проверки гипотезы о различии автономного потребления следует тестировать гипотезу H0: ˜=0. Если эта гипотеза будет отвергнута, следует
3 
сделать вывод о том, что автономное потребление для двух групп потребителей действительно различается. 
б . Для проверки гипотезы о различии значений предельной склонности к потреблению при уровнях дохода выше и ниже некоторого порогового значения создадим фиктивную переменную Bi, которая описывается следующим образом: 
B
i 
= 
˝˙ˆ 
1, 
åñëè ˙income
°
100; 
0, 
åñëè˙income 
100
.
< 
И перепишем функцию потребления с использованием фиктивной переменной: 
c =˝+˝ ˛income +˝ ˛ B ˛income +˙ .
i 12 i 3 i ii 
Видим, что для индивидов с уровнем дохода выше 100 тыс. функция потребления примет вид: 
c =˝ +(˝ +˝ )˛income +˙ ,
i 1 23 ii 
а для индивидов с уровнем дохода ниже y*: 
c =˝+˝ ˛income +˙ .
i 12 ii 
Таким образом, для проверки гипотезы о различии значений предельной склонности к потреблению при уровнях дохода выше и ниже порогового значения следует тестировать гипотезу H0: ˜=0. Если эта
3 
гипотеза будет отвергнута, следует сделать вывод о том, что предельная склонность к потреблению для двух групп потребителей действительно различается. 
Задание 4 . Производственная функция 
В логарифмической модели эластичностью зависимой переменной по одному из регрессоров является значение коэффициента перед этим регрессором. Поэтому задача состоит в том, чтобы в рассматриваемом уравнении регрессии учесть различие значений коэффициентов перед переменной lnLi для отечественных и иностранных фирм. 
Создадим фиктивную переменную di: 
° 1,˛åñëè˛ôèðìà˛èíîñòðàííàÿ;
di =˛
0,˛åñëè˛ôèðìà˛îòå÷åñòâåííàÿ.
˝ 
И запишем уравнение, которое нужно будет оценить: 
lnY =˝+˝˛ln K +˝˛ln L +˝d ln L +˙.
˛˛
i 12 i 3 i 4 i ii 
В этом случае производственная функция для иностранной фирмы примет вид: 
lnY =˝+˝ ˛ ln K + (˝ +˝ )˛ ln L +˙ ,
i 12 i 34 ii 
а для отечественной: 
lnY =˝+˝ ˛ ln K +˝ ˛ ln L +˙ .
i 12 i 3 ii 
То есть различие в эластичности выпуска по труду для иностранных и отечественных фирм учтено. 
Задание 5 . Готэм-сити 
а . Если рассматриваются только квартиры в центре города, то переменная Centeri = 1, а исходное оцененное уравнение регрессии принимает вид: 
^
ln P = , + , ˛ ln S + 0 09 ˛ Metro ;
10311 ,
i ii 
˜P ˜S
° 11, ˛ . 
PS 
Следовательно, при прочих равных условиях при увеличении площади квартиры, расположенной в центре города, на 1%, ее цена возрастает на 1,1%. б . Для преобразованной в пункте (а) модели 
˜P 
009 ˛˜Metro.
° ,
P 
Следовательно, при прочих равных условиях квартира, расположенная в центре рядом с метро, стоит на 9% дороже аналогичной квартиры, расположенной не рядом с метро. 
в . Если рассматриваются только квартиры, расположенные не в центре города, то переменная Centeri = 0, а исходное оцененное уравнение регрессии принимает вид: 
^
ln P = , + , ˛ ln S + 0 04 ˛ Metro ;
10009 ,
i ii 
˜P 
004 ˛˜Metro.
° ,
P 
Следовательно, при прочих равных условиях, квартира, расположенная не в центре рядом с метро, стоит на 4% дороже аналогичной квартиры, расположенной не рядом с метро. 
Задание 6 . Альфа, Бета и Гамма 
а . Поскольку в данном пункте рассматриваются только телевизоры фирмы «Бета», то переменная Betai = 1, а Alfai = 0. Тогда исходное уравнение принимает вид: 
^
ln Pi = , + , Diagi ;206008 ˛ 
˜P 
008 ˛˜Diag.
° ,
P 
Следовательно, при увеличении диагонали экрана телевизора фирмы «Бета» на один дюйм его цена увеличивается на 8%. 
б . Поскольку в данном пункте рассматриваются только телевизоры фирмы «Гамма», то переменная Betai = 0, а Alfai = 0. Тогда исходное уравнение принимает вид: 
^
ln Pi = , + , Diagi ;
200005 ˛ 
˜P 
005 ˛˜Diag.
° ,
P 
Следовательно, при увеличении диагонали экрана телевизора фирмы «Гамма» на один дюйм его цена увеличивается на 5%. 
в . Нам нужно сравнить телевизоры марки «Альфа» с телевизорами какой-нибудь другой марки. Удобнее всего сравнивать с телевизорами марки «Гамма» (телевизоры марки «Гамма» — так называемая эталонная категория, так как соответствующая им переменная не включена в модель). Поэтому при прочих равных условиях телевизоры фирмы «Альфа» на 7% дороже, чем телевизоры марки «Гамма». 
Обратите внимание, что в этой задаче мы имеем дело с логарифмически-линейной моделью. В этой модели использование приближенных формул корректно, только если коэффициент при переменной не слишком велик (меньше одной десятой). В нашей задаче это так. В противном случае пришлось бы пользоваться точной формулой (см. решение последнего пункта задания 2). 
Задание 7 . Абитуриенты 
а . Сначала методом наименьших квадратов оценим регрессию переменной Y на константу и переменную D. Получаем следующий результат: 
Модель 1: МНК, использованы наблюдения 1-150 Зависимая переменная: Y 
Коэффициент Ст. ошибка t-статистика P-значение const 48,01 0,727166 66,0234 <0,00001 *** D −5,07 1,25949 −4,0254 0,00009 *** 
Сумма кв. остатков 7825,810 Ст. ошибка модели 7,271664 R2 0,098683 Испр. R2 0,092593 F (1, 148) 16,20418 Р-значение (F) 0,000090 
Запишем полученный результат в стандартном виде: 
Y^ i = , − , ˛ Di ; R2 = 0 099.
4801 507 , 
(,) (,)073 126 
Иными словами, абитуриент, посетивший подготовительные курсы для поступающих, напишет вступительный экзамен по экономической теории в среднем на 5 баллов хуже, чем абитуриент, который подготовительные курсы не посещал. 
Можно ли в данном случае говорить о причинно-следственной связи между посещением курсов и скверными результатами экзамена? Чтобы ответить на этот вопрос, решим остальные пункты задания. 
б . Теперь оценим регрессию переменной Y на константу, переменную D и переменную EF. 
Модель 2: МНК, использованы наблюдения 1-150 Зависимая переменная: Y 
Коэффициент Ст. ошибка t-статистика P-значение const 28,6635 1,18103 24,2700 <0,00001 *** D 10,2035 1,13125 9,0197 <0,00001 *** EF 20,3647 1,1637 17,4999 <0,00001 *** Сумма кв. остатков 2538,114 Ст. ошибка модели 4,155248 R2 0,707679 Испр. R2 0,703702 F(2, 147) 177,9363 Р-значение (F) 5,50e-40 
^2
Y = , + , ˛ D + , ˛ EF ; R
1020 2036 = ,.
2866 071 
i ii
(,) (,) (,)118 113 116 
При добавлении контрольной переменной EF оценка коэффициента при переменной D, влияние которой нас интересует, поменяла знак. Абитуриент, посетивший подготовительные курсы для поступающих, получает за вступительный экзамен по экономической теории в среднем на 10,2 балла больше, чем абитуриент, который подготовительные курсы не посещал. 
Можно сделать вывод о том, что оценки коэффициентов в уравнении регрессии из пункта (а) были смещены из-за пропуска существенной переменной EF. Отметим также, что R2 при добавлении существенной переменной EF значительно увеличился. 
в . Результаты теста Рамсея представлены в таблице ниже. 
Вспомогательная регрессия для теста Рамсея МНК, использованы наблюдения 1-150 Зависимая переменная: Y Пропущены из-за совершенной коллинеарности: yhat^3 
Коэффициент Ст. ошибка t-статистика P-значение const 48,2704 3,09216 15,61 6,23e-033 *** D 43,2668 5,01245 8,632 9,48e-015 *** EF 83,3295 9,41232 8,853 2,62e-015 *** yhat^2 −0,0341656 0,00507718 −6,729 3,62e-010 *** 
Тестовая статистика: F = 22,641476, P-значение = P(F(2,146) > 22,6415) = 2,73e-009 
Обратите внимание, что в данном случае в модель включены только квадраты предсказанных значений зависимой переменной и не включены кубы. Это связано с тем, что в силу специфики данных включение обеих этих переменных не имеет смысла, так как приведет к чистой мультиколлинеарности. Такая проблема иногда проявляется, если в уравнение включены только фиктивные переменные (как в нашем случае). На практике чаще вы будете сталкиваться с ситуацией, когда в уравнение входят не только бинарные переменные, а значит, сложностей с реализацией теста Рамсея возникать не будет. 
P-значения теста Рамсея составляет 2,73 · 10–9, что заведомо меньше одной сотой. Следовательно, при уровне значимости 1% нулевая гипотеза теста Рамсея отвергается. То есть мы должны заключить, что данная спецификация уравнения некорректна и продолжить поиск. 
г. 
Модель 3: МНК, использованы наблюдения 1-150 Зависимая переменная: Y 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
constDEFDEF  20,2000 19,7250 29,2737 −14,1987  1,62904 1,72786 1,67136 2,10999  12,3999 11,4159 17,5149 −6,7293  <0,00001 <0,00001 <0,00001 <0,00001  *** *** *** ***  
Сумма кв. остатковR2F (3, 146)  1937,259 0,776881 169,4534  Ст. ошибка модеИспр. R2Р-значение (F) ли  3,642650 0,772297 2,37e-47  

Обратите внимание, что коэффициент при новой переменной D × EF, отвечающий за разницу в «надбавке курсов», значим на 1%-м уровне. R2 и скорректированный R2 в новой модели также существенно увеличились: 
^2
Y = , + , ˝ D + 2927 ˝ EF −1420 ˝ D ˝ ; R = 078.
2021973 , , DEF ,
i i iii
(,) (,) (,) (,)163 173 167 211 
Для абитуриента, являющегося выпускником бакалавриата данного экономического факультета (подставим в оцененное уравнение EF = 1), оцененное уравнение регрессии примет вид: 
^
Y = , + , ˛ D
4947 553 .
ii 
Таким образом, выпускник данного экономического факультета, посетивший курсы, на экзамене получит в среднем на 5,53 балла больше, чем выпускник данного экономического факультета, не посетивший курсы. Важно отметить, что в этой модели статистически значимо отличаются от нуля не только отдельные коэффициенты, но и указанная разность 5,53 = 19,73 – 14,20. Чтобы в этом убедиться, нужно проверить гипотезу о том, что сумма коэффициентов при переменных D и D × EF равна нулю. P-значение для теста на соответствующее линейное ограничение равно 0,00001. Следовательно, эта гипотеза отвергается при любом разумном уровне значимости, и мы можем утверждать, что для выпускников данного экономического факультета посещение курсов значимо и положительно влияет на результат экзамена. 
Для абитуриента, не являющегося выпускником бакалавриата данного экономического факультета (подставим EF = 0), оцененное уравнение примет вид: 
^
Y = , + , D
2021973˛ .
ii 
То есть выпускник другого вуза или факультета, посетивший курсы, на экзамене получит в среднем на 19,73 балла больше, чем выпускник другого вуза или факультета, не посетивший курсы. 
Сравнение результатов оценивания уравнения регрессии по двум группам абитуриентов позволяет сделать вывод о различии в «надбавке знаний», полученной на курсах. Для студентов, являющихся выпускниками бакалавриата данного экономического факультета, «надбавка курсов», выраженная в баллах за вступительный экзамен, меньше на 14,2 балла (коэффициент при переменной D × EF) по сравнению с «надбавкой» для студентов иных вузов или факультетов. 
Провести тест Рамсея для данной спецификации не получится из-за совершенной мультиколлинеарности. Однако по всем доступным признакам эта спецификация является наиболее предпочтительной из рассмотренных вариантов. 
д . Результаты теста оценивания логарифмически-линейной модели представлены ниже: 
Модель 4: МНК, использованы наблюдения 1-150 Зависимая переменная: l_Y 
lnY =+˝ D + 090 ˝ EF − 0 57˝ D ˝ EF ;
300068 R = 083 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const D EF DEF  3,002980,6768680,896279−0,569789  0,03795420,04025650,03894020,0491596  79,1216,8123,02−11,59  <0,0001<0,0001<0,0001<0,0001  *** *** *** ***  
Сумма кв. остатков R2 F (3, 146)  1,0515800,828126234,4860  Ст. ошибка модели Испр. R2 Р-значение (F)  0,0848680,8245941,31e-55  
  2 

,,,, ,.
i 
i iii
(,) (,) (,) (,)004 004 004 005 
Отметим, что все коэффициенты в этой модели тоже статистически значимы на однопроцентном уровне. Сумма коэффициентов при переменных D и D × EF также статистически значимо отличается от нуля. 
Для абитуриента, являющегося выпускником бакалавриата данного экономического факультета (подставим EF = 1), оцененное уравнение примет вид: 
lnYi = , + 011˛ D ,  39 , i 
т.е. выпускник данного экономического факультета, посетивший курсы, напишет экзамен в среднем на (e0,11 – 1) · 100% = 12% лучше, чем выпускник данного экономического факультета, не посетивший курсы. 
Для абитуриента, не являющегося выпускником бакалавриата данного экономического факультета (подставим EF = 0), оцененное уравнение примет вид: 

lnY = , + , D ,
300068˛
ii 
т.е. выпускник не данного экономического факультета, посетивший курсы, на экзамене получит в среднем на (e0,68 – 1) · 100% = 97% больше баллов, чем такой же абитуриент, не посетивший курсы. 
Мы могли бы задаться вопросом о выборе лучшей из моделей, оцененных в пунктах (г) и (д), однако это бессмысленная работа, так как обе эти модели содержательно приводят к одному и тому же выводу: посещение курсов полезно для всех типов абитуриентов, однако для тех, кто не является выпускником данного факультета, польза значительно выше. В этом случае выбирать из двух моделей можно просто исходя из ваших предпочтений в интерпретации (нравится ли вам интерпретировать прирост баллов в абсолютном выражении или в процентах). 
Задание 8 . Спрос на товар Ф 
а . Функция спроса женщин на товар (d = 0): y =˛ +˛2 ln x +˝ .
i 1 ii 
4258 Тестируемая гипотеза H0: ˜=0. 8 =>,, т.е. гипотеза отверга
2 
2 
ется: изменение дохода оказывает статистически значимое влияние на 
потребление товара женщинами. 
Увеличение дохода на 1% меняет величину спроса на 0,08 кг. 
б . Функция спроса мужчин на товар (d = 1): 
y =˛ + (˛ +˛ )ln x +˝ .
i 1 23 ii 
Тестируемая гипотеза H0: ˜ +˜ = 0. Вычислим расчетное значе
23 
ние тестовой статистики: 
^^
˜ +˜ 86
−

23 == 04, < 258, . 
^^ 22
va( + 4 ˙ , ˜r˜ +˜ )2 + 225 
23 
Гипотеза не отвергается: изменение дохода не оказывает статистически значимого влияния на потребление товара мужчинами. 
в . Коэффициент VIF в данном случае определяется в результате оценки парной регрессии одной объясняющей переменной на вторую. Так как R2 в парной регрессии равен квадрату коэффициента корреляции между этими переменными, то R2 = 0,72 = 0,49. 
Следовательно, коэффициент VIF равен: 
1 
=196 1049− , ,. 
Он меньше 10, значит, можно сделать вывод о том, что существенной мультиколлинеарности в модели нет. 
Задание 9 . Спрос на товар N 
a . Функция спроса женщин на товар (d = 1): 
ln y =˛ + (˛ +˛ )ln x +˝ .
i 1 23 ii 
Тестируемая гипотеза H0: ˜ +˜ = 0 . Вычислим расчетное значе
23 
ние тестовой статистики: 
^^
˜ +˜ 10−11 1

23 = =− ;
˜ ^^22 3
var(˜ +˜ )1 +2 +22˙
23 
1
−<258
,.
3 
Гипотеза не отвергается: изменение дохода не оказывает статистически значимого влияния на потребление товара женщинами. 
б . Функция спроса мужчин на товар (d = 0): ln y =˛ +˛ ln x +˝ .
i 12 ii 
Тестируемая гипотеза H0: ˜=0. 10 =10 > 258
,, т.е. гипотеза отвер
2 
1 
гается: изменение дохода оказывает статистически значимое влияние 
на потребление товара мужчинами. 
Увеличение дохода на 1% делает величину спроса больше на 10%. 
в . Коэффициент VIF в данном случае определяется в результате оценки парной регрессии одной объясняющей переменной на вторую. Так как R2 в парной регрессии равен квадрату коэффициента корреляции между этими переменными, то R2 = 0,42 = 0,16. 
Следовательно, коэффициент VIF равен: 
1 
=12,.
1016
− , 
Он меньше 10, значит, можно сделать вывод о том, что существенной мультиколлинеарности в модели нет. 
Задание 10 . Сотрудники фирмы АВС 
^^ 
˜
а . y= 25 − 3˛ x, se() = 2. Расчетное значение статистики равно
ii 2 
(–1,5), гипотеза не отклоняется, следовательно, значимая связь отсутствует. (Выкладки аналогичны примерам из гл. 2.) б . В соответствии с результатами § 3.1 математическое ожидание оценки интересующего нас коэффициента в этом случае составит: 
˜
cov(xz,)
^
E˜ =˜ +˜ .
2 23 ° 
var()x 
По условию в фирме АВСмужчины и женщины в среднем имеют 
(
одинаковый уровень образования. Следовательно, cov xz,) = 0. . Поэ^ 
тому E˜2 =˜2, и оценка интересующего нас параметра не смещена. в . Если женщины имеют в среднем более высокий уровень образова
(,xz) > 0
ния, то cov . При этом по условию более образованные работни
ки в среднем получают более высокую заработную плату, чем менее обра
˜
cov(xz,)
зованные, т.е. ˜3 > 0. Поэтому ˜3 > 0. Отсюда получаем, что
° 
var()x ^
E˜ >˜ , и оценка интересующего нас параметра смещена и завышена.
22 
К ГЛАВЕ 5 
Задание 1 . Тест Уайта 
а . Чтобы провести тест Уайта, исследователю нужно оценить регрессию квадратов остатков исходного уравнения на сами регрессоры исходного уравнения, их квадраты и попарные произведения: 
2 ()1 ()2 ()3
e =˝ +˝˛ x +˝ ˛ x +˝ ˛ x +
i 01 i 2 i 3 i ()12 ()22 ()32
+˛ °(x ) +˛ °(x ) +˛ °(x ) +
4 i 5 i 6 i ()1 ()2 ()1 ()3 ()2 ()3
+˛ °(x ° x ) +˛ °(x ° x ) +˛ °(x ° x ) + u.
7 ii 8 ii 9 ii i 
Замечание: если регрессор является фиктивной переменной, то не нужно включать в оцениваемое уравнение регрессии его квадрат, так 
2
как для фиктивной переменной всегда верно равенство x = x.
ii 
б . В тесте Уайта проверяется следующая гипотеза: 
22 2
H :˜ =˜ =…=˜ =const.
01 2 n Тестовая статистика: nR˜ 2~ °2( p). Расчетное значение: nR 180 04581.
˜ 2 =˜ , = 
Критическое значение на уровне значимости 5%: &#15;2()9 = 16,92. 81 >16 92
,, следовательно, нулевая гипотеза отклоняется и в модели присутствует гетероскедастичность. 
Задание 2 . Взвешенный МНК а . Рассмотрим две модели: 
y=˝+˝ ˛ x+˙ ;
i 12 ii y 
1
i
=˝˛ +˝+ u.
12 i
xx
ii 
Второе уравнение получается с помощью деления обеих частей первого уравнения регрессии на xi. Тогда случайные ошибки этой новой 
° 
i
модели имеют вид u= . Следовательно:
i 
x
i 
22
°&#23;˙ °&#23;˙21 cx˘
ii 2 i 2
var(u)var ˝ ˇ= E˝ˇ= ˘&#23;= = c
= E() = const.
i 2 i 2
˛ xˆ˛ xˆ xx
iii i 
В модифицированной модели дисперсия случайной ошибки постоянна, а значит, гетероскедастичность отсутствует. 
б . Используя данные из условия, вычислим оценки взвешенного метода наименьших квадратов параметров ° 1 и ° 2. 
y °
1
* ii
Пусть y= ; z= ; u= . Тогда в новых обозначениях модель
i ii
xxx
iii 
*
принимает вид: y=˝ +˝˛ z+ u, а МНК-оценки коэффициентов
i 21 ii 
равны: 
** 
yz˝− yz˝
^ ^^
*
˜= , ˜= y−˜ ˝ z.
1 21
22
z− ()z 
yi  xi  y* iy= i xi  1 z= i xi  yz* &#14;i i  2zi  
1  1  1  1  1  1  1  
2  1  1  1  1  1  1  
3  1,5  0,5  3  2  6  4  
4  1,5  0,5  3  2  6  4  
5  1  0,25  4  4  16  16  
Сумма  12  10  30  26  
Среднее  2,4  2  6  5,2  

Тогда МНК-оценки в модифицированной модели равны: 
−,
6242˝
^^
˜= =1; ˜=, −˝ =
241 204,.
12
2
52, −2 
Оцененное модифицированное уравнение регрессии имеет вид: 
^* 
yi = 04, + zi. 
Возвращаясь к исходным обозначениям, получаем: 
^ 
y =+, x
104 ˛ .
ii 
^
Ответ: yi =+, xi104 ˛ . 
Задание 3 . О пользе тренингов 
а . 
Модель 1: МНК, использованы наблюдения 1-2000 Зависимая переменная: sales Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
const trainingfemaleexperiencecapitalIQ −24,3731 18,8678 0,392756 5,30055 3,29574 1,72884  6,70733 1,81762 1,758490,5695461,609320,0647299  −3,63410,38 0,2233 9,307 2,04826,71  0,0003 <0,0001 0,8233 <0,0001 0,0407 <0,0001  *** *** *** ** ***  

Сумма кв. остатков 2574369 Ст. ошибка модели 35,93129 R2 0,319723 Испр. R2 0,318017 F (5, 1994) 180,6451 Р-значение (F) 7,0e-159 
Уравнение в целом значимо, так как соответствующее P-значение (F) меньше, чем 0,05. Все переменные, кроме переменной female, при 5%-м уровне также значимы. 
Прохождение тренинга увеличивает объем продаж менеджера в среднем при прочих равных условиях на 18,9 тыс. руб. за период. 
б . 
Модель 2: МНК, использованы наблюдения 1-2000 Зависимая переменная: sales Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const −22,3146 6,67966 −3,341 0,0009 *** training 15,6526 2,46556 6,349 <0,0001 *** female 0,339034 1,75748 0,1929 0,8470 experience 5,31764 0,568830 9,348 <0,0001 *** IQ 1,72363 0,0647424 26,62 <0,0001 *** training×capital 6,44380 3,12531 2,062 0,0394 ** 
Сумма кв. остатков 2573304 Ст. ошибка модели 35,92386 R2 0,320004 Испр. R2 0,318299 F (5, 1994) 181,3970 Р-значение (F) 1,9e-159 
Снова в модели значимы все переменные, кроме female. Для менеджера не из столицы прохождение тренинга в среднем при прочих равных условиях увеличивает объем продаж на 15,7 тыс. руб. за период. А для менеджера из столицы — на (15,7 + 6,4) = 22,1 тыс. руб. 
в . Результаты тестов приведены в таблице ниже. В обеих моделях каждый из тестов указывает на наличие гетероскедастичности в модели. 
Тест Уайта  Тест Бреуша — Пагана  
Модель (а)  Тестовая статистика: n · R2 = 74,31; P-значение = 0,000000  Тестовая статистика: 78,34; P-значение = 0,000000  
Модель (б)  Тестовая статистика: n · R2 = 73,33; P-значение = 0,000000  Тестовая статистика: LM = 78,66; P-значение = 0,000000  

Задание 4 . О пользе тренингов (продолжение) 
а . 
Модель 3: МНК, использованы наблюдения 1-2000 Зависимая переменная: l_sales Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка t-статистика  P-значение  
const  3,96789  0,0423912  93,60  <0,0001  ***  
training  0,106850  0,00988053  10,81  <0,0001  ***  
female  0,00430117  0,0100226  0,4291  0,6679  
experience  0,0318566  0,00333978  9,539  <0,0001  ***  
capital  0,0220084  0,00924573  2,380  0,0174  **  
IQ  0,0100775  0,000380241  26,50  <0,0001  ***  

Сумма кв. остатков 85,52455 Ст. ошибка модели 0,207101 R2 0,324542 Испр. R2 0,322849 F (5, 1994) 169,7457 Р-значение (F) 1,1e-150 
Уравнение в целом значимо, так как соответствующее P-значение (F) меньше, чем 0,05. Все переменные, кроме переменной female, на 5%-м уровне также значимы. 
Прохождение тренинга увеличивает объем продаж менеджера в среднем при прочих равных условиях на (e0,107 – 1) · 100% = 11%. 
б . 
Модель 4: МНК, использованы наблюдения 1-2000 Зависимая переменная: l_sales Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 3,98128 0,0418804 95,06 <0,0001 *** training 0,0874891 0,0133756 6,541 <0,0001 *** female 0,00399624 0,0100202 0,3988 0,6901 experience 0,0319771 0,00334259 9,567 <0,0001 *** IQ 0,0100459 0,000380340 26,41 <0,0001 *** Training × capital 0,0390130 0,0163035 2,393 0,0168 ** 
Сумма кв. остатков 85,52848 Ст. ошибка модели 0,207106 R2 0,324511 Испр. R2 0,322818 F (5, 1994) 171,9623 Р-значение (F) 2,3e-152 
Снова в модели значимы все переменные, кроме female. Для менеджера не из столицы прохождение тренинга в среднем при прочих равных условиях увеличивает объем продаж на 9%, а для менеджера из столицы — на (e0,087+0,039 – 1) · 100% = 13%. 
в . Результаты тестов приведены в таблице ниже. По сравнению с результатами предыдущей задачи в данном случае гетероскедастичность выражена гораздо менее ярко. В частности, тест Уайта в обеих моделях не отвергает гипотезу о гомоскедастичности при любом разумном уровне значимости. А тест Бреуша — Пагана не отвергает ее в последней модели при уровне значимости 1% (так как соответствующее P-значение равно 0,013, что больше, чем 0,01). 
Тест Уайта  Тест Бреуша — Пагана  
Модель (а)  Тестовая статистика: n · R2 = 20,25; P-значение = 0,262  Тестовая статистика: 19,94; P-значение = 0,003  
Модель (б)  Тестовая статистика: n · R2 = 15,43; P-значение = 0,493  Тестовая статистика: 14,37; P-значение = 0,013  

Задание 5 . О сельском хозяйстве 
а . Разделим правую и левую части уравнения из примера 5.1 на переменную LABOUR. В этом случае зависимая переменная PRODP превратится в переменную PRODP/LABOUR, регрессор FUNG1 превратится в FUNG1/LABOUR и т.д. В частности, переменная трудозатрат LABOUR из исходного уравнения будет константой (LABOUR/LABOUR = 1), а константа из исходного уравнения станет переменной 1/LABOUR. 
Результаты оценивания нового уравнения представлены в таблице ниже. 
Модель 1: МНК, использованы наблюдения 1-200 Зависимая переменная: PRODP/LABOUR 
Коэффициент Ст. ошибка t-статистика P-значение const 0,0424811 0,00281702 15,08 <0,0001 *** FUNG1/LABOUR 0,0565558 0,0452629 1,249 0,2130 FUNG2/LABOUR 0,0629782 0,0466643 1,350 0,1787 GIRB/LABOUR 0,0654744 0,0472559 1,386 0,1675 INSEC/LABOUR 0,0805226 0,0473590 1,700 0,0907 * YDOB1/LABOUR 0,0293886 0,0244971 1,200 0,2317 YDOB2/LABOUR −0,0540951 0,0246134 −2,198 0,0292 ** 1/LABOUR −39,2084 6,43039 −6,097 <0,0001 *** 
Сумма кв. остатков 0,020781 Ст. ошибка модели 0,010404 R2 0,722694 Испр. R2 0,712584 F (7, 192) 71,48245 Р-значение (F) 4,26e-50 
б . Как было указано выше, трудозатратам (переменная LABOUR в исходной модели) в новой модели соответствует константа. Согласно нашим результатам, при прочих равных условиях увеличение трудозатрат на 1 руб. приводит к увеличению продуктивности на примерно на 0,042 тыс. руб. (т.е. на 42 руб.). 
в . Тестовая статистика теста Уайта составляет n · R2 = 21,63, а P-значение равно 0,96. Следовательно, можно заключить, что в новой модели гетероскедастичность отсутствует. Иными словами, применение взвешенного метода наименьших квадратов привело к требуемому результату. 
Задание 6 . Взвешенный МНК в регрессии на константу 
а . Сначала вычислим МНК-оценку коэффициента ° : 
˜( yi −˝^)2 ˛ min. 
Берем производную по оцениваемому параметру: 
^
−°yi −˝) =0;
2( 
˜ y = n˛˝^;
i 
^
˜= y.
ÌÍÊ 
Покажем, что эта оценка является несмещенной. 
˝˛yˇ E(˜^) =Ey() =Ei =&#22;1 E(˛y) =
ÌÍÊ ˆ˙n &#23;˘ni 
11
=° ˛+i)) =°Enˆ˛ˇi) ={ − } =
E((ˆˇ ( °+ ˆíå˛ñëó÷àéíàÿ˛âåëè÷èíà 
nn 
11
=+˛ ˝( ˆ) =+˛˝˙ Eˆ=Eˆ) =0 =
˙ E (){( } ˙.
i ii
nn 
^
E(˜ÌÍÊ ) =˜, следовательно, МНК-оценка является несмещенной. Найдем дисперсию этой оценки: 
2
˝&#22;y ˇ
^ ^ ^2^2 i
var(˜ÌÍÊ ) = E(˜ÌÍÊ − E(˜ÌÍÊ )) = E(˜ÌÍÊ −˜) = Eˆ˙ n −˜&#23;˘ = 
22
˝&#19;( +) ˇ ˝&#19;&#17; ˇ 12
&#18;&#17;
ii
=E −&#18; =E&#18;+ −&#18;=&#22;E &#17;=
ˆ &#23;ˆ &#23; (&#19;)
2 i
˙ n ˘˙ n ˘ n 
˝ ˇ˝ ˝ˇˇ 
22
=°Eˆ &#18;+ &#18;&#18;° &#23;= °ˆE &#18;+Eˆ &#18;&#18;° &#23;&#23;= 
1 &#20; &#20;&#20;ij 1 (&#20;) &#20;&#20;ij
n2 ˆ i &#23; n2 ˆ i ˆ &#23;&#23;
˙ ij&#19;˘ ˙ ij ˘˘
˙&#19; 
˝ ˇ&#22; E(&#18;&#18;) =0 &#14;&#17;2 °x
1 &#16; ij &#16;&#20;
()2 (&#18;&#18; &#21; i
= °ˆ&#20;E&#18;i +&#20;&#20;Ei ° j)&#23;= == 
2 222
ˆ &#23;&#16;E() =&#17; °
n &#18; x&#16; n
˙ ij ˘ i
&#19;&#15; i 
2
˝˛xi ˝2 ° x 
== .
2
nn 
б . Чтобы найти оценку взвешенного метода наименьших квадратов, поделим обе части уравнения регрессии на 
yi 1 ˙i=°˝ 
+ 
. 
x xx
i ii 


y 1 ° 
* ii
Обозначим y= 
; z= 
; u= 
. Тогда модель примет вид:
i ii 
xxx
iii 
* 
y=°˝z+u;
i ii 

 2
° ** ˝ *^ 2
y− y = (y− &#22;ˇ z) ˘ min;
&#23;˛ ii˙&#23; ii 
&#22; 
^*
− z°(y− ˙° z) = 0;
2˝ ii i 
&#21; 
*^ 2
˝zy˜ −˙˝z= 0;
ii i 
1 yi y
˝˛ i 
* ˝ 
zy˛ x
^ ˝ ii i 
&#22; 
˜== = .
ÂÌÍÊ ˝ i
z2 11
˝˝ 
&#21; 
xx
ii 
Покажем, что эта оценка является несмещенной: 
yiˇ ˝˜°iˇ
˝+ ˆ&#21;&#23;ˆ&#21; &#23; 
^ ˆ xi&#23;ˆ xi &#23;
E(˜ ) =E =E =
ÂÌÍÊ 
ˆ 1 &#23;ˆ 1 &#23; 
&#22; 
ˆ&#21;&#23;ˆ&#21; &#23;
ˆ x&#23;ˆ x &#23; 
&#21; 
= {x− äåòåðìèíèðîâàííûé&#19;ðåãðåðññîð} = 
&#21;
˝+i ˝ ˝&#20;i
&#21;&#20;ˇ ˇˇ 


˙
˘˙˘ii 111 &#20; 
=°Eˆ&#22; &#23;= °ˆ&#21;&#22;+Eˆ&#22;&#23;&#23;= 
1 ˙ xi ˘&#22;1 
˙ xi ˙ xi˘˘
&#22;xx
ii 
1 ()=+˙ ˛ Eˆi=Eˆ) =0 =˙.
˝ {( }
i˝1 xx
i i 
^
E(˜ÂÌÍÊ ) =˜, следовательно, оценка взвешенного МНК является несмещенной. Вычислим дисперсию этой оценки: 
^ ^ ^2^ ^2
var(˜ ) = E(˜− E(˜ )) = E(˜ −˜) =
ÂÌÍÊ ÂÌÍÊ ÂÌÍÊ ÂÌÍÊ 
˛ zy&#23;* ˆ˛ z&#23;( &#23;+ ˆ
&#21; 2 &#21;&#20;zu)2 
ii iii
=E˙ −&#20;˘=E˙ −&#20;˘= 
˙ z2 ˘˙ z2 ˘
˝&#21;i ˇ ˝&#21;i ˇ 
2
z zu zu
iii iii 
2 
2 
2
˝
ˇ
˝
ˇ
˝
ˇ 
&#21; 
+ 
z
2 
i 
−
&#20; 
zu
i
&#20;
+ 
−
&#20;
=
E
=
E
=
E
ˆˆ˙ 
&#23;&#23;˘ 
ˆˆ˙ 
&#23;&#23;˘ 
ˆˆ˙ 
&#23;&#23;˘ 
= 
&#21;
z
2 
i
&#21;
2 
i
z 
12
=−z } = E ˙
{ äåòåðìèíèðîâàííûé&#19;ðåãðåññîð zu = 
22 (ˆii)(ˆzi) 
˙˘ 
22
zu &#18;&#18;&#22;=
= Eˇ &#21;+ zz&#21; &#21;&#21;
1 &#20;ii &#20;&#20;i ji j
22 ˇ &#19;&#22;
ˆ ij &#23;

(&#20;z)
i 
zE˙ u2 ˆˆˇ ˙ j˙ (˘˘ij)
2 zz E
ˆi () iji = i +={(E˘˘ij) =0} = 22 22
(ˆzi) (ˆzi) 
˙&#20;2 ˘ &#21; 1 ˝Eˇ&#21; 1 ˝&#20;i 2 
2 xi&#22; E()&#21;zE˝ ()u2 xi ˆˇ i&#23;&#22; x2 
ii i
== == 
22 22 
z ˙˘ ˙˘
(&#21; i) 1 &#21; 1 
ˇ&#21;&#22; ˇ&#22;
ˆ x&#23;ˆ x&#23;
ii 
12 21
&#23; °&#22;° x &#22;° 
2 i &#23; 
xx 2
&#22;
ii
= == .
2 21
˛ˆ ˛ˆ
11 &#23;
˙&#23;˘ ˙&#23;˘ xi
˝ xˇ˝ xˇ
ii 
°2 ˝ x °2
^^ 
в . Сравним var(˜ ) = и var(˜ ) = ;
ÌÍÊ ÌÍÊ
n 1
˝ 
x
i 
2
°˝ x 
^
var(˜ ) 11
ÌÍÊ n
== x˝ . °2 ˙ x ˙ in2 
var(˜^) i 
ÌÍÊ 
˙ 1 
x
i 
Это выражение всегда больше либо равно единице (доказательство см. далее). Поэтому дисперсия оценки взвешенного МНК всегда меньше либо равна дисперсии МНК-оценки. Следовательно, оценка взвешенного МНК эффективна (что неудивительно, ведь мы находимся в условиях гетероскедастичности). 
Осталось доказать, что: 
˜ 1 x° 1 ˛1; 
x ˜ i 2
n
i 
2
˜ 1 ˜xi ° n. 
x
i 
Это неравенство непосредственно следует из неравенства Коши – Буняковского. Если вы его помните, то можете воспользоваться им сразу. Мы же просто докажем его для нашего случая. 
Для этого отметим, что для любого tочевидно верно неравенство: 
2
˛ˆ 
&#22;˙ 
xt˜− 
1 ˘&#23;0. ˙ ix˘
˝ iˇ 
Раскрыв скобки, получаем: 
2
˙xt˜−2nt˜+˙1 ˝0.
i 
x
i 
Это квадратное неравенство относительно t всегда верно, значит, соответствующий дискриминант всегда меньше либо равен нулю. Запишем этот дискриминант (деленный на 4): 
D 1 
=n2 −˝˝xi˛0;
4 x
i 
1
˜˜i °2
xn. 
x
i 
Задание 7 . Взвешенный МНК в регрессии без константы а . Вычислим МНК-оценку коэффициента ° в модели: 
y=°˝x+˙;
i ii 
˝( y−°˙^ x)2 ˛min.
ii 
Возьмем производную по оцениваемому параметру: 
^
−2˝x°( y−°˙x) =0;
ii i 
^ 
xy˜= x2;
˛ ii ˝˛ i 
˝xy˛
^ ii
˜= .
ÌÍÊ ˝ 2xi Покажем, что эта оценка является несмещенной: ˝ˇ˝ˇ˝ˇ&#20;&#20;&#20;&#22;(˜&#22;+°)&#22;&#22;°xyxxx^ iiiiiii(˜ ) ˜EEEEˆ&#23;ˆ&#23;ˆ&#23;+====ÌÍÊ ˆ&#23;ˆ&#23;ˆ&#23;222&#20;&#20;&#20;˙˘˙˘˙˘xxxiii ) 
xE&#19; =˝ ˇ=&#23; ii=E&#19;) =} =&#23;. 
˛ &#23;−íåñëó÷àéíàÿ&#22;âåëè÷èíà ˆ &#20;&#21;()
=+ {( 0 
˙x−äåòåðìèíèðîâàííûé&#22;ðåãðåññîð˘&#20;xi 2 i 
^
E(˜ÌÍÊ ) =˜, следовательно, МНК-оценка является несмещенной. Найдем дисперсию этой оценки: 
^^^ ^
var(˜ÌÍÊ ) = E(˜ÌÍÊ − E(˜ÌÍÊ ))2 = E(˜ÌÍÊ −˜)2 = 
22˛ xy&#23; ˆ˛ x&#23;(&#20;&#23;+x &#19;) ˆ
&#21;ii &#21;i ii
=E˙ −&#20;˘=E˙ −&#20;˘= 
˙ x2 ˘˙ x2 ˘
˝&#21;i ˇ ˝&#21;i ˇ 
2 
=
&#17;
&#20;
x
ii 
&#23; &#21;= &#21;
&#22; 
= 
a&#20;xi 4 
2. 
n 
&#19;
) xxE 
ˆ&#23; = 1 ˝E˘&#20;x2 ˝&#18;2 +&#20;&#20;xx˝ ˝˝ &#21;=
&#18;&#18;
ii ijij
22 ˘ &#19;&#21;
ˇ ij &#22;
(&#20;xi) 
ˆˆ &#23;
1 
22 
&#18;&#18;
= ˝˘E(&#20;x˝&#18;)+E˘&#20;&#20;xx˝ ˝˝ &#21;
ii ijij
22 ˘˘ &#21;
ˇ ij
ˇ&#19; &#22;

(&#20;x)
i 
ˆ&#23;
1 
22
= ˝˘ xE˝ ()&#18;+ ˝˝ (&#18;&#18; )&#21;
&#20;ii &#20;&#20;ij ij
22 ˘&#21;
ij
x ˇ &#19;&#22;

(&#20;i) 
˛ E(&#19;&#19; ) =0 ˇ ax° 4 ax4
˙ ij ˙&#20; i &#20;i 2
= === x=n=˝˘ {&#20;i }
22
˙E() =°x˙ 22 22&#19; a
ˆ ii&#23; (&#20;xi) (&#20;xi) 
(
E
1 
22 
x
i 
2 
2 
i
x 
E
E 
+ 
− 
i
x 
&#20; 
&#19;
( 
= 
ˇ 
&#23;&#23;˘ 
&#17;
&#20;
ii 
2
&#19; &#19;
x
˝ 
ˆˆ˙ 
= 
ˇ 
&#23;&#23;˘ 
&#18; 
&#17;
&#20;
ii 
2
&#19; &#19;
x 
&#18; 
˝ 
ˆˆ˙ 
= 
б . Чтобы найти оценку взвешенного метода наименьших квадратов, поделим обе части уравнения регрессии на xi: 
yi ˝i=+ .
˛ 
xx
ii 
y ° 
* ii
Обозначим yi = ; ui = . Тогда модель примет вид: 
xx
ii y * =+u
i ˛ i ; 
 2
° ** ˝ *^ 
y − y = ( y −&#23;)2 ˇ min;
˘˛ ii ˙˘ i 
^*
−2˛( yi −˝) = 0; 
^
*
˜y −˛=n ˙ 0;
i 
* ˛ yi 
yx
^ ˛ ii
˜ == .
ÂÌÍÊ 
nn 
Покажем, что эта оценка является несмещенной: 
y ˇ ˝˜x˝ &#22;+°ˇ
i ii
ˆ&#20;&#23;ˆ&#20; &#23;
xx 1 ˝˜x
&#22;+°ˇ
^ ˆ i &#23;ˆ i &#23; ii
E(˜ ) =E =E =&#22;E =
ÂÌÍÊ ˆn &#23;ˆ n &#23;n ˆ&#20; x &#23;
˙˘
i
ˆ&#23;ˆ &#23;
ˆ&#23;ˆ &#23;
˙˘˙ ˘ 
1 ˝ &#20;ˇˇ 1 E()
˝ i &#20;i
=°ˆn°+&#21;E ˆ&#22;&#23;=+°&#22; =E &#20;) =0} =&#21;
&#23;&#21; {( i . 
˙ x ˘˘ nx
n ˙ ii 
^
E(˜ÂÌÍÊ ) =˜, следовательно, оценка взвешенного МНК является несмещенной. 
Вычислим дисперсию этой оценки: 
^ ^ ^2^2
var(˜ ) = E(˜− E(˜ )) = E(˜ −˜) =
ÂÌÍÊ ÂÌÍÊ ÂÌÍÊ ÂÌÍÊ 
2 22
˛ y ˆ ˛&#20;&#23;+&#19;ˆ ˛ &#19;ˆ
x
iii i
˙&#21;˘˙&#21; ˘˙&#21;˘
xx xi
˙ i ˘˙ i ˘˙ ˘
=E −&#20;=E −&#20;=E &#20;+ −&#20;= 
˙˘˙ ˘˙˘
nn n
˙˘˙ ˘˙˘
˙˘˙ ˘˙˘
˝ˇ˝ ˇ˝ˇ 
2 
2 
2
˙
° 
°
° 
˙
&#23; 
° 
ˆ2 E(ˆˆ )
1 E() 1 ij
= °˛ i + °˛˛ = Eˆˆ ) =0 =
{( }
2 22 xx° ij
n xn
i ij˙ ij 
1 E()2 1 ° 2 a = °˛˝i = °˛axi= .
2 222 
nn xnx
ii 
4
ax
^ ˛ ia
в . Сравним var(˜ ) = è var(˜^) = :
ÌÍÊ ÌÍÊ
2
nn 
^4
var(˜ÌÍÊ ) ˛xi
= . 
n
^
var(˜ )
ÌÍÊ 
x
°n 2 ˛ i 4 
С учетом того, что по условию задачи x= n, выражение
i=1 i 
n 
всегда больше либо равно единице (доказательство см. далее). Поэтому дисперсия оценки взвешенного всегда меньше либо равна дисперсии МНК-оценки. Следовательно, оценка взвешенного МНК более эффективна (что неудивительно, ведь мы находимся в условиях гетероскедастичности). 
Осталось доказать, что: 
˜xi 4 °1. 
n 
Это неравенство непосредственно следует из неравенства Коши – Буняковского. Мы докажем его для нашего случая. 
Для этого отметим, что для любого tочевидно верно неравенство: 
2
2
˝(xt˜−1) ˛0.
i 
Раскрыв скобки, получаем: 
42 2
xt˜− 2 xtn˜+ ˝ 0.

˙ i ˙ i 
E 
i 
j j 
1 
2
n 
E
2
n 
1
E 
i 
n 
=
ˇ ˇˆ 
&#22;&#22;
i
xx
i 
˘
+&#23;&#23; 
ij
&#20; 
˙ 
ˇˆ 
i x 
&#22; 
˝˛
&#23;
˝ ˝˛ 
˙ 
˘
=
ˇˆ 
i x
i 
&#22;
&#23;
˝˛ 
˘
= 
ˇ ˇ ˇ ˇˇˆ 
i x 
&#22; 
˝ ˝ ˝ ˝˝˛ 
= 
Это квадратное неравенство относительно t всегда верно, значит, соответствующий дискриминант всегда меньше либо равен нулю. Запишем этот дискриминант (деленный на 4): 
D 22 
= x − nx4 ˙ 0;
4 (ˆ i)ˆ i 
D 
= n2 − nx4 ˛ 0;
4 ˝ i ˜xi 4 ° n. 
Задание 8 . Взвешенный МНК 
Делаем замену аналогично подходу, рассмотренному в задании 2: 
y
* i
y= ;
i 025
,
x
i x
* i 075 
x== x,;
i 025 i
,
x
i 
* ** 
y=˛x+˝ ,
i ii 
По формуле оценки коэффициента в регрессии без константы (см. вторую главу) имеем: 
** 
xy
 ˛ ii .
˜=
˛x *2
()i 
Подставив выражения для y* и x*, получим: 
05,
˛xy
ii
 .
˜= 
15,
˛xi 
Задание 9 . Взвешенный МНК 
Делаем замену аналогично подходу, рассмотренному в задании 2: 
y
* i
y= ;
iz05, i 
x
* i
x= ;
iz05, i 
* ** 
y=˛x+˝ ,
i ii 
По формуле оценки коэффициента в регрессии без константы (см. вторую главу) имеем: 
** 
xy
 ˛ ii
˜= .
˛xi *2
() 
Подставив выражения для y* и x*, получим: 

˜= 
xy ˝xz ˝iii 
2 
ii 
−1
z 
−1 
. 
Задание 10 . Ковариационная матрица ОМНК-оценки вектора коэффициентов: 
˜^* −1 −1 −1 −1 −1 −1
V() =VXˇ X) Xˇ ] = [( ˇ X) Xˇ (X˜+ =
[( ˝˝ y VX˝ ˝°)] 
−1 −1 −1 −1 −1 −1 −1 −1 −1
[(
=VX°˝ X) X°˝ ˙] = (X°˝ X) X°˝ V[]˙ ((X°˝ X) X°˝ )°= −1 −1 −1 −1 −1 −1
= (X°˝ X) X°˝ ˝((X°˝ X) X°˝ )°= −1 −1 −1 −1 −1 −1 −1
= (X°˝ X) X˝ ( °˝ X) = (X°˝
° XX X). 
К ГЛАВЕ 6 
Задание 1 . Разминка с условными матожиданиями 
а . Eyi=+˛−˛=15238 −13. 
б . Eyx| =4)1 54 316 =
( =+˙−˙ −27.
ii в . Eyx)15 x 3 x2 +E(˙| x)15 x 2
(| =+˛−˛ =+˛−˛3 x.
ii iiii ii 
Задание 2 . Матожидания в разных моделях: 
y=˝+˝ ˛ x+˙ .
i 12 ii а . Ey( − y) = E(˙+˙ ˝ x +ˆ −˙−˙˝ x −ˆ ) = 
98 1 2991288 =˝ (() − ()) + E˙− E() = =˝(() −()) +−=0.
Ex Ex () ˙ Ex Ex 00
298 982 ii б . Ey( − y) = E(˙+˙ ˝ x +ˆ −˙−˙˝ x −ˆ ) = 
98 12991288 =˝ (x − x) + E˙− E() == (x − x).
() ˙
298 9 8 ˛29 8 в . Ey − yx| x
( ,) = 
9 889 = E(˙+˙ ˝ x +ˆ −˙−˙˝ x −ˆ | x, x) = 
1 2991 28889 =˝(( | xx,) −(| xx ) +−== (x −
Ex Ex ,) 00 x).
2 989 889 ˛29 8 
Задание 3 . Опыт работы и доход а. P-значение равно: 
˛ 
˙
2˜&#22;−
˙ 
˝ 
^
&#21;
j 
^ 
se(&#21;j ) 
ˆ 
˛0 3218, ˆ
=˜2 &#22;− 2 (, =, 
˘ =˜&#22;−6177) 6610˜−10.
˘˙ ˘
˝0 0521, ˇ
ˇ 
Так как P-значение меньше одной сотой и пяти сотых, то соответствующий коэффициент является значимым и при 1%-м, и тем более при 5%-м уровнях значимости. Следовательно, женщины при прочих равных в среднем имеют более низкий доход, чем мужчины. 
б . P-значение равно: 

˛ 2˜&#22;−
˙ ˝ 
^
&#21;−c
j 
^ 
se(&#21;)
j 
ˆ ˛ 
ˆ
−0 3218−−02,)
,(
=˜2 &#22;− 
=2˜− ) =0 019.
&#22;(,2 337 ,
˘˙ 
˘
0 0521
,
˝ 
ˇ
ˇ 
Так как P-значение больше одной сотой, то гипотеза не может быть отвергнута при уровне значимости 1%. В то же время гипотеза отвергается при уровне значимости 5%, так как P-значение меньше, чем 0,05. 
в . Асимптотический доверительный интервал имеет вид: 
^^ ^^
(˜− se(˜ )˛25,,8 ˜+ se(˜ )˛2,58)
jj jj 
(− , − , ° ,, − , + , ° ,)
03218 00521 258 03218 00521 258 (− ,, − ,)
046 019 
Задание 4 . Опыт работы и доход (продолжение) 
а . По формуле вершины параболы находим: 
−0 0818
, =17 78 (лет).
2 °−(,0 0023) , 
б . Сформулируем интересующую нас гипотезу в терминах коэффициентов модели: 
˝
2
−= 20.
2 °˝
3 
Представим это выражение в виде линейного ограничения на параметры модели: 
˜+ 40 ˛˜ = 0.
23 
Теперь можно вычислить расчетное значение тестовой статистики: 
^^ ^^
°+°−˙0 ˙+°˙
1 ˙40 40
23 23
== =
t÷ 

^^ ^^ 
se(1°+°˙2 40 ˙3) 
var(˙+40°˙)
23 
, −40 ˛0 0023 ,
0 0818 , 0 0102 
= 
=− =−113,.
2 ,0
22 −5 0 009
00297 240310˛˛
, +40 ˛0 0010, −˛ 
Расчетное значение тестовой статистики по модулю меньше, чем 1,96. Следовательно, гипотеза не отвергается. 
Аналогичный вывод можно получить, используя P-значение, которое равно: 2 ˜˙(,−1 13) = 0260 05, > ,. 
Задание 5 . 
1331
а . E()˜=i −˝+˝−˝ +˝111 =0. ˝
1 Предпосылка E()i выполняется.
8888 Чтобы показать, что предпосылка E˜ix) = 0 не выполняется, до
(| i статочно привести любое значение xi, для которого указанное равенство нарушено. Рассмотрим, например, случай xi = 0: 
1 31
(| i 0 ˝+˝=.
E˜ix=) =−11 
4 42 
Следовательно, предпосылка E(|˜ ) = 0 не выполняется — регрес
i xi 
сор в модели является эндогенным. 
б . 
cov xy cov( , ) cov(x,°˜x+˛) cov(x, ˛˜(, ) p xy + )
^ ii iii ii
˜=˙ˆ = =+
˙˜ .
°
OLS var()x var()i var()i var xi
xx () 
Вычислим cov(x, ˝ ) и var(xi):
ii 
cov(x, ˜ ) = ( − ( ))(˜− E()) = Ex− 05 ˜− 0) =
Ex Ex ˜ ( ,)(
iiiiii i i 
1 331
˛− + 0051 105 ˛−+) 1051,)˛=
= (005−,)(1) ( −,)˛+ ( −,)(1 ( − 
8 888 1331 
= − − + =−025
,.
16 16 16 16 
Здесь и далее то же самое можно подсчитать короче, используя другую формулу ковариации: 
˙31 ˘
cov(x, ˜) = ( ˜) − ( )(˜) =−+ −=−,
Ex ExE 0 0 25;
ii iiii ˇ&#22;
ˆ88 &#23; 
var(x) = Ex( − Ex( ))2 = 
i ii 
1 3 31
2 222
= (005− ,) + ( − ,) + 105− ,) + ( − ,) = 0 25
005 ( 105,.
8 8 88 
Окончательно получаем, что: 
cov(x, °) −025,
^ p ii
˜ ˛˝˜ =+ ˜1
˛+ ˜=−.
OLS 
var()i ,x 025 
МНК-оценка является несостоятельной. Что вполне ожидаемо, учитывая эндогенность регрессора. 
в . Поскольку МНК не позволяет состоятельно оценить интересующий нас параметр, то нужно придумать что-то альтернативное. К счастью, в данном случае это нетрудно сделать, так как мы знаем константу, на которую завышена МНК-оценка. Поэтому достаточно просто ее скорректировать соответствующим образом: 
˜
cov(xy,)
^^
˜ =˜ +1 =+1.
new OLS 
° 
var()x 
На практике, впрочем, про распределение случайной ошибки известно гораздо меньше, чем в этом примере. Поэтому для получения состоятельных оценок в условиях эндогенности регрессора обычно используются другие подходы, например, метод инструментальных переменных, который рассматривается в одной из следующих глав. 
Задание 6 . 
^OLS
а . Формула МНК-оценки ° в модели парной регрессии
2 y =˝+˝ ˛ x+ u может быть записана следующим образом:
i 12 ii 
(x− x)˝(y− y)
1 ˙ni i
^OLS i 1
n = 
˜= = 
2 
1 n 
(x− x)2 
n˙i=1 i 
(x− x)˛(ˆ+ˆ ˛ x+ u−ˆ−ˆ˛ −
xu)
1 ˙in =1 i 12 ii 12
n
== 
1 n (x− x)2 
n˙i=1 i 
− x)˛( ˛ x−ˆ˛ +
(x ˆ xu− u)
1 ˙ni 2 i 2 i
i=1
n
== 
1 n
(x− x)2 
n˙i=1 i (x− x)˛(ˆ˛(x− x) + u− u)
1 ˙in =1 i 2 ii
n
== 
1 n
(x− x)2 
n˙i=1 i 1 n 1 n
˝ (x− x)2 + (x− x)˝(u− u)
ˆ2 ˙i=1 i ˙i=1 ii
nn
== 
1 n(x− x)2 
n˙i=1 i 1 ˇn(x−x)(˝ ui−u) cov(xu)
i ,
ni=1 p ii
=˘+ ˙˘+ .
˙ˆ
21 n 22
2 &#23;
(x−x) x 
nˇi=1 i Но поскольку по условию cov(xu,) > 0, а ˜2 ° 0, то
ii x OLS p cov(xu,)
^ ii
˜ ˛˝˜ + >˜ .
˛
2 222
° 
x 
Оценка не является состоятельной. Более того, в данном случае можно сказать, что она завышена. 
б . 
n
(z− z)˝(y− y)
 ˙i=1 ii 
==
˜2 
n
(z− z)˝(x− x)
˙i=1 ii n
(z− z)˛(ˆ+ˆ ˛ x+ u−ˆ−ˆ ˛ xu− )
˙i=1 i 12 ii 12 
== 
n
(z− z)(˛ x− x)
˙i=1 ii 
n 
− z)˛( ˛ x−ˆ˛ +
(z ˆ xu− u)
˙i=1 i 2 i 2 i 
== 
n
(z− z)(˛ x− x)
˙i=1 ii 
n
(z− z)˛(ˆ˛(x− x) +(u− u))
˙i=1 i 2 ii 
== 
n
(z− z)(˛ x− x)
˙i=1 ii nn
(z− z)(˛ x− x) + (z− z)˛(u− u) =
ˆ2 ˙i=1 ii ˙i=1 ii 
= 
n
(z− z)(˛ x− x)
˙i=1 ii n
˛(z−z)(˙ u−u) cov(zu,)
˛i=1 i ip ii
=˘+ ˆ˘+ = 
2 n ˆˇ 2 cov( ,)
c zx
(z−z)(˙ x−x) ii
˛i=1 ii 
˛˙˝ 
ˇ˙˘
˙&#23; 
=
&#22;2. 
(,ii)
zu 
0˜ïî˜óñëîâèþ
cov cov( ) 
= 
= 
°
0˜ïî˜óñëîâèþ
˙ˆ
,
zx
ii 
p
°
Следовательно, ˜ °˛˜ , и оценка ° 2 является состоятельной.
22 
Задание 7 . а . Известно, что в векторно-матричной форме верно равенство: 
^ T −1 TT −1 T
˜= (XX) . Так как =+, ˝=(XX) X(X Рас-
Xy yX˝˙˜òî˜^ ˝+˙). 
крывая скобки, получим: 
^ T −1 TT −1 T
˜= (XX) XX˜+ (XX) X°; T −1 T
(XX) =
XX I. 
n ^ T −1 T
=+(XX) X°, ˛xwˆ ˛&#23;ˆ 
Следовательно, ˜˜ где 
11 1 
˛&#22;ˆ
˙ ˘˙˘ 1
X=… …; &#23;=…; &#22;= .
˙˘˙ ˘˙˘ &#22;
˝ˇ
˙ ˘˙˘ 2
xw &#23;
˝ ˇ˝ˇ
nn n 
Перемножим матрицы: 
˛
ˆ
2 
˝ˇ
°
˛˜
x 
xw 
x 
=
T
XX n
˙˙˝ 
˘˘ˇ 
и X
T
˜ = nˆ&#23;. 
˙w˛˜˘
° 
xw w
2 
^ ˛ 2 ˆ−1 ˛ˆ
˛˜ˆ ˛˜ˆ xxw x&#21;° 
Следовательно, 1 1 ˘+˙ &#21;˘˙ ˘.
^ ˇ˘ = ˙
˝˙˜2 ˝˜2 ˇ ˙˝ xw&#21; w2 ˘ˇ ˝w&#21;°ˇ 
Так как нам нужно проверить состоятельность МНК-оценок, то целесообразно выяснить, к чему сходится по вероятности вектор оценок 
коэффициентов: 
−1
° 11 ˙°1 ˙
2
^ x xw&#22; x&#22;&#17;
°˜1 ˙ °˜1 ˙˝ n &#21;in &#21; iiˇ˝n &#21; iiˇ p ^ ˇ=˝ ˇ+˝ ˇ˝ ˇ&#20;&#19;
&#20;˝
˜˜ 111
˛ ˆ˛ ˆ
22 ˝ 2 ˇ˝ ˇ
&#21;xw&#22;&#21;w &#21;w&#22;&#17;
˛ ii i ˆ˛ iiˆ
nnn 
−1
2
˝&#20;ˇ ˝ Ex() Ex( ˛w)ˇ˝Ex( ˛&#19;)ˇ
p 1 i ii ii
˜°˜ˆ &#23;+ˆ &#23;ˆ &#23;= ˙ ˘ˆ˙Ex( ˛w) Ew ) &#23;˘ ˙ ( ˛&#19;)
&#20; (2 Ew ˘
2 iii ii 
−1
&#23;
&#20;
Ex()
2 
i 
° 
&#21;&#22; &#23;= ˆ˝ˇ 
&#20;
Ex( w 
&#15;
&#16;&#16;
) 
0 
0
&#14;&#14; 
&#23;
&#20;
0
˝˛ 
= 
1 2 
i 
i
&#21;&#21;&#22; 
&#18;&#18;&#19; 
+
&#18;&#19; 
=
=
&#21;&#22;
&#18;&#19;
Ew
(
&#16;
&#15;i)
2 
i
)
Ex( 
) 
0 
0 Ew
(
=
˝˙
˝˘
i
i 
i 
° 
°
˙
1 
0
˙
0 
&#21;
&#22;
ˇˇˇˇˆ 
˝˝˝˝˛ 
&#22;
11 Ewi&#23; i)
( 
˝ˇ 
^ p
° . ^ 
а . Из полученного выражения следует, что ˜1 °˛˜1 То есть МНК
оценка ° 1 состоятельна. 
б . Ewi˜˛i)
( > 0 (так как по условию соответствующие переменные положительно коррелированы), поэтому: 
Ew( ˙°)
^ p ii
˜ ˛˝˜ + >˜ .
˛ 
2 22
2 ()
Ew
i 
^ 
Следовательно, МНК-оценка ° 2 будет несостоятельной. Замечание: в выкладках выше использовались следующие соображения: По закону больших чисел 
1 p 1 p 1 p
22 22
x ˜°Ex w ˜°Ew( ); ˛˜E( ˛
˜ (); ˜ xw˜°Exi w);
˝ ii ˝ ii ˝ ii i
nn n 
Ex()2 
i
˙
°
˙
°
°
˙
0
˝ ˝ ˝˛ 
ˇ ˇ ˇˆ 
+ 
+
˝˛ 
=
ˇˆ 
=
˝˛
ˇˆ
˝˛
ˇˆ 
.
Ew
(
&#21;
&#23;
)
&#22;
1
&#22;
i 
i
2 
2
0 
Ewi 2)
(
2
Ew
( 
)
i 
1 p 1 p
˜° °˜˙).
˝xw°˛Ex( ˜w); ˝w˜˙ °˛E(w
iiii ii ii
nn По условию нам известно, что Ex()i = 0;(Ewi) = 0. Поэтому: cov(xu,) = ( ˛˝ ) − Ex)(˝ ) = Ex
Ex ( ˛ E ( ˛˝ );
ii iiii ii cov(xw) = ( ˛ ) − Ex)() = Exw
, Ex w ( ˛Ew ( ˛ ).
ii iiii ii 
)0 ) =
По условию cov(x, ˜=; cov(x, w 0 . Отсюда следует, что
ii ii Ex( ˜˛ ) = 0˜è˜Ex( ˜ w) = 0.
ii ii 
Задание 8 . Асимптотическое распределение МНК-оценки в регрессии без константы: 
1 n 1 n 
xy x° 
^ n˙i=1 ii n˙i=1 ii
˜= =˜+ .
22
1 n 1 n
22
xx 
n˙i=1 in˙i=1 i 
С учетом этого представления получим: 
n
ˆ 1 n &#23; 
1 x 

^ 
˘ n&#20;i=1xii °&#21; n &#20;i=1 i ° i 
n(˜ −˜ ) = n ˜+ −˜= ..
22 ˘ 22 &#21;
1 n 1 n
˘ 2 &#21; 2 ˇ n&#20;i=1xi &#22; n&#20;i=1xi 
Знаменатель этой дроби сходится по вероятности к Ex()2.
i 
К числителю этой дроби применима центральная предельная теорема (используя неравенство Коши — Буняковского, по аналогии с выкладками § 6.4 покажите, что в данном случае предпосылки этой теоремы выполнены): 
n
1 d 

x˙ ˛˝ , 
° ii ˛ˆ ni=1 
где случайная величина имеет распределение N(,0var(xii˝ )). Обобщая все сказанное выше и применяя теорему Слуцкого, получим: 

1 ˘nx° 

i=1 ii
^ nd ˛ 
n( −˜ ) = ˆˇ ,˜ˆ
22 2
1 n 2 Ex()
xi 
n˘i=1 i где случайная величина имеет распределение N(,0var(xii˝ )). Следова
°
˙
var 
(
˜
ii 
22 
)
x 
0,
тельно, случайная величина имеет распределение N ()2
˝˝˛ 

ˇˇˆ 
. 
Ex
i 
Ex()
i 
Таким образом, мы доказали, что: 
ˆ
&#23;
(
°
)
var 
x
^ d
( ˝˙
˝ 
^ 
2 
˜ Следовательно, ° имеет асимптотически нормальное распределе-var( ˜ )x ние с математическим ожиданием ° и дисперсией .2 
ii nEx()22
° 
i 

ii
−
˜
) 
0,
N
˘˘ˇ 
&#21;&#21;&#22; 
n 
.
2 
2 
Ex()22 
i 
К ГЛАВЕ 7 
Задание 1 
Поскольку данные об объясняющей переменной получены в ходе опроса, то авторы столкнулись с проблемой эндогенности из-за ошибок измерения регрессора. Респонденты могут не помнить, какие именно телеканалы они смотрели, а также иногда могут сознательно давать на этот вопрос неверный ответ. 
Другой источник эндогенности в данной модели — обратная причинно-следственная связь. Вполне возможно, решение голосовать за определенную партию обусловлено не тем, что телеканал ее похвалил, а, наоборот, избиратель решает смотреть именно данный телеканал потому, что там хвалят партию, которую он уже и так любит. 
Примечание: авторы работы действительно указывают на эти проблемы и решают их, используя инструментальные переменные. Поэтому мы еще вернемся к данному кейсу в гл. 8, посвященной инструментальным переменным. 
Задание 2 
Регрессор может быть эндогенен из-за пропущенных существенных переменных. На подушевой ВВП могут влиять другие факторы помимо качества институтов. 
Регрессор может быть эндогенен из-за двусторонней причинноследственной связи. Возможно, дело не в том, что страны с лучшими институтами становятся богаче, а, наоборот, богатые страны могут позволить себе лучшие институты. 
Наконец, регрессор наверняка эндогенен из-за ошибок его измерения. Действительно, вряд ли используемый индекс (равно как и любой другой) может идеально охарактеризовать такое сложное понятие, как защита прав собственности. 
Примечание: авторы работы действительно указывают на эти проблемы и решают их, используя инструментальные переменные. Поэтому мы еще вернемся к данному кейсу в гл. 8. 
Задание 3 . 
а . Поскольку исследователю доступны только наблюдения о фактических объемах продаж (xi) и недоступны об ожидаемых объемах продаж 
e
(),x он будет оценивать регрессию y=˝+˝ ˛ x+˙ .
ii 12 ii ee
Так как y=˝+˝ ˛ xи x= x+ u, то y=˙+˙ ˝(x− u); 
i 12 i iii i 12 ii 
y=˙+˙ ˝x+−( ˙˝u). 
i 12 i 2 i 
Следовательно, y=˝+˝ ˛ x+˙ , где ˜ =−° 2 ˙u.
i 12 iii i 
= ee ,
б . cov(x, ˜ )cov(x+ u, −° ˆu) =−° ˆcov(x+ uu) = 
ii ii 2 i 2 i ii 
ee 2
=−˙2 ˝(cov( , + ,) ={ ,) =0˜ïî˜óñëîâèþ =−˙˝ ˇ0.
xu)cov(uu) cov(xu } ˙ˆ
iiii ii 2 u 
Следовательно, xi— эндогенный регрессор. 
2 e 22
˜= var(x= x+ u) =˜ +˜ ;
)var( 
x i iixu 
e 
˜˜
ÌÍÊ cov( , ) cov(x, ˜ +˜
xy ˙ x+° )
^ ii i 12 ii
˜== = 
°°
2 ()xi var()i
var x 
˜
cov(x, ˆ) p cov(x, ˆ)
ii ii
=˙+ ˛˙+ =
˛˝
2 ° 2 
x
var()i var()i
x 
(−ˆˇ˙2) ˆˇ˙2 
2 u 2 u
=ˆ+ =ˆ− ˝ˆ.
2 2 2222
ˇ ˇ+ˇ 
x xu 
e 
Очевидно, что МНК-оценка не состоятельна. 
Задание 4 
Обратите внимание, что условия похожи на ситуацию из § 7.4, посвященного ошибкам измерения регрессора. Только в этом случае с ошибкой измеряется не регрессор, а зависимая переменная. 
Логика решения тут такая же, как в этом параграфе. Однако в данном случае оказывается, что регрессор в модели остается экзогенным (действительно, он-то измерен без ошибок). Поэтому эндогенность в модели не возникает. Следовательно, МНК-оценка в модели остается состоятельной. 
Так как y = y * + u , то y =˝+˝ ˛ x + ui , следовательно:
iii i 12 i =° ;
ui i , ) cov(x , °)cov(xu
^ p ii ii
˜˛˝˜+ =˜+ =˜
22 2
˛ var() 2 var()x . 
x
ii 
Задание 5 
Поскольку между потреблением и ВВП существует одновременная причинно-следственная связь, то обычный МНК не даст состоятельную оценку: 
C =C +mpcY˛+˝; (1)
ta tt Y = C + I . (2)
t tt 
Подставляя выражение (1) в выражение (2), получим: 
Y =C +mpcY˛++I
˝ :
t a ttt 
1 11
Y = C ˛+ ˛˙;˛+ I
t att
1 −mpc 1−mpc 1−mpc 
ˆCa 11 &#23; cov(Y , ˜)cov ˘+ ˙+ ˙˜, ˜&#21;=
= I
tt ttt
1−mpc 1−mpc 1−mpc 11 
ˇ&#22; 
=˛cov(I , ˙ ) +˛cov(˙ , ˙ ) = 
tt tt
1 − mpc 1− mpc ˙˝ 2 = { (,) = 0} =˛
cov I ˝ ˜ïî˜óñëîâèþ 0,
tt 
1− mpc 
где Yt — эндогенный регрессор, и, следовательно, МНК-оценка предельной склонности к потреблению не будет состоятельной: 
˜
˜(YC, ) cov(YC, + mpcY˛ +˝)
cov
˜ a
mpc == = 
°° 
var()Y var Y
() ˜ 2
cov(Y , ˙) p cov(Y , ˙ ) ˆ˙
= mpc +˛mpc +=mpc +&#23;mpc
˛˝ tt . var Y var Yt ( −mpc)˘ˆY 
° () ()12 
Задание 6 
Поскольку задание сформулировано в свободной форме, написать единственно верное решение здесь не получится. Тем не менее можно указать возможные в данном случае разумные шаги: проанализировать описательные статистики для соответствующих переменных; оценить уравнение, где в качестве зависимой переменной используется смертность от ДТП (или ее логарифм), а в качестве объясняющей — потребление алкоголя (или его логарифм); попробовать использовать различные функциональные формы связи и различные контрольные переменные. 
Можно попробовать отдельно анализировать подвыборки развитых и развивающихся стран. 
По всей видимости, вывод должен быть такой: на основе доступных данных можно заключить, что уровень потребления алкоголя в стране в целом не влияет на количество ДТП. 
Этот вывод основан на том, что нет никаких устойчивых свидетельств в пользу значимого влияния. 
В таблице ниже в качестве примера указаны результаты оценивания логарифмической модели для полной выборки (тест Рамсея не отвергает ее корректность), а также результаты оценки аналогичной спецификации отдельно для развитых и для развивающихся стран: 
Метод оценки - МНК Зависимая переменная: l_DTP 
Полная выборка  Развитые страны  Развивающиеся страны  
constl_CARSl_LENTHl_ALCDEVn  3,95***(0,17)−0,07**(0,03)−0,13***(0,03)−0,02(0,03)−0,67***(0,11)144  2,68(1,96)−0,15(0,33)−0,08*(0,04)0,31*(0,16)29  4,00***(0,19)−0,07**(0,03)−0,14***(0,03)−0,03(0,03) 115  
Испр.  R2  0,51  0,10  0,19  

В скобках указаны стандартные ошибки; 
* − значимость на 10%-м уровне; ** − значимость на 5%-м уровне; *** − значимость на 1%-м уровне. 
Примечание: трудность получения надежных оценок в данном случае состоит в сильной неоднородности выборки, которой традиционно характеризуются межстрановые данные (это относится к оценкам коэффициента не только при переменной интереса, но и при контрольных переменных). В значительной степени эта проблема может быть решена в рамках моделей на панельных данных, о которых мы поговорим в гл. 9. 
Задание 7 . Производственная функция 
а . Будем использовать для решения производственную функцию Кобба — Дугласа. Вычислив логарифмы соответствующих переменных и оценив параметры модели, получаем следующий результат: 
Модель 1: МНК, использованы наблюдения 1-100 Зависимая переменная: l_Q Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент const 1,41416 l_L 0,495014 l_K 0,509324 
Сумма кв. остатков 
R2 F (2, 97) 
Ст. ошибка 0,300323 0,0558797 0,0985645
 0,015424 0,998739
 20629,11 
t-статистика P-значение 4,709 <0,0001 *** 8,859 <0,0001 *** 5,167 <0,0001 *** 
Ст. ошибка модели 0,012610 Испр. R2 0,998713 Р-значение (F) 2,9e-128 
Следовательно, эластичность выпуска по капиталу составляет примерно 0,5. 
б . В таблице ниже указаны доверительные интервалы для всех коэффициентов: 
t(97, 0,005) = 2,627
 Переменная Коэффициент 99 доверительный интервал const 1,41416 (0,63, 2,20)l_L 0,495014 (0,35, 0,64)l_K 0,509324 (0,25, 0,77) 
В частности, 99%-й доверительный интервал для интересующей нас эластичности оказывается очень широк: эластичность с соответствующей вероятностью находится в пределах от 0,25 до 0,77. Не слишком точная оценка! 
Коэффициент корреляции между логарифмами труда и капитала близок к единице. Соответственно, и коэффициент VIF в оцененной модели заметно больше 10. Он составляет примерно 170. Так что в модели есть существенная мультиколлинеарность, а это может сказываться на точности оценивания. 
в . В нашей спецификации моделей для этого необходимо проверить гипотезу о том, что сумма коэффициентов при логарифмах труда и капитала равна единице. P-значение для этой гипотезы существенно больше и одной сотой и пяти сотых, поэтому гипотеза не отвергается при любом разумном уровне значимости. Мы можем заключить, что технология производства в данной отрасли описывается функцией Кобба — Дугласа c постоянной отдачей от масштаба: 
˛ 1−˛
QA= KL . 
г . Для перехода к новой модели достаточно разделить правую и левую части равенства на количество труда: 
˛ 1−˛
Q AKL 
= ;
LL 
Q= A ° K˙˘ ;
L ˛˝ Lˆˇ 
° 
qA= k, 
/ =где qQL= — производительность труда; kKL/ — капиталовооруженность труда. Для получения МНК-оценки эластичности выпуска по капиталу снова нужно перейти от этой модели к логарифмической. Сделав это и вычислив МНК-оценки, получаем следующие результаты: 
Модель 2: МНК, использованы наблюдения 1-100 Зависимая переменная: lq Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 1,44419 0,00814959 177,2 <0,0001 *** lk 0,499833 0,00966924 51,69 <0,0001 *** 
Сумма кв. остатков 0,015427 Ст. ошибка модели 0,012547 R2 0,985597 Испр. R2 0,985450 F (1, 98) 2672,172 Р-значение (F) 6,31e-73 
Точечная оценка эластичности выпуска по капиталу составляет 0,50, что близко к предыдущей оценке. Однако устранение мультиколлинеарности действительно позволило существенно увеличить точность результатов. Новый 99%-й доверительный интервал теперь имеет следующий вид: 
(0,47, 0,53). 
Задание 8 . Про математический анализ 
а . Переменная ЕГЭ помогает учесть уровень первоначальной подготовки студентов (выступает в качестве замещающей переменной для 
этого уровня). Если его игнорировать, то это может привести к смещению оценок коэффициентов из-за пропуска существенной переменной. Действительно, уровень первоначальной подготовки студента влияет на его успеваемость по математическому анализу и при этом может быть коррелирован с решением студента посещать или не посещать лекции. 
б . Утверждение исследователя ложно. Чтобы понять, как посещение лекций влияет на результаты экзамена, нужно вычислить производную результатов экзамена по посещению лекций: 

˜points 
=− , + , ˙ege 
021019 . 
˜lect 
Важно отметить, что по условию задачи во всей генеральной совокупности анализируемых студентов ege > 60. Следовательно, это производная положительна. 
Например, для студента у которого было за ЕГЭ 60 баллов, посещение каждой дополнительной лекции улучшает результаты экзамена в среднем при прочих равных на –0,21 + 0,19 · 60 = 11,19 балла. 
К ГЛАВЕ 8 
Задание 1 . Отдача от образования 
а . Требуемая таблица представлена ниже: 
Модель 1: МНК, использованы наблюдения 1-3010 Зависимая переменная: LWAGE76 
Коэффициент Ст. ошибка t-статистика P-значение const 4,73366 0,0676026 70,0219 <0,00001 *** ED76 0,074009 0,00350543 21,1126 <0,00001 *** EXP76 0,0835958 0,00664779 12,5750 <0,00001 *** EXP762 −0,00224088 0,00031784 −7,0503 <0,00001 *** BLACK −0,189632 0,0176266 −10,7583 <0,00001 *** SMSA76 0,161423 0,0155733 10,3654 <0,00001 *** SOUTH76 −0,124862 0,0151182 −8,2590 <0,00001 *** 
Среднее зав. перемен 6,261832 Ст. откл. зав. перемен 0,443798 Сумма кв. остатков 420,4760 Ст. ошибка модели 0,374191 R2 0,290505 Испр. R2 0,289088 F (6, 3003) 204,9318 Р-значение (F) 1,5e-219 Лог. правдоподобие −1308,702 Крит. Акаике 2631,403 Крит. Шварца 2673,471 Крит. Хеннана-Куинна 2646,532 
б . При прочих равных условиях при увеличении числа лет обучения на один год зарплата индивида увеличивается на 7,4%. 
в . Переменная nearc4 может быть хорошим (валидным) инструментом по двум причинам: во-первых, она коррелирована с переменной ed76 (если индивид живет близко к колледжу, то логично предположить, что он с большей вероятностью примет решение продолжать обучение); во-вторых, она не коррелирована с ненаблюдаемой переменной способностей, учтенной в случайных ошибках (сам факт проживания рядом с колледжем не делает индивида более способным). 
Результаты оценивания представлены в столбце (в) табл. Р.8.1. Влияние образования по-прежнему значимо на 1%-м уровне. При прочих равных условиях при увеличении числа лет обучения на один год зарплата индивида увеличивается на (e0,132 – 1) · 100% = 14%. Отдача от образования несколько выше по сравнению с предыдущей моделью. 
г . F-статистика для теста на слабые инструменты равна 17,5. Это больше 10, что говорит о том, что используемый инструмент релевантен. 
P-значение теста Хаусмана равно 0,21, что больше, чем 0,05. Следовательно, даже при уровне значимости 5% гипотеза о состоятельности МНК оценок не отвергается. В соответствии с результатами теста Хаусмана стоит предпочесть модель, оцененную МНК (т.е. модель из пункта (а)). 
Впрочем, следует отметить, что отдача от образования статистически значима в обеих моделях, так что в этом смысле результаты устойчивы. 
д . Переменные MOMED и DADED будут валидными инструментами. 
С одной стороны, образование родителей коррелировано с образованием детей, так как более образованные родители чаще склонны отправлять своих детей в университеты (это говорит о релевантности инструментов). Высокое значение F-статистики теста на слабые инструменты подтверждает это рассуждение (см. столбец (д) табл. Р.8.1). 
С другой стороны, образование родителей само по себе не гарантирует более высокого уровня таланта у их детей (экзогенность). Конечно, с аргументами в пользу экзогенности можно поспорить, предположив, что у более талантливых родителей в среднем должны быть и более талантливые дети. Однако P-значения теста Саргана равно 0,26 > 0,05, что говорит в пользу экзогенности используемых инструментов. 
Таблица Р.8.1 
Результаты моделирования отдачи от образования . Зависимая переменная: LWAGE76 
(а)МНК  (в)2МНК  (д)2МНК  
constED76EXP76EXP762 BLACK SMSA76SOUTH76  4,734**(0,070)0,074**(0,004)0,084**(0,007)−0,002**(0,000)−0,190**(0,017)0,161**(0,015)−0,125**(0,015)  3,753**(0,818)0,132**(0,049)0,107**(0,021)−0,002**(0,000)−0,131**(0,052)0,131**(0,030)−0,105**(0,023)  4,400**(0,212)0,094**(0,013)0,092**(0,008)−0,002**(0,000)−0,170**(0,021)0,151**(0,016)−0,118**(0,016)  
F-статистика теста  
на слабые инструменты  —  17,51  76,85  

P-значение теста Саргана  —  —  0,26  
P-значение  
теста Хаусмана  —  0,21  0,08  

n  3010  3010  3010  
R2  0,291  0,267  0,287  
В скобках указаны робастные стандартные ошибки.  
* − значимость на 10%-м уровне;  
** − значимость на 5%-м уровне.  
В модели (г) инструмент для  ED76 — переменная  NEARC4.  

В модели (д) инструменты для ED76 — NEARC4, MOMED, DADED. 
В построенной модели возможно проведение теста Саргана, поскольку в данном случае число инструментов превышает число эндогенных регрессоров (три эндогенных регрессора и пять инструментов). В модели из пункта (в) число эндогенных регрессоров совпадало с числом инструментов, поэтому проведение теста на сверхидентификацию было невозможно. 
Тест Хаусмана по-прежнему не отклоняет гипотезу о состоятельности оценок обычного МНК (Р-значение >0,05). 
е . Сводные результаты представлены в табл. Р.8.1. Во всех моделях коэффициент при образовании статистически значим и положителен, так что мы можем сделать вывод, что увеличение уровня образования способствует увеличению заработной платы. 
Если бы выводы моделей различались, то следовало бы сделать выбор в пользу первой из них, так как даже при использовании экзогенных и релевантных инструментов тест Хаусмана отдает предпочтение методу наименьших квадратов. 
Задание 2 . Спрос на сигареты 
а . В уравнение первого шага 2МНК нужно включать все инструментальные переменные и все экзогенные регрессоры. 
Поэтому в рамках рассматриваемой модели уравнение первого шага двухшагового МНК будет выглядеть следующим образом: 
ln() =˛ +˛ ln(rtaxso ) +˛ ln(rtax ) +˛ ln(Income ) + u .
P
i 12 i 3 i 4 ii 
На первом шаге оцениваем это уравнение и получаем прогнозные 
Pi
значения ln(). 
б . В условиях наличия экзогенных регрессоров в уравнении первого шага нужно вычислить F-статистику, используемую для сравнения «короткой» и «длинной» регрессий. 
Тестируемая гипотеза: H0: ˜ =˜ = 0;
23 
(R2 − R2)/ qF = UR R = 900,
ðàñ÷ 2
(1 − RUR )/(n − k) 
= ;( 484 где q 2 n − k) = −= 44; 2 — коэффициент детерминации в оце
RUR ниваемом уравнении регрессии первого шага 2МНК; RR 2 — коэффициент детерминации в уравнении регрессии первого шага 2МНК, включающем лишь экзогенный регрессор (т.е. только логарифм дохода). 
Так как Fрасч = 900 > 10, делаем вывод, что инструменты сильные. 
в . Проверим значимость каждого коэффициента в регрессии второго шага 2МНК. Тестируемая гипотеза: H0: ˜=0;
1 
12,
=− =−6; −>,.
61 96 Нулевая гипотеза отвергается, и пере
tðàñ÷ 
02, 
менная ln(Pi) является значимой на 5%-м уровне. 
Интерпретация коэффициента: при прочих равных условиях при увеличении цены на 1% величина спроса на сигареты снижается на 1,2%. 
Тестируемая гипотеза: H0: ˜=0;
2 046 
tðàñ÷ , 148 ,
== ,;148196< , ° вывод: нулевая гипотеза не отклоня
031
, 
ется, и переменная ln(Incomei) не является значимой на 5%-м уровне. 
Задание 3 . Эмпирический пример 
а . Открываем файл в MS EXCEL, выбираем опцию «Генерация случайных чисел» и создаем по 2000 наблюдений для трех независимых одинаково (нормально) распределенных случайных величин ˝i , ui , vi . Так как в задании используется генерация случайных чисел, то ваши численные ответы могут не совпадать с приведенными в этом решении. Однако основные выводы должны сохраниться. 
б . Теперь вычислим по 2000 значений для переменных x, y, z с помощью приведенных в задании расчетных формул и импортируем данные в эконометрический пакет, начиная с соответствующего столбца. 
в . Оценим параметры парной регрессии y ˝˙x ˆобычным
=+˛+
i ii 
МНК: 
Модель 1: МНК, использованы наблюдения 1-2000 Зависимая переменная: y 
Коэффициент Ст. ошибка t-статистика P-значение const 2,01482 0,0118063 170,6563 <0,00001 *** x 0,89268 0,0109056 81,8551 <0,00001 *** 
Среднее зав. перемен 2,909313 Ст. откл. зав. перемен 0,416901 Сумма кв. остатков 79,80710 Ст. ошибка модели 0,199859 R2 0,770299 Испр. R2 0,770184 F (1, 1998) 6700,253 Р-значение (F) 0,000000 Лог. правдоподобие 383,4129 Крит. Акаике −762,8258 Крит. Шварца −751,6240 Крит. Хеннана-Куинна −758,7127 
y ^ i = , + , xi ; R2 = 077.201089˛ , (, )(,)0 012 001 
, −
08904,
Проверим гипотезу H: ˜=04 t == 49 t > ,
,; ;196 ˝
0 ðàñ÷ ðàñ÷
001
, 
вывод: нулевая гипотеза отклоняется. Таким образом, в нашем случае использование МНК приводит к некорректным результатам. 
г . Проанализируем, можно ли доверять полученным МНК-оценкам: 
cov(x, ˜ )cov(˜+ u, ˜ ) = cov(˜ , ˜+ u, ˜ ) =
= )cov( 
ii iii iiii 
={cov(u, ˝) =0, òàê˝êàê˝uè˝˝−íåçàâèñèìûå} =˙2 =˛0.
1
ii ii ˝ 
Следовательно, x– эндогенная переменная. Полученные МНКоценки в модели смещены и несостоятельны. Им доверять не стоит: 
˜ 
^ cov(xy,) p˝+cov(xi, ° i) ˜
˜=˝˙˜ ˇ;
° 
x
var()x var()i 
var(x)var(˝+u) =u ˝− } =var(˝)var()u=+=;
= { è° íåçàâèñèìûå + 1112
i iiii i i 
1
^ p
˜°˛ , +=09 ˆ04,.
°04 ,
2 
д . Решить проблему несостоятельности оценок коэффициентов поможет использование двухшагового МНК, где переменная z – валидный инструмент для x. Во-первых, данный инструмент релевантен: 
cov(,xz) =cov(˝+uv+u) =˙2 =˛ Во-вторых, инструмент экзо
, 10.
ii iiii u генен: cov(z, ˜ )cov(v+ u, ˜ ) = cov(v, ˜+ u, ˜ )
= )cov( = 0.
ii iii iiii 
Модель 2: 2МНК, использованы наблюдения 1-2000 Зависимая переменная: y Независимые переменные: x Инструменты: const z 
Коэффициент Ст. ошибка z P-значение const 2,47946 0,030102 82,3687 <0,00001 *** x 0,428982 0,0294035 14,5895 <0,00001 *** 
Среднее зав. перемен 2,909313 Ст. откл. зав. перемен 0,416901 Сумма кв. остатков 152,0201 Ст. ошибка модели 0,275837 R2 0,770299 Испр. R2 0,770184 F (1, 1998) 212,8539 Р-значение (F) 6,87e-46 Лог. правдоподобие -11342,73 Крит. Акаике 22689,46 Крит. Шварца 22700,66 Крит. Хеннана-Куинна 22693,57 
Тест Хаусмана (Hausman) 
Нулевая гипотеза: МНК оценки состоятельны
 Асимптотическая тестовая статистика: Хи-квадрат(1) = 946,778 
P -значение = 6,65336e-208 
Тест на слабые инструменты -F-статистика для 1-го шага (1, 1998) = 709,452 
^ ^2
yi = , + , xi ; R = 077.
248043˛ , 
(, )(, )
003 003 ^^ 
Очевидно, что ˜TSLS ,, OLS ,
= 043 это не совпадает с ˜= 089 и близко к истинному значению ° = 0,4. Проверим гипотезу о равенстве коэффициента истинному значению. 
, −
04204,
H0: ˜=04, ; t == 06,;7 t <1,96 ˛ вывод: нулевая
ðàñ÷ ðàñ÷
003
, 
гипотеза не отклоняется на 5-м уровне значимости. 
Проблема несостоятельности оценок коэффициентов решена. 
е . Нулевая гипотеза теста Хаусмана состоит в том, что МНК-оценки коэффициентов состоятельны. 
Поскольку Р-значение при проверке гипотезы оказалось крайне мало, то нулевая гипотеза отклоняется, и МНК-оценки, полученные в модели из пункта (в), несостоятельны. Следовательно, необходимо пользоваться моделью из пункта (д), оцененной с помощью 2МНК. 
Также отметим, что тестовая статистика для проверки гипотезы о силе/слабости инструментов превышает пороговое значение 10. Следовательно, инструмент z сильный. 
Задание 4 . Выбор модели 
Сначала проанализируем F-статистики, полученные в результате проведения теста на слабые инструменты (First-stage F-statistic). Известно, что инструменты считаются сильными, если F-статистика больше 10. Следовательно, инструменты в моделях 1 и 5 являются слабыми. В рассмотрении остаются модели 2, 3 и 4. 
Результаты теста Саргана на экзогенность инструментов показывают, что лишь в модели 2 инструменты являются экзогенными (P-value >0,05, и гипотеза об экзогеннности не отклоняется), а в моделях 3 и 4 хотя бы один инструмент эндогенен (P-value< 0,05, и гипотеза отклоняется). 
Поэтому следует сделать выбор в пользу модели 2. 
В модели 1 проведение теста Саргана невозможно, поскольку число инструментов совпадает с числом эндогенных переменных, а данный тест доступен лишь тогда, когда число инструментов превышает число эндогенных регрессоров. Поэтому в соответствующей ячейке и стоит прочерк. 
Задание 5 . Еще один выбор модели 
а . Чтобы заполнить первую ячейку, нужно проверить значимость инструмента в регрессии первого шага в модели 2 (эта регрессия выгля
^ ^^ ^
дит так: X =˛˛1 +2 W +˛3 Z1), используя тест для сравнения короткой и длинной регрессий: 
R − R
22 nk 05, − , 250
− 01 − 3
F = UR R ˛= ˛= 08, ˛247 =1976, . 
1− R2 q 105− ,1
UR 
Чтобы заполнить вторую ячейку, нужно проверить значимость двух инструментов в регрессии первого шага в модели 3 (т.е. в регрессии 
^ ^^^ ^
X =+ W +˛Z1+˛Z
˛˛ 2), используя тест для сравнения короткой
123 4 
и длинной регрессий: 
R − R
22 nk 06, − , 250
− 01 − 4
F = UR R ˛= ˛=125 ˛246 / 2 =
, 153 7,55. 
1 − R2 q 106− ,2
UR 
б . P-значение теста Хаусмана в обоих случаях ниже любого разумного уровня значимости, поэтому при использовании каждого комплекта инструментов отвергается гипотеза о том, что МНК-оценки состоятельны. Таким образом, модель 1 нам не подойдет. 
F-статистика для теста на слабые инструменты больше 10 в обоих случаях, следовательно, инструменты в моделях 2 и 3 релевантны. 
P-значение теста Саргана в модели 3 меньше любого разумного уровня значимости, поэтому гипотеза об экзогенности всех инструментов в этой модели отвергается, что вынуждает нас отказаться от модели 3. 
Во модели 2 проведение теста Саргана невозможно, так как там число инструментов совпадает с числом эндогенных регрессоров. 
Таким образом, нам остается сделать выбор в пользу модели 2 (и надеяться, что инструмент в этой модели экзогенен). 
в . Расчетное значение тестовой статистики для теста на значимость 
14, 
< ,.
переменной X равно 196 Следовательно, можно сделать вывод о 
09, 
том, что переменная X не влияет на переменную Y. 
Задание 6 . Макроэкономическая модель 
а . Выразим ВВП через экзогенные переменные: 
˝ 11
GDP = 1 + (I +G ) +˙ .
t ttt
1−˝ 1−˝ 1 −˝
22 2 
1
Откуда: cov(GDP , ˜ ) =˛2 ˜> 0; ;
tt 1−° 
2 cov(GDP , ° )
^ tt
plim˜=˜+ >˜ , т.е. МНК оценка несостоятельна.
222 2
˛
GDP 
1 ˝(C −C )(z − z )
TSLS ii 
б . Оценка в явном виде: ˜^2 = n . (GDPGDP− )(z − z )
1 ˝ ii
n 
Докажем состоятельность, вычислив соответствующий предел по вероятности: 
1 
TSLS ˆ(Ci −C )(zi −z ) cov(Cz,)^ n pii
˜= ˝˝˙ = 
21 c,)
cov(GDPz
(GDPGDP− )(z −z ) ii
ˆ ii
n 
cov(Cz, ) cov(˝+˝ ˛GDP +˙ , z )
ii 12 i ii
== = 
cov(GDPz, ) cov(GDPz,)
ii ii 
+˝ , z ) ˛ cov(GDPz +˝ , I )cov(+˝
˛ cov(GDPz, )cov( , )cov( , G )
2 ii ii 2 ii ii ii
== = 
cov GDPz, cov(GDPz
() ,)
ii ii 
˛cov(GDPz ) ++
, 00
2 ii
= =˛. 
cov(GDPz,) 2 
ii 
в . Численно 2МНК-оценка в этом случае, вообще говоря, будет отличаться от предыдущего пункта, так как уравнение регрессии первого шага будет теперь включать две независимые переменные вместо одной. Однако эта оценка будет также состоятельной, так как оба инструмента экзогенны (по условию) и релевантны (в силу уравнения для ВВП, которое мы вывели в пункте (а)). 
Задание 7 . Телевидение и выборы 
Описанная ситуация может быть представлена как система одновременных уравнений следующим образом: 
y =˝+˝ ˛ x +˙ ;
i 12 ii 
x =˝+˝ ˛ y +˝ ˛ z + u .
i 12 i 3 ii 
Кроме того, по смыслу задачи cov(zi ,)˜=0, так как случайные
i 
ошибки, характеризующие шоки популярности партии в 1999 г., по всей видимости, не могли влиять на размещение оборудования телеканала в далеких 1980-х гг. 
МНК-оценка первого уравнения будет несостоятельной, так как регрессор коррелирован со случайной ошибкой. Чтобы в этом убедиться, следует выразить xi и yi через экзогенные переменные zi, ˝i , ui, т.е. записать уравнение в приведенной форме: 
˙ +˙(ˆ +ˇ) +˙ ˝z +u
1 21 i 3 ii
x = ;
i 
1−˙ˆ
22 
ˆ +ˆ(˙ +ˇ) +ˆ ˝z +u
1 21 i 3 ii
y =˙+˙˝ +ˇ.
i 12 i
1 −ˆ˙
22 
Теперь вычислим ковариацию между xi и ˝i , убедившись, что она не равна нулю: 
° cov(xi , ˜) = 2 var() ˆ
˜ 0.
ii
1−°˛
22 
(предполагаем, что ˜° ˛1), следовательно:
22 
^ cov(xi , ° i )plim˜=˜+ ˙˜ .
22 2
var x
()i 
Таким образом, МНК-оценка в рассматриваемой модели несостоятельна. 
Для оценки коэффициента ° 2 придется оценить первое уравнение системы двухшаговым МНК, где в качестве инструмента для переменной x выступает переменная z. 
Переменная z является валидным инструментом, так как она, скорее всего, не коррелирована со случайной ошибкой (мы уже обсудили это выше), но коррелирована с регрессором (это следует из уравнения приведенной формы для xi). 
Осталось записать формулу для новой оценки и доказать, что она состоятельна: 
TSLS 1 ˆ(yi −y)(zi −z ) p cov(yz,)^ n ii
˜= ˝
˝˙ = 
21 (x ,)
cov i , zi(x −x )(z −z )
ˆ ii
n 
cov(yz) xz+ , z
, cov(˝+˝ ˛ x+˙ , z) ˝ cov(x, )cov(˙ )
ii 12 i ii 2 ii ii
=== = .
˝2
cov(xz, ) cov(xz, ) cov(xz,)
iiii ii 
Задание 8 . Эластичность предложения 
Приведем здесь кратко идею решения задания. 
По аналогии с примером 8.1, который рассмотрен в гл. 8, здесь наблюдается явная эндогенность: переменная P коррелирована со случайными ошибками модели. 
Чтобы показать это формально, запишем функции спроса и предложения в данном случае. Функция предложения зависит от цены товара, налогов и издержек производства: 
lnQ= a+ aln PA+ alnT+ aln PC+ v;
i 01 i 2 i 3 ii 
a> 0; a< 0; a< 0.
12 3 
Функция спроса, в свою очередь, зависит от цены товара А, цены его заменителя и дохода потребителя: 
lnQ= b+ bln PA+ bln I+ bln PB+ u;
i 01 i 2 i 3 ii 
b> 0; b< 0; b° 0; b> 0.
01 23 
Равновесная цена следующим образом выражается через экзогенные переменные: 
b− a+ bln I+ bln PB+ u− alnT− aln PC− v
0 02 i 3 ii 2 i 3 ii
ln PA= .
i 
a− b
11 
Отсюда получаем, что цена коррелирована со случайными ошибками в уравнении для функции предложения: 
−var(v)
cov(ln PAv,) = i < 0.
ii 
a− b
11 
В примере 8.1 мы оценивали функцию спроса и, чтобы решить проблему эндогенности, использовали в качестве инструмента переменную, которая влияет только на предложение (это были налоги). Теперь нам нужно оценить функцию предложения, следовательно, по аналогии легко показать, что в качестве инструмента нам нужно использовать переменные, которые влияют только на спрос: доход и цена товара заменителя. 
Таким образом, возможна следующая эмпирическая стратегия: оценить регрессию логарифма Qна константу, логарифм P(эндогенная переменная), логарифм налогов (экзогенная переменная) и логарифм цены сырья (тоже экзогенная переменная). При этом в качестве инструментов для цены следует использовать логарифмы дохода и цены товара заменителя. 
Результат оценки соответствующего уравнения представлен ниже: 
Модель 1: 2МНК, использованы наблюдения 1-200 Зависимая переменная: l_Q Независимые переменные: l_PA Инструменты: const l_PB l_I l_T l_PC Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент  Ст. ошибка  t-статистика  P-значение  
constl_PAl_T l_PC  0,1992502,02248−2,49067−1,08309  0,2647080,1093930,3125700,303722  0,752718,49−7,968−3,566  0,45257,79e-0451,29e-0130,0005  *** *** ***  
Среднее зав. переменСумма кв. остатков R2F(3, 196)  2,153561272,39760,573821117,3460  Ст. откл. зав. перемен Ст. ошибка модели Испр. R2 Р-значение (F)  1,6816371,1788910,5672981,56e-43  

Тест Хаусмана (Hausman) Нулевая гипотеза: МНК оценки состоятельны Асимптотическая тестовая статистика: Хи-квадрат(1) = 2570,24 Р-значение = 0 
Тест на сверхидентификацию Саргана (Sargan) Нулевая гипотеза: все инструменты допустимы Тестовая статистика: LM = 0,286781 Р-значение = P(Хи-квадрат(1) > 0,286781) = 0,592291 
Тест на слабые инструменты F-статистика для 1-го шага (2, 195) = 661,027 Значение < 10 может указывать на слабые инструменты 
Тест Саргана подтверждает экзогенность используемых инструментов, а F-статистика для регрессии первого шага указывает на то, что инструменты сильные. Тест Хаусмана отвергает гипотезу о состоятельности обычного МНК, следовательно, также позволяет сделать вывод в пользу наших 2МНК-оценок. 
Логарифм цены товара А оказывается значимой переменной (при 1%-м уровне), и соответствующий коэффициент равен 2. Следовательно, можно заключить, что эластичность предложения по цене равна двум. 
К ГЛАВЕ 9 
Задание 1 . Панельные данные в Вестеросе а . Осуществим внутригрупповое преобразование: 
** 
y = (y − y ); x = (x − x ).
it iti it iti 
i  t  y  x  y*  x*  (x*)2  x*y*  
1  1  4  10  0  0  0  0  
1  2  4  10  0  0  0  0  
2  1  7  10  2  0  0  0  
2  2  3  10  −2  0  0  0  
3  1  12  20  3  5  25  15  
3  2  6  10  −3  −5  25  15  
4  1  13  20  0  0  0  0  
4  2  13  20  0  0  0  0  
5  1  26  40  6  10  100  60  
5  2  14  20  −6  −10  100  60  
Сумма:  250  150  

** ^ it it
˛˛xy 150
˜= == 06,.
1 ˛˛()xit * 2 250 
б . Перейдем к разностям. Для этого запишем уравнения первого и второго периодов времени и вычтем из второго уравнения первое: 
y =˝+˝˛x +˛ +
˙z ˆ;
i1 01 i1 ii1 y =˝+˝˛x +˛ +
˙z ˆ;
i2 01 i2 ii2 ˜y =˙ ˝˜x + ˜ˆ .
i21 i2 i2 
Получим модель регрессии без константы: 
i  t  y  x  Δy  Δx  (Δx)2  ΔxΔy  
1  1  4  10  
1  2  4  10  0  0  0  0  
2  1  7  10  
2  2  3  10  −4  0  0  0  
3  1  12  20  
3  2  6  10  −6  −10  100  60  
4  1  13  20  
4  2  13  20  0  0  0  0  
5  1  26  40  
5  2  14  20  −12  −20  400  240  
Сумма:  500  300  

300
^
˜= = 06,.
1 
500 
Отметим, что результаты пунктов (а) и (б) совпадают неслучайно. Если T= 2, то оценки модели в первых разностях и модели на основе внутригруппового преобразования будут одинаковыми. 
в . Перейдем к разностям. Для этого запишем уравнения первого и второго периодов времени и вычтем из второго уравнения первое: 
y= +˛x+˝˛1+˛+ 
˝˝ ˙z ˆ;
i1 01 i12 ii1 
y= +˛x+˝˛2 +˛+ˆ;˝˝ ˙z
i2 01 i22 ii2 
˜y=˙ ˝˜x+ ˙ +˜ˆ .
i21 i22 i2 
Получим модель парной регрессии. В этом случае, в отличие от предыдущего пункта, в модели есть константа: 
˜( xy, ) ()(,)44 336,
cov ˙˙ 60 −−6 ˝−
^
˜== ==05, 25;2
1 
° 2
var()˙x 100 −−()6 64 
^^
˜ =− , ()˝˜ =−1 25.
44 −−6,
21 
Задание 2 . Прав ли Тайвин? 
Нужно провести тест на сравнение короткой и длинной регрессий, проверив гипотезу о том, что коэффициенты при всех фиктивных переменных равны нулю: 
098096 6
, − , 10 −
F = ˛=1.
− ,41098 
Критическое значение при уровне значимости 5% больше единицы, поэтому гипотеза не может быть отвергнута, следовательно, pooled regression лучше. Ланнистер — молодец. 
Задание 3 . Выбор модели 
а . В моделях 3 и 4 гипотеза теста Хаусмана о состоятельности RE оценок отклоняется при уровне значимости 1% (а также 5%), так как соответствующие P-значения меньше одной сотой (пяти сотых). Следовательно, модели с фиксированными эффектами (1 и 2) лучше, чем модели со случайными эффектами. 
Из моделей 1 и 2, в свою очередь, следует выбрать модель 2, так как гипотеза об отсутствии временных эффектов отклоняется. Это видно из того, что соответствующее P-значение меньше 0,01 (0,05). 
Таким образом, наилучшей является модель 2.
 б . Расчетное значение тестовой статистики по модулю равно 
−05 ,
,/00510= . Критическое значение при уровне значимости 5% равно 1,96, что меньше расчетного по модулю. Следовательно, тестируемая гипотеза отклоняется, поэтому мы делаем вывод о том, что есть связь между принятием закона и уровнем преступности. 
Можно тестировать гипотезу для 1%-го уровня значимости. Вывод останется аналогичным. 
Для интерпретации коэффициента воспользуемся формулой из гл. 4: 
05,
( −°) 100% =−39%.
e− 1 
При прочих равных условиях введение закона приводит к снижению количества преступлений на 39%. 
Задание 4 . Есть ли дискриминация? 
а . Результаты оценивания модели представлены в табл. Р.9.1. Коэффициенты при переменных exp × female и female значимы при уровне значимости 5% и отрицательны. Таким образом, при равном опыте работы и квалификации женщины получают более низкую зарплату, чем мужчины. Каждый дополнительный год работы обеспечивает мужчине прибавку к зарплате около 13%, а женщине — на 4 процентных пункта меньше, т.е. ежегодная прибавка составляет всего около 9%. 
Женщина без опыта работы получает зарплату примерно на 15% ниже, чем мужчина без опыта работы и с таким же уровнем образова
,0 159 
ния: (e− −°1) 100% =−15%. 
Таблица Р.9.1 
Результаты оценки регрессии пула 
Зависимая переменная: l_wage 
const  2,750** 
 (0,060)  
exp  0,131** 
 (0,003)  
educ  0,049** 
 (0,005)  
exp ×  female  −0,042** 
 (0,005)  
female  −0,159** 
 (0,035)  

n 1000 R2 0,733 
* − значимость на 10%-м уровне; ** − значимость на 5%-м уровне. 
б . Переменная female не может быть включена в уравнение, так как она не меняется во времени, и ее добавление вместе с фиксированными эффектами приведет к чистой мультиколлинеарности. 
Результаты оценивания представлены в табл. Р.9.2 в столбце (б). Коэффициент при переменной exp × female значим на уровне 5% и отрицателен. Таким образом, женщины получают более низкую прибавку к зарплате за опыт работы, чем мужчины: каждый дополнительный год работы обеспечивает мужчине прибавку к зарплате около 9%, а женщине — на 6 процентных пунктов меньше, т.е. всего около 3%. 
P-значение теста на отсутствие фиксированных эффектов меньше одной сотой. Следовательно, при уровне значимости 1% мы отвергаем гипотезу об их отсутствии и заключаем, что добавление в уравнение фиксированных эффектов оправдано. 
Таблица Р.9.2 
Результаты оценки моделей с фиксированными и случайными эффектами 
Зависимая переменная: l_wage 
(б) (в) (г)const 3,066** 2,437** 2,519**(0,081) (0,105) (0,055) exp 0,085** 0,148** 0,154**(0,007) (0,010) (0,003)educ 0,044** 0,072** 0,064**(0,007) (0,007) (0,004) exp × female −0,058** −0,055** −0,062**(0,010) (0,010) (0,003)dt_2 — −0,245** −0,242**(0,026) (0,016) n 1000 1000 1000 Испр. R2 0,348 0,441 — 
* − значимость на 10%-м уровне; ** − значимость на 5%-м уровне. 
в . Результаты оценивания модели представлены в табл. Р.9.2 в столбце (в). Коэффициент при переменной exp × female значим на 5%-м уровне и отрицателен. Таким образом, женщины получают более низкую прибавку к зарплате за опыт работы, чем мужчины. 
P-значение теста на отсутствие фиксированных эффектов индивидов меньше одной сотой. Следовательно, при уровне значимости 1% мы отвергаем гипотезу об однородности индивидов и заключаем, что добавление в уравнение фиксированных эффектов оправдано. 
P-значение теста на отсутствие фиксированных эффектов времени также меньше одной сотой. Следовательно, при уровне значимости 1% мы отвергаем гипотезу об их отсутствии и заключаем, что добавление в уравнение фиктивной переменной времени оправдано. 
г . Результаты оценивания модели представлены в табл. Р.9.2 в столбце (г). Коэффициент при переменной exp × female, как и прежде, значим на 5%-м уровне и отрицателен. Таким образом, в рамках этой модели женщины тоже получают более низкую прибавку к зарплате за опыт работы, чем мужчины. 
Этот вывод можно сделать на основе интерпретации результатов всех оцененных нами моделей. 
P-значение теста Бреуша — Пагана меньше одной сотой. Следовательно, при уровне значимости 1% мы отвергаем гипотезу о равенстве нулю дисперсии случайных эффектов и заключаем, что модель со случайными эффектами предпочтительна по отношению к модели без индивидуальных эффектов. 
P-значение теста Хаусмана больше 0,05. Следовательно, при уровне значимости 5% (равно как и при уровне значимости 1%) мы не отвергаем гипотезу состоятельности ОМНК-оценок модели со случайными эффектами. 
Задание 5 . Государственный долг и экономический рост 
а . В результате импорта должно получиться 18 объектов и 31 период. Создадим новые переменные: 
1. l_realGDP — логарифм реального ВВП. 
° Pop ˙
t
2. Popgrowth — темп прироста населения ˝−1ˇ˘100. Если не 
˛ Pop ˆ
t −1 
умножить на 100, то из-за разных размерностей (слева — проценты, справа — доли) коэффициент при этой переменной в модели будет слишком большим по сравнению с остальными коэффициентами модели. Это не представляет проблемы, но разный порядок коэффициентов в модели может вызвать у неопытного читателя вопросы касательно интерпретации коэффициентов1. 
3. Sq_Debtgov — квадрат переменной Debtgov. Сводные результаты оценивания представлены в табл. Р.9.3. б . Выберем среди оцененных моделей «лучшую». Тест «на различие констант в группах» сравнивает обычную МНК
модель и модель с фиксированными эффектами. По результатам этого теста (см. табл. Р.9.3) нулевая гипотеза об отсутствии фиксированных эффектов отвергается: 
P-значение около нуля, т.е. меньше любого разумного уровня значимости. Поэтому модель с фиксированными эффектами предпочтительнее, чем обычная МНК-модель. 
Тест Бреуша − Пагана сравнивает обычную МНК-модель и модель со случайными эффектами. По его результатам нулевая гипотеза об отсутствии случайных эффектов отвергается (P-значение около нуля, т.е. меньше любого разумного уровня значимости), поэтому модель со случайными эффектами предпочтительнее, чем обычная МНК-модель. 
Тест Хаусмана сравнивает модель с фиксированными эффектами и модель со случайными эффектами. По результатам этого теста нулевая гипотеза о состоятельности ОМНК-оценок, получаемых в модели 
Хорошая заметка с подробными объяснениями, что «самый большой» коэффициент при переменной не делает ее «самой главной» в модели, есть в блоге Дэйва Джайлса, профессора Университета Виктории в Канаде [URL: http://davegiles.blogspot.ru/2013/08/ large-and-small-regression-coefficients.html, дата обращения 16.09.2016]. 
со случайными эффектами, отвергается, поскольку P-значение снова меньше любого разумного уровня значимости. Поэтому модель с фиксированными эффектами предпочтительнее, чем модель со случайными эффектами. 
Таким образом, по результатам трех тестов выбираем модель с фиксированными эффектами. 
Таблица Р.9.3 
Результаты оценки трех моделей 
Модель МодельОбычная с фиксированными со случайнымиМНК-модель 
эффектами эффектами 47,39 *** 80,29*** 47,39***Константа 
(6,94) (6,04) (6,04)Валовые национальные 0,06* 0,11** 0,06*** сбережения (лаг) (0,037) (0,05) (0,02)Реальный ВВП на душу 
−5,24*** −7,67*** −5,23***населения (логарифм, 
(0,74) (1,69) (0,63)
лаг)Темп прироста населе-−0,13 −0,56* −0,13 ния (лаг) (0,34) (0,29) (0,22)Открытость экономики −0,009** 0,016 −0,009** (лаг) (0,004) (0,014) (0,003)Среднее число лет об
0,31*** −0,22 0,31***учения среди населе
(0,099) (0,39) (0,007)ния старше 15 (лаг)Демографическая на0,07 −0,05 0,07**грузка (детьми и по
(0,06) (0,067) (0,03)
жилыми, лаг) −0,23*** −0,32*** −0,23***
Инфляция (лаг) 
(0,035) (0,06) (0,03)Банковские кризисы −1,82*** −1,88*** −1,82*** (лаг) (0,33) (0,3) (0,25)Государственный долг 5,1*** 5,48** 5,1*** (лаг) (1,654) (2,33) (1,32)Квадрат государствен-−2,88*** −2,54*** −2,88*** ного долга (лаг) (0,75) (0,9) (0,69)Расчетное значение «порога» отношения 88% 108% 89% госдолга к ВВП Тест на различие констант в группах — 0,0000 — (P-значение)Тест Бреуша − Пагана 
— — 0,0000(P-значение)Тест Хаусмана — — 0,0000
(P-значение)Число наблюдений 522 522 522 
Примечание: ***, **, * − соответствуют значимости на уровне 1%, 5% и 10%. 
в . На основе полученных по выбранной модели оценок рассчитаем «пороговое значение» уровня государственного долга (как вершину параболы). 
Расчетное значение составляет приблизительно 5,48/(2 · 2,54) = 1,08, т.е. точечная оценка «порога» государственного долга равна 108% ВВП. 
Гипотеза о равенстве порогового значения 90% проверяется с помощью теста на линейные ограничения. Гипотеза «вершина параболы равна 90%» может быть записана в виде: −b/2a = 0,9, а для теста на линейные ограничения нулевая гипотеза переписывается как 1,8 · a + b = 0. В данном тесте было получено P-значение 0,24, что больше 0,05, поэтому нулевая гипотеза не отвергается при уровне значимости 5%. 
Данные не противоречат тому, что «пороговое значение» государственного долга составляет 90% ВВП. 
Задание 6 
В этом случае оценка модели в первых разностях имеет вид: 
nn
˙xy (x − x )(y − y )
˝ i ˙ i ˝ i2 i1 i2 i1
^ i=1 i=1
˜= = ..
FD nn
(˙x )2 (x − )2
˝i=1 i ˝i=1 i2 xi1 
Внутригрупповое преобразование предполагает вычисление следующей оценки: 
n 2 ˆ x +x &#23;ˆ y +y &#23;
i1 i2 i1 i2 
n 2 ˙˙˘x − &#21;˘y −&#21;
xy i=1 t =1 it it
˙˙ ˇ 2 &#22;ˇ 2 &#22;
 i=1 t =1 it it
˜== = 
n 22
()x 2 n 2 ˆ x +x &#23; 
iit i1
˙˙=1 t =1 x − i2




˙˙˘ &#21;
i=1 t =1 it 2
ˇ&#22; 
n ˛ x − x ˆ˛ y − y ˆ n ˛ x − x ˆ˛ y − y ˆ
i2 i1 i2 i1 i1 i2 i1 i2
&#22;˙ ˘˙ ˘+&#22;˙ ˘˙ ˘
i=12 2 i=12 2
˝ ˇ˝ ˇ˝ ˇ˝ ˇ 
== 
n ˛ x − x ˆ2 n ˛ x − x ˆ2 
i2 i1 i1 i2
+
&#22;˙ ˘&#22;˙ ˘
i=12 i=12
˝ˇ˝ˇ 
n
˙(x − x )(y − y )
i=1 i2 i1 i2 i1 
= . 
n 2 
x − x
˙i=1( i2 i1 ) 
Таким образом, мы показали, что эти оценки численно совпадают друг с другом. 
Задание 7 . Про внутригрупповую и межгрупповую дисперсию 
а . Внутригрупповое преобразование состоит в том, что от исходной регрессии следует перейти к регрессии в отклонениях от средних по времени значений: 
(y − y ) =˙˛(x − x ) + (u − u ).
iti it i iti 
Параметр этой преобразованной модели следует оценить при помощи МНК. Внутригрупповая оценка имеет вид: 
3 100

xy˛
^ ˝˝= i 1 it it
t 1 =
˜= ,
3 100
()2 
t it
˝˝=1 i=1 x 
где y = (y − y ); x= (x − x );
it iti it iti 
˝ y + y + y ˇ˝ 2y − y − y ˇ
i1 i2 i3 i1 i2 i3
var()var ˆ y − &#23;=ˆ &#23;=
y = var
i1 i1 
33
˙ ˘˙˘ 
11 
= var(2u − u − u ) = (var(2u ) + var(u ) + var(u )) = 
i1 i2 i3 i1 i2 i3
99 1 12 
= (4var(u + u ) +var(u ) = ˛˛22
)var( ) 6 ˝= ˝;
i1 i2 i3
9 93 ˛ 3 100 ˆ

xyˇ 2
˘˘ it it &#21;
^ ˙ t =1 i=1 &#22;
var(˜)var .
== 
˙ 3 100 &#22; 3 100
˙ ()x 2 ()2
˝˘˘ it &#23;&#22;˘˘ xit
t =1 i=1 t =1 i=1 
2
° 
^ 
Ответ: var(˜) = .
3 100
(x −x )2
˙˙ it
t =1 i=1 i 
б . В первом случае слагаемые x − x будут маленькими по абсолют
it i 
3 1000 2
ной величине. Следовательно, сумма их квадратов ˛˛ (x − x )
t =1 i=1 it i 
тоже будет мала, и из-за этого дисперсия оценки будет большой. 
Во втором случае все будет наоборот. Поэтому во втором случае оценка будет более точной. 
Задание 8 . Динамическая панель 
а . Переход к первым разностям приведет к получению следующей модели: 
y − y =˝(y − y ) + (˙ −˙ ). 
i3 i2 i2 i1 i3 i2 
В этой модели регрессором является разность (y − y ), а случай
i2 i1 ной ошибкой — разность (˜ −˜ ). Обратите внимание, что регрессор
i3 i2 
будет эндогенным, так как он коррелирован со случайной ошибкой. Действительно, одно из слагаемых регрессора (yi2) непосредственно зависит от одного из слагаемых случайной ошибки (˝i2): 
y =˛y +µ +˙ ;
i2 i1 ii2 
cov(˜y +µ+˛ − y , ˛ −˛ ) = 
i1 ii2 i1 i3 i2 
−cov(˝y +µ+ˆ −y , ˆ ) =−var(ˆ ).
i1 ii2 i1 i2 i2 
Эндогенность регрессора, как мы знаем из гл. 7, приводит к несостоятельности оценки коэффициента. 
б . Проблема может быть решена, например, при помощи двухшагового МНК. В данном случае в качестве инструмента подойдет переменная y . Она релевантна (так как коррелирована с регрессором y – y ) и
i1 i2 i1 
экзогенна (так как не коррелирована со случайной ошибкой ˜ −˜ ) 1.
i3 i2 
1 Кроме того, на практике для получения состоятельных оценок в динамических панельных моделях обычно используется процедура Ареллано — Бонда. Ее описание выходит за рамки нашего вводного курса, однако заинтересованный читатель может ознакомиться с деталями в статье: Arellano, Manuel, Bond, Stephen (1991). Some tests of specification for panel data: Monte Carlo evidence and an application to employment equations // Review of Economic Studies. Vol. 58 (2). Pp. 277. 
К ГЛАВЕ 10 
Задание 1 . Кто купит попкорн? 
ln()
L
1
а . pseudo-R2 =− .
ln()0
L 
ln()0
L Модель 1: pseudo-R2 =− =.
10 
ln()0
L 
51 
0 136.
Модель 2: pseudo-R2 =−1 =,
59 
50
1 =,
Модель 3: pseudo-R2 =− 0 153. 
59 
б . LR 2 lnLR −lnLUR ) 2( 51+ )
=− ( =−− 50 =2. 
Критическое значение тестовой статистики Хи-квадрат(2) при уровне значимости 5% равно 5,99. Расчетное значение меньше критического, следовательно, гипотеза о равенстве нулю коэффициентов при добавленных переменных не отвергается. Делаем вывод о том, что добавление переменных не оправдано. Модель 2 является предпочтительной. 
в . Влияние значимо, так как 0,1/0,01 >1,96. 
Предельный эффект: 
−(˙+˙ x) −−( 52+01, ˛500) 2
dp e 12 ee 
= ˛˙= ˛01 =˛01 = ,.
, , 001 
dx (1+e−(˙1+˙2x))2 2(1 +e−−( 52+01, ˛500))2 (1 +e22) 
Иными словами, один дополнительный доллар дохода для среднего по выборке посетителя увеличит вероятность покупки попкорна на 1 процентный пункт. 
Задание 2 . Усилия и результат 
а . 
2000 
− 30 ˝05,
^ xy − xy 100 20 −15 5
˜== === ,
0 025;
2 
2 2 110000 1100 − 900 200
−()x − 2
x 30
100 
^^
˜ y ˜x 05 , ˝ =−025 
=− ˝=, −0025 30 ,.
12 
R2 можно вычислять разными способами. Самый простой в данном случае, пожалуй, следующий: 
y2 − y 2 = , − 025025 
() 05, = ,; 
(xy − xy)2 25
2  2
(,)) ,5R = (corr xy = == 0 5. 
2 2 2 2200 ˛025 
(x −(x))(˛ y − (y)) , 
Увеличение времени подготовки на 1 ч увеличивает вероятность сдать экзамен на 2,5 процентных пункта (на 0,025). 
б . z =−351117+ , ˝30 =0
,; 
^
dp = e−z ˛˙2 = 117, = ,,
0 2925 
−z 2
dx (1+ e )4 
т.е. на 29,25 процентных пункта. 
Задание 3 . Кому выдать кредит? 
а . Результаты оценивания модели представлены ниже. Очевидно, что при уровне значимости 5% значимыми являются все переменные, кроме переменной семейного статуса. 
Модель 1: Логит, использованы наблюдения 1-100 Зависимая переменная: defolt Стандартные ошибки рассчитаны на основе Гессиана 
Лог. правдоподобие −31,08625 Крит. Акаике 70,17250 
Коэффициент  Ст. ошибка  z  P-значение  
const home salarymarried  2,79582−1,87982−0,09365260,296437  0,8833250,8969400,02312400,671922  3,165−2,096−4,0500,4412  0,00160,0361<0,00010,6591  *** ** ***  
Среднее зав. перемен R2 МакФаддена  0,2500000,447194  Ст. откл. зав. перемен Испр. R2  0,4351940,376062  

Крит. Шварца 80,59318 Крит. Хеннана-Куинна 74,38994 
Количество ‘корректно предсказанных’ случаев = 85 (85,0%) f (beta’x) для среднего значения независимых переменных = 0,435 Критерий отношения правдоподобия: Хи-квадрат(3) = 50,2945 [0,0000] 
б . Оценив модель заново, получаем, что теперь все регрессоры значимы при уровне значимости 5%. 
В следующей таблице для новой модели указаны предельные эффекты для изменения анализируемых переменных. Можно видеть, что для среднего по выборке индивида предельный эффект увеличения зарплаты на 1 тыс. руб. составляет −0,007. То есть увеличение зарплаты на 1 тыс. руб. будет снижать вероятность дефолта примерно на 0,7 процентных пункта. 
Для индивидов, обладающих собственной недвижимостью и средней по выборке заработной платой, вероятность дефолта на 14 процентных пунктов ниже, чем у индивидов с аналогичной зарплатой, но без недвижимости. 
Модель 3: Логит, использованы наблюдения 1-100 Зависимая переменная: defolt Стандартные ошибки рассчитаны на основе Гессиана 
Коэффициент Ст. ошибка z Угл. коэф.* const 2,89817 0,854019 3,394home −1,76930 0,852664 −2,075 −0,136722salary −0,0932860 0,0230201 −4,052 −0,00746261 
Среднее зав. перемен 0,250000 Ст. откл. зав. перемен 0,435194R2 МакФаддена 0,445451 Испр. R2 0,392102Лог. правдоподобие −31,18427 Крит. Акаике 68,36853Крит. Шварца 76,18404 Крит. Хеннана-Куинна 71,53161 
*Вычисления для среднего значения Количество ‘корректно предсказанных’ случаев = 86 (86,0%) f(beta’x) для среднего значения независимых переменных = 0,435 Критерий отношения правдоподобия: Хи-квадрат(2) = 50,0985 [0,0000] 
в . Для индивида с указанными характеристиками вероятность дефолта составляет немного менее 10%. Поэтому в соответствии с критерием банка ему следует выдать кредит. 
Задание 4 . Кому выдать кредит? 
а . Результаты оценивания модели представлены ниже. Легко видеть, что на 5% уровне значимыми являются все переменные, кроме переменной семейного статуса. Модель 1: Пробит, использованы наблюдения 1-100 Зависимая переменная: defolt Стандартные ошибки рассчитаны на основе Гессиана 
Коэффициент Ст. ошибка zP-значение const 1,53065 0,466678 3,280 0,0010 *** home −1,07425 0,500588 −2,146 0,0319 ** salary −0,0520034 0,0116131 −4,478 7,54e-06 *** married 0,100176 0,374872 0,2672 0,7893 
Среднее зав. перемен 0,250000 Ст. откл. зав. перемен 0,435194R2 МакФаддена 0,449395 Испр. R2 0,378263Лог. Правдоподобие −30,96246 Крит. Акаике 69,92492Крит. Шварца 80,34560 Крит. Хеннана-Куинна 74,14236 
Количество ‘корректно предсказанных’ случаев = 85 (85,0%) f(beta’x) для среднего значения независимых переменных = 0,155 Критерий отношения правдоподобия: Хи-квадрат(3) = 50,5421 [0,0000] 
б . Оценив модель заново, получаем, что теперь все регрессоры значимы на уровне 5%. 
В следующей таблице для новой модели указаны предельные эффекты для изменения анализируемых переменных. Можно видеть, что для среднего по выборке индивида предельный эффект увеличения зарплаты на 1 тыс. руб. составляет −0,008. То есть увеличение зарплаты на 1 тыс. руб. будет снижать вероятность дефолта примерно на 0,8 процентных пункта. 
Для индивидов, обладающих собственной недвижимостью и средней по выборке заработной платой, вероятность дефолта на 15 процентных пунктов ниже, чем у индивидов с аналогичной зарплатой, но без недвижимости. 
Модель 3: Пробит, использованы наблюдения 1-100 Зависимая переменная: defolt Стандартные ошибки рассчитаны на основе Гессиана 
Коэффициент Ст. ошибка z Угл. коэф. const 1,58106 0,430075 3,676home −1,04204 0,483037 −2,157 −0,152504salary −0,0522280 0,0116518 −4,482 −0,00809593 
Среднее зав. перемен  0,250000 Ст. откл. зав. перемен 0,435194R2 МакФаддена  0,448759 Испр. R2 0,395410Лог. Правдоподобие −30,99820 Крит. Акаике 67,99641Крит. Шварца 75,81192 Крит. Хеннана-Куинна 71,15949 
Количество ‘корректно предсказанных’ случаев = 85 (85,0%) f(beta’x) для среднего значения независимых переменных = 0,155 Критерий отношения правдоподобия: Хи-квадрат(2) = 50,4706 [0,0000] 
в . Для индивида с указанными характеристиками вероятность дефолта составляет всего 8%. Поэтому в соответствии с критерием банка ему следует выдать кредит. 
В целом полученные результаты построения пробит-модели похожи на результаты применения логит-анализа. 
Итоговая логит-модель характеризуется незначительно более точным прогнозом внутри выборки (86% верно предсказанных исходов вместо 85%). 
Задание 5 . Оценка параметров 
1 
==(
Py( 1) F˝+˝x) = ;
i 12 i (˝˝x)
−+ 
1+e 12 i 
16 610 18
LF= () F( +˝ )( − F())( − F
˝˝ 1 ˝ 1(˝ +˝ )) ;
1121 12 
ln L=16ln F˝+ 6ln F˝ +˝ ) +101 − F( )) +18ln( − F˝ +˝ )).
()( ln( ˝ 1(
1121 12 
Оптимизационная задача состоит в том, чтобы максимизировать этот логарифм функции правдоподобия по ° 1 и ° 2. Необходимое условие экстремума: 
˜ln L () ˆ () (
16F ˛ˆ 6F ˛( +ˆ ) 10F ˛ˆ 18F ˛ˆ +ˆ )
112 112
=+−− = 0;
˜ˆ F () F ( +ˆ )1− F ()1− F ˆ +ˆ )
ˆˆ ˆ (
1112 1 12 
˜ln L 6F ˛(ˆ +ˆ ) 18F ˛(ˆ +ˆ )
12 12
=− = 0. 
˜ˆ F (ˆ +ˆ )1− F (ˆ +ˆ )
2 12 12 С учетом того, что для логистической функции всегда ˜> 0, по-
Fz() 81
лученную систему легко упростить до F () = и F (˜ +˜ ) = .
˜113 124 ^^ 
= 047 ,.
Отсюда находим, что ˜1 ,; ˜2 =−157 
Задание 6 . Тест по вождению автомобиля 
а . Ф(0,06 · 5 + 0,7) = 0,841; Ф(0,08 · 5 − 0,17 − 0,04 · 5 + 0,80) = 0,797. б . Ф’(0,08 · 5 − 0,17 − 0,04 · 5 + 0,80) · (0,08 − 0,04) = 0,011. в . −0,04/0,01 = −4. По модулю эта величина больше, чем 1,96. Сле
довательно, коэффициент при переменной Male × Experience статистически значим на 5%-м уровне. Поэтому можно заключить, что влияние опыта вождения на успешность сдачи экзамена зависит от пола. 
К ГЛАВЕ 11 
Задание 1 . Регрессия на бинарную переменную 
Нужно доказать, что МНК-оценка коэффициента при переменной в 
^ ^^ 
регрессии на бинарную переменную Y ˝˝D
=+˛ равна:
i 12 i 
^
˜= − ,
YY
210 
° Yi
D=1 где Y1 = i — среднее выборочное значение зависимой пере
n
1 
менной для тех наблюдений, для которых Di = 1 (обозначим число таких наблюдений n1); 
° Y
D=0 i Y = i — среднее выборочное значение зависимой перемен
0 
n
0 ной для тех наблюдений, для которых Di = 0 (обозначим число таких наблюдений n0). 
Таким образом, общее число наблюдений составляет n0 + n1 = n. Воспользуемся формулой МНК-оценки коэффициента при переменной в модели парной регрессии: 
0 ˛ Y +1˛ YY + Y
˙D=0 i ˙D=1 in ˙D=0 i ˙D=1 i
ii 1 ii
DY− DY˛= −= 
n nn 
(n + n) Y − nY − nY
01 ˝D=1 i 1˝D=0 i 1˝D=1 i
ii i
== 
2
n nY − nY0 ˛D=1 i 1 ˛D=0 i = ii ;
2
n 
nn2 nn( + n) − n2 nn
2 211 101 1 01
D − ()D =−= = ;
22 2
n 
nn n 
nY −nY
DY−˝ 0 ˙D=1 i 1 ˙D=0 i
DY
^ ii
˜== = 
2 
22 nn
D −()D 01 
i
˛D=1Y ˛D=0Yi
ii
=− −
= YY
0.
1
nn
10 ^ 
Теперь найдем оценку ° 1: 
Y + Y ˙ YY˘
&#21;D=0 i &#21;D=1 i ˇ&#21;D=1 i &#21;D=0 i&#22;n
^^ ii ii 1
˜=−˜D= −−
Y = 
12 n ˇ nn &#22;n
ˇ 10 &#22;
ˆ&#23; 
1 ˛ nˆ&#23;D=0Yi
1 i
=˙1+ ˘&#23;Yi ==Y0. 
n˝ n ˇ n
0 D=00
i 
Задание 2 . Правильная доля 
Требуемая дисперсия для случая гомоскедастичности равна (см. гл. 2): 
22
°° 
^
var(˜ |, ,, D)
DD …= == 
212 n 22
ˇ(D− D) ˇ(D−˛)
ii 
2 22
˙ ˙˙ 
== = .
22 22
˝1−ˆ) +n ˝ˆ n˝˝−ˆ1 ˆ) +˝− ˝) nˆ( ˆ
n (( n(1 ˆˆ ˝˝−1)
10 Выражение ˜(1 ˜ /. В этом случае ди
°−) максимально при ˜=12 сперсия оценки будет минимальной. Следовательно, для получения максимально точной оценки при заданном объеме выборки необходимо включить в испытуемую группу половину объектов. 
Задание 3 . Метод разности разностей и МНК 
Обозначим qчисло объектов в группе, подвергшейся воздействию, а mчисло элементов в контрольной группе. Тогда общее число наблюдений в каждом из двух периодов равно (m+ q), а общее число наблюдений в двух периодах равно n= 2(m+ q). 
В этом случае матрица регрессоров X будет состоять из четырех столбцов: первый столбец отвечает за константу, второй — за переменную x, третий — за переменную z, четвертый — за переменную zx. Эта матрица может быть записана так: 
• 
первые m строк — наблюдения, относящиеся к контрольной группе и первому периоду; 

• 
следующие m строк — наблюдения, относящиеся к контрольной группе и второму периоду; 

• 
следующие q строк — наблюдения, относящиеся к treatment группе и первому периоду; 

• 
последние q строк — наблюдения, относящиеся к treatment группе и второму периоду. 


В этом случае в первом столбце матрицы X будут только единицы. Во втором столбце будет 2m нулей, потом 2q единиц. В третьем столбце будет m нулей, потом m единиц, потом q нулей, потом q единиц. В четвертом столбце будет (2m + q) нулей, а потом q единиц. 
Если записать такую матрицу и вычислить величину XX&#17; , то получим: 
˝
2 + )2q +
(mq mqq 2q 2qqq 
ˇ ˆ ˆ ˆ ˆ˙ &#23; &#23; &#23; &#23;˘ 
˜
XX 
Найдем обратную к ней матрицу: 
= 
. 
mq+ q +mqq q qqq 
˙
1  −1  −1  1  
−1 −1  +mq q 1  1 2  +mq− q −2  

mq++
mq
1 −−22 
qq 
˘ 
ˇ ˇ ˇ ˇ ˇ ˇˇˆ 
&#22; &#22; &#22; &#22; &#22; &#22;&#22;&#23; 
1
(XX˜ )−1
= 
. 
m 
Вектор X’y будет иметь длину 4: 
• 
Первый элемент вектора — сумма всех значений y. 

• 
Второй элемент вектора — сумма всех значений y, относящихся к treatment группе. 

• 
Третий элемент вектора — сумма всех значений y, относящихся ко второму периоду. 

• 
Четвертый элемент вектора — сумма всех значений y, относящихся к treatment группе и ко второму периоду: 


˙ 2m 2 + 2 +˘
m mq mq2 y + y + y + y
ˇ˝i ˝i ˝i ˝ i &#22; 
ˇ&#22;
= im=+ i=2m+ i=2m++1
i 11 1 q
ˇ&#22; 
mq2
2mq+ 2 +
ˇ&#22; 
ˇ˝yi +˝yi &#22; ˇ i=2m+1 =2 ++1 &#22;
i mq
Xy˜= .
ˇ&#22;
mq2
2m 2 +
ˇ&#22;
y + y
ˇ˝i ˝ i &#22; 
ˇ im=+1 i=2mq 1 &#22;
++ 
ˇ 2mq+2 &#22; ˇ&#22; ˇ˝yi &#22;
ˆ i=2m+q+1 &#23; 
Чтобы выяснить все оценки коэффициентов, осталось подсчитать произведение (XX˜ )−1 Xy˜ . Но нам для ответа на вопрос достаточно выяснить оценку коэффициента при самой последней переменной. Для 
−
этого нужно умножить последнюю строчку матрицы (XX˜ ) 1 на вектор Xy&#17; . В итоге получим: 
2mq+ 2 + ˆ y + y + y + y &#23;− 
˝ m 2m mq2 ˇ

1 ˛ i ˛ i ˛ i ˛ i
m ˆ&#23;
1 im 1 i=2m 1 i=2mq 1
˙i= =+ + ++˘ 
˛ mq 2 +2 ˆ
2 + mq
˛ 11 ˆ
−+ ˙ y + y ˘−

&#22; i &#22; i
˝˙ qm ˇ˘˙ ˘
˝i=2m+1 i=2m+q+1 ˇ 
˛22mq+2 ˆ 2mq
m +2
2 ˛22 ˆ
−˙ y +&#22;y ˘++&#22; =
&#22;ii ˙˘ yi
m ˙ ˘˝qm ˇ
˝im 1 i=2mq 1 ˇ i= ++1
=+ ++ 2mq 
˛ 2 +22mq+ˆ 2 m ˆ
mq ˛ m
11 11 
=˙ y − y ˘−˙ y − y ˘=

&#22; i &#22;i &#22;i &#22;i
˙qq ˘˙mm ˘
˝i=2m++ i=2m+ˇ im 1
q 11 ˝ =+ i=1 ˇ 
= [y − y ]−[y − y ].
, treatmentbefore, control, after conttrol, before
treatmentafter 
Задание 4 . Метод разности разностей и МНК (продолжение) 
Задание сводится к заданию 1 из этой главы. Для этого достаточно в решении задания 1 заменить Yi на &#16;Yi , а Di на xi. 
Задание 5 . Минимальная зарплата и безработица в Вестеросе 
Ytreatmentbefore 10 +10 + 911+ 
==10;
, 
4 
8897Ytreatmentafter = +++ =8;
, 
4 
11+12 +13 +13 +11 
==12;
Ycontrolbefore 5
, 
77789Ycontrolafter = ++++ =76,;
, 
5 ^
˜= [Y −Y ]−[Y −Y ] = 
treatmentafter, treatmentbefore, control, after coontrol, before 
=−[810]−[,7612− ] =−2 +44, =24,. 
Таким образом, введение минимальной заработной платы увеличивает уровень безработицы в среднем на 2,4 процентных пункта (как мы увидим далее, этот эффект статистически значим). 
Без использования метода «разность разностей» уловить этот эффект было бы затруднительно, так как легко видеть, что если рассматривать отдельно регионы, которые ввели минимальную зарплату, то безработица в них падает. Однако если бы они не ввели минимальную заработную плату, то она упала бы еще сильнее. Объясняется это тем, что, судя по данным, безработица падает в Вестеросе в целом (видимо, в 2014 г. в королевстве начался циклический подъем). 
б . Используя формулы из гл. 11, получаем: 
^
˜= =12;
0, 
Ycontrolbefore 
^
˜=Y −Y =−2;
1 treatmentbefore,,control before 
^
˜=Y −Y =−44,;
, controlbefore,
2 controlafter 
^
˜= [Y −Y ]−[Y −Y ] = 
treatmentafter, treatmentbefore, control, after coontrol, before 
=−[810]−[,7612− ] =−2 +44, =24,. 
МНК-оценка коэффициента при переменной xi · zt совпадает с оценкой эффекта от введения минимальной заработной платы, полученной в предыдущем пункте. 
в . Критическое значение t-статистики при уровне значимости 5%: t(18 − 4) = t(14) = 2,145. Вычислив расчетные значения для всех коэффициентов, можем сделать вывод, что все расчетные значения больше критического, и, следовательно, все коэффициенты значимы. 
Интерпретация: 
В регионах, которые приняли решение о вводе минимальной заработной платы, перед принятием этого решения (т.е. в 2013 г.) уровень безработицы был в среднем на 2 процентных пункта ниже, чем в остальных регионах. 
В регионах, которые не использовали закон о минимальной заработной плате, уровень безработицы снизился в среднем на 4 процентных пункта. 
Введение минимальной заработной платы увеличивает уровень безработицы в среднем на 2,4 процентных пункта. 
Задание 6 . Закон о запрете продажи алкоголя 
a . 
Id  t  Y  X  y*  x*  x*y*  (x*)^2  
1  0  6  0  0  −0,5  0  0,25  
1  1  6  1  0  0,5  0  0,25  
2  0  6  0  −1  −0,5  0,5  0,25  
2  1  8  1  1  0,5  0,5  0,25  
3  0  8  0  −0,5  −0,5  0,25  0,25  
3  1  9  1  0,5  0,5  0,25  0,25  
4  0  4  0  −0,5  −0,5  0,25  0,25  
4  1  5  1  0,5  0,5  0,25  0,25  
5  0  4  0  −1  0  0  0  
5  1  6  0  1  0  0  0  
6  0  3  0  −1  0  0  0  
6  1  5  0  1  0  0  0  
7  0  3  0  −1  0  0  0  
7  1  5  0  1  0  0  0  
8  0  2  0  −1  0  0  0  
8  1  4  0  1  0  0  0  
сумма  2  2  

** 
xy
^ ˛˛ it it 2
˜= ==1. 
x*2 2


˛˛()
it 
Введение закона приводит к увеличению потребления алкоголя на 1 л на человека в год. 
б . 
6684 
=+++ =6;
Ytreatmentbefore 4
, 
6 +++
895 
==7;
Ytreatmentafter 4
, 
4332 
= +++ =3;
Ycontrolbefore 4
, 
6554 
= +++ =5;
Ycontrolafter 4
, 
^
˜=[Y −Y ]−[Y −Y ] =−1.
treatmentafter, treatmentbefore, control, after coontrol, before 
Введение закона приводит к снижению потребления алкоголя на 1 л на человека в год. 
в . Спецификация в пункте (а) не учитывает временной эффект, в то время как, судя по данным, наблюдается явная тенденция к росту зависимой переменной со временем. Метод «разность разностей» этот эффект учитывает, так что оценка в пункте (б) выглядит более надежной. 
Проведя дополнительные вычисления, легко проверить, что в нашем примере, если оценить модель с фиксированными эффектами, которая учитывает фиктивную переменную времени, то она даст в точности такую же оценку коэффициента, как и метод «разность разностей», т.е. противоречие между двумя подходами будет устранено. 
Задание 7 . Инфляционное таргетирование и инфляция 
а . Если анализировать выборку в целом, то для стран, таргетирующих инфляцию, ее средний уровень до перехода составлял около 11%, а после перехода — около 6%. Однако вовсе не факт, что дело тут в инфляционном таргетировании, так как средний уровень инфляции в мире в рассматриваемые годы тоже сократился. 
б . В таблице ниже представлены результаты оценивания уравнения для развитых и развивающихся стран. Можно видеть, что в развитых странах переход к инфляционному таргетированию не сказывается на инфляции, а в развивающихся странах он ассоциируется с ее снижением примерно на 7,5 процентных пункта. Это является свидетельством в пользу эффективности инфляционного таргетирования как средства борьбы с высокими темпами роста цен в развивающихся странах. 
Развитые страны  Развивающиеся страны  
Константа  −2,27***  0,30 
(0,53)  (1,26) 
Инфляционное  −0,97  −7,48*** 
таргетирование  (1,10)  (2,81) 
Число наблюдений  32  102  
R2  0,03  0,06  

Примечание:зависимая переменная — изменение уровня инфляции; в скобках указаны робастные стандартные ошибки; *** − значимость на 1%-м уровне. 
Задание 8 . LATE и 2SLS 
Рассмотрим регрессию Y=˛ +˛ D+˝ , в которой коэффициент
i 12 ii 
при бинарной переменной Diоценивается при помощи 2МНК с бинарной переменной Ziв качестве инструмента. 
Все наши наблюдения можно представить в виде таблицы: 
D= 0i D= 1i 
Z= 0i Число наблюдений = а Сумма соответствующих значений зависимой переменной i˛Y a  Число наблюдений = b Сумма соответствующих значений зависимой переменной i˛Y b  
Z= 0i Число наблюдений = c Сумма соответствующих значений зависимой переменной ˛Yi c  Число наблюдений = d Сумма соответствующих значений зависимой переменной ˛Yi d  

Y+ Y ( +) Y+ Y+ Y+
ˇci ˇdi cd(ˇai ˇbi ˇci ˇdYi)
ZY ZY−°=− = abcd (abcd)2
+++ +++ 
+)(ˆYi+ˆdYi)(cd)(ˆYi+ˆbYi)
(ab −+ 
ca
= ;(abcd+++)2 
d (cdbd+)
+)(
DZ DZ−°=− = abcd (abcd)2
+++ +++ 
22
adbdcdd+++ bccdbdd+++ adbc
− 
= −= .
2 22
(abcd+++)(abcd+++)( +++
abcd) 
В этом случае оценка коэффициента при переменной равна: 
( +) Y+ Y −+)
ab (cd Y+ Y
di) ˘˘bi)
ZY−˝ZY (˘ ˘ci (ai
^
˜= = .2 DZ−˝DZ ad−bc 
В свою очередь, оценка LATEсоставляет: 
YY
−
 10
LATE= ,
D− D
10 
где Y1 — среднее значение зависимой переменной для индивидов, которые получили предписание; Y0 — среднее значение зависимой переменной для индивидов, которые не получили предписание; D — доля тех, кто подвергся воздействию, среди тех, кто получил
1 
предписание. В нашем примере это доля победителей лотереи, которые пошли служить; D0 — доля тех, кто подвергся воздействию, среди тех, кто не получил предписание; 
db ad− bc
D− D=−= ;
10 cd ab+ ( + )( +
+ abcd) 
˝cYi+˝dYi ˝aYi+˝bYiYY ==
−−
10 
cd+ ab
+ 
+) Y+ Y (cd) Y+ Y
(ab −+ 
= (ˆˆdi) ˆˆbi ;
ci ai 
+)( +
(abcd) 
(ab) Y+ Y (cd) Y+ Y
+ −+

YY− (ˆˆ) ˆˆ 
 10 cidi aibi ^
LATE== =ˇ..
2
D−D ad−bc
10 
Это и требовалось доказать. 
Задание 9 . Эффект от прививки 
−
YY , − ,
008009 
 10
LATE== =−01,.
D1 −D0 03, −02, 
Таким образом, прививка от гриппа снижает вероятность быть госпитализированным с респираторным заболеванием на 10 процентных пунктов. 
Задание 10 . Вакцинация 
Опираясь на результаты задания 7, вычислим оценку LATE при помощи двухшагового МНК. Результаты представлены в выдаче эконометрического пакета ниже. Из них видно, что вакцинация снижает число заболеваний примерно на 20 случаев (в расчете на 100 человек). Указанный эффект является статистически значимым на 1%-м уровне. 
Модель 1: 2МНК, использованы наблюдения 1-500 Зависимая переменная: Disease Независимые переменные: Vaccination Инструменты: const Z Робастные оценки стандартных ошибок (с поправкой на гетероскеда
стичность), вариант HC1  
Коэффициент  Ст. ошибка  t-статистика P-значение  
const  25,0684  0,176115  142,3  0,0000  ***  
Vaccination  −20,2068  0,586197  −34,47  5,44e-134  ***  

Среднее зав. перемен 20,82500 Ст. откл. зав. перемен 8,622281 Сумма кв. остатков 4267,610 Ст. ошибка модели 2,927370 R2 0,885177 Испр. R2 0,884947 F (1, 498) 1188,246 Р-значение (F) 5,4e-134 Лог. правдоподобие −3563,114 Крит. Акаике 7130,228 Крит. Шварца 7138,657 Крит. Хеннана-Куинна 7133,535 
Тест Хаусмана (Hausman) 
Нулевая гипотеза: МНК оценки состоятельны
 Асимптотическая тестовая статистика: Хи-квадрат(1) = 0,405883
 Р-значение = 0,524067 
Тест на слабые инструменты 
F-статистика для 1-го шага (1, 498) = 189,703
 Значение < 10 может указывать на слабые инструменты 
Величину ITT эффекта можно оценить при помощи обычного МНК, регрессируя зависимую переменную на переменную Z. Соответствующие результаты представлены в таблице ниже. Из нее видно, что этот эффект, как и полагается, меньше LATE по абсолютной величине и составляет примерно −9. 
Модель 2: МНК, использованы наблюдения 1-500 Зависимая переменная: Disease Робастные оценки стандартных ошибок (с поправкой на гетероскедастичность), вариант HC1 
Коэффициент Ст. ошибка t-статистика P-значение const 25,0684 0,176115 142,3 0,0000 *** Z −9,06714 0,695343 −13,04 1,21e-033 *** 
Среднее зав. перемен 20,82500 Ст. откл. зав. перемен 8,622281Сумма кв. остатков 26862,98 Ст. ошибка модели 7,344504R2 0,275882 Испр. R2 0,274428F (1, 498) 170,0367 Р-значение (F) 1,21e-33Лог. правдоподобие −1705,443 Крит. Акаике 3414,887Крит. Шварца 3423,316 Крит. Хеннана-Куинна 3418,194 
Задание 11 . Гетерогенный эффект воздействия 
а . Решение: 
−1 −1
^2 2
˛˜ˆ ˛&#22;x &#22;xwˆ ˛&#22;xyˆ˛ Ex Exwˆ˛Exyˆ
i ii iip iii ii
˘&#20;&#19;˙
˘=˙ ˘˙ &#20; ˘˙˘= 
˙^2 2
˝°ˇ ˝˙&#22;xw &#22;w ˇ˘ ˝&#22;wyiiˇ ˝˙Exw Ew ˇ˘ ˝Ewyiiˇ
iii iii 
˛
2
Ew −Ex w
i ii
˛
ˆ
ˆ
Exiiy
1
˙˙˝ 
˙˝ 
˘˘ˇ 
˘ˇ 
=
= 
22 )2
Ex Ew 
Exw Ex
ii 
2 
i 
Ewyii
− ( 
−
Ex w
ii
ii 
˝
Ew2Ex y − Exw Ew y
i ii ii ii 
−
ExwExy
ii ii 
+ 
2
Ex Ew
ii 
yi 
ˇ
1
ˆˆ˙ 
&#23;&#23;˘ 
= 
.
22 )2
Ex Ew 
− 
(
Ex w
ii
ii 
Таким образом: 
Ex2Ew y −Exw Ex y
^ p i ii iiii
˜°˛ .
° 
22 2
Ex Ew −(Ex w )
ii ii Подставим в это выражение y =° °ˆи воспользуемся
˝x +°˙xw +
i i iii 
условием экзогенности случайных ошибок: 
Ew y = E( wx + xw2) =˛ () +˝E 2
˛˝ Ewx (xw );
ii iiii ii ii 
22 22
Ex y = E( x + xw ) = E() + E
˛˝ ˛ x ˝ (xw );
iiiii i ii 
2 222
)(° () +˛E(xw )) −(Ex w )( E(x ) +˛E
(Ex Ewx ° (xw ))
^ piii ii iii ii
˜˝˙ ;˝ 
22 2
Ex Ew −(Ex w )
ii ii 
22 2 
p ()( ) −Exw Exw)(
Ex Exw ()
^ i ii ii ii
˜˛˝°
˛ .
22 2
()( ) −(Exw)
Ex Ew
ii ii 
Отметим, что для всех наблюдений wi 2 = wi. Поэтому выражение можно упростить: 
2 222
()( ) −Exw Exw)() () − ()
Ex Exw ( Ex Exw
^ p iii iiii i ii
˜˛˝° = Exw)
˛°E(.
22 ii 22
()() −(Exw) ()() −(Exw)
ExEw ExEw
iiii iiii 
Интересующий исследователя средний эффект воздействия составляет: 
E˜ =°Ex.
ii 
˛
Ex()2 − Exw(2 )
i ii
Exw)
( ii 
Ex Ew
()2 () 
ˆ 
˜
Ex 
тельна. Направление асимптотического смещения может быть произвольным. б. Решение: 
22 
p Ex() − (
Exw)
^ i ii
˛ Exw
˜ ˜˛˝° () = ii 
()2 () −(Exw 2
Ex Ew )
ii ii 
22 2
Ex − ()() Ex 1− (
() Ex Ew (()( Ew))
iii ii
() Ex
=˛Ex Ew =˛ () <˛Ex().
ii ii
2 22 22
() () Ew
Ex Ew−(Ex)(Ew) Ex −(Ex) ()
iiii i ii 
Чтобы доказать последнее неравенство, продемонстрируем, что числитель дроби меньше знаменателя. Действительно: 
2 22
1− ( Ex ) Ew
Ex()( Ew)) < () −(Ex ();
i i iii −Ew Ex()()2 <−(Ex)2 Ew();
ii ii (Ex)2 < Ex()2;
ii 0 < Ex()2 −(Ex)2;
ii 0 < var(xi). 
Оценка является несостоятельной и асимптотически заниженной. Ответ: оценка несостоятельна в обоих случаях. В пункте (а) смеще
&#23;
Так как
˙˙˝ 
˘˘ˇ 
, то оценка несостоя
i
)2
− (
Exw
ii
ii 
ние может быть в любую сторону, в пункте (б) оценка будет занижена. 
Литература 
Айвазян С.А., Фантаццини Д. 2015. Эконометрика-2: Продвинутый курс с приложениями в финансах. М.: Магистр, Инфра-М, 2015. – 944 c. 
Вербик М. 2008. Путеводитель по современной эконометрике/ Пер. с англ. В.А. Банникова / Науч. ред. и предисл. С.А. Айвазяна.  М.: Научная книга. 
Доугерти К. 2009. Введение в эконометрику: Учебник. 3-е изд. / Пер. с англ. М.: ИНФРА-М. 
Магнус Я.Р., Катышев П.К., Пересецкий А.А. 2007. Эконометрика. Начальный курс: учеб. 6-е изд., перераб. и доп. М.: Дело. 
Кэмерон Э. К., Триведи П. К. 2015. Микроэконометрика: методы и их применение. М.: Издательский дом «Дело». 
Носко В.П. 2011. Эконометрика. М.: Дело. 
Сток Дж., Уотсон М. 2015. Введение в эконометрику. М.: Издательский дом «Дело». 
Acemoglu D., Simon J., Robinson J. A. 2001. The Colonial Origins of Comparative Development: An Empirical Investigation // American Economic Review. Vol. 91(5). Pp. 1369–1401. 
Angrist J. D. 1990. Lifetime Earnings and the Vietnam Era Draft Lottery: Evidence from Social Security Administrative Records // The American Economic Review. Vol. 80. No. 3 (Jun.). Pp. 313–336. 
Angrist J.D., Pischke J.S. 2009. Mostly harmless econometrics. Princeton University Press. 
Arellano M., Bond S. 1991. Some tests of specification for panel data: Monte Carlo evidence and an application to employment equations // Review of Economic Studies. No. 58 (2). Pp. 277–297. 
Athey S., Imbens G. W. 2017. The State of Applied Econometrics: Causality and Policy Evaluation // Journal of Economic Perspectives. No. 31 (2). Pp. 3−32. 
Card D., Krueger A.B. 2000. Minimum Wages and Employment: A Case Study of the Fast-Food Industry in New Jersey and Pennsylvania // American Economic Review. Vol. 90(5). Pp. 1397–1420. 
Dougherty С. 2011. Introduction to Econometrics. 4th ed. Oxford University Press. 
Enikolopov R., Petrova M., Zhuravskaya E. 2011. Media and Political Persuasion: Evidence from Russia // American Economic Review. No. 111(7). Pp. 3253−3285. 
Greene W. H. 2003. Econometric analysis. 5th ed. Prentice Hall. 
Hayashi. 2000. Econometrics. Princeton University Press. 
Kreuger A.B. 1999. Experimental Estimates of Education Production Functions // The Quarterly Journal of Economics. 
Lee D. S. 2008. Randomized Experiments from Non-random Selection in U.S. House Elections // Journal of Econometrics. No. 142(2). Pp. 675−697. 
Mian A, Sufi A. 2011. House Prices, Home Equity–Based Borrowing, and the US Household Leverage Crisis // American Economic Review. Vol. 101(5). Pp. 2132–2156. 
Sheridan N., Ball L. 2005. Does Inflation Targeting Matter? In: The Inflation Targeting Debate. Ed. by B.S. Bernanke, M. Woodford. University of Chicago Press for the National Bureau of Economic Research. Pp. 249–276. 
Wooldridge J. M. 2010. Econometric Analysis of Cross Section and Panel Data. The MIT Press. 
Филипп Картаев 

ВВЕДЕНИЕ В ЭКОНОМЕТРИКУ 
Учебник 




